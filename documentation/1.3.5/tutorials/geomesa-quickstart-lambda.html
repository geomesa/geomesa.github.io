

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GeoMesa Lambda Quick Start &mdash; GeoMesa 1.3.5 Manuals</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="GeoMesa 1.3.5 Manuals" href="../index.html"/>
        <link rel="up" title="Tutorials" href="index.html"/>
        <link rel="next" title="GeoMesa NiFi Quick Start" href="geomesa-quickstart-nifi.html"/>
        <link rel="prev" title="GeoMesa Kafka Quick Start" href="geomesa-quickstart-kafka.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.3.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#getting-started">Getting Started</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-accumulo.html">GeoMesa Accumulo Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-hbase.html">GeoMesa HBase Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-cassandra.html">GeoMesa Cassandra Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-kafka.html">GeoMesa Kafka Quick Start</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">GeoMesa Lambda Quick Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#download-and-build-the-tutorial">Download and Build the Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#about-this-tutorial">About this Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-the-tutorial">Run the Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transient-vs-persistent-features">Transient vs Persistent Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#looking-at-the-code">Looking at the Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#re-running-the-quick-start">Re-Running the Quick Start</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-nifi.html">GeoMesa NiFi Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geodocker-geomesa/index.html">GeoDocker GeoMesa</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-hbase-s3-on-aws.html">Bootstrapping GeoMesa HBase on AWS S3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-in-out">Data In/Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-analysis">Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#security">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indexing-and-queries">Indexing and Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#about-tutorial-versions">About Tutorial Versions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">GeoMesa</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Tutorials</a> &raquo;</li>
      
    <li>GeoMesa Lambda Quick Start</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/geomesa-quickstart-lambda.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geomesa-lambda-quick-start">
<h1>GeoMesa Lambda Quick Start<a class="headerlink" href="#geomesa-lambda-quick-start" title="Permalink to this headline">¶</a></h1>
<p>This tutorial can get you started with the GeoMesa Lambda data store. Note that the Lambda data store
is for advanced use-cases - see <a class="reference internal" href="../user/lambda/overview.html#lambda-overview"><span class="std std-ref">Overview of the Lambda Data Store</span></a> for details on when to use a Lambda store.</p>
<p>In the spirit of keeping things simple, the code in this tutorial only does a few small things:</p>
<ol class="arabic simple">
<li>Establishes a new (static) SimpleFeatureType</li>
<li>Prepares the Accumulo table and Kafka topic to store this type of data</li>
<li>Creates a thousand example SimpleFeatures</li>
<li>Repeatedly updates these SimpleFeatures in the Lambda store through Kafka</li>
<li>Persists the final SimpleFeatures to Accumulo</li>
</ol>
<p>The only dynamic element in the tutorial is the Accumulo and Kafka connection;
it needs to be provided on the command-line when running the code.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before you begin, you must have the following:</p>
<ul class="simple">
<li>an instance of Accumulo 1.7 or 1.8 running on Hadoop 2.2 or better,</li>
<li>an Accumulo user that has both create-table and write permissions,</li>
<li>the GeoMesa Accumulo distributed runtime installed for your Accumulo instance (see <a class="reference internal" href="../user/accumulo/install.html#install-accumulo-runtime"><span class="std std-ref">Installing the Accumulo Distributed Runtime Library</span></a>),</li>
<li>an instance of Kafka 0.9.0.1,</li>
<li>optionally, a GeoServer instance with the Lambda data store installed (see <a class="reference internal" href="../user/lambda/install.html#install-lambda-geoserver"><span class="std std-ref">Installing GeoMesa Lambda in GeoServer</span></a>),</li>
<li>a local copy of <a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java JDK 8</a>,</li>
<li>Apache <a class="reference external" href="http://maven.apache.org/">Maven</a> installed, and</li>
<li>a GitHub client installed.</li>
</ul>
</div>
<div class="section" id="download-and-build-the-tutorial">
<h2>Download and Build the Tutorial<a class="headerlink" href="#download-and-build-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Pick a reasonable directory on your machine, and run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git clone https://github.com/geomesa/geomesa-tutorials.git
$ <span class="nb">cd</span> geomesa-tutorials
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to download a particular release of the
tutorials project to target a particular GeoMesa release.</p>
</div>
<p>To build, run</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ mvn clean install -pl geomesa-quickstart-lambda
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensure that the version of Accumulo, Hadoop, Kafka etc in
the root <code class="docutils literal"><span class="pre">pom.xml</span></code> match your environment.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Depending on the version, you may also need to build
GeoMesa locally. Instructions can be found
<a class="reference external" href="https://github.com/locationtech/geomesa/">here</a>.</p>
</div>
</div>
<div class="section" id="about-this-tutorial">
<h2>About this Tutorial<a class="headerlink" href="#about-this-tutorial" title="Permalink to this headline">¶</a></h2>
<p>The QuickStart operates by inserting 1000 features, and then updating them every 200 milliseconds. After
approximately 30 seconds, the updates stop and the features are persisted to Accumulo.</p>
</div>
<div class="section" id="run-the-tutorial">
<h2>Run the Tutorial<a class="headerlink" href="#run-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>On the command-line, run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ java -cp geomesa-quickstart-lambda/target/geomesa-quickstart-lambda-<span class="si">${</span><span class="nv">geomesa</span><span class="p">.version</span><span class="si">}</span>.jar <span class="se">\</span>
  com.example.geomesa.lambda.LambdaQuickStart <span class="se">\</span>
  --brokers &lt;brokers&gt;                         <span class="se">\</span>
  --instance &lt;instance&gt;                       <span class="se">\</span>
  --zookeepers &lt;zookeepers&gt;                   <span class="se">\</span>
  --user &lt;user&gt;                               <span class="se">\</span>
  --password &lt;password&gt;                       <span class="se">\</span>
  --catalog &lt;table&gt;
</pre></div>
</div>
<p>where you provide the following arguments:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">&lt;brokers&gt;</span></code> the host:port for your Kafka brokers</li>
<li><code class="docutils literal"><span class="pre">&lt;instance&gt;</span></code> the name of your Accumulo instance</li>
<li><code class="docutils literal"><span class="pre">&lt;zookeepers&gt;</span></code> your Zookeeper nodes, separated by commas</li>
<li><code class="docutils literal"><span class="pre">&lt;user&gt;</span></code> the name of an Accumulo user that has permissions to create, read and write tables</li>
<li><code class="docutils literal"><span class="pre">&lt;password&gt;</span></code> the password for the previously-mentioned Accumulo user</li>
<li><code class="docutils literal"><span class="pre">&lt;table&gt;</span></code> the name of the destination table that will accept these test records; this table should either not exist or should be empty</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you have set up the GeoMesa Accumulo distributed
runtime to be isolated within a namespace (see
<a class="reference internal" href="../user/accumulo/install.html#install-accumulo-runtime-namespace"><span class="std std-ref">Namespace Install</span></a>) the value of <code class="docutils literal"><span class="pre">&lt;table&gt;</span></code>
should include the namespace (e.g. <code class="docutils literal"><span class="pre">myNamespace.geomesa</span></code>).</p>
</div>
<p>Once you run the quick start, it will prompt you to load the layer in geoserver. Using the same connection
parameters you used for the quick start, register a new data store according to <a class="reference internal" href="../user/lambda/geoserver.html#create-lambda-ds-geoserver"><span class="std std-ref">Using the Lambda Data Store in GeoServer</span></a>.
After saving the store, you should be able to publish the <code class="docutils literal"><span class="pre">lambda-quick-start</span></code> layer. Open the layer preview for
the layer, then proceed with the quick start run.</p>
<p>As the quick start runs, you should be able to refresh the layer preview page and see the features moving across
the map. After approximately 30 seconds, the updates will stop, and the features will be persisted to Accumulo.</p>
</div>
<div class="section" id="transient-vs-persistent-features">
<h2>Transient vs Persistent Features<a class="headerlink" href="#transient-vs-persistent-features" title="Permalink to this headline">¶</a></h2>
<p>The layer preview will merge the results of features from Kafka with features from Accumulo. You may disable
results from one of the source by using the <code class="docutils literal"><span class="pre">viewparams</span></code> parameter:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>...<span class="p">&amp;</span><span class="nv">viewparams</span><span class="o">=</span>LAMBDA_QUERY_TRANSIENT:false
...<span class="p">&amp;</span><span class="nv">viewparams</span><span class="o">=</span>LAMBDA_QUERY_PERSISTENT:false
</pre></div>
</div>
<p>While the quick start is running, all the features should be returned from the transient store (Kafka). After the quick
start finishes, all the feature should be returned from the persistent store (Accumulo). You can play with the
<code class="docutils literal"><span class="pre">viewparams</span></code> to see the difference.</p>
</div>
<div class="section" id="looking-at-the-code">
<h2>Looking at the Code<a class="headerlink" href="#looking-at-the-code" title="Permalink to this headline">¶</a></h2>
<p>Looking at the source code, you can see that normal GeoTools <code class="docutils literal"><span class="pre">FeatureWriters</span></code> are used; feature persistence
is managed transparently for you.</p>
</div>
<div class="section" id="re-running-the-quick-start">
<h2>Re-Running the Quick Start<a class="headerlink" href="#re-running-the-quick-start" title="Permalink to this headline">¶</a></h2>
<p>The quick start relies on not having any existing state when it runs. This can cause issues with Kafka, which
by default does not delete topics when requested. To re-run the quick start, first ensure that your Kafka
instance will delete topics by setting the configuration <code class="docutils literal"><span class="pre">delete.topic.enable=true</span></code> in your server properties.
Then use the Lamdba command-line tools (see <a class="reference internal" href="../user/lambda/install.html#setting-up-lambda-commandline"><span class="std std-ref">Setting up the Lambda Command Line Tools</span></a>) to remove the quick start schema:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ geomesa-lambda remove-schema -f lambda-quick-start ...
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="geomesa-quickstart-nifi.html" class="btn btn-neutral float-right" title="GeoMesa NiFi Quick Start" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="geomesa-quickstart-kafka.html" class="btn btn-neutral" title="GeoMesa Kafka Quick Start" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2017 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>