<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>25. GeoMesa GeoJSON &mdash; GeoMesa 3.5.2 Manuals</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/geojson.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="26. GeoMesa Stream Processing" href="stream.html" />
    <link rel="prev" title="24. Combined Data Store Views" href="ds_views.html" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53087457-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53087457-1');
</script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                3.5.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="geotools.html">5. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">6. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="convert/index.html">9. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo/index.html">15. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="bigtable/index.html">17. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka/index.html">18. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis/index.html">19. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem/index.html">20. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kudu/index.html">21. Kudu Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgis/index.html">22. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda/index.html">23. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="ds_views.html">24. Combined Data Store Views</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">25. GeoMesa GeoJSON</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#geojson-api">25.1. GeoJSON API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-and-updating-features">25.1.1. Adding and Updating Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#querying-features">25.1.2. Querying Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programmatic-access">25.1.3. Programmatic Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rest-access">25.1.4. REST Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#methods">25.1.5. Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#json-attributes">25.2. JSON Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jsonpath-cql-filter-function">25.2.1. JSONPath CQL Filter Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jsonpath-with-geoserver-styles">25.2.2. JSONPath With GeoServer Styles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stream.html">26. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">27. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Manual</a></li>
      <li class="breadcrumb-item active"><span class="section-number">25. </span>GeoMesa GeoJSON</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geomesa-geojson">
<h1><span class="section-number">25. </span>GeoMesa GeoJSON<a class="headerlink" href="#geomesa-geojson" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The GeoMesa GeoJSON API is deprecated and will be removed in a future version.</p>
</div>
<p>GeoMesa provides built-in integration with GeoJSON. GeoMesa provides a GeoJSON API that allows for the
indexing and querying of GeoJSON data. The GeoJSON API does not use GeoTools - all data and operations
are pure JSON. The API also includes a REST endpoint for web integration.</p>
<p>In addition, when working with GeoTools, JSON can be stored as an attribute in a simple feature
and queried using CQL.</p>
<p>GeoMesa’s JSON processing uses <a class="reference external" href="http://goessner.net/articles/JsonPath/">JSONPath</a> for selecting JSON elements.</p>
<section id="geojson-api">
<h2><span class="section-number">25.1. </span>GeoJSON API<a class="headerlink" href="#geojson-api" title="Permalink to this headline">¶</a></h2>
<p>The GeoJSON API provides a simplified interface for spatially indexing GeoJSON. GeoJSON is ingested
by indexing the embedded geometry. Additionally, a date field can be indexed by specifying a custom
field in the <code class="docutils literal notranslate"><span class="pre">properties</span></code> element, which allows arbitrary JSON extensions.</p>
<p>Data may be accessed programmatically or through a REST endpoint.</p>
<section id="adding-and-updating-features">
<h3><span class="section-number">25.1.1. </span>Adding and Updating Features<a class="headerlink" href="#adding-and-updating-features" title="Permalink to this headline">¶</a></h3>
<p>Data is added to the index as GeoJSON strings. When creating the index, you may optionally specify an ID field
and a date field using JSONPath expressions. The ID field is required in order to update or modify features.
The date field will allow for optimized spatio-temporal queries.</p>
<p>Features can be added to the index by passing in GeoJSON objects of type <code class="docutils literal notranslate"><span class="pre">Feature</span></code> or <code class="docutils literal notranslate"><span class="pre">FeatureCollection</span></code>.
Updating or deleting features requires the corresponding feature IDs.</p>
</section>
<section id="querying-features">
<h3><span class="section-number">25.1.2. </span>Querying Features<a class="headerlink" href="#querying-features" title="Permalink to this headline">¶</a></h3>
<p>Features can be queried using a MongoDB-like JSON syntax. Results will be the original GeoJSON, or may be
transformed into arbitrary JSON py passing in a projection.</p>
<section id="predicates">
<h4><span class="section-number">25.1.2.1. </span>Predicates<a class="headerlink" href="#predicates" title="Permalink to this headline">¶</a></h4>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Predicate</p></th>
<th class="head"><p>Syntax</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>include</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>equals</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>greater-than</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;$gt&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;$gte&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>less-than</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;$lt&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;$lte&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>bounding box</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;$bbox&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">-180</span><span class="p">,</span><span class="w"> </span><span class="mi">-90</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">]</span><span class="w"> </span><span class="p">}}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>spatial intersects</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;$intersects&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;$geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;coordinates&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>spatial within</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;$within&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;$geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>spatial contains</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;$contains&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;$geometry&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;coordinates&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>and</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;baz&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>or</p></td>
<td><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;$or&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;foo&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;baz&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="transformations">
<h4><span class="section-number">25.1.2.2. </span>Transformations<a class="headerlink" href="#transformations" title="Permalink to this headline">¶</a></h4>
<p>The JSON being returned can be transformed by specifying element mappings. The transform is defined by a
map where the keys define the element in the returned JSON using dot notation, and the values specify the
JSONPath expression used to extract the value from the original GeoJSON.</p>
<p>For example, to return just the geometry you could use a mapping of <code class="docutils literal notranslate"><span class="pre">&quot;geom&quot;</span> <span class="pre">-&gt;</span> <span class="pre">&quot;geometry&quot;</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;geom&quot;</span><span class="p">:{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">]}}</span>
</pre></div>
</div>
</section>
</section>
<section id="programmatic-access">
<h3><span class="section-number">25.1.3. </span>Programmatic Access<a class="headerlink" href="#programmatic-access" title="Permalink to this headline">¶</a></h3>
<p>The main interface for programmatic access is the <code class="docutils literal notranslate"><span class="pre">GeoJsonIndex</span></code>. It can be instantiated by wrapping a
GeoMesa <code class="docutils literal notranslate"><span class="pre">DataStore</span></code>. The module is available through maven:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
<span class="w">    </span><span class="nt">&lt;groupId&gt;</span>org.locationtech.geomesa<span class="nt">&lt;/groupId&gt;</span>
<span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>geomesa-geojson-api_2.12<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">    </span><span class="nt">&lt;version&gt;</span>1.3.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<p>Example code in scala:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">geojson</span><span class="p">.{</span><span class="nc">GeoJsonGtIndex</span><span class="p">,</span><span class="w"> </span><span class="nc">GeoJsonIndex</span><span class="p">}</span>

<span class="kd">val</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">DataStoreFinder</span><span class="p">.</span><span class="n">getDataStore</span><span class="p">(...)</span><span class="w"> </span><span class="c1">// ensure this is a GeoMesa data store</span>
<span class="kd">val</span><span class="w"> </span><span class="n">index</span><span class="p">:</span><span class="w"> </span><span class="nc">GeoJsonIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">GeoJsonGtIndex</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">index</span><span class="p">.</span><span class="n">createIndex</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">Some</span><span class="p">(</span><span class="s">&quot;$.properties.id&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="s">s&quot;&quot;&quot;{ &quot;type&quot;: &quot;FeatureCollection&quot;,</span>
<span class="s">       |  &quot;features&quot;: [</span>
<span class="s">       |    {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0&quot;}},</span>
<span class="s">       |    {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[31,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1&quot;}},</span>
<span class="s">       |    {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2&quot;}}</span>
<span class="s">       |  ]</span>
<span class="s">       |}&quot;&quot;&quot;</span><span class="p">.</span><span class="n">stripMargin</span>

<span class="n">index</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">features</span><span class="p">)</span>

<span class="c1">// query by bounding box</span>
<span class="n">index</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;&quot;{ &quot;geometry&quot; : { &quot;$bbox&quot; : [29, 9, 31.5, 11] }}&quot;&quot;&quot;</span><span class="p">).</span><span class="n">toList</span>
<span class="c1">// result:</span>
<span class="c1">// {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0&quot;}}</span>
<span class="c1">// {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[31,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1&quot;}}</span>

<span class="c1">// query for all, transform JSON coming back</span>
<span class="n">index</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{}&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span><span class="s">&quot;foo.bar&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;geometry&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo.baz&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;properties.name&quot;</span><span class="p">)).</span><span class="n">toList</span>
<span class="c1">// result:</span>
<span class="c1">// {&quot;foo&quot;:{&quot;bar&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[30,10]},&quot;baz&quot;:&quot;n0&quot;}}</span>
<span class="c1">// {&quot;foo&quot;:{&quot;bar&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[31,10]},&quot;baz&quot;:&quot;n1&quot;}}</span>
<span class="c1">// {&quot;foo&quot;:{&quot;bar&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[32,10]},&quot;baz&quot;:&quot;n2&quot;}}</span>
</pre></div>
</div>
</section>
<section id="rest-access">
<h3><span class="section-number">25.1.4. </span>REST Access<a class="headerlink" href="#rest-access" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GeoJsonIndex</span></code> is also exposed through a REST endpoint. Currently, the REST endpoint does not support
transformation of responses. Furthermore, it requires Accumulo as the backing data store. It may be installed
in GeoServer by extracting the install file into <code class="docutils literal notranslate"><span class="pre">geoserver/WEB-INF/lib</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>tar<span class="w"> </span>-xf<span class="w"> </span>geomesa-geojson/geomesa-geojson-gs-plugin/target/geomesa-geojson-gs-plugin_2.12-<span class="nv">$VERSION</span>-install.tar.gz<span class="w"> </span>-C<span class="w"> </span>&lt;dest&gt;
</pre></div>
</div>
<p>Note that this also requires the AccumuloDataStore to be installed. See <a class="reference internal" href="accumulo/install.html#install-accumulo-geoserver"><span class="std std-ref">Installing GeoMesa Accumulo in GeoServer</span></a>.</p>
<p>The REST endpoint will be available at <code class="docutils literal notranslate"><span class="pre">&lt;host&gt;:&lt;port&gt;/geoserver/geomesa/geojson/</span></code>.</p>
</section>
<section id="methods">
<h3><span class="section-number">25.1.5. </span>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<section id="get-registered-datastores">
<h4><span class="section-number">25.1.5.1. </span>Get Registered DataStores<a class="headerlink" href="#get-registered-datastores" title="Permalink to this headline">¶</a></h4>
<p>Returns a list of data stores available for querying.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/ds</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><strong>Data Params</strong></p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;mycloud&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;accumulo.instance.id&quot;</span><span class="p">:</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accumulo.zookeepers&quot;</span><span class="p">:</span><span class="s2">&quot;foo1,foo2,foo3&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accumulo.catalog&quot;</span><span class="p">:</span><span class="s2">&quot;foo.bar&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accumulo.user&quot;</span><span class="p">:</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accumulo.password&quot;</span><span class="p">:</span><span class="s2">&quot;***&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/ds&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>Notes</strong></p></td>
<td><p>An entry will be returned for each registered data store</p></td>
</tr>
</tbody>
</table>
</section>
<section id="register-a-datastore">
<h4><span class="section-number">25.1.5.2. </span>Register a DataStore<a class="headerlink" href="#register-a-datastore" title="Permalink to this headline">¶</a></h4>
<p>Registers a data store to make it available for querying.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/ds/:alias</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">POST</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Alias used to reference the data store in future requests</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Data Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">accumulo.instance.id=[alphanumeric]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accumulo.zookeepers=[alphanumeric]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accumulo.user=[alphanumeric]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accumulo.catalog=[alphanumeric]</span></code></p></li>
</ul>
<p><strong>Optional</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.security.auths=[alphanumeric]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.query.timeout=[alphanumeric]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.query.threads=[integer]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accumulo.query.record-threads=[integer]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accumulo.write.threads=[integer]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.query.loose-bounding-box=[Boolean]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.stats.generate=[Boolean]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.query.audit=[Boolean]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.query.caching=[Boolean]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geomesa.security.force-empty-auths=[Boolean]</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if data store can not be created with the provided parameters</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/ds/myds&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span>accumulo.user<span class="o">=</span>foo<span class="w"> </span>-d<span class="w"> </span>accumulo.password<span class="o">=</span>foo<span class="w"> </span>-d<span class="w"> </span>accumulo.catalog<span class="o">=</span>foo.bar<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span>accumulo.zookeepers<span class="o">=</span>foo1,foo2,foo3<span class="w"> </span>-d<span class="w"> </span>accumulo.instance.id<span class="o">=</span>foo
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>Notes</strong></p></td>
<td><p>Parameters correspond to the <code class="docutils literal notranslate"><span class="pre">AccumuloDataStore</span></code> connection parameters used
by DataStoreFinder</p></td>
</tr>
</tbody>
</table>
</section>
<section id="create-geojson-index">
<h4><span class="section-number">25.1.5.3. </span>Create GeoJSON Index<a class="headerlink" href="#create-geojson-index" title="Permalink to this headline">¶</a></h4>
<p>Creates a new index under an existing data store.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">POST</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of the GeoJSON index to create</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Data Params</strong></p></td>
<td><p><strong>Optional</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">points=[Boolean]</span></code> Optimization hint if all geometries will be points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">date=[alphanumeric]</span></code> JSONPath expression to a date field for temporal indexing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id=[alphanumeric]</span></code> JSONPath expression to an ID field to uniquely identify each
record</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 201</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="nv">id</span><span class="o">=</span>properties.id
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="delete-geojson-index">
<h4><span class="section-number">25.1.5.4. </span>Delete GeoJSON Index<a class="headerlink" href="#delete-geojson-index" title="Permalink to this headline">¶</a></h4>
<p>Deletes an existing index and all features it contains.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of the GeoJSON index to create</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 204</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-X<span class="w"> </span>DELETE
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="add-features">
<h4><span class="section-number">25.1.5.5. </span>Add Features<a class="headerlink" href="#add-features" title="Permalink to this headline">¶</a></h4>
<p>Add features to the index with GeoJSON.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index/features</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">POST</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Body</strong></p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[alphanumeric]</span></code> GeoJSON <code class="docutils literal notranslate"><span class="pre">Feature</span></code> or <code class="docutils literal notranslate"><span class="pre">FeatureCollection</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> <code class="docutils literal notranslate"><span class="pre">[&quot;1&quot;,&quot;2&quot;]</span></code> List of ids for the added features</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0&quot;}}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>feature.json
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span>@feature.json

<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1&quot;}},&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[34,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2&quot;}}]}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>features.json
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span>@features.json
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="update-features">
<h4><span class="section-number">25.1.5.6. </span>Update Features<a class="headerlink" href="#update-features" title="Permalink to this headline">¶</a></h4>
<p>Update existing features in the index. Feature IDs will be extracted from the GeoJSON submitted.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index/features</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PUT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Body</strong></p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[alphanumeric]</span></code> GeoJSON <code class="docutils literal notranslate"><span class="pre">Feature</span></code> or <code class="docutils literal notranslate"><span class="pre">FeatureCollection</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
<p><strong>Code:</strong> 400 - if ID field was not specified when creating the index</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0-updated&quot;}}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>feature.json
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--upload-file<span class="w"> </span>feature.json

<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1-updated&quot;}},&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[34,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2-updated&quot;}}]}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>features.json
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--upload-file<span class="w"> </span>features.json
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="update-features-by-id">
<h4><span class="section-number">25.1.5.7. </span>Update Features by ID<a class="headerlink" href="#update-features-by-id" title="Permalink to this headline">¶</a></h4>
<p>Update existing features in the index, explicitly specifying the feature IDs.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index/features/:ids</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PUT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id=[alphanumeric]</span></code> Feature IDs to update, comma-separated</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Body</strong></p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[alphanumeric]</span></code> GeoJSON <code class="docutils literal notranslate"><span class="pre">Feature</span></code> or <code class="docutils literal notranslate"><span class="pre">FeatureCollection</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0-updated&quot;}}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>feature.json
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--upload-file<span class="w"> </span>feature.json

<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1-updated&quot;}},&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;&quot;coordinates&quot;:[34,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2-updated&quot;}}]}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>features.json
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/1,2&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--upload-file<span class="w"> </span>features.json
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="delete-features-by-id">
<h4><span class="section-number">25.1.5.8. </span>Delete Features by ID<a class="headerlink" href="#delete-features-by-id" title="Permalink to this headline">¶</a></h4>
<p>Delete existing features in the index by feature IDs.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index/features/:ids</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id=[alphanumeric]</span></code> Feature IDs to delete, comma-separated</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/1,2&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-X<span class="w"> </span>DELETE
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="query-features-by-id">
<h4><span class="section-number">25.1.5.9. </span>Query Features by ID<a class="headerlink" href="#query-features-by-id" title="Permalink to this headline">¶</a></h4>
<p>Query features in the index by feature IDs.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index/features/:ids</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id=[alphanumeric]</span></code> Feature IDs to query, comma-separated</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> GeoJSON feature collection</p>
<p><strong>Example:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;geometry&quot;</span><span class="p">:{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">32</span><span class="p">,</span><span class="mi">10</span><span class="p">]},</span>
<span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;n1&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/1,2&#39;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="query-features">
<h4><span class="section-number">25.1.5.10. </span>Query Features<a class="headerlink" href="#query-features" title="Permalink to this headline">¶</a></h4>
<p>Query features with a predicate.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>URL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/index/:alias/:index/features</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Method</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>URL Params</strong></p></td>
<td><p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</p></li>
</ul>
<p><strong>Optional</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">q=[alphanumeric]</span></code> JSON query predicate</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Success</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> GeoJSON feature collection</p>
<p><strong>Example:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;geometry&quot;</span><span class="p">:{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">32</span><span class="p">,</span><span class="mi">10</span><span class="p">]},</span>
<span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;n1&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Error</strong>
<strong>Response</strong></p></td>
<td><p><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Sample Call</strong></p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># return all features in the index &#39;test&#39;</span>
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span>

<span class="c1"># query by feature id</span>
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--get<span class="w"> </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;q={&quot;properties.id&quot;:&quot;0&quot;}&#39;</span>

<span class="c1"># query by bounding box</span>
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--get<span class="w"> </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;q={&quot;geometry&quot;:{&quot;$bbox&quot;:[33,9,35,11]}}&#39;</span>

<span class="c1"># query by property</span>
curl<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--get<span class="w"> </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;q={&quot;properties.name&quot;:&quot;n1&quot;}&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Notes</strong></p></td>
<td><p>See <a class="reference internal" href="#querying-features">Querying Features</a> for full query syntax</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="json-attributes">
<span id="id1"></span><h2><span class="section-number">25.2. </span>JSON Attributes<a class="headerlink" href="#json-attributes" title="Permalink to this headline">¶</a></h2>
<p>In addition to the GeoJSON API, GeoMesa allows for JSON integration with GeoTools data stores. Simple
feature <code class="docutils literal notranslate"><span class="pre">String</span></code>-type attributes can be marked as JSON and then queried using CQL. JSON attributes
must be specified when creating a simple feature type:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="c1">// append the json hint after the attribute type, separated by a colon</span>
<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;json:String:json=true,dtg:Date,*geom:Point:srid=4326&quot;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
<span class="n">dataStore</span><span class="p">.</span><span class="na">createSchema</span><span class="p">(</span><span class="n">sft</span><span class="p">);</span>
</pre></div>
</div>
<p>JSON attributes are still strings, and are set as any other strings:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">String</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;{ \&quot;foo\&quot; : \&quot;bar\&quot; }&quot;</span><span class="p">;</span>
<span class="n">SimpleFeature</span><span class="w"> </span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sf</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">json</span><span class="p">);</span>
</pre></div>
</div>
<p>JSON attributes can be queried using JSONPath expressions. The first part of the path refers to the simple
feature attribute name, and the rest of the path is applied to the JSON attribute. Note that in ECQL, path
expressions must be enclosed in double quotes.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ECQL</span><span class="p">.</span><span class="na">toFilter</span><span class="p">(</span><span class="s">&quot;\&quot;$.json.foo\&quot; = &#39;bar&#39;&quot;</span><span class="p">)</span>
<span class="n">SimpleFeature</span><span class="w"> </span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sf</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{ \&quot;foo\&quot; : \&quot;bar\&quot; }&quot;</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">sf</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns true</span>
<span class="n">sf</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;\&quot;$.json.foo\&quot;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns &quot;bar&quot;</span>
<span class="n">sf</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{ \&quot;foo\&quot; : \&quot;baz\&quot; }&quot;</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">sf</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns false</span>
<span class="n">sf</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;\&quot;$.json.foo\&quot;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns &quot;baz&quot;</span>
<span class="n">sf</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;\&quot;$.json.bar\&quot;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns null</span>
</pre></div>
</div>
<section id="jsonpath-cql-filter-function">
<span id="json-path-filter-function"></span><h3><span class="section-number">25.2.1. </span>JSONPath CQL Filter Function<a class="headerlink" href="#jsonpath-cql-filter-function" title="Permalink to this headline">¶</a></h3>
<p>JSON attributes can contain periods and spaces. In order to query these attributes through an ECQL filter
use the jsonPath CQL filter function. This passes the path to an internal interpreter function that understands
how to handle these attribute names.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ECQL</span><span class="p">.</span><span class="na">toFilter</span><span class="p">(</span><span class="s">&quot;jsonPath(&#39;$.json.foo&#39;) = &#39;bar&#39;&quot;</span><span class="p">)</span>
<span class="n">SimpleFeature</span><span class="w"> </span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sf</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{ \&quot;foo\&quot; : \&quot;bar\&quot; }&quot;</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">sf</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns true</span>
</pre></div>
</div>
<p>To handle periods and spaces in attribute names, enclose the attribute in the standard bracket notation. However,
since the path is being passed to the jsonPath function as a string literal parameter, the single quotes need to be
escaped with an additional single quote.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ECQL</span><span class="p">.</span><span class="na">toFilter</span><span class="p">(</span><span class="s">&quot;jsonPath(&#39;$.json.[&#39;&#39;foo.bar&#39;&#39;]&#39;) = &#39;bar&#39;&quot;</span><span class="p">)</span>
<span class="n">SimpleFeature</span><span class="w"> </span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sf</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{ \&quot;foo.bar\&quot; : \&quot;bar\&quot; }&quot;</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">sf</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns true</span>
</pre></div>
</div>
<p>Similarly for spaces:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ECQL</span><span class="p">.</span><span class="na">toFilter</span><span class="p">(</span><span class="s">&quot;jsonPath(&#39;$.json.[&#39;&#39;foo bar&#39;&#39;]&#39;) = &#39;bar&#39;&quot;</span><span class="p">)</span>
<span class="n">SimpleFeature</span><span class="w"> </span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sf</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{ \&quot;foo bar\&quot; : \&quot;bar\&quot; }&quot;</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">sf</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns true</span>
</pre></div>
</div>
</section>
<section id="jsonpath-with-geoserver-styles">
<h3><span class="section-number">25.2.2. </span>JSONPath With GeoServer Styles<a class="headerlink" href="#jsonpath-with-geoserver-styles" title="Permalink to this headline">¶</a></h3>
<p>When using JSON path in GeoServer styles (SLD or CSS), the attribute and path must be separated out in order for
the GeoTools renderer to work correctly. In this case, pass in two arguments, the first being a property expression
in double quotes of the JSON-type attribute name, and the second being the path:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* {
  mark: symbol(arrow);
  mark-size: 12px;
  mark-rotation: [ jsonPath(&quot;json&quot;, &#39;foo&#39;) ];
  :mark {
    fill: #009900;
  }
}
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ds_views.html" class="btn btn-neutral float-left" title="24. Combined Data Store Views" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="stream.html" class="btn btn-neutral float-right" title="26. GeoMesa Stream Processing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2021 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    
    - view <a href="../_sources/user/geojson.rst.txt" rel="nofollow">page source</a>
    
  </p>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53087457-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-53087457-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>