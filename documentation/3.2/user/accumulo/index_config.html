

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>15.6. Accumulo Index Configuration &mdash; GeoMesa 3.2.2 Manuals</title>
  

  
  
  
  
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/accumulo/index_config.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="15.7. GeoMesa Jobs" href="jobs.html" />
    <link rel="prev" title="15.5. Accumulo Configuration" href="configuration.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                3.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">5. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">6. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">15. Accumulo Data Store</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">15.1. Installing GeoMesa Accumulo</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">15.2. Using the Accumulo Data Store Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">15.3. Using the Accumulo Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">15.4. Accumulo Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">15.5. Accumulo Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">15.6. Accumulo Index Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attribute-indices">15.6.1. Attribute Indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#feature-expiration">15.6.2. Feature Expiration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logical-timestamps">15.6.3. Logical Timestamps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upgrading-existing-indices">15.6.4. Upgrading Existing Indices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html">15.7. GeoMesa Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="kerberos.html">15.8. Kerberos</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html">15.9. Command Line Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">17. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">18. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">19. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">20. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kudu/index.html">21. Kudu Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">22. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">23. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">24. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">25. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">26. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Manual</a> &raquo;</li>
        
          <li><a href="index.html">15. Accumulo Data Store</a> &raquo;</li>
        
      <li>15.6. Accumulo Index Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="accumulo-index-configuration">
<h1>15.6. Accumulo Index Configuration<a class="headerlink" href="#accumulo-index-configuration" title="Permalink to this headline">¶</a></h1>
<p>GeoMesa exposes a variety of configuration options that can be used to customize and optimize a given installation.
The Accumulo data store supports most of the general options described under <a class="reference internal" href="../datastores/index_config.html#index-config"><span class="std std-ref">Index Configuration</span></a>.</p>
<div class="section" id="attribute-indices">
<span id="accumulo-attribute-indices"></span><h2>15.6.1. Attribute Indices<a class="headerlink" href="#attribute-indices" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="../datastores/index_basics.html#attribute-indices"><span class="std std-ref">Attribute Index</span></a> for an overview of attribute indices. The Accumulo data store extends the
normal attribute indices with an additional ‘join’ format that stores less data.</p>
<div class="section" id="join-indices">
<h3>15.6.1.1. Join Indices<a class="headerlink" href="#join-indices" title="Permalink to this headline">¶</a></h3>
<p>Join indices store a reduced subset of data in the index - just the feature ID, the default date
and the default geometry. To answer most queries, a join against the record index is required
to retrieve the full simple features - hence the name join index. Joining against the record
table is slow when returning many results, and should generally be avoided except for small queries.</p>
<p>GeoMesa will avoid joining against the record table if it is possible to answer
a query with only the data in the join index. In general, this means that the query is only
returning the properties for the default date, default geometry and the attribute being queried.
In addition, any CQL filters must only operate on those three attributes as well.</p>
<p>To enable a join index, the keyword <code class="docutils literal notranslate"><span class="pre">join</span></code> may be used in place of <code class="docutils literal notranslate"><span class="pre">true</span></code> when specifying an
attribute index in the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>.</p>
</div>
<div class="section" id="full-indices">
<h3>15.6.1.2. Full Indices<a class="headerlink" href="#full-indices" title="Permalink to this headline">¶</a></h3>
<p>Full indices store the full simple feature. This takes up the most space on disk, but allows for any query to
be answered without joining against the record table. This is the only option for non-Accumulo data stores.
To use a full index, the keyword <code class="docutils literal notranslate"><span class="pre">full</span></code> or <code class="docutils literal notranslate"><span class="pre">true</span></code> may be used when specifying an attribute
index in the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>.</p>
</div>
</div>
<div class="section" id="feature-expiration">
<span id="accumulo-feature-expiry"></span><h2>15.6.2. Feature Expiration<a class="headerlink" href="#feature-expiration" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Any manually configured age-off iterators should be removed before setting feature expiration, as they may
not operate correctly due to the configuration name.</p>
</div>
<p>The GeoMesa Accumulo data store supports setting a per-feature time-to-live. Expiration can be set in the
<code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> user data, using the key <code class="docutils literal notranslate"><span class="pre">geomesa.feature.expiry</span></code>. See <a class="reference internal" href="../datastores/index_config.html#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details
on configuring the user data. Expiration can be set before calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>, or can be added to an existing
schema by calling <code class="docutils literal notranslate"><span class="pre">updateSchema</span></code>, which may cause currently ingested features to be expired.</p>
<p>Expiration can be based on either ingest time or a feature attribute. To set expiration based on ingest time,
specify a time-to-live as a duration string, e.g. <code class="docutils literal notranslate"><span class="pre">24</span> <span class="pre">hours</span></code> or <code class="docutils literal notranslate"><span class="pre">180</span> <span class="pre">days</span></code>. To set expiration based on
a feature attribute, specify the attribute along with a time-to-live in parentheses, e.g. <code class="docutils literal notranslate"><span class="pre">dtg(24</span> <span class="pre">hours)</span></code> or
<code class="docutils literal notranslate"><span class="pre">event-time(30</span> <span class="pre">days)</span></code> (where <code class="docutils literal notranslate"><span class="pre">dtg</span></code> and <code class="docutils literal notranslate"><span class="pre">event-time</span></code> are <code class="docutils literal notranslate"><span class="pre">Date</span></code>-type attributes in the schema).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Ingest-time expiration requires that logical timestamps are disabled in the schema. See
<a class="reference internal" href="#logical-timestamps"><span class="std std-ref">Logical Timestamps</span></a>, below.</p>
</div>
<p>Feature expiration is implemented using an Accumulo filter. See <a class="reference internal" href="commandline.html#accumulo-age-off-command"><span class="std std-ref">configure-age-off</span></a> for details
on viewing or modifying existing filters.</p>
<div class="section" id="statistics">
<h3>15.6.2.1. Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h3>
<p>As features are aged off, summary data statistics will get out of date, which can degrade query planning. For
manageable data sets, it is recommended to re-analyze statistics every so often, via the
<a class="reference internal" href="commandline.html#accumulo-tools-stats-analyze"><span class="std std-ref">stats-analyze</span></a> command. If the data set is too large for this to be feasible, then stats
can instead be disabled completely via <a class="reference internal" href="../datastores/runtime_config.html#stats-generate-config"><span class="std std-ref">geomesa.stats.generate</span></a>.</p>
</div>
<div class="section" id="forcing-deletion-of-records">
<h3>15.6.2.2. Forcing Deletion of Records<a class="headerlink" href="#forcing-deletion-of-records" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa age-off iterators will not fully delete records until compactions occur. To force a true deletion of data
on disk, you must manually compact a table or range. When compacting an entire table you should take care not to
overwhelm your system. To facilitate this, you may use the GeoMesa Accumulo command-line <a class="reference internal" href="commandline.html#compact-command"><span class="std std-ref">compact</span></a>
command.</p>
</div>
</div>
<div class="section" id="logical-timestamps">
<span id="id1"></span><h2>15.6.3. Logical Timestamps<a class="headerlink" href="#logical-timestamps" title="Permalink to this headline">¶</a></h2>
<p>By default, GeoMesa index tables are created using Accumulo’s logical time. This ensures that updates to a given
simple feature will be ordered correctly, however it obscures the actual insert time for the underlying data
row. For advanced use cases, standard system time can be used instead of logical time. To disble logical
time, add the following user data hint to the simple feature type before calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// append the hints to the end of the string, separated by a semi-colon</span>
<span class="n">String</span> <span class="n">spec</span> <span class="o">=</span> <span class="s">&quot;name:String,dtg:Date,*geom:Point:srid=4326;geomesa.logical.time=&#39;false&#39;&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span> <span class="n">sft</span> <span class="o">=</span> <span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="upgrading-existing-indices">
<span id="index-upgrades"></span><h2>15.6.4. Upgrading Existing Indices<a class="headerlink" href="#upgrading-existing-indices" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa often makes updates to indexing formats to improve query and write performance. However,
the index format for a given schema is fixed when it is first created. Updating GeoMesa versions
will provide bug fixes and new features, but will not update existing data to new index formats.</p>
<p>The exact version of an index used for each schema can be read from the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> user data,
or by simple examining the name of the index tables created by GeoMesa. See below for a description of
current index versions.</p>
<p>Using the GeoMesa command line tools, you can add or update an index to a newer version using <code class="docutils literal notranslate"><span class="pre">add-index</span></code>.
For example, you could add the XZ3 index to replace the Z3 index for a feature type with non-point geometries.
The command will populate the new index using a distributed job. For large data sets, you can choose to
only populate features matching a CQL filter (e.g. the last month), or choose to not populate any
data. The update is seamless, and clients can continue to query and ingest while it runs.</p>
<p>See <a class="reference internal" href="commandline.html#add-index-command"><span class="std std-ref">add-index</span></a> for more details on the command line tools.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="jobs.html" class="btn btn-neutral float-right" title="15.7. GeoMesa Jobs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configuration.html" class="btn btn-neutral" title="15.5. Accumulo Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2021 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    
    - view <a href="../../_sources/user/accumulo/index_config.rst.txt" rel="nofollow">page source</a>
    
  </p>
</div>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<!-- analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-53087457-1', 'auto');
ga('send', 'pageview');
</script>




</body>
</html>