

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12.2. Using the Kafka Data Store Programmatically &mdash; GeoMesa 2.0.2 Manuals</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="GeoMesa 2.0.2 Manuals" href="../../index.html"/>
        <link rel="up" title="12. Kafka Data Store" href="index.html"/>
        <link rel="next" title="12.3. Using the Kafka Data Store in GeoServer" href="geoserver.html"/>
        <link rel="prev" title="12.1. Installing GeoMesa Kafka" href="install.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                2.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">7. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">8. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">9. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">10. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">11. Cassandra Data Store</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">12. Kafka Data Store</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">12.1. Installing GeoMesa Kafka</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">12.2. Using the Kafka Data Store Programmatically</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-data-store">12.2.1. Creating a Data Store</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kafka-data-store-parameters">12.2.2. Kafka Data Store Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">12.3. Using the Kafka Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">12.4. Kafka Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="producers.html">12.5. Data Producers</a></li>
<li class="toctree-l3"><a class="reference internal" href="consumers.html">12.6. Data Consumers</a></li>
<li class="toctree-l3"><a class="reference internal" href="feature_events.html">12.7. Listening for Feature Events</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">13. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">14. FileSystem Datastore (Amazon S3, HDFS Datastore)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">15. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">16. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">17. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">18. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">19. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi.html">20. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blobstore.html">21. GeoMesa Blob Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../native_api.html">22. GeoMesa Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html">23. GeoMesa Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">24. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../web_data.html">25. GeoMesa Web Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">26. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GeoMesa</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">User Manual</a> &raquo;</li>
      
          <li><a href="index.html">12. Kafka Data Store</a> &raquo;</li>
      
    <li>12.2. Using the Kafka Data Store Programmatically</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user/kafka/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-the-kafka-data-store-programmatically">
<h1>12.2. Using the Kafka Data Store Programmatically<a class="headerlink" href="#using-the-kafka-data-store-programmatically" title="Permalink to this headline">¶</a></h1>
<div class="section" id="creating-a-data-store">
<h2>12.2.1. Creating a Data Store<a class="headerlink" href="#creating-a-data-store" title="Permalink to this headline">¶</a></h2>
<p>An instance of a Kafka data store can be obtained through the normal GeoTools discovery methods,
assuming that the GeoMesa code is on the classpath. To create a <code class="docutils literal"><span class="pre">KafkaDataStore</span></code> there are two
required properties, one for the Apache Kafka connection, <code class="docutils literal"><span class="pre">kafka.brokers</span></code>, and one for the Apache
Zookeeper connection, <code class="docutils literal"><span class="pre">kafka.zookeepers</span></code>. An optional parameter, <code class="docutils literal"><span class="pre">kafka.zk.path</span></code> is
used to specify a path in Zookeeper under which schemas are stored. If
no zk path is specified then a default path will be used. Configuration
parameters are described fully below.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Serializable</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">parameters</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;kafka.zookeepers&quot;</span><span class="o">,</span> <span class="s">&quot;localhost:2181&quot;</span><span class="o">);</span>
<span class="n">parameters</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;kafka.brokers&quot;</span><span class="o">,</span> <span class="s">&quot;localhost:9092&quot;</span><span class="o">);</span>
<span class="n">org</span><span class="o">.</span><span class="na">geotools</span><span class="o">.</span><span class="na">data</span><span class="o">.</span><span class="na">DataStore</span> <span class="n">dataStore</span> <span class="o">=</span>
    <span class="n">org</span><span class="o">.</span><span class="na">geotools</span><span class="o">.</span><span class="na">data</span><span class="o">.</span><span class="na">DataStoreFinder</span><span class="o">.</span><span class="na">getDataStore</span><span class="o">(</span><span class="n">parameters</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="kafka-data-store-parameters">
<span id="kafka-parameters"></span><h2>12.2.2. Kafka Data Store Parameters<a class="headerlink" href="#kafka-data-store-parameters" title="Permalink to this headline">¶</a></h2>
<p>The Kafka Data Store takes several parameters (required parameters are marked with <code class="docutils literal"><span class="pre">*</span></code>):</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="5%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.brokers</span> <span class="pre">*</span></code></td>
<td>String</td>
<td>Kafka brokers, e.g. “localhost:9092”</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kafka.zookeepers</span> <span class="pre">*</span></code></td>
<td>String</td>
<td>Kafka zookeepers, e.g “localhost:2181”</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.zk.path</span></code></td>
<td>String</td>
<td>Zookeeper discoverable path (namespace)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kafka.producer.config</span></code></td>
<td>String</td>
<td>Configuration options for kafka producer, in Java properties
format. See <a class="reference external" href="http://kafka.apache.org/documentation.html#producerconfigs">Producer Configs</a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.consumer.config</span></code></td>
<td>String</td>
<td>Configuration options for kafka consumer, in Java properties
format. See <a class="reference external" href="http://kafka.apache.org/documentation.html#newconsumerconfigs">New Consumer Configs</a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kafka.consumer.from-beginning</span></code></td>
<td>Boolean</td>
<td>Start reading from the beginning of the topic (vs ignore existing messages). If enabled, features
will not be available for query until all existing messages are processed. However, feature
listeners will still be invoked as normal.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.consumer.count</span></code></td>
<td>Integer</td>
<td>Number of kafka consumers used per feature type. Set to 0
to disable consuming (i.e. producer only)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kafka.topic.partitions</span></code></td>
<td>Integer</td>
<td>Number of partitions to use in kafka topics</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.topic.replication</span></code></td>
<td>Integer</td>
<td>Replication factor to use in kafka topics</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kafka.cache.expiry</span></code></td>
<td>String</td>
<td>Expire features from in-memory cache after this delay, e.g. “10 minutes”</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.cache.cleanup</span></code></td>
<td>String</td>
<td>Clean expired cache entries every so often, e.g.
“60 seconds”. If not specified, expired features will be
cleaned incrementally during reads and writes</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kafka.cache.consistency</span></code></td>
<td>String</td>
<td>Check the feature cache for consistency at this interval, e.g. “1 hour”</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kafka.cache.cqengine</span></code></td>
<td>Boolean</td>
<td>Use CQEngine-based implementation of in-memory feature cache</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">geomesa.query.loose-bounding-box</span></code></td>
<td>Boolean</td>
<td>Use loose bounding boxes, which offer improved performance but are not exact</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">geomesa.query.audit</span></code></td>
<td>Boolean</td>
<td>Audit incoming queries. By default audits are written to a log file</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">geomesa.security.auths</span></code></td>
<td>String</td>
<td>Default authorizations used to query data, comma-separated</td>
</tr>
</tbody>
</table>
<p>More information on using GeoTools can be found in the <a class="reference external" href="http://docs.geotools.org/stable/userguide/">GeoTools user guide</a>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="geoserver.html" class="btn btn-neutral float-right" title="12.3. Using the Kafka Data Store in GeoServer" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral" title="12.1. Installing GeoMesa Kafka" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2017 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>