

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GeoMesa Authorizations &mdash; GeoMesa 3.2.1 Manuals</title>
  

  
  
  
  
    <link rel="canonical" href="https://www.geomesa.org/documentation/tutorials/geomesa-examples-authorizations.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Feature Level Visibility and Security" href="geomesa-examples-featurelevelvis.html" />
    <link rel="prev" title="Web Processing Services (WPS) Tube Select" href="geomesa-tubeselect.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                3.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#quick-starts">Quick Starts</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-in-out">Data In/Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-analysis">Data Analysis</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#security">Security</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">GeoMesa Authorizations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#about-this-tutorial">About this Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visibilities-in-geomesa">Visibilities in GeoMesa</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authorizations-in-geomesa">Authorizations in GeoMesa</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-visibilities-in-accumulo">Create Visibilities in Accumulo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#download-and-build-the-tutorial">Download and Build the Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-the-tutorial">Run the Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#looking-at-the-code">Looking at the Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applying-authorizations-and-visibilities-to-geoserver-using-pkis-and-ldap">Applying Authorizations and Visibilities to GeoServer Using PKIS and LDAP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-examples-featurelevelvis.html">Feature Level Visibility and Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indexing-and-queries">Indexing and Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#about-tutorial-versions">About Tutorial Versions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>GeoMesa Authorizations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geomesa-authorizations">
<h1>GeoMesa Authorizations<a class="headerlink" href="#geomesa-authorizations" title="Permalink to this headline">¶</a></h1>
<p>This tutorial demonstrates the ways you can apply data-level security
to GeoMesa. It is a more advanced tutorial; you should already be familiar
with the basics of GeoMesa and GeoServer. This tutorial targets Accumulo -
GeoMesa also supports HBase visibilities through the same mechanisms, but the
HBase configuration required is not covered here. See <a class="reference internal" href="../user/hbase/visibilities.html#hbase-visibilities"><span class="std std-ref">HBase Visibilities</span></a>
for more information on HBase.</p>
<p>In this tutorial, you will learn how to:</p>
<ol class="arabic simple">
<li>Set visibilities on your data during ingestion into GeoMesa</li>
<li>Apply authorizations to your queries through GeoMesa</li>
<li>Implement user authorizations through the GeoMesa GeoServer plugin,
using PKI certs to authenticate with GeoServer and LDAP to store
authorizations</li>
</ol>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<div class="section" id="visibilities-and-authorizations">
<h3>Visibilities and Authorizations<a class="headerlink" href="#visibilities-and-authorizations" title="Permalink to this headline">¶</a></h3>
<p>One of the most powerful features of Accumulo is the implementation of
cell-level security, using <strong>visibilities</strong> and <strong>authorizations</strong>. Data
that is protected by visibilities can only be seen by users that have
the corresponding authorizations. This allows for the fine-grained
protection of data, based on arbitrary labels.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Authorizations are distinct from table-level
permissions, and operate at a much finer grain.</p>
</div>
</div>
<div class="section" id="public-key-infrastructure-pki">
<h3>Public Key Infrastructure (PKI)<a class="headerlink" href="#public-key-infrastructure-pki" title="Permalink to this headline">¶</a></h3>
<p>Public key infrastructure can be used to securely authenticate end
users. In PKI, a <strong>certificate authority</strong> (CA) will issue digital
certificates that verify that a particular public key belongs to a
particular individual. Other users can then trust that certificate
because it has been digitally signed by the CA.</p>
<p>In this tutorial, the keys used are not provided by trusted CAs. As
such, it is necessary to import the CA’s certificate into the Java
keystore, which allows Java (and by extension Tomcat) to trust any keys
verified by the CA.</p>
<p>PKI solves the issue of <strong>authentication</strong> (<em>who</em> a user is) but not
<strong>authorization</strong> (<em>what</em> a user can do). For this tutorial,
authorization is provided by an LDAP server.</p>
</div>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before you begin, you must have the following:</p>
<ul class="simple">
<li><a class="reference external" href="http://java.oracle.com/">Java</a> JDK 1.8</li>
<li>Apache <a class="reference external" href="http://maven.apache.org/">Maven</a> 3.5.2 or later</li>
<li>a GitHub client</li>
<li>an Accumulo 1.7.x, 1.8.x, 1.9.x or 2.0.x instance</li>
<li>an Accumulo user that has both create-table and write permissions</li>
<li>the GeoMesa distributed runtime installed for your instance</li>
</ul>
<p>If you are not familiar with Accumulo authorizations, you should review
the relevant Accumulo
<a class="reference external" href="http://accumulo.apache.org/1.7/accumulo_user_manual.html#_security">documentation</a>,
with more examples <a class="reference external" href="http://accumulo.apache.org/1.7/examples/visibility.html">here</a>.</p>
</div>
<div class="section" id="about-this-tutorial">
<h2>About this Tutorial<a class="headerlink" href="#about-this-tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial operates by inserting and then querying several thousand features.
The features are inserted with visibility labels, and then queried with two different users
to show how authorizations work.</p>
</div>
<div class="section" id="visibilities-in-geomesa">
<h2>Visibilities in GeoMesa<a class="headerlink" href="#visibilities-in-geomesa" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa supports setting the visibility for each feature that is written. This
can be set through user data in a simple feature:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.locationtech.geomesa.security.SecurityUtils</span><span class="p">;</span>
<span class="p">...</span>
<span class="n">SimpleFeature</span> <span class="n">sf</span> <span class="o">=</span> <span class="p">...</span>
<span class="c1">// set user data directly</span>
<span class="n">sf</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="n">SecurityUtils</span><span class="p">.</span><span class="na">FEATURE_VISIBILITY</span><span class="p">,</span> <span class="s">&quot;user&amp;admin&quot;</span><span class="p">);</span>
<span class="c1">// alternatively, use static utility methods</span>
<span class="n">SecurityUtils</span><span class="p">.</span><span class="na">setFeatureVisibilities</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span> <span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="s">&quot;admin&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>For more information on feature-level visibilities, see <a class="reference internal" href="geomesa-examples-featurelevelvis.html"><span class="doc">Feature Level Visibility and Security</span></a>.</p>
</div>
<div class="section" id="authorizations-in-geomesa">
<h2>Authorizations in GeoMesa<a class="headerlink" href="#authorizations-in-geomesa" title="Permalink to this headline">¶</a></h2>
<p>When performing a query, GeoMesa delegates the retrieval of
authorizations to <strong>service providers</strong> that implement the following
interface:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.locationtech.geomesa.security</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AuthorizationsProvider</span> <span class="p">{</span>

    <span class="cm">/**</span>
<span class="cm">     * Gets the authorizations for the current context. This may change over time</span>
<span class="cm">     * (e.g. in a multi-user environment), so the result should not be cached.</span>
<span class="cm">     *</span>
<span class="cm">     * @return</span>
<span class="cm">     */</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getAuthorizations</span><span class="p">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Configures this instance with parameters passed into the DataStoreFinder</span>
<span class="cm">     *</span>
<span class="cm">     * @param params</span>
<span class="cm">     */</span>
    <span class="kt">void</span> <span class="nf">configure</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Serializable</span><span class="o">&gt;</span> <span class="n">params</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When a GeoMesa <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> is instantiated, it will scan for available
service providers. Third-party implementations can be enabled by placing
them on the classpath and including a special service descriptor file.
See the Oracle
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">Javadoc</a>
for details on implementing a service provider.</p>
<p>The GeoMesa <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> will call <code class="docutils literal notranslate"><span class="pre">configure()</span></code> on the
<code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code> implementation, passing in the parameter map
from the call to <code class="docutils literal notranslate"><span class="pre">DataStoreFinder.getDataStore(Map</span> <span class="pre">params)</span></code>. This
allows the <code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code> to configure itself based on the
environment.</p>
<p>To ensure that the correct <code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code> is used, GeoMesa
will throw an exception if multiple third-party service providers are
found on the classpath. In this scenario, the particular service
provider class to use can be specified by the following system property:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">AuthorizationsProvider</span><span class="p">.</span><span class="na">AUTH_PROVIDER_SYS_PROPERTY</span> <span class="o">=</span> <span class="s">&quot;geomesa.auth.provider.impl&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>For simple scenarios, the set of authorizations to apply to all queries
can be specified when creating the GeoMesa <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> by using the
<code class="docutils literal notranslate"><span class="pre">geomesa.security.auths</span></code> configuration parameter. This will use the
<code class="docutils literal notranslate"><span class="pre">DefaultAuthorizationsProvider</span></code> implementation provided by GeoMesa.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// create a map containing initialization data for the GeoMesa data store</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">configuration</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">configuration</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.security.auths&quot;</span><span class="p">,</span> <span class="s">&quot;user,admin&quot;</span><span class="p">);</span>
<span class="n">DataStore</span> <span class="n">dataStore</span> <span class="o">=</span> <span class="n">DataStoreFinder</span><span class="p">.</span><span class="na">getDataStore</span><span class="p">(</span><span class="n">configuration</span><span class="p">);</span>
</pre></div>
</div>
<p>If there are no <code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code>s found on the classpath,
and the <code class="docutils literal notranslate"><span class="pre">geomesa.security.auths</span></code> parameter is not set, GeoMesa will default to using
the authorizations associated with the underlying Accumulo connection
(i.e. the <code class="docutils literal notranslate"><span class="pre">accumulo.user</span></code> configuration value).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is not a recommended approach for a production system.</p>
</div>
<p>In addition, please note that the authorizations used in any scenario
cannot exceed the authorizations of the underlying Accumulo connection.</p>
</div>
<div class="section" id="create-visibilities-in-accumulo">
<h2>Create Visibilities in Accumulo<a class="headerlink" href="#create-visibilities-in-accumulo" title="Permalink to this headline">¶</a></h2>
<p>This tutorial requires that you specify a visibility string and the associated
authorizations string. The visibilities can be anything valid for your Accumulo instance.
For the rest of this exercise, we are going to assume the visibility string is <code class="docutils literal notranslate"><span class="pre">user</span></code>.
You can see the visibilities that are currently enabled for your user through the Accumulo shell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ accumulo shell -u &lt;username&gt; -p &lt;password&gt;

Shell - Apache Accumulo Interactive Shell
-
- version: <span class="m">1</span>.8.1
- instance name: xxxxx
- instance id: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
-
- <span class="nb">type</span> <span class="s1">&#39;help&#39;</span> <span class="k">for</span> a list of available commands
-
myuser@mycloud&gt; getauths
user,admin
</pre></div>
</div>
<p>If your user does not already have authorizations, you can add them
through the Accumulo shell with the <code class="docutils literal notranslate"><span class="pre">addauths</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>myuser@mycloud&gt; getauths
user
myuser@mycloud&gt; addauths -s admin -u myuser
myuser@mycloud&gt; getauths
user,admin
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A user cannot set authorizations unless the user has
the System.ALTER_USER permission.</p>
</div>
<p>After running the tutorial code, you should see a visibility label in
square brackets when you scan the index tables through the Accumulo shell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>myuser@mycloud&gt; scan -t mytable_id
<span class="se">\x</span><span class="m">0100700230</span>-fdfe-422e-b4d1-8072db6f3dda SFT: <span class="o">[</span>user<span class="o">]</span>    <span class="se">\x</span><span class="m">02</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span>01b00700230...
</pre></div>
</div>
</div>
<div class="section" id="download-and-build-the-tutorial">
<h2>Download and Build the Tutorial<a class="headerlink" href="#download-and-build-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Pick a reasonable directory on your machine, and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/geomesa/geomesa-tutorials.git
$ <span class="nb">cd</span> geomesa-tutorials
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure that you download or checkout the version of the tutorials project that corresponds to
your GeoMesa version. See <a class="reference internal" href="index.html#tutorial-versions"><span class="std std-ref">About Tutorial Versions</span></a> for more details.</p>
</div>
<p>To ensure that the quick start works with your environment, modify the <code class="docutils literal notranslate"><span class="pre">pom.xml</span></code>
to set the appropriate versions for Accumulo, Hadoop, etc.</p>
<p>For ease of use, the project builds a bundled artifact that contains all the required
dependencies in a single JAR. To build, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mvn clean install -pl geomesa-tutorials-accumulo/geomesa-tutorials-accumulo-authorizations -am
</pre></div>
</div>
</div>
<div class="section" id="run-the-tutorial">
<h2>Run the Tutorial<a class="headerlink" href="#run-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>On the command line, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ java -cp geomesa-tutorials-accumulo/geomesa-tutorials-accumulo-authorizations/target/geomesa-tutorials-accumulo-authorizations-<span class="si">${</span><span class="nv">geomesa</span><span class="p">.version</span><span class="si">}</span>.jar <span class="se">\</span>
    org.geomesa.example.accumulo.auths.AuthorizationsTutorial <span class="se">\</span>
    --accumulo.instance.id &lt;instance&gt;                         <span class="se">\</span>
    --accumulo.zookeepers &lt;zookeepers&gt;                        <span class="se">\</span>
    --accumulo.user &lt;user&gt;                                    <span class="se">\</span>
    --accumulo.password &lt;password&gt;                            <span class="se">\</span>
    --accumulo.catalog &lt;table&gt;                                <span class="se">\</span>
    --geomesa.security.auths &lt;authorizations&gt;                 <span class="se">\</span>
    --visibilities &lt;visibilities&gt;
</pre></div>
</div>
<p>where you provide the following arguments:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&lt;instance&gt;</span></code> the name of your Accumulo instance</li>
<li><code class="docutils literal notranslate"><span class="pre">&lt;zookeepers&gt;</span></code> your Zookeeper nodes, separated by commas</li>
<li><code class="docutils literal notranslate"><span class="pre">&lt;user&gt;</span></code> the name of an Accumulo user that has permissions to
create, read and write tables</li>
<li><code class="docutils literal notranslate"><span class="pre">&lt;password&gt;</span></code> the password for the previously-mentioned Accumulo
user</li>
<li><code class="docutils literal notranslate"><span class="pre">&lt;table&gt;</span></code> the name of the destination table that will accept these
test records. This table should either not exist or should be empty</li>
<li><code class="docutils literal notranslate"><span class="pre">&lt;visibilities&gt;</span></code> the visibilities label to apply to the data, e.g. <code class="docutils literal notranslate"><span class="pre">user</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">&lt;authorizations&gt;</span></code> the authorizations associated with the visibilities you
selected, e.g. <code class="docutils literal notranslate"><span class="pre">user</span></code>. Make sure that your Accumulo user has the authorization
you use</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you have set up the GeoMesa Accumulo distributed
runtime to be isolated within a namespace (see
<a class="reference internal" href="../user/accumulo/install.html#install-accumulo-runtime-namespace"><span class="std std-ref">Namespace Install</span></a>) the value of <code class="docutils literal notranslate"><span class="pre">&lt;table&gt;</span></code>
should include the namespace (e.g. <code class="docutils literal notranslate"><span class="pre">myNamespace.geomesa</span></code>).</p>
</div>
<p>Optionally, you can also specify that the tutorial should delete its data upon completion. Use the
<code class="docutils literal notranslate"><span class="pre">--cleanup</span></code> flag when you run to enable this behavior.</p>
<p>Once run, you should see the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Loading datastore

Loading datastore

Creating schema: GLOBALEVENTID:String,Actor1Name:String,Actor1CountryCode:String,Actor2Name:String,Actor2CountryCode:String,EventCode:String,NumMentions:Integer,NumSources:Integer,NumArticles:Integer,ActionGeo_Type:Integer,ActionGeo_FullName:String,ActionGeo_CountryCode:String,dtg:Date,geom:Point

Generating test data

Writing test data
Wrote 2356 features

Executing query with AUTHORIZED data store: auths are &#39;user&#39;
Running query dtg BETWEEN 2017-12-31T00:00:00+00:00 AND 2018-01-02T00:00:00+00:00 AND BBOX(geom, -83.0,33.0,-80.0,35.0)
01 719024887=719024887|DEPUTY||||010|4|1|4|3|Abbeville County, South Carolina, United States|US|2017-12-31T00:00:00.000Z|POINT (-82.4665 34.2334)
02 719024893=719024893|UNITED STATES|USA|DEPUTY||010|6|1|6|3|Abbeville County, South Carolina, United States|US|2017-12-31T00:00:00.000Z|POINT (-82.4665 34.2334)
03 719024895=719024895|UNITED STATES|USA|EMPLOYEE||010|2|1|2|3|Ninety Six, South Carolina, United States|US|2017-12-31T00:00:00.000Z|POINT (-82.024 34.1751)
04 719025110=719025110|||UNITED STATES|USA|051|6|1|6|3|Edgefield, South Carolina, United States|US|2018-01-01T00:00:00.000Z|POINT (-81.9296 33.7896)
05 719025605=719025605|SCHOOL||ADMINISTRATION||043|16|1|16|3|Greenwood County, South Carolina, United States|US|2018-01-01T00:00:00.000Z|POINT (-82.1165 34.1668)
06 719025410=719025410|POLICE||||193|1|1|1|3|Ninety Six National Historic Site, South Carolina, United States|US|2018-01-01T00:00:00.000Z|POINT (-82.0193 34.146)
07 719027188=719027188|UNITED STATES|USA|UNITED STATES|USA|193|1|1|1|3|Ware Shoals, South Carolina, United States|US|2018-01-01T00:00:00.000Z|POINT (-82.2468 34.3985)
08 719024941=719024941|||DEPUTIES||090|8|1|8|3|Edgewood, South Carolina, United States|US|2018-01-01T00:00:00.000Z|POINT (-80.6137 34.2874)
09 719024950=719024950|||DEPUTIES||190|8|1|8|3|Edgewood, South Carolina, United States|US|2018-01-01T00:00:00.000Z|POINT (-80.6137 34.2874)
10 719024894=719024894|UNITED STATES|USA|DEPUTY||010|2|1|2|3|Abbeville County, South Carolina, United States|US|2017-12-31T00:00:00.000Z|POINT (-82.4665 34.2334)

Returned 39 total features

Executing query with UNAUTHORIZED data store: auths are &#39;&#39;
Running query dtg BETWEEN 2017-12-31T00:00:00+00:00 AND 2018-01-02T00:00:00+00:00 AND BBOX(geom, -83.0,33.0,-80.0,35.0)

Returned 0 total features

Done
</pre></div>
</div>
<p>The first query should return 1 or more results. The second query should
return 0 results, since they are hidden by visibilities.</p>
</div>
<div class="section" id="looking-at-the-code">
<h2>Looking at the Code<a class="headerlink" href="#looking-at-the-code" title="Permalink to this headline">¶</a></h2>
<p>The source code is meant to be accessible for this tutorial. The main logic is contained in
<code class="docutils literal notranslate"><span class="pre">org.geomesa.example.accumulo.auths.AuthorizationsTutorial</span></code> in the
<code class="docutils literal notranslate"><span class="pre">geomesa-tutorials-accumulo/geomesa-tutorials-accumulo-authorizations</span></code> module. Some relevant methods are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">createDataStore</span></code> uses a system property to control the visibility provider used by each data store</li>
<li><code class="docutils literal notranslate"><span class="pre">queryFeatures</span></code> run the same query with each data store</li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// get an instance of the data store that uses our authorizations provider,</span>
<span class="c1">// that always returns empty auths</span>
<span class="n">System</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">AuthorizationsProvider</span><span class="p">.</span><span class="na">AUTH_PROVIDER_SYS_PROPERTY</span><span class="p">,</span>
                   <span class="n">EmptyAuthorizationsProvider</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
<span class="n">unauthorizedDatastore</span> <span class="o">=</span> <span class="kd">super</span><span class="p">.</span><span class="na">createDataStore</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>

<span class="c1">// get an instance of the data store that uses the default authorizations provider,</span>
<span class="c1">// which will use whatever auths the connector has available</span>
<span class="n">System</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">AuthorizationsProvider</span><span class="p">.</span><span class="na">AUTH_PROVIDER_SYS_PROPERTY</span><span class="p">,</span>
                   <span class="n">DefaultAuthorizationsProvider</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
<span class="k">return</span> <span class="kd">super</span><span class="p">.</span><span class="na">createDataStore</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
<p>This code snippet shows how you can specify the
<code class="docutils literal notranslate"><span class="pre">AuthorizationProvider</span></code> to use with a system property. The
<code class="docutils literal notranslate"><span class="pre">DefaultAuthorizationsProvider</span></code> class is provided by GeoMesa, and used
when no other implementations are found.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">EmptyAuthorizationsProvider</span></code> class is included in the tutorial. The <code class="docutils literal notranslate"><span class="pre">EmptyAuthorizationsProvider</span></code>
will always return an empty <code class="docutils literal notranslate"><span class="pre">Authorizations</span></code> object, which means that any data stored with visibilities
will not be returned.</p>
<p>There is a more useful implementation of <code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code> that
will be explored in more detail in the next section, the
<code class="docutils literal notranslate"><span class="pre">LdapAuthorizationsProvider</span></code>.</p>
</div>
<div class="section" id="applying-authorizations-and-visibilities-to-geoserver-using-pkis-and-ldap">
<span id="authorizations-gs-pki-ldap"></span><h2>Applying Authorizations and Visibilities to GeoServer Using PKIS and LDAP<a class="headerlink" href="#applying-authorizations-and-visibilities-to-geoserver-using-pkis-and-ldap" title="Permalink to this headline">¶</a></h2>
<p>This section will show you how to configure GeoServer to authenticate
users with PKIs, use LDAP to store authorizations, and apply
authorizations on a per-user/per-query basis.</p>
<p>Basic user authentication will take place via user certificates. Each
user will have their own public/private key pair that uniquely
identifies them.</p>
<p>User authorizations will come from LDAP. Once a user’s identity has been
verified via PKI, we will look up the user’s details in LDAP.</p>
<p>Once we have a user’s authentication and authorizations, we will apply
them to the GeoMesa query using a custom <code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code>
implementation.</p>
<div class="section" id="run-geoserver-in-tomcat">
<h3>Run GeoServer in Tomcat<a class="headerlink" href="#run-geoserver-in-tomcat" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are already running GeoServer in Tomcat, you
can skip this step.</p>
</div>
<p>GeoServer ships by default with an embedded Jetty servlet. In order to
use PKI login, we need to install it in Tomcat instead.</p>
<ol class="arabic">
<li><p class="first">Download and install <a class="reference external" href="http://tomcat.apache.org/download-70.cgi">Tomcat 7</a>.</p>
</li>
<li><p class="first">Create an environment variable pointing to your tomcat installation
(you may want to add this to your bash init scripts):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">CATALINA_HOME</span><span class="o">=</span>/path/to/tomcat
</pre></div>
</div>
</li>
<li><p class="first">If you want to reuse your existing GeoServer configuration, create an
environment variable pointing to your GeoServer data directory (you
may want to add this to your shell initialization scripts):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">GEOSERVER_DATA_DIR</span><span class="o">=</span>/path/to/geoserver/data_dir
</pre></div>
</div>
</li>
<li><p class="first">Copy the GeoServer webapp from the GeoServer distribution into the
tomcat servlet:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cp -r /path/to/geoserver/webapps/geoserver/ <span class="nv">$CATALINA_HOME</span>/webapps/
</pre></div>
</div>
</li>
<li><p class="first">Increase the memory allocated to Tomcat, which you will need for
running complex queries in GeoServer (the values here may not be
applicable for every installation):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> <span class="nv">$CATALINA_HOME</span>/bin
$ <span class="nb">echo</span> <span class="s1">&#39;CATALINA_OPTS=&quot;-Xmx2g -XX:MaxPermSize=128m&quot;&#39;</span> &gt;&gt; setenv.sh
</pre></div>
</div>
</li>
<li><p class="first">Start Tomcat, either as a service or through the startup scripts, and
ensure that GeoServer is available at <a class="reference external" href="http://localhost:8080/geoserver/web/">http://localhost:8080/geoserver/web/</a>.</p>
</li>
</ol>
</div>
<div class="section" id="create-the-accumulo-data-store-and-layer-in-geoserver">
<h3>Create the Accumulo Data Store and Layer in GeoServer<a class="headerlink" href="#create-the-accumulo-data-store-and-layer-in-geoserver" title="Permalink to this headline">¶</a></h3>
<p>Log into GeoServer using your user and password credentials. Click “Stores” and “Add new Store”.
Select the <code class="docutils literal notranslate"><span class="pre">Accumulo</span> <span class="pre">(GeoMesa)</span></code> vector data source, and fill in the required parameters.</p>
<p>Basic store info:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">workspace</span></code> this is dependent upon your GeoServer installation</li>
<li><code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">source</span> <span class="pre">name</span></code> pick a sensible name, such as <code class="docutils literal notranslate"><span class="pre">geomesa_authorizations</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">description</span></code> this is strictly decorative; <code class="docutils literal notranslate"><span class="pre">GeoMesa</span> <span class="pre">authorizations</span> <span class="pre">tutorial</span></code></li>
</ul>
<p>Connection parameters:</p>
<ul class="simple">
<li>these are the same parameter values that you supplied on the
command line when you ran the tutorial; they describe how to connect
to the Accumulo instance where your data reside</li>
<li><code class="docutils literal notranslate"><span class="pre">geomesa.security.auths</span></code> leave this field empty</li>
</ul>
<p>Click “Save”, and GeoServer will search your Accumulo table for any
GeoMesa-managed feature types.</p>
</div>
<div class="section" id="publish-the-layer">
<h3>Publish the Layer<a class="headerlink" href="#publish-the-layer" title="Permalink to this headline">¶</a></h3>
<p>GeoServer should recognize the <code class="docutils literal notranslate"><span class="pre">gdelt-secure</span></code> feature type, and
should present that as a layer that can be published. Click on the
“Publish” link.</p>
<p>You will be taken to the “Edit Layer” screen. You will need to enter values for the data bounding
boxes. In this case, you can click on the link to compute these values from the data.</p>
<p>Click on the “Save” button when you are done.</p>
</div>
<div class="section" id="configure-geoserver-for-pki-login">
<h3>Configure GeoServer for PKI Login<a class="headerlink" href="#configure-geoserver-for-pki-login" title="Permalink to this headline">¶</a></h3>
<p>Follow the instructions in the GeoServer
<a class="reference external" href="http://docs.geoserver.org/latest/en/user/security/tutorials/cert/index.html">documentation</a>
in order to enable PKI login to GeoServer.</p>
<p>In the step where you add the ‘cert’ filter to the ‘Filter Chains’, also
add it to the ‘rest’, ‘gwc’ and ‘default’ chains (in addition to web).</p>
<p>We will be using the ‘rod’ and ‘scott’ users, so be sure to install
those into your browser.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure that you click the ‘Save’ button on all
GeoServer screens. Otherwise, your changes may be lost.</p>
</div>
<p>Verify that the changes were applied by re-starting Tomcat, and checking
that the ‘web’ filter chain has the ‘cert’ filter selected:</p>
<div class="figure" id="id1">
<img alt="Web Filter Panel" src="../_images/filter-chain-cert.jpg" />
<p class="caption"><span class="caption-text">Web Filter Panel</span></p>
</div>
</div>
<div class="section" id="install-an-ldap-server-for-storing-authorizations">
<h3>Install an LDAP Server for Storing Authorizations<a class="headerlink" href="#install-an-ldap-server-for-storing-authorizations" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are already have an LDAP server set up, you
can skip this step.</p>
</div>
<ol class="arabic simple">
<li>Download and install
<a class="reference external" href="http://directory.apache.org/apacheds/">ApacheDS</a></li>
<li>Either run as a service, or run through the start scripts:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> apacheds-2.0.0-M20/bin
$ chmod <span class="m">755</span> *.sh
$ ./apacheds.sh
</pre></div>
</div>
</div>
<div class="section" id="configure-ldap-for-storing-authorizations">
<h3>Configure LDAP for Storing Authorizations<a class="headerlink" href="#configure-ldap-for-storing-authorizations" title="Permalink to this headline">¶</a></h3>
<p>We want to configure LDAP with a user to match the Spring Security PKIs
we are testing with. The end result we want is to create the following
user:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DN</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">rod</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">Spring</span> <span class="n">Security</span><span class="p">,</span><span class="n">o</span><span class="o">=</span><span class="n">Spring</span> <span class="n">Framework</span>
</pre></div>
</div>
<p>In order to do that, we will use Apache Directory Studio.</p>
<ol class="arabic simple">
<li>Download and run <a class="reference external" href="http://directory.apache.org/studio/">Apache Directory
Studio</a>.</li>
<li>Connect to the your LDAP instance (ApacheDS), using the instructions
<a class="reference external" href="http://directory.apache.org/apacheds/basic-ug/1.4.2-changing-admin-password.html">here</a>
(note: you do not need to change the password unless you want to).</li>
<li>Create a partition for our data:<ol class="arabic">
<li>Right-click the ‘ApacheDS (localhost)’ entry under the
‘Connection’ tab and select ‘Open Configuration’.</li>
<li>Click ‘Advanced Partitions Configuration…’.</li>
<li>Click ‘Add’.</li>
<li>Set the ID field to be ‘Spring Framework’.</li>
<li>Set the Suffix field to be ‘o=Spring Framework’.</li>
<li>Uncheck ‘Auto-generate context entry from suffix DN’.</li>
<li>Set the following attributes in Context Entry:<ul>
<li>objectclass: extensibleObject</li>
<li>objectclass: top</li>
<li>objectclass: domain</li>
<li>dc: Spring Framework2</li>
<li>o: Spring Framework2</li>
</ul>
</li>
<li>Hit <strong>Ctrl-s</strong> to save the partition. <img alt="ApacheDS Partition" src="../_images/apache-ds-partition.png" /></li>
</ol>
</li>
<li><strong>Restart ApacheDS.</strong> Otherwise the partition will not be available
and the LDIF import will fail.</li>
<li>Load the following LDIF file, which will create the Spring Security
OU and the ‘rod’ user:<ul>
<li><a class="reference download internal" download="" href="../_downloads/db385c668e92c6af056a61a2ae00d558/spring-security-rod.ldif"><code class="xref download docutils literal notranslate"><span class="pre">spring-security-rod.ldif</span></code></a></li>
<li>Right-click the ‘Root DSE’ node in the LDAP browser, and select
‘Import-&gt;LDIF import…’</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="test-ldap-connection-using-tutorial-code">
<h3>Test LDAP Connection Using Tutorial Code<a class="headerlink" href="#test-ldap-connection-using-tutorial-code" title="Permalink to this headline">¶</a></h3>
<p>The tutorial code includes an <code class="docutils literal notranslate"><span class="pre">AuthorizationsProvider</span></code> implementation
that will connect to LDAP to retrieve authorizations, in the class
<code class="docutils literal notranslate"><span class="pre">com.example.geomesa.auths.LdapAuthorizationsProvider</span></code>.</p>
<p>The provider will configure itself based on the
<code class="docutils literal notranslate"><span class="pre">geomesa-ldap.properties</span></code> file on the classpath (under
<code class="docutils literal notranslate"><span class="pre">src/main/resources</span></code>):</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="c"># ldap connection properties</span>
<span class="na">java.naming.factory.initial</span><span class="o">=</span><span class="s">com.sun.jndi.ldap.LdapCtxFactory</span>
<span class="na">java.naming.provider.url</span><span class="o">=</span><span class="s">ldap://localhost:10389</span>
<span class="na">java.naming.security.authentication</span><span class="o">=</span><span class="s">simple</span>
<span class="na">java.naming.security.principal</span><span class="o">=</span><span class="s">uid=admin,ou=system</span>
<span class="na">java.naming.security.credentials</span><span class="o">=</span><span class="s">secret</span>

<span class="c"># the ldap node to start the query from</span>
<span class="na">geomesa.ldap.search.root</span><span class="o">=</span><span class="s">o=Spring Framework</span>
<span class="c"># the query that will be applied to find the user&#39;s record</span>
<span class="c"># the &#39;{}&#39; will be replaced with the common name from the certificate the user has logged in with</span>
<span class="na">geomesa.ldap.search.filter</span><span class="o">=</span><span class="s">(&amp;(objectClass=person)(cn={}))</span>
<span class="c"># the ldap attribute that holds the comma-delimited authorizations for the user</span>
<span class="na">geomesa.ldap.auths.attribute</span><span class="o">=</span><span class="s">employeeType</span>
</pre></div>
</div>
<p>The default file included with the tutorial will connect to the LDAP
instance we set up in the previous steps. If you are using a different
LDAP configuration, you will need to modify the file appropriately.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LdapAuthorizationsProvider</span></code> will look for a particular LDAP
attribute that stores the user’s authorizations in a comma-delimited
list. For simplicity, in this tutorial we have re-purposed an existing
attribute, <code class="docutils literal notranslate"><span class="pre">employeeType</span></code>. The attribute to use can be modified
through the property file.</p>
<p>When we inserted the ‘rod’ record into LDAP, we set his <code class="docutils literal notranslate"><span class="pre">employeeType</span></code>
to ‘user,admin’, corresponding to our Accumulo authorizations. If you
are using different authorizations, you will need to update the
attribute to match.</p>
<p>The tutorial code includes a test case for connecting to LDAP, in the
class <code class="docutils literal notranslate"><span class="pre">LdapAuthorizationsProviderTest</span></code>.</p>
<p>Once you have modified <code class="docutils literal notranslate"><span class="pre">geomesa-ldap.properties</span></code> to connect to your
LDAP, you can test the connection by running this test class:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ java -cp geomesa-tutorials-accumulo/geomesa-tutorials-accumulo-authorizations/target/geomesa-tutorials-accumulo-authorizations-<span class="si">${</span><span class="nv">geomesa</span><span class="p">.version</span><span class="si">}</span>.jar <span class="se">\</span>
    org.geomesa.example.accumulo.auths.LdapAuthorizationsProviderTest rod
</pre></div>
</div>
<p>The argument to the program (‘rod’) is the user to retrieve
authorizations for. You should get the following output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Checking auths from LDAP <span class="k">for</span> user <span class="s1">&#39;rod&#39;</span>
Retrieved auths: user,admin
</pre></div>
</div>
</div>
<div class="section" id="installing-the-ldap-authorizationprovider-in-geoserver">
<h3>Installing the LDAP AuthorizationProvider in GeoServer<a class="headerlink" href="#installing-the-ldap-authorizationprovider-in-geoserver" title="Permalink to this headline">¶</a></h3>
<p>In order to use the <code class="docutils literal notranslate"><span class="pre">LdapAuthorizationsProvider</span></code>, we need to install
it as a service provider into GeoServer, where it will automatically be
picked up by GeoMesa.</p>
<p>The tutorial code includes a service provider registry in the
<code class="docutils literal notranslate"><span class="pre">META-INF/services</span></code> folder. By default, the provider class is
specified as the <code class="docutils literal notranslate"><span class="pre">EmptyAuthorizationsProvider</span></code>.</p>
<ol class="arabic">
<li><p class="first">Ensure that your LDAP configuration is correct by running
<code class="docutils literal notranslate"><span class="pre">LdapAuthorizationsProviderTest</span></code>, as described above.</p>
</li>
<li><p class="first">Change the provider class in the single line file
<code class="docutils literal notranslate"><span class="pre">src/main/resources/META-INF/services/org.locationtech.geomesa.security.AuthorizationsProvider</span></code>
to be
<code class="docutils literal notranslate"><span class="pre">org.geomesa.example.accumulo.auths.LdapAuthorizationsProvider</span></code></p>
</li>
<li><p class="first">Rebuild the tutorial JAR and install the <strong>unshaded original</strong> jar
in GeoServer:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mvn clean install -pl geomesa-tutorials-accumulo/geomesa-tutorials-accumulo-authorizations
$ cp geomesa-tutorials-accumulo/geomesa-tutorials-accumulo-authorizations/target/geomesa-tutorials-accumulo-authorizations-<span class="si">${</span><span class="nv">geomesa</span><span class="p">.version</span><span class="si">}</span>.jar <span class="se">\</span>
    /path/to/tomcat/webapps/geoserver/WEB-INF/lib/
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We want to use the unshaded jar since all the
required dependencies are already installed in GeoServer.</p>
</div>
<ol class="arabic simple" start="4">
<li>Restart GeoServer (or start it if it is not running).</li>
</ol>
<p>At this point you should have everything configured and in-place.</p>
</div>
<div class="section" id="verifying-the-ldap-authorizations-in-geoserver">
<h3>Verifying the LDAP Authorizations in GeoServer<a class="headerlink" href="#verifying-the-ldap-authorizations-in-geoserver" title="Permalink to this headline">¶</a></h3>
<p>In order to verify that the authorizations are working correctly,
execute a query against GeoMesa by calling the WMS provider over HTTPS
in your browser:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>https://localhost:8443/geoserver/wms?service<span class="o">=</span>WMS<span class="p">&amp;</span><span class="nv">version</span><span class="o">=</span><span class="m">1</span>.1.0<span class="p">&amp;</span><span class="nv">request</span><span class="o">=</span>GetMap<span class="p">&amp;</span><span class="nv">layers</span><span class="o">=</span>geomesa:gdelt_auths<span class="p">&amp;</span><span class="nv">styles</span><span class="o">=</span><span class="p">&amp;</span><span class="nv">bbox</span><span class="o">=</span><span class="m">31</span>.6,44,37.4,47.75<span class="p">&amp;</span><span class="nv">width</span><span class="o">=</span><span class="m">1200</span><span class="p">&amp;</span><span class="nv">height</span><span class="o">=</span><span class="m">600</span><span class="p">&amp;</span><span class="nv">srs</span><span class="o">=</span>EPSG:4326<span class="p">&amp;</span><span class="nv">format</span><span class="o">=</span>application/openlayers
</pre></div>
</div>
<p>When prompted, select the ‘rod’ certificate.</p>
<p>You should see the normal data come back, with many red points
indicating the data:</p>
<div class="figure" id="id2">
<img alt="Authorized Results" src="../_images/geoserver-layer-preview.png" />
<p class="caption"><span class="caption-text">Authorized Results</span></p>
</div>
<p>Now try the same query, but use the ‘scott’ certificate. This time,
there should be no data returned, as the ‘scott’ user does not have any
authorizations set up in LDAP.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A simple way to use different certificates at once
is to open multiple ‘incognito’ or ‘private’ browser windows.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="geomesa-examples-featurelevelvis.html" class="btn btn-neutral float-right" title="Feature Level Visibility and Security" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="geomesa-tubeselect.html" class="btn btn-neutral" title="Web Processing Services (WPS) Tube Select" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2021 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    
    - view <a href="../_sources/tutorials/geomesa-examples-authorizations.rst.txt" rel="nofollow">page source</a>
    
  </p>
</div>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<!-- analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-53087457-1', 'auto');
ga('send', 'pageview');
</script>




</body>
</html>