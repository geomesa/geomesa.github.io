

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10.1. Installing GeoMesa HBase &mdash; GeoMesa 2.1.3 Manuals</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.10/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.10/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.10/tab.min.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10.2. Manual Coprocessors Registration" href="coprocessor_install.html" />
    <link rel="prev" title="10. HBase Data Store" href="index.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                2.1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">7. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">8. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">9. GeoMesa Spark</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">10. HBase Data Store</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">10.1. Installing GeoMesa HBase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-the-binary-distribution">10.1.1. Installing the Binary Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-from-source">10.1.2. Building from Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-the-geomesa-distributed-runtime-jar">10.1.3. Installing the GeoMesa Distributed Runtime JAR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-and-classpaths">10.1.4. Configuration and Classpaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-the-hbase-command-line-tools">10.1.5. Setting up the HBase Command Line Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-geomesa-hbase-in-geoserver">10.1.6. Installing GeoMesa HBase in GeoServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connecting-to-external-hbase-clusters-backed-by-s3">10.1.7. Connecting to External HBase Clusters Backed By S3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-hbase-on-azure-hdinsight">10.1.8. Configuring HBase on Azure HDInsight</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="coprocessor_install.html">10.2. Manual Coprocessors Registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">10.3. HBase Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">10.4. Using the HBase Data Store Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">10.5. Using the HBase Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">10.6. HBase Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_config.html">10.7. HBase Index Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_config.html#hbase-index-versions">10.8. HBase Index Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="heatmaps.html">10.9. HBase Heatmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="visibilities.html">10.10. HBase Visibilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="kerberos.html">10.11. Kerberos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">11. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">12. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">13. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">14. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">15. FileSystem Data Store (HDFS, S3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kudu/index.html">16. Kudu Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">17. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../merged_view.html">18. Merged Data Store View</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">19. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">20. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">21. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi.html">22. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blobstore.html">23. GeoMesa Blob Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../native_api.html">24. GeoMesa Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">25. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">26. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Manual</a> &raquo;</li>
        
          <li><a href="index.html">10. HBase Data Store</a> &raquo;</li>
        
      <li>10.1. Installing GeoMesa HBase</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user/hbase/install.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-geomesa-hbase">
<h1>10.1. Installing GeoMesa HBase<a class="headerlink" href="#installing-geomesa-hbase" title="Permalink to this headline">¶</a></h1>
<p>GeoMesa supports traditional HBase installations as well as HBase running on <a class="reference external" href="https://aws.amazon.com/emr/">Amazon’s EMR</a>
, <a class="reference external" href="https://hortonworks.com/products/data-center/hdp/">Hortonworks’ Data Platform (HDP)</a>, and the
<a class="reference external" href="https://www.cloudera.com/products/enterprise-data-hub.html">Cloudera Distribution of Hadoop (CDH)</a>. For details
on bootstrapping an EMR cluster, see <a class="reference internal" href="../../tutorials/geomesa-hbase-s3-on-aws.html"><span class="doc">Bootstrapping GeoMesa HBase on AWS S3</span></a>. For details on deploying to
Cloudera CDH, see <a class="reference internal" href="../../tutorials/geomesa-hbase-on-cdh.html"><span class="doc">Deploying GeoMesa HBase on Cloudera CDH 5.X</span></a>.</p>
<div class="section" id="installing-the-binary-distribution">
<h2>10.1.1. Installing the Binary Distribution<a class="headerlink" href="#installing-the-binary-distribution" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa HBase artifacts are available for download or can be built from source.
The easiest way to get started is to download the most recent binary version
(2.1.3) from <a class="reference external" href="https://github.com/locationtech/geomesa/releases">GitHub</a>.</p>
<p>Extract it somewhere convenient:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># download and unpackage the most recent distribution:</span>
$ wget <span class="s2">&quot;https://github.com/locationtech/geomesa/releases/download/geomesa_2.11-</span><span class="nv">$VERSION</span><span class="s2">/geomesa-hbase_2.11-</span><span class="nv">$VERSION</span><span class="s2">-bin.tar.gz&quot;</span>
$ tar xvf geomesa-hbase_2.11-<span class="nv">$VERSION</span>-bin.tar.gz
$ <span class="nb">cd</span> geomesa-hbase_2.11-<span class="nv">$VERSION</span>
$ ls
bin/  conf/  dist/  docs/  examples/  lib/  LICENSE.txt  logs/
</pre></div>
</div>
</div>
<div class="section" id="building-from-source">
<span id="hbase-install-source"></span><h2>10.1.2. Building from Source<a class="headerlink" href="#building-from-source" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa HBase may also be built from source. For more information refer to <a class="reference internal" href="../../developer/introduction.html#building-from-source"><span class="std std-ref">Building from Source</span></a>
in the developer manual, or to the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file in the the source distribution.
The remainder of the instructions in this chapter assume the use of the binary GeoMesa HBase
distribution. If you have built from source, the distribution is created in the <code class="docutils literal notranslate"><span class="pre">target</span></code> directory of
<code class="docutils literal notranslate"><span class="pre">geomesa-hbase/geomesa-hbase-dist</span></code>.</p>
<p>More information about developing with GeoMesa may be found in the <a class="reference internal" href="../../developer/index.html"><span class="doc">Developer Manual</span></a>.</p>
</div>
<div class="section" id="installing-the-geomesa-distributed-runtime-jar">
<span id="hbase-deploy-distributed-runtime"></span><h2>10.1.3. Installing the GeoMesa Distributed Runtime JAR<a class="headerlink" href="#installing-the-geomesa-distributed-runtime-jar" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa uses custom HBase filters and coprocessors to speed up queries. In order to use them, you must deploy the
distributed runtime jar to the HBase to the directory specified by the HBase configuration variable called
<code class="docutils literal notranslate"><span class="pre">hbase.dynamic.jars.dir</span></code>.  This is set to <code class="docutils literal notranslate"><span class="pre">${hbase.rootdir}/lib</span></code> by default.  Copy the distribute runtime jar to
this directory as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hadoop fs -put <span class="si">${</span><span class="nv">GEOMESA_HBASE_HOME</span><span class="si">}</span>/dist/hbase/geomesa-hbase-distributed-runtime-<span class="nv">$VERSION</span>.jar <span class="si">${</span><span class="nv">hbase</span><span class="p">.dynamic.jars.dir</span><span class="si">}</span>/
</pre></div>
</div>
<p>If running on top of Amazon S3, you will need to use the <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span></code> command line tool.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws s3 cp <span class="si">${</span><span class="nv">GEOMESA_HBASE_HOME</span><span class="si">}</span>/dist/hbase/geomesa-hbase-distributed-runtime-<span class="nv">$VERSION</span>.jar s3://<span class="si">${</span><span class="nv">hbase</span><span class="p">.dynamic.jars.dir</span><span class="si">}</span>/
</pre></div>
</div>
<p>If required, you may disable distributed processing by setting the system property <code class="docutils literal notranslate"><span class="pre">geomesa.hbase.remote.filtering</span></code>
to <code class="docutils literal notranslate"><span class="pre">false</span></code>. Note that this may have an adverse effect on performance.</p>
<div class="section" id="register-the-coprocessors">
<span id="registering-coprocessors"></span><h3>10.1.3.1. Register the Coprocessors<a class="headerlink" href="#register-the-coprocessors" title="Permalink to this headline">¶</a></h3>
<p>Assuming that you have installed the distributed runtime JAR under <code class="docutils literal notranslate"><span class="pre">hbase.dynamic.jars.dir</span></code>, coprocessors will be
registered automatically when you call <code class="docutils literal notranslate"><span class="pre">createSchema</span></code> on a data store. Alternatively, the coprocessors may be
registered manually. See <a class="reference internal" href="coprocessor_install.html#coprocessor-alternate"><span class="std std-ref">Manual Coprocessors Registration</span></a> for details.</p>
<p>For more information on managing coprocessors see
<a class="reference external" href="https://blogs.apache.org/hbase/entry/coprocessor_introduction">Coprocessor Introduction</a> on Apache’s Blog.</p>
</div>
</div>
<div class="section" id="configuration-and-classpaths">
<h2>10.1.4. Configuration and Classpaths<a class="headerlink" href="#configuration-and-classpaths" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa HBase requires Hadoop and HBase jars and configuration files to be available on the classpath. This includes
files such as the hbase-site.xml and core-site.xml files in addition to standard jars and libraries. Configuring the
classpath is important if you plan to use the GeoMesa HBase command line tools to ingest and manage GeoMesa.</p>
<p>By default, GeoMesa HBase will attempt to read various HBase and Hadoop related environmental variables in order to
build the classpath. You can configure environment variables and classpath settings in
<code class="docutils literal notranslate"><span class="pre">geomesa-hbase_2.11-$VERSION/conf/geomesa-env.sh</span></code> or in your external env (e.g. bashrc file). The logic GeoMesa
uses to determine which external entries to include on the classpath is:</p>
<blockquote>
<div><p>1. If the environmental variables <code class="docutils literal notranslate"><span class="pre">GEOMESA_HADOOP_CLASSPATH</span></code> and <code class="docutils literal notranslate"><span class="pre">GEOMESA_HBASE_CLASSPATH</span></code> are set then GeoMesa
HBase will use these variables to set the classpath and skip all other logic.</p>
<p>2. Next, if <code class="docutils literal notranslate"><span class="pre">$HBASE_HOME</span></code> and <code class="docutils literal notranslate"><span class="pre">$HADOOP_HOME</span></code> are set then GeoMesa HBase will attempt to build the classpath by
searching for jar files and configuration in standard locations. Note that this is very specific to the
installation or distribution of Hadoop you are using and may not be reliable.</p>
<p>3. If no environmental variables are set but the <code class="docutils literal notranslate"><span class="pre">hbase</span></code> and <code class="docutils literal notranslate"><span class="pre">hadoop</span></code> commands are available then GeoMesa will
interrogate them for their classpaths by running the <code class="docutils literal notranslate"><span class="pre">hadoop</span> <span class="pre">classpath</span></code> and <code class="docutils literal notranslate"><span class="pre">hbase</span> <span class="pre">classpath</span></code> commands. This
method of classpath determination is slow due to the fact that the <code class="docutils literal notranslate"><span class="pre">hbase</span> <span class="pre">classpath</span></code> command forks a new JVM. It
is therefore recommended that you set manually set these variables in your environment or the
<code class="docutils literal notranslate"><span class="pre">conf/geomesa-env.sh</span></code> file.</p>
</div></blockquote>
<p>In addition, <code class="docutils literal notranslate"><span class="pre">geomesa-hbase</span></code> will pull any additional entries from the <code class="docutils literal notranslate"><span class="pre">GEOMESA_EXTRA_CLASSPATHS</span></code>
environment variable.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">GEOMESA_EXTRA_CLASSPATHS</span></code>, <code class="docutils literal notranslate"><span class="pre">GEOMESA_HADOOP_CLASSPATH</span></code>, and <code class="docutils literal notranslate"><span class="pre">GEOMESA_HBASE_CLASSPATH</span></code> variables
all follow standard
<a class="reference external" href="http://docs.oracle.com/javase/8/docs/technotes/tools/windows/classpath.html">Java Classpath</a> conventions, which
generally means that entries must be directories, JAR, or zip files. Individual XML files will be ignored. For example,
to add a <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> or <code class="docutils literal notranslate"><span class="pre">core-site.xml</span></code> file to the classpath you must either include a directory on the
classpath or add the file to a zip or JAR archive to be included on the classpath.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">geomesa</span> <span class="pre">classpath</span></code> command in order to see what JARs are being used.</p>
<p>A few suggested configurations are below:</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-QW1hem9uIEVNUg== docutils container">
<div class="docutils container">
Amazon EMR</div>
</div>
<div class="item sphinx-data-tab-U3RhbmRhcmQ= docutils container">
<div class="docutils container">
Standard</div>
</div>
<div class="item sphinx-data-tab-SERQ docutils container">
<div class="docutils container">
HDP</div>
</div>
<div class="item sphinx-data-tab-TWFudWFsIEluc3RhbGw= docutils container">
<div class="docutils container">
Manual Install</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-QW1hem9uIEVNUg== active docutils container">
<p>When using EMR to install HBase or Hadoop there are AWS specific jars that need to be used (e.g. EMR FS).
It is recommended to use EMR to install Hadoop and/or HBase in order to properly configure and install these
dependencies (especially when using HBase on S3).</p>
<p>If you used EMR to install Hadoop and HBase, you can view their classpaths using the <code class="docutils literal notranslate"><span class="pre">hadoop</span> <span class="pre">classpath</span></code> and
<code class="docutils literal notranslate"><span class="pre">hbase</span> <span class="pre">classpath</span></code> commands to build an appropriate classpath to include jars and configuration files for
GeoMesa HBase:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">GEOMESA_HADOOP_CLASSPATH</span><span class="o">=</span><span class="k">$(</span>hadoop classpath<span class="k">)</span>
<span class="nb">export</span> <span class="nv">GEOMESA_HBASE_CLASSPATH</span><span class="o">=</span><span class="k">$(</span>hbase classpath<span class="k">)</span>
<span class="nb">export</span> <span class="nv">GEOMESA_HBASE_HOME</span><span class="o">=</span>/opt/geomesa
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GEOMESA_HBASE_HOME</span><span class="si">}</span><span class="s2">/bin&quot;</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-U3RhbmRhcmQ= docutils container">
<p>Configure GeoMesa to use pre-installed HBase and Hadoop distributions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">HADOOP_HOME</span><span class="o">=</span>/path/to/hadoop
<span class="nb">export</span> <span class="nv">HBASE_HOME</span><span class="o">=</span>/path/to/hbase
<span class="nb">export</span> <span class="nv">GEOMESA_HBASE_HOME</span><span class="o">=</span>/opt/geomesa
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GEOMESA_HOME</span><span class="si">}</span><span class="s2">/bin&quot;</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-SERQ docutils container">
<p>Configure the environment to use an HDP install</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">HADOOP_HOME</span><span class="o">=</span>/usr/hdp/current/hadoop-client/
<span class="nb">export</span> <span class="nv">HBASE_HOME</span><span class="o">=</span>/usr/hdp/current/hbase-client/
<span class="nb">export</span> <span class="nv">GEOMESA_HBASE_HOME</span><span class="o">=</span>/opt/geomesa
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GEOMESA_HBASE_HOME</span><span class="si">}</span><span class="s2">/bin&quot;</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-TWFudWFsIEluc3RhbGw= docutils container">
<p>If no HBase or Hadoop distribution is installed, try manually installing the JARs from maven:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">GEOMESA_HBASE_HOME</span><span class="o">=</span>/opt/geomesa
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GEOMESA_HBASE_HOME</span><span class="si">}</span><span class="s2">/bin&quot;</span>
<span class="nb">cd</span> GEOMESA_HBASE_HOME
bin/install-hadoop.sh lib
bin/install-hbase.sh lib
</pre></div>
</div>
<p>You will also need to provide the hbase-site.xml file within a the GeoMesa <code class="docutils literal notranslate"><span class="pre">conf</span></code> directory, an external
directory, zip, or JAR archive (an entry referencing the XML file directly will not work with the Java
classpath).</p>
<p>When creating a zip or jar file, the hbase-site.xml should be at the root level of the archive
and not nested within any packages or subfolders. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ jar tf my.jar
META-INF/
META-INF/MANIFEST.MF
hbase-site.xml
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># try this</span>
cp /path/to/hbase-site.xml <span class="si">${</span><span class="nv">GEOMESA_HBASE_HOME</span><span class="si">}</span>/conf/

<span class="c1"># or this</span>
<span class="nb">cd</span> /path/to/hbase-conf-dir
jar cvf conf.jar hbase-site.xml
<span class="nb">export</span> <span class="nv">GEOMESA_EXTRA_CLASSPATHS</span><span class="o">=</span>/path/to/confdir:/path/to/conf.zip:/path/to/conf.jar
</pre></div>
</div>
</div>
</div>
<p>Due to licensing restrictions, dependencies for shape file support must be separately installed.
Do this with the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bin/install-jai.sh
$ bin/install-jline.sh
</pre></div>
</div>
</div>
<div class="section" id="setting-up-the-hbase-command-line-tools">
<span id="setting-up-hbase-commandline"></span><h2>10.1.5. Setting up the HBase Command Line Tools<a class="headerlink" href="#setting-up-the-hbase-command-line-tools" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To use HBase with the command line tools, you need to install the coprocessors first, as described above.</p>
</div>
<p>GeoMesa comes with a set of command line tools for managing HBase features located in
<code class="docutils literal notranslate"><span class="pre">geomesa-hbase_2.11-$VERSION/bin/</span></code> of the binary distribution.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can configure environment variables and classpath settings in geomesa-hbase_2.11-$VERSION/conf/geomesa-env.sh.</p>
</div>
<p>If desired, you may use the included script <code class="docutils literal notranslate"><span class="pre">bin/geomesa-hbase</span> <span class="pre">configure</span></code> to help set up the environment variables
used by the tools. Otherwise, you may invoke the <code class="docutils literal notranslate"><span class="pre">geomesa-hbase</span></code> script using the fully-qualified path, and
use the default configuration.</p>
<p>The tools will read the <code class="docutils literal notranslate"><span class="pre">$HBASE_HOME</span></code> and <code class="docutils literal notranslate"><span class="pre">$HADOOP_HOME</span></code> environment variables to load the
appropriate JAR files for HBase and Hadoop. If installing on a system without HBase and/or Hadoop,
the <code class="docutils literal notranslate"><span class="pre">install-hbase.sh</span></code> and <code class="docutils literal notranslate"><span class="pre">install-hadoop.sh</span></code> scripts in the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory may be used to download
the required HBase and Hadoop JARs into the <code class="docutils literal notranslate"><span class="pre">lib</span></code> directory. You should edit this script to match the versions
used by your installation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="../cli/logging.html#slf4j-configuration"><span class="std std-ref">Logging Configuration</span></a> for information about configuring the SLF4J implementation.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">GeoMesa provides the ability to provide additional jars on the classpath using the environmental variable
<code class="docutils literal notranslate"><span class="pre">$GEOMESA_EXTRA_CLASSPATHS</span></code>. GeoMesa will prepend the contents of this environmental variable  to the computed
classpath giving it highest precedence in the classpath. Users can provide directories of jar files or individual
files using a colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) as a delimiter. These entries will also be added the the map-reduce libjars variable.
Use the <code class="docutils literal notranslate"><span class="pre">geomesa-hbase</span> <span class="pre">classpath</span></code> command to print the final classpath that will be used when executing geomesa
commands.</p>
</div>
<p>The tools also need access to the <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> for your cluster. If <code class="docutils literal notranslate"><span class="pre">$HBASE_HOME</span></code> is defined, it will pick
it up from there. However, it may not be available for map/reduce jobs. To ensure it’s availability,
add it at the root level of the <code class="docutils literal notranslate"><span class="pre">geomesa-hbase-datastore</span></code> JAR in the lib folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ zip -r lib/geomesa-hbase-datastore_2.11-<span class="nv">$VERSION</span>.jar hbase-site.xml
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Ensure that the <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> is at the root (top) level of your JAR, otherwise it will not be picked up.</p>
</div>
<p>Due to licensing restrictions, certain dependencies for shape file support must be separately
installed. Do this with the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bin/install-jai.sh
$ bin/install-jline.sh
</pre></div>
</div>
<p>Test the command that invokes the GeoMesa Tools:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ bin/geomesa-hbase
INFO  Usage: geomesa-hbase [command] [command options]
  Commands:
  ...
</pre></div>
</div>
<p>For more details, see <a class="reference internal" href="commandline.html#hbase-tools"><span class="std std-ref">HBase Command-Line Tools</span></a>.</p>
</div>
<div class="section" id="installing-geomesa-hbase-in-geoserver">
<span id="install-hbase-geoserver"></span><h2>10.1.6. Installing GeoMesa HBase in GeoServer<a class="headerlink" href="#installing-geomesa-hbase-in-geoserver" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<dl class="last docutils">
<dt>GeoServer 2.13.0 and 2.13.1 are not recommended due to two serious bugs:</dt>
<dd><ul class="first last simple">
<li>GeoMesa WPS processes are not triggered correctly, and will run slowly or not at all</li>
<li>GeoMesa count optimizations are bypassed, potentially resulting in large duplicate scans for WFS queries</li>
</ul>
</dd>
</dl>
</div>
<p>The HBase GeoServer plugin is bundled by default in a GeoMesa binary distribution. To install, extract
<code class="docutils literal notranslate"><span class="pre">$GEOMESA_HBASE_HOME/dist/gs-plugins/geomesa-hbase-gs-plugin_2.11-$VERSION-install.tar.gz</span></code> into GeoServer’s
<code class="docutils literal notranslate"><span class="pre">WEB-INF/lib</span></code> directory. Note that this plugin contains a shaded JAR with HBase 1.3.1
bundled. This JAR should work with HBase 1.3.x or 1.4.x.</p>
<p>This distribution does not include the Hadoop or Zookeeper JARs; the following JARs
should be copied from the <code class="docutils literal notranslate"><span class="pre">lib</span></code> directory of your HBase or Hadoop installations into
GeoServer’s <code class="docutils literal notranslate"><span class="pre">WEB-INF/lib</span></code> directory:</p>
<p>(Note the versions may vary depending on your installation.)</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-U3RhbmRhcmQ= docutils container">
<div class="docutils container">
Standard</div>
</div>
<div class="item sphinx-data-tab-SERQ docutils container">
<div class="docutils container">
HDP</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-U3RhbmRhcmQ= active docutils container">
<ul class="simple">
<li>commons-cli-1.2.jar</li>
<li>commons-configuration-1.6.jar</li>
<li>commons-io-2.5.jar  (you may need to remove an older version from geoserver)</li>
<li>commons-logging-1.1.3.jar</li>
<li>hadoop-auth-2.7.4.jar</li>
<li>hadoop-client-2.7.4.jar</li>
<li>hadoop-common-2.7.4.jar</li>
<li>hadoop-hdfs-2.7.4.jar</li>
<li>htrace-core-3.1.0-incubating.jar</li>
<li>metrics-core-2.2.0.jar</li>
<li>netty-3.6.2.Final.jar</li>
<li>netty-all-4.0.41.Final.jar</li>
<li>servlet-api-2.4.jar</li>
<li>zookeeper-3.4.10.jar</li>
</ul>
<p>You can use the bundled <code class="docutils literal notranslate"><span class="pre">$GEOMESA_HBASE_HOME/bin/install-hadoop.sh</span></code> script to install these JARs.</p>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-SERQ docutils container">
<ul class="simple">
<li>hadoop-annotations.jar</li>
<li>hadoop-auth.jar</li>
<li>hadoop-common.jar</li>
<li>protobuf-java.jar</li>
<li>commons-io.jar</li>
<li>zookeeper-3.4.10.jar</li>
<li>commons-configuration-1.6.jar</li>
</ul>
</div>
</div>
<p>The HBase data store requires the configuration file <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> to be on the classpath. This can
be accomplished by placing the file in <code class="docutils literal notranslate"><span class="pre">geoserver/WEB-INF/classes</span></code> (you should make the directory if it
doesn’t exist). Utilizing a symbolic link will be useful here so any changes are reflected in GeoServer.</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-U3RhbmRhcmQ= docutils container">
<div class="docutils container">
Standard</div>
</div>
<div class="item sphinx-data-tab-SERQ docutils container">
<div class="docutils container">
HDP</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-U3RhbmRhcmQ= active docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ln -s /path/to/hbase-site.xml /path/to/geoserver/WEB-INF/classes/hbase-site.xml
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-SERQ docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ln -s /usr/hdp/current/hbase-client/hbase-site.xml /path/to/geoserver/WEB-INF/classes/hbase-site.xml
</pre></div>
</div>
</div>
</div>
<p>Restart GeoServer after the JARs are installed.</p>
<div class="section" id="jackson-version">
<h3>10.1.6.1. Jackson Version<a class="headerlink" href="#jackson-version" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Some GeoMesa functions (in particular Arrow conversion) requires <code class="docutils literal notranslate"><span class="pre">jackson-core-2.6.x</span></code>. Some versions
of GeoServer ship with an older version, <code class="docutils literal notranslate"><span class="pre">jackson-core-2.5.0.jar</span></code>. After installing the GeoMesa
GeoServer plugin, be sure to delete the older JAR from GeoServer’s <code class="docutils literal notranslate"><span class="pre">WEB-INF/lib</span></code> folder.</p>
</div>
</div>
</div>
<div class="section" id="connecting-to-external-hbase-clusters-backed-by-s3">
<h2>10.1.7. Connecting to External HBase Clusters Backed By S3<a class="headerlink" href="#connecting-to-external-hbase-clusters-backed-by-s3" title="Permalink to this headline">¶</a></h2>
<p>To use a EMR cluster to connect to an existing, external HBase Cluster first follow the above instructions to setup the
new cluster and install GeoMesa.</p>
<p>The next step is to obtain the <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> for the external HBase Cluster, copy to the new EMR cluster and
copy it into <code class="docutils literal notranslate"><span class="pre">${GEOMESA_HBASE_HOME}/conf</span></code>. At this point you may run the geomesa-hbase command line tools.</p>
<p>If you wish to execute SQL queries using Spark, you must first zip the <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> file for the external cluster:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>zip hbase-site.zip hbase-site.xml
</pre></div>
</div>
<p>Then copy the zip file to  <code class="docutils literal notranslate"><span class="pre">${GEOMESA_HBASE_HOME}/conf</span></code> then add the zipped configuration file to the Spark classpath:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">SPARK_JARS</span><span class="o">=</span>file:///opt/geomesa/dist/spark/geomesa-hbase-spark-runtime_2.11-<span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span>.jar,file:///opt/geomesa/conf/hbase-site.zip
</pre></div>
</div>
<p>Then start up the Spark shell:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>spark-shell --jars <span class="nv">$SPARK_JARS</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-hbase-on-azure-hdinsight">
<h2>10.1.8. Configuring HBase on Azure HDInsight<a class="headerlink" href="#configuring-hbase-on-azure-hdinsight" title="Permalink to this headline">¶</a></h2>
<p>HDInsight generally creates <code class="docutils literal notranslate"><span class="pre">HBASE_HOME</span></code> in HDFS under the path <code class="docutils literal notranslate"><span class="pre">/hbase</span></code>. In order to make the GeoMesa
coprocessors and filters available to the region servers, use the <code class="docutils literal notranslate"><span class="pre">hadoop</span></code> filesystem command to put
the GeoMesa JAR there:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hadoop fs -mkdir /hbase/lib
hadoop fs -put geomesa-hbase-distributed-runtime-<span class="nv">$VERSION</span>.jar /hbase/lib/
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="coprocessor_install.html" class="btn btn-neutral float-right" title="10.2. Manual Coprocessors Registration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="10. HBase Data Store" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2017 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/sphinx_tabs/tabs.js"></script>
        <script type="text/javascript" src="../../_static/sphinx_tabs/semantic-ui-2.2.10/tab.min.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>