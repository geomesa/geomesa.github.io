<!DOCTYPE html >
<html>
        <head>
          <meta http-equiv="X-UA-Compatible" content="IE=edge" />
          <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
          <title>GeoMesa Metrics Micrometer 5.4.0 API  - org.locationtech.geomesa.metrics.micrometer.dbcp2</title>
          <meta name="description" content="GeoMesa Metrics Micrometer 5.4.0 API - org.locationtech.geomesa.metrics.micrometer.dbcp2" />
          <meta name="keywords" content="GeoMesa Metrics Micrometer 5.4.0 API org.locationtech.geomesa.metrics.micrometer.dbcp2" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      
      <link href="../../../../../../lib/index.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../../../../../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../../../../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript" src="../../../../../../lib/jquery.min.js"></script>
      <script type="text/javascript" src="../../../../../../lib/jquery.panzoom.min.js"></script>
      <script type="text/javascript" src="../../../../../../lib/jquery.mousewheel.min.js"></script>
      <script type="text/javascript" src="../../../../../../lib/index.js"></script>
      <script type="text/javascript" src="../../../../../../index.js"></script>
      <script type="text/javascript" src="../../../../../../lib/scheduler.js"></script>
      <script type="text/javascript" src="../../../../../../lib/template.js"></script>
      
      <script type="text/javascript">
        /* this variable can be used by the JS to determine the path to the root document */
        var toRoot = '../../../../../../';
      </script>
    
        </head>
        <body>
      <div id="search">
        <span id="doc-title">GeoMesa Metrics Micrometer 5.4.0 API<span id="doc-version"></span></span>
        <span class="close-results"><span class="left">&lt;</span> Back</span>
        <div id="textfilter">
          <span class="input">
            <input autocapitalize="none" placeholder="Search" id="index-input" type="text" accesskey="/" />
            <i class="clear material-icons"></i>
            <i id="search-icon" class="material-icons"></i>
          </span>
        </div>
    </div>
      <div id="search-results">
        <div id="search-progress">
          <div id="progress-fill"></div>
        </div>
        <div id="results-content">
          <div id="entity-results"></div>
          <div id="member-results"></div>
        </div>
      </div>
      <div id="content-scroll-container" style="-webkit-overflow-scrolling: touch;">
        <div id="content-container" style="-webkit-overflow-scrolling: touch;">
          <div id="subpackage-spacer">
            <div id="packages">
              <h1>Packages</h1>
              <ul>
                <li name="_root_.root" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="_root_"></a><a id="root:_root_"></a>
      <span class="permalink">
      <a href="../../../../../../index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../../../../../../index.html"><span class="name">root</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../../../../../../index.html" class="extype" name="_root_">root</a></dd></dl></div>
    </li><li name="_root_.org" visbl="pub" class="indented1 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="org"></a><a id="org:org"></a>
      <span class="permalink">
      <a href="../../../../../../org/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../../../../../index.html"><span class="name">org</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../../../../../../index.html" class="extype" name="_root_">root</a></dd></dl></div>
    </li><li name="org.locationtech" visbl="pub" class="indented2 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="locationtech"></a><a id="locationtech:locationtech"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../../../../index.html"><span class="name">locationtech</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../../../../../index.html" class="extype" name="org">org</a></dd></dl></div>
    </li><li name="org.locationtech.geomesa" visbl="pub" class="indented3 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="geomesa"></a><a id="geomesa:geomesa"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../../../index.html"><span class="name">geomesa</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../../../../index.html" class="extype" name="org.locationtech">locationtech</a></dd></dl></div>
    </li><li name="org.locationtech.geomesa.metrics" visbl="pub" class="indented4 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="metrics"></a><a id="metrics:metrics"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../../index.html"><span class="name">metrics</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../../../index.html" class="extype" name="org.locationtech.geomesa">geomesa</a></dd></dl></div>
    </li><li name="org.locationtech.geomesa.metrics.micrometer" visbl="pub" class="indented5 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="micrometer"></a><a id="micrometer:micrometer"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../index.html"><span class="name">micrometer</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../../index.html" class="extype" name="org.locationtech.geomesa.metrics">metrics</a></dd></dl></div>
    </li><li name="org.locationtech.geomesa.metrics.micrometer.cloudwatch" visbl="pub" class="indented6 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="cloudwatch"></a><a id="cloudwatch:cloudwatch"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/cloudwatch/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../cloudwatch/index.html"><span class="name">cloudwatch</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../index.html" class="extype" name="org.locationtech.geomesa.metrics.micrometer">micrometer</a></dd></dl></div>
    </li><li name="org.locationtech.geomesa.metrics.micrometer.dbcp2" visbl="pub" class="indented6 current" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="dbcp2"></a><a id="dbcp2:dbcp2"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/dbcp2/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <span class="name">dbcp2</span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../index.html" class="extype" name="org.locationtech.geomesa.metrics.micrometer">micrometer</a></dd></dl></div>
    </li><li class="current-entities indented6">
                        <a class="object" href="MetricsDataSource$.html" title=""></a>
                        <a class="class" href="MetricsDataSource.html" title="Extension of commons-dbcp data source that works with micrometer/prometheus metrics."></a>
                        <a href="MetricsDataSource.html" title="Extension of commons-dbcp data source that works with micrometer/prometheus metrics.">MetricsDataSource</a>
                      </li><li name="org.locationtech.geomesa.metrics.micrometer.prometheus" visbl="pub" class="indented6 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="prometheus"></a><a id="prometheus:prometheus"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/prometheus/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../prometheus/index.html"><span class="name">prometheus</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../index.html" class="extype" name="org.locationtech.geomesa.metrics.micrometer">micrometer</a></dd></dl></div>
    </li><li name="org.locationtech.geomesa.metrics.micrometer.utils" visbl="pub" class="indented6 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="utils"></a><a id="utils:utils"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/utils/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../utils/index.html"><span class="name">utils</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../index.html" class="extype" name="org.locationtech.geomesa.metrics.micrometer">micrometer</a></dd></dl></div>
    </li>
              </ul>
            </div>
          </div>
          <div id="content">
            <body class="package value">
      <div id="definition">
        <div class="big-circle package">p</div>
        <p id="owner"><a href="../../../../../index.html" class="extype" name="org">org</a>.<a href="../../../../index.html" class="extype" name="org.locationtech">locationtech</a>.<a href="../../../index.html" class="extype" name="org.locationtech.geomesa">geomesa</a>.<a href="../../index.html" class="extype" name="org.locationtech.geomesa.metrics">metrics</a>.<a href="../index.html" class="extype" name="org.locationtech.geomesa.metrics.micrometer">micrometer</a></p>
        <h1>dbcp2<span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/dbcp2/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span></h1>
        
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <span class="name">dbcp2</span>
      </span>
      </h4>

      
          <div id="comment" class="fullcommenttop"></div>
        

      <div id="mbrsel">
        <div class="toggle"></div>
        <div id="memberfilter">
          <i class="material-icons arrow"></i>
          <span class="input">
            <input id="mbrsel-input" placeholder="Filter all members" type="text" accesskey="/" />
          </span>
          <i class="clear material-icons"></i>
        </div>
        <div id="filterby">
          <div id="order">
            <span class="filtertype">Ordering</span>
            <ol>
              
              <li class="alpha in"><span>Alphabetic</span></li>
              
            </ol>
          </div>
          
          <div id="visbl">
              <span class="filtertype">Visibility</span>
              <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
            </div>
        </div>
      </div>

      <div id="template">
        <div id="allMembers">
        

        <div id="types" class="types members">
              <h3>Type Members</h3>
              <ol><li name="org.locationtech.geomesa.metrics.micrometer.dbcp2.MetricsDataSource" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="MetricsDataSourceextendsBasicDataSource"></a><a id="MetricsDataSource:MetricsDataSource"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/dbcp2/MetricsDataSource.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">class</span>
      </span>
      <span class="symbol">
        <a title="Extension of commons-dbcp data source that works with micrometer/prometheus metrics." href="MetricsDataSource.html"><span class="name">MetricsDataSource</span></a><span class="result"> extends <span class="extype" name="org.apache.commons.dbcp2.BasicDataSource">BasicDataSource</span></span>
      </span>
      
      <p class="shortcomment cmt">Extension of commons-dbcp data source that works with micrometer/prometheus metrics.</p><div class="fullcomment"><div class="comment cmt"><p>Extension of commons-dbcp data source that works with micrometer/prometheus metrics.
See https://github.com/micrometer-metrics/micrometer/issues/2593 for reference.</p><p>We skip the standard jmx exposure in BasicDataSource, because we only want to register the connection pool,
otherwise gauges don't register correctly due to jmx name overlap.</p><p>BasicDataSource registers jmx mbeans in at least 3 places:</p><ul><li>itself, using the <code>jmxName</code> set by the user</li><li>its GenericObjectPool, using <code>config.getJmxNameBase</code> + <code>config.getJmxNamePrefix</code></li><li>connections created with its PoolableConnectionFactory, using &quot;jmxName&quot; + &quot;,connectionpool=connections,connection=&quot; + <code>i</code></li></ul><p>Micrometer's CommonsObjectPool2Metrics tries to register anything with the jmx name prefix 'org.apache.commons.pool2:'. It uses
the <code>name</code> attribute in the jmx name for a tag, and it tries to read <code>getFactoryType</code> from the underlying object as a tag.
It exposes pool-related values from the jmx objects (e.g. NumIdle, etc) as metrics.</p><p>The only thing that makes sense to instrument with those values is the GenericObjectPool. Thus, we skip jmx registration for
this data source and the underlying connections. Indeed, since the metric name is based on the jmx name, and the metric
value is pulled from the object itself, registering the datasource or connections will break the metric since the object
doesn't have the expected pool methods.</p><p>Note: short-lived data sources may cause error logs like <code>ERROR CommonsObjectPool2Metrics: can not set name tag</code> due to
already being removed from the mbean server by the time the jmx listener fires.
</p></div></div>
    </li></ol>
            </div>

        

        <div class="values members">
              <h3>Value Members</h3>
              <ol>
                <li name="org.locationtech.geomesa.metrics.micrometer.dbcp2.MetricsDataSource" visbl="pub" class="indented0 " data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="MetricsDataSource"></a><a id="MetricsDataSource:MetricsDataSource"></a>
      <span class="permalink">
      <a href="../../../../../../org/locationtech/geomesa/metrics/micrometer/dbcp2/MetricsDataSource$.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">object</span>
      </span>
      <span class="symbol">
        <a title="" href="MetricsDataSource$.html"><span class="name">MetricsDataSource</span></a>
      </span>
      
      
    </li>
              </ol>
            </div>

        

        
        </div>

        <div id="inheritedMembers">
        
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>
    </body>
          </div>
        </div>
      </div>
    </body>
      </html>
