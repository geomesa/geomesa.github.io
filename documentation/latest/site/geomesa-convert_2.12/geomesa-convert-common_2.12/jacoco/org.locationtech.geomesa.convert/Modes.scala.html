<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Modes.scala</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GeoMesa Convert Common</a> &gt; <a href="index.source.html" class="el_package">org.locationtech.geomesa.convert</a> &gt; <span class="el_source">Modes.scala</span></div><h1>Modes.scala</h1><pre class="source lang-java linenums">/***********************************************************************
 * Copyright (c) 2013-2025 General Atomics Integrated Intelligence, Inc.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at
 * https://www.apache.org/licenses/LICENSE-2.0
 ***********************************************************************/

package org.locationtech.geomesa.convert

import org.locationtech.geomesa.utils.conf.GeoMesaSystemProperties.SystemProperty

<span class="nc" id="L13">trait Modes {</span>

  this: Enumeration =&gt;

  type Mode

  protected def defaultValue: Mode

  def systemProperty: SystemProperty

  def apply(): Mode = {
<span class="nc" id="L24">    val string = systemProperty.get</span>
<span class="nc" id="L25">    values.find(_.toString.equalsIgnoreCase(string)).map(_.asInstanceOf[Mode]).getOrElse(defaultValue)</span>
  }
}

<span class="nc" id="L29">object Modes {</span>

  type ErrorMode = ErrorMode.Value
  type ParseMode = ParseMode.Value
  type LineMode  = LineMode.Value

<span class="nc" id="L35">  object ErrorMode extends Enumeration with Modes {</span>

    type Mode = Modes.ErrorMode
<span class="nc" id="L38">    val RaiseErrors   : ErrorMode = Value(&quot;raise-errors&quot;)</span>
<span class="nc" id="L39">    val LogErrors     : ErrorMode = Value(&quot;log-errors&quot;)</span>
<span class="nc" id="L40">    val ReturnErrors  : ErrorMode = Value(&quot;return-errors&quot;)</span>
<span class="nc" id="L41">    def Default       : ErrorMode = apply()</span>

    def apply(mode: String): ErrorMode = {
<span class="nc" id="L44">      values.find(_.toString.equalsIgnoreCase(mode)) match {</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">        case Some(m) =&gt; m</span>
<span class="nc bnc" id="L46" title="All 2 branches missed.">        case None =&gt;</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">          if (&quot;skip-bad-records&quot;.equalsIgnoreCase(mode)) {</span>
<span class="nc" id="L48">            LogErrors</span>
          } else {
<span class="nc" id="L50">            throw new IllegalArgumentException(</span>
<span class="nc" id="L51">              s&quot;Invalid error mode '$mode'. Valid values are ${values.mkString(&quot;'&quot;, &quot;', '&quot;, &quot;'&quot;)}&quot;)</span>
          }
      }
    }

<span class="nc" id="L56">    override protected val defaultValue: ErrorMode = LogErrors</span>
<span class="nc" id="L57">    override val systemProperty: SystemProperty =</span>
<span class="nc" id="L58">      SystemProperty(&quot;geomesa.converter.error.mode.default&quot;, defaultValue.toString)</span>
  }

<span class="nc" id="L61">  object ParseMode extends Enumeration with Modes {</span>
    type Mode = Modes.ParseMode
<span class="nc" id="L63">    val Incremental: ParseMode = Value(&quot;incremental&quot;)</span>
<span class="nc" id="L64">    val Batch      : ParseMode = Value(&quot;batch&quot;)</span>
<span class="nc" id="L65">    def Default    : ParseMode = apply()</span>

<span class="nc" id="L67">    override protected val defaultValue: ParseMode = Incremental</span>
<span class="nc" id="L68">    override val systemProperty: SystemProperty =</span>
<span class="nc" id="L69">      SystemProperty(&quot;geomesa.converter.parse.mode.default&quot;, defaultValue.toString)</span>
  }

<span class="nc" id="L72">  object LineMode extends Enumeration with Modes {</span>
    type Mode = Modes.LineMode
<span class="nc" id="L74">    val Single : LineMode = Value(&quot;single&quot;)</span>
<span class="nc" id="L75">    val Multi  : LineMode = Value(&quot;multi&quot;)</span>
<span class="nc" id="L76">    def Default: LineMode = apply()</span>

<span class="nc" id="L78">    override protected val defaultValue: LineMode = Single</span>
<span class="nc" id="L79">    override val systemProperty: SystemProperty =</span>
<span class="nc" id="L80">      SystemProperty(&quot;geomesa.converter.line.mode.default&quot;, defaultValue.toString)</span>
  }
<span class="nc" id="L82">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>