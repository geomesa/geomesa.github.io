<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GeomesaPysparkFunctions.scala</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GeoMesa Spark SQL</a> &gt; <a href="index.source.html" class="el_package">org.locationtech.geomesa.spark.sql</a> &gt; <span class="el_source">GeomesaPysparkFunctions.scala</span></div><h1>GeomesaPysparkFunctions.scala</h1><pre class="source lang-java linenums">/***********************************************************************
 * Copyright (c) 2013-2025 General Atomics Integrated Intelligence, Inc.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at
 * https://www.apache.org/licenses/LICENSE-2.0
 ***********************************************************************/

package org.locationtech.geomesa.spark.sql

import org.apache.spark.sql.expressions.UserDefinedFunction
import org.apache.spark.sql.functions.udf
import org.locationtech.geomesa.spark.jts.udf.GeometricAccessorFunctions._
import org.locationtech.geomesa.spark.jts.udf.GeometricCastFunctions._
import org.locationtech.geomesa.spark.jts.udf.GeometricConstructorFunctions._
import org.locationtech.geomesa.spark.jts.udf.GeometricOutputFunctions._
import org.locationtech.geomesa.spark.jts.udf.GeometricProcessingFunctions.{ST_BufferPoint, ST_MakeValid, ST_antimeridianSafeGeom}
import org.locationtech.geomesa.spark.jts.udf.SpatialRelationFunctions._
import org.locationtech.geomesa.spark.sql.GeometricDistanceFunctions._

/**
 * Re-wrapping the UDFs so we can access them from PySpark without using the SQL API.
 */
<span class="nc" id="L24">object GeomesaPysparkFunctions {</span>

  /* Geometric Accessor Functions */
<span class="nc" id="L27">  def st_boundary: UserDefinedFunction = udf(ST_Boundary)</span>
<span class="nc" id="L28">  def st_coordDim: UserDefinedFunction = udf(ST_CoordDim)</span>
<span class="nc" id="L29">  def st_dimension: UserDefinedFunction = udf(ST_Dimension)</span>
<span class="nc" id="L30">  def st_envelope: UserDefinedFunction = udf(ST_Envelope)</span>
<span class="nc" id="L31">  def st_exteriorRing: UserDefinedFunction = udf(ST_ExteriorRing)</span>
<span class="nc" id="L32">  def st_geometryN: UserDefinedFunction = udf(ST_GeometryN)</span>
<span class="nc" id="L33">  def st_interiorRingN: UserDefinedFunction = udf(ST_InteriorRingN)</span>
<span class="nc" id="L34">  def st_isClosed: UserDefinedFunction = udf(ST_IsClosed)</span>
<span class="nc" id="L35">  def st_isCollection: UserDefinedFunction = udf(ST_IsCollection)</span>
<span class="nc" id="L36">  def st_isEmpty: UserDefinedFunction = udf(ST_IsEmpty)</span>
<span class="nc" id="L37">  def st_isRing: UserDefinedFunction = udf(ST_IsRing)</span>
<span class="nc" id="L38">  def st_isSimple: UserDefinedFunction = udf(ST_IsSimple)</span>
<span class="nc" id="L39">  def st_isValid: UserDefinedFunction = udf(ST_IsValid)</span>
<span class="nc" id="L40">  def st_numGeometries: UserDefinedFunction = udf(ST_NumGeometries)</span>
<span class="nc" id="L41">  def st_numPoints: UserDefinedFunction = udf(ST_NumPoints)</span>
<span class="nc" id="L42">  def st_pointN: UserDefinedFunction = udf(ST_PointN)</span>
<span class="nc" id="L43">  def st_x: UserDefinedFunction = udf(ST_X)</span>
<span class="nc" id="L44">  def st_y: UserDefinedFunction = udf(ST_Y)</span>

  /* Geometric Cast Functions */
<span class="nc" id="L47">  def st_castToPoint: UserDefinedFunction = udf(ST_CastToPoint)</span>
<span class="nc" id="L48">  def st_castToPolygon: UserDefinedFunction = udf(ST_CastToPolygon)</span>
<span class="nc" id="L49">  def st_castToLineString: UserDefinedFunction = udf(ST_CastToLineString)</span>
<span class="nc" id="L50">  def st_castToGeometry: UserDefinedFunction = udf(ST_CastToGeometry)</span>
<span class="nc" id="L51">  def st_byteArray: UserDefinedFunction = udf(ST_ByteArray)</span>

  /* Geometric Constructor Functions */
<span class="nc" id="L54">  def st_geomFromGeoHash: UserDefinedFunction = udf(ST_GeomFromGeoHash)</span>
<span class="nc" id="L55">  def st_box2DFromGeoHash: UserDefinedFunction = udf(ST_GeomFromGeoHash)</span>
<span class="nc" id="L56">  def st_geomFromGeoJSON: UserDefinedFunction = udf(ST_GeomFromGeoJSON)</span>
<span class="nc" id="L57">  def st_geomFromText: UserDefinedFunction = udf(ST_GeomFromWKT)</span>
<span class="nc" id="L58">  def st_geometryFromText: UserDefinedFunction = udf(ST_GeomFromWKT)</span>
<span class="nc" id="L59">  def st_geomFromWKT: UserDefinedFunction = udf(ST_GeomFromWKT)</span>
<span class="nc" id="L60">  def st_geomFromWKB: UserDefinedFunction = udf(ST_GeomFromWKB)</span>
<span class="nc" id="L61">  def st_lineFromText: UserDefinedFunction = udf(ST_LineFromText)</span>
<span class="nc" id="L62">  def st_makeBox2D: UserDefinedFunction = udf(ST_MakeBox2D)</span>
<span class="nc" id="L63">  def st_makeBBOX: UserDefinedFunction = udf(ST_MakeBBOX)</span>
<span class="nc" id="L64">  def st_makePolygon: UserDefinedFunction = udf(ST_MakePolygon)</span>
<span class="nc" id="L65">  def st_makePoint: UserDefinedFunction = udf(ST_MakePoint)</span>
<span class="nc" id="L66">  def st_makeLine: UserDefinedFunction = udf(ST_MakeLine)</span>
<span class="nc" id="L67">  def st_makePointM: UserDefinedFunction = udf(ST_MakePointM)</span>
<span class="nc" id="L68">  def st_mLineFromText: UserDefinedFunction = udf(ST_MLineFromText)</span>
<span class="nc" id="L69">  def st_mPointFromText: UserDefinedFunction = udf(ST_MPointFromText)</span>
<span class="nc" id="L70">  def st_mPolyFromText: UserDefinedFunction = udf(ST_MPolyFromText)</span>
<span class="nc" id="L71">  def st_point: UserDefinedFunction = udf(ST_Point)</span>
<span class="nc" id="L72">  def st_pointFromGeoHash: UserDefinedFunction = udf(ST_PointFromGeoHash)</span>
<span class="nc" id="L73">  def st_pointFromText: UserDefinedFunction = udf(ST_PointFromText)</span>
<span class="nc" id="L74">  def st_pointFromWKB: UserDefinedFunction = udf(ST_PointFromWKB)</span>
<span class="nc" id="L75">  def st_polygon: UserDefinedFunction = udf(ST_Polygon)</span>
<span class="nc" id="L76">  def st_polygonFromText: UserDefinedFunction = udf(ST_PolygonFromText)</span>

  /* Geometric Output Functions */
<span class="nc" id="L79">  def st_asBinary: UserDefinedFunction = udf(ST_AsBinary)</span>
<span class="nc" id="L80">  def st_asGeoJSON: UserDefinedFunction = udf(ST_AsGeoJSON)</span>
<span class="nc" id="L81">  def st_asLatLonText: UserDefinedFunction = udf(ST_AsLatLonText)</span>
<span class="nc" id="L82">  def st_asText: UserDefinedFunction = udf(ST_AsText)</span>
<span class="nc" id="L83">  def st_geoHash: UserDefinedFunction = udf(ST_GeoHash)</span>

  /* Geometric Processing Functions */
<span class="nc" id="L86">  def st_antimeridianSafeGeom: UserDefinedFunction = udf(ST_antimeridianSafeGeom)</span>
<span class="nc" id="L87">  def st_bufferPoint: UserDefinedFunction = udf(ST_BufferPoint)</span>
<span class="nc" id="L88">  def st_idlSafeGeom: UserDefinedFunction = udf(ST_antimeridianSafeGeom)</span>
<span class="nc" id="L89">  def st_makeValid: UserDefinedFunction = udf(ST_MakeValid)</span>

  /* Spatial Relation Functions */
<span class="nc" id="L92">  def st_translate: UserDefinedFunction = udf(ST_Translate)</span>
<span class="nc" id="L93">  def st_contains: UserDefinedFunction = udf(ST_Contains)</span>
<span class="nc" id="L94">  def st_covers: UserDefinedFunction = udf(ST_Covers)</span>
<span class="nc" id="L95">  def st_crosses: UserDefinedFunction = udf(ST_Crosses)</span>
<span class="nc" id="L96">  def st_disjoint: UserDefinedFunction = udf(ST_Disjoint)</span>
<span class="nc" id="L97">  def st_equals: UserDefinedFunction = udf(ST_Equals)</span>
<span class="nc" id="L98">  def st_intersects: UserDefinedFunction = udf(ST_Intersects)</span>
<span class="nc" id="L99">  def st_overlaps: UserDefinedFunction = udf(ST_Overlaps)</span>
<span class="nc" id="L100">  def st_touches: UserDefinedFunction = udf(ST_Touches)</span>
<span class="nc" id="L101">  def st_within: UserDefinedFunction = udf(ST_Within)</span>
<span class="nc" id="L102">  def st_relate: UserDefinedFunction = udf(ST_Relate)</span>
<span class="nc" id="L103">  def st_relateBool: UserDefinedFunction = udf(ST_RelateBool)</span>
<span class="nc" id="L104">  def st_area: UserDefinedFunction = udf(ST_Area)</span>
<span class="nc" id="L105">  def st_centroid: UserDefinedFunction = udf(ST_Centroid)</span>
<span class="nc" id="L106">  def st_closestPoint: UserDefinedFunction = udf(ST_ClosestPoint)</span>
<span class="nc" id="L107">  def st_distance: UserDefinedFunction = udf(ST_Distance)</span>
<span class="nc" id="L108">  def st_distanceSphere: UserDefinedFunction = udf(ST_DistanceSphere)</span>
<span class="nc" id="L109">  def st_distanceSpheroid: UserDefinedFunction = udf(ST_DistanceSpheroid)</span>
<span class="nc" id="L110">  def st_length: UserDefinedFunction = udf(ST_Length)</span>
<span class="nc" id="L111">  def st_lengthSphere: UserDefinedFunction = udf(ST_LengthSphere)</span>
<span class="nc" id="L112">  def st_lengthSpheroid: UserDefinedFunction = udf(ST_LengthSpheroid)</span>
<span class="nc" id="L113">  def st_intersection: UserDefinedFunction = udf(ST_Intersection)</span>
<span class="nc" id="L114">  def st_difference: UserDefinedFunction = udf(ST_Difference)</span>
<span class="nc" id="L115">  def st_transform: UserDefinedFunction = udf(ST_Transform)</span>
<span class="nc" id="L116">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>