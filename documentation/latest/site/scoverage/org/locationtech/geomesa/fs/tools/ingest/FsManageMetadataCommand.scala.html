<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title id="title">
          org/locationtech/geomesa/fs/tools/ingest/FsManageMetadataCommand.scala.html
        </title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/css/theme.default.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/js/jquery.tablesorter.min.js"></script><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" type="text/css"/><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script><script type="text/javascript">
        $(document).ready(function() {$(".tablesorter").tablesorter();});
      </script>
        <style>
          table.codegrid { font-family: monospace; font-size: 12px; width: auto!important; }table.statementlist { width: auto!important; font-size: 13px; } table.codegrid td { padding: 0!important; border: 0!important } table td.linenumber { width: 40px!important; } 
        </style>
      </head>
      <body style="font-family: monospace;">
        <ul class="nav nav-tabs">
          <li>
            <a href="#codegrid" data-toggle="tab">Codegrid</a>
          </li>
          <li>
            <a href="#statementlist" data-toggle="tab">Statement List</a>
          </li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="codegrid">
            <pre style='font-size: 12pt; font-family: courier, monospace;'>1 <span style=''>/***********************************************************************
</span>2 <span style=''> * Copyright (c) 2013-2024 Commonwealth Computer Research, Inc.
</span>3 <span style=''> * All rights reserved. This program and the accompanying materials
</span>4 <span style=''> * are made available under the terms of the Apache License, Version 2.0
</span>5 <span style=''> * which accompanies this distribution and is available at
</span>6 <span style=''> * http://www.opensource.org/licenses/apache2.0.php.
</span>7 <span style=''> ***********************************************************************/
</span>8 <span style=''>
</span>9 <span style=''>package org.locationtech.geomesa.fs.tools.ingest
</span>10 <span style=''>
</span>11 <span style=''>import com.beust.jcommander.converters.BaseConverter
</span>12 <span style=''>import com.beust.jcommander.validators.PositiveInteger
</span>13 <span style=''>import com.beust.jcommander.{Parameter, ParameterException, Parameters}
</span>14 <span style=''>import com.typesafe.scalalogging.LazyLogging
</span>15 <span style=''>import org.apache.hadoop.fs.{FileStatus, RemoteIterator}
</span>16 <span style=''>import org.locationtech.geomesa.fs.storage.api.FileSystemStorage
</span>17 <span style=''>import org.locationtech.geomesa.fs.storage.api.StorageMetadata.{PartitionBounds, PartitionMetadata, StorageFile}
</span>18 <span style=''>import org.locationtech.geomesa.fs.storage.common.metadata.{FileBasedMetadataFactory, MetadataJson}
</span>19 <span style=''>import org.locationtech.geomesa.fs.storage.common.utils.StorageUtils
</span>20 <span style=''>import org.locationtech.geomesa.fs.tools.FsDataStoreCommand
</span>21 <span style=''>import org.locationtech.geomesa.fs.tools.FsDataStoreCommand.{FsParams, PartitionParam}
</span>22 <span style=''>import org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker
</span>23 <span style=''>import org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand._
</span>24 <span style=''>import org.locationtech.geomesa.tools.utils.Prompt
</span>25 <span style=''>import org.locationtech.geomesa.tools.{Command, CommandWithSubCommands, OptionalForceParam, RequiredTypeNameParam}
</span>26 <span style=''>import org.locationtech.geomesa.utils.concurrent.{CachedThreadPool, PhaserUtils}
</span>27 <span style=''>import org.locationtech.geomesa.utils.io.WithClose
</span>28 <span style=''>import org.locationtech.jts.geom.Envelope
</span>29 <span style=''>
</span>30 <span style=''>import java.io.{Closeable, FileNotFoundException}
</span>31 <span style=''>import java.util
</span>32 <span style=''>import java.util.concurrent.{ConcurrentHashMap, Phaser}
</span>33 <span style=''>import scala.collection.mutable.ArrayBuffer
</span>34 <span style=''>import scala.util.control.NonFatal
</span>35 <span style=''>
</span>36 <span style=''>class FsManageMetadataCommand extends CommandWithSubCommands {
</span>37 <span style=''>  override val name: String = </span><span style='background: #AEF1AE'>&quot;manage-metadata&quot;</span><span style=''>
</span>38 <span style=''>  override val params = </span><span style='background: #AEF1AE'>new ManageMetadataParams</span><span style=''>
</span>39 <span style=''>  override val subCommands: Seq[Command] =
</span>40 <span style=''>    </span><span style='background: #AEF1AE'>Seq(new CompactCommand(), new RegisterCommand(), new UnregisterCommand(), new CheckConsistencyCommand())</span><span style=''>
</span>41 <span style=''>}
</span>42 <span style=''>
</span>43 <span style=''>object FsManageMetadataCommand {
</span>44 <span style=''>
</span>45 <span style=''>  import scala.collection.JavaConverters._
</span>46 <span style=''>
</span>47 <span style=''>  class CompactCommand extends FsDataStoreCommand {
</span>48 <span style=''>
</span>49 <span style=''>    override val name = </span><span style='background: #AEF1AE'>&quot;compact&quot;</span><span style=''>
</span>50 <span style=''>    override val params = </span><span style='background: #AEF1AE'>new CompactParams</span><span style=''>
</span>51 <span style=''>
</span>52 <span style=''>    override def execute(): Unit = </span><span style='background: #F0ADAD'>withDataStore { ds =&gt;
</span>53 <span style=''></span><span style='background: #F0ADAD'>      Command.user.info(&quot;Compacting metadata, please wait...&quot;)
</span>54 <span style=''></span><span style='background: #F0ADAD'>      val metadata = ds.storage(params.featureName).metadata
</span>55 <span style=''></span><span style='background: #F0ADAD'>      metadata.compact(None, None, params.threads)
</span>56 <span style=''></span><span style='background: #F0ADAD'>      val partitions = metadata.getPartitions()
</span>57 <span style=''></span><span style='background: #F0ADAD'>      Command.user.info(s&quot;Compacted metadata into ${partitions.length} partitions consisting of &quot; +
</span>58 <span style=''></span><span style='background: #F0ADAD'>          s&quot;${partitions.map(_.files.size).sum} files&quot;)
</span>59 <span style=''></span><span style='background: #F0ADAD'>    }</span><span style=''>
</span>60 <span style=''>  }
</span>61 <span style=''>
</span>62 <span style=''>  class RegisterCommand extends FsDataStoreCommand {
</span>63 <span style=''>
</span>64 <span style=''>    override val name = </span><span style='background: #AEF1AE'>&quot;register&quot;</span><span style=''>
</span>65 <span style=''>    override val params = </span><span style='background: #AEF1AE'>new RegisterParams</span><span style=''>
</span>66 <span style=''>
</span>67 <span style=''>    override def execute(): Unit = </span><span style='background: #F0ADAD'>withDataStore { ds =&gt;
</span>68 <span style=''></span><span style='background: #F0ADAD'>      val metadata = ds.storage(params.featureName).metadata
</span>69 <span style=''></span><span style='background: #F0ADAD'>      val files = params.files.asScala.map(StorageFile(_, System.currentTimeMillis()))
</span>70 <span style=''></span><span style='background: #F0ADAD'>      val count = Option(params.count).map(_.longValue()).getOrElse(0L)
</span>71 <span style=''></span><span style='background: #F0ADAD'>      val bounds = new Envelope
</span>72 <span style=''></span><span style='background: #F0ADAD'>      Option(params.bounds).foreach { case (xmin, ymin, xmax, ymax) =&gt;
</span>73 <span style=''></span><span style='background: #F0ADAD'>        bounds.expandToInclude(xmin, ymin)
</span>74 <span style=''></span><span style='background: #F0ADAD'>        bounds.expandToInclude(xmax, ymax)
</span>75 <span style=''></span><span style='background: #F0ADAD'>      }
</span>76 <span style=''></span><span style='background: #F0ADAD'>      metadata.addPartition(PartitionMetadata(params.partition, files.toSeq, PartitionBounds(bounds), count))
</span>77 <span style=''></span><span style='background: #F0ADAD'>      val partition = metadata.getPartition(params.partition).getOrElse(PartitionMetadata(&quot;&quot;, Seq.empty, None, 0L))
</span>78 <span style=''></span><span style='background: #F0ADAD'>      Command.user.info(s&quot;Registered ${params.files.size} new files. Updated partition: ${partition.files.size} &quot; +
</span>79 <span style=''></span><span style='background: #F0ADAD'>          s&quot;files containing ${partition.count} known features&quot;)
</span>80 <span style=''></span><span style='background: #F0ADAD'>    }</span><span style=''>
</span>81 <span style=''>  }
</span>82 <span style=''>
</span>83 <span style=''>  class UnregisterCommand extends FsDataStoreCommand {
</span>84 <span style=''>
</span>85 <span style=''>    override val name = </span><span style='background: #AEF1AE'>&quot;unregister&quot;</span><span style=''>
</span>86 <span style=''>    override val params = </span><span style='background: #AEF1AE'>new UnregisterParams</span><span style=''>
</span>87 <span style=''>
</span>88 <span style=''>    override def execute(): Unit = </span><span style='background: #F0ADAD'>withDataStore { ds =&gt;
</span>89 <span style=''></span><span style='background: #F0ADAD'>      val metadata = ds.storage(params.featureName).metadata
</span>90 <span style=''></span><span style='background: #F0ADAD'>      val files = params.files.asScala.map(StorageFile(_, 0L))
</span>91 <span style=''></span><span style='background: #F0ADAD'>      val count = Option(params.count).map(_.longValue()).getOrElse(0L)
</span>92 <span style=''></span><span style='background: #F0ADAD'>      metadata.removePartition(PartitionMetadata(params.partition, files.toSeq, None, count))
</span>93 <span style=''></span><span style='background: #F0ADAD'>      val partition = metadata.getPartition(params.partition).getOrElse(PartitionMetadata(&quot;&quot;, Seq.empty, None, 0L))
</span>94 <span style=''></span><span style='background: #F0ADAD'>      Command.user.info(s&quot;Unregistered ${params.files.size} files. Updated partition: ${partition.files.size} &quot; +
</span>95 <span style=''></span><span style='background: #F0ADAD'>          s&quot;files containing ${partition.count} known features&quot;)
</span>96 <span style=''></span><span style='background: #F0ADAD'>    }</span><span style=''>
</span>97 <span style=''>  }
</span>98 <span style=''>
</span>99 <span style=''>  class CheckConsistencyCommand extends FsDataStoreCommand with LazyLogging {
</span>100 <span style=''>
</span>101 <span style=''>    override val name = </span><span style='background: #AEF1AE'>&quot;check-consistency&quot;</span><span style=''>
</span>102 <span style=''>    override val params = </span><span style='background: #AEF1AE'>new CheckConsistencyParams()</span><span style=''>
</span>103 <span style=''>
</span>104 <span style=''>    override def validate(): Option[ParameterException] = {
</span>105 <span style=''>      if (</span><span style='background: #F0ADAD'>params.repair &amp;&amp; params.rebuild</span><span style=''>) {
</span>106 <span style=''>        </span><span style='background: #F0ADAD'>Some(new ParameterException(&quot;Please specify at most one of --repair and --rebuild&quot;))</span><span style=''>
</span>107 <span style=''>      } else {
</span>108 <span style=''>        </span><span style='background: #F0ADAD'>None</span><span style=''>
</span>109 <span style=''>      }
</span>110 <span style=''>    }
</span>111 <span style=''>
</span>112 <span style=''>    override def execute(): Unit = {
</span>113 <span style=''>      if (</span><span style='background: #AEF1AE'>params.rebuild &amp;&amp; !params.partitions.isEmpty</span><span style=''>) </span><span style='background: #F0ADAD'>{
</span>114 <span style=''></span><span style='background: #F0ADAD'>        Command.user.warn(
</span>115 <span style=''></span><span style='background: #F0ADAD'>          s&quot;Rebuilding all metadata using only ${params.partitions.size} partitions - &quot; +
</span>116 <span style=''></span><span style='background: #F0ADAD'>              &quot;metadata will not exist for any other partitions&quot;)
</span>117 <span style=''></span><span style='background: #F0ADAD'>        if (!params.force &amp;&amp; !Prompt.confirm(&quot;Continue (y/n)? &quot;)) {
</span>118 <span style=''></span><span style='background: #F0ADAD'>          Command.user.info(&quot;Cancelling operation&quot;)
</span>119 <span style=''></span><span style='background: #F0ADAD'>          return
</span>120 <span style=''></span><span style='background: #F0ADAD'>        }
</span>121 <span style=''></span><span style='background: #F0ADAD'>      }</span><span style=''>
</span>122 <span style=''>
</span>123 <span style=''>      </span><span style='background: #AEF1AE'>withDataStore { ds =&gt;
</span>124 <span style=''></span><span style='background: #AEF1AE'>        Command.user.info(&quot;Checking consistency, please wait...&quot;)
</span>125 <span style=''></span><span style='background: #AEF1AE'>        val storage = ds.storage(params.featureName)
</span>126 <span style=''></span><span style='background: #AEF1AE'>        val partitions = Option(params.partitions).collect { case p if !p.isEmpty =&gt; </span><span style='background: #F0ADAD'>p.asScala.toSeq</span><span style='background: #AEF1AE'> }
</span>127 <span style=''></span><span style='background: #AEF1AE'>        WithClose(new ConsistencyChecker(storage, partitions, params.rebuild, params.repair, params.threads))(_.run())
</span>128 <span style=''></span><span style='background: #AEF1AE'>      }</span><span style=''>
</span>129 <span style=''>    }
</span>130 <span style=''>  }
</span>131 <span style=''>
</span>132 <span style=''>  object CheckConsistencyCommand {
</span>133 <span style=''>
</span>134 <span style=''>    class ConsistencyChecker(
</span>135 <span style=''>        storage: FileSystemStorage,
</span>136 <span style=''>        partitions: Option[Seq[String]],
</span>137 <span style=''>        rebuild: Boolean,
</span>138 <span style=''>        repair: Boolean,
</span>139 <span style=''>        threads: Int
</span>140 <span style=''>      ) extends Runnable with Closeable with LazyLogging {
</span>141 <span style=''>
</span>142 <span style=''>      private val pool = </span><span style='background: #AEF1AE'>new CachedThreadPool(threads)</span><span style=''>
</span>143 <span style=''>      private val onDisk = </span><span style='background: #AEF1AE'>new ConcurrentHashMap[String, ConcurrentHashMap[String, Boolean]]()</span><span style=''>
</span>144 <span style=''>
</span>145 <span style=''>      private val computeFunction = </span><span style='background: #AEF1AE'>new</span><span style=''> java.util.function.Function[String, ConcurrentHashMap[String, Boolean]] {
</span>146 <span style=''>        override def apply(t: String): ConcurrentHashMap[String, Boolean] = </span><span style='background: #AEF1AE'>new ConcurrentHashMap[String, Boolean]()</span><span style=''>
</span>147 <span style=''>      }
</span>148 <span style=''>
</span>149 <span style=''>      override def run(): Unit = {
</span>150 <span style=''>        </span><span style='background: #AEF1AE'>storage.metadata.invalidate()</span><span style=''> // invalidate any cached state
</span>151 <span style=''>
</span>152 <span style=''>        // list out the files currently in the root directory, results go into onDisk
</span>153 <span style=''>        </span><span style='background: #AEF1AE'>listRoot()</span><span style=''>
</span>154 <span style=''>
</span>155 <span style=''>        if (</span><span style='background: #AEF1AE'>rebuild</span><span style=''>) </span><span style='background: #AEF1AE'>{
</span>156 <span style=''></span><span style='background: #AEF1AE'>          val (count, partitions) = buildPartitionConfigs()
</span>157 <span style=''></span><span style='background: #AEF1AE'>          Command.user.info(s&quot;Setting metadata to ${partitions.length} partitions containing $count data files...&quot;)
</span>158 <span style=''></span><span style='background: #AEF1AE'>          storage.metadata.setPartitions(partitions)
</span>159 <span style=''></span><span style='background: #AEF1AE'>          Command.user.info(&quot;Done&quot;)
</span>160 <span style=''></span><span style='background: #AEF1AE'>        }</span><span style=''> else </span><span style='background: #AEF1AE'>{
</span>161 <span style=''></span><span style='background: #AEF1AE'>          val inconsistencies = scala.collection.mutable.Map.empty[String, ArrayBuffer[Inconsistency]]
</span>162 <span style=''></span><span style='background: #AEF1AE'>          var inconsistentCount = 0
</span>163 <span style=''></span><span style='background: #AEF1AE'>
</span>164 <span style=''></span><span style='background: #AEF1AE'>          // compare the files known to the metadata to the ones on disk
</span>165 <span style=''></span><span style='background: #AEF1AE'>          storage.metadata.getPartitions().foreach { partition =&gt;
</span>166 <span style=''></span><span style='background: #AEF1AE'>            if (partitions.forall(</span><span style='background: #F0ADAD'>_.contains(partition.name)</span><span style='background: #AEF1AE'>)) {
</span>167 <span style=''></span><span style='background: #AEF1AE'>              val checked = scala.collection.mutable.Set.empty[String]
</span>168 <span style=''></span><span style='background: #AEF1AE'>              val partitionOnDisk = onDisk.getOrDefault(partition.name, new ConcurrentHashMap[String, Boolean]())
</span>169 <span style=''></span><span style='background: #AEF1AE'>              partition.files.foreach { file =&gt;
</span>170 <span style=''></span><span style='background: #AEF1AE'>                if (partitionOnDisk.remove(file.name)) {
</span>171 <span style=''></span><span style='background: #AEF1AE'>                  // metadata and file are consistent
</span>172 <span style=''></span><span style='background: #AEF1AE'>                  checked.add(file.name)
</span>173 <span style=''></span><span style='background: #AEF1AE'>                  // TODO if (params.analyze) {} // update metadata
</span>174 <span style=''></span><span style='background: #AEF1AE'>                } else {
</span>175 <span style=''></span><span style='background: #AEF1AE'>                  val buf = inconsistencies.getOrElseUpdate(partition.name, ArrayBuffer.empty)
</span>176 <span style=''></span><span style='background: #AEF1AE'>                  // file is missing from metadata vs file in in metadata more than once
</span>177 <span style=''></span><span style='background: #AEF1AE'>                  val duplicate = !checked.add(file.name)
</span>178 <span style=''></span><span style='background: #AEF1AE'>                  buf += Inconsistency(file, duplicate)
</span>179 <span style=''></span><span style='background: #AEF1AE'>                  inconsistentCount += 1
</span>180 <span style=''></span><span style='background: #AEF1AE'>                }
</span>181 <span style=''></span><span style='background: #AEF1AE'>              }
</span>182 <span style=''></span><span style='background: #AEF1AE'>              if (partitionOnDisk.isEmpty) {
</span>183 <span style=''></span><span style='background: #AEF1AE'>                onDisk.remove(partition.name)
</span>184 <span style=''></span><span style='background: #AEF1AE'>              }
</span>185 <span style=''></span><span style='background: #AEF1AE'>            }
</span>186 <span style=''></span><span style='background: #AEF1AE'>          }
</span>187 <span style=''></span><span style='background: #AEF1AE'>
</span>188 <span style=''></span><span style='background: #AEF1AE'>          if (onDisk.isEmpty &amp;&amp; </span><span style='background: #F0ADAD'>inconsistencies.isEmpty</span><span style='background: #AEF1AE'>) {
</span>189 <span style=''></span><span style='background: #AEF1AE'>            </span><span style='background: #F0ADAD'>Command.user.info(&quot;No inconsistencies detected&quot;)</span><span style='background: #AEF1AE'>
</span>190 <span style=''></span><span style='background: #AEF1AE'>          } else if (repair) {
</span>191 <span style=''></span><span style='background: #AEF1AE'>            if (inconsistencies.nonEmpty) {
</span>192 <span style=''></span><span style='background: #AEF1AE'>              Command.user.info(s&quot;Removing $inconsistentCount inconsistent metadata references...&quot;)
</span>193 <span style=''></span><span style='background: #AEF1AE'>              inconsistencies.foreach { case (partition, files) =&gt;
</span>194 <span style=''></span><span style='background: #AEF1AE'>                storage.metadata.removePartition(PartitionMetadata(partition, files.map(_.file).toSeq, None, 0L))
</span>195 <span style=''></span><span style='background: #AEF1AE'>              }
</span>196 <span style=''></span><span style='background: #AEF1AE'>              Command.user.info(&quot;Done&quot;)
</span>197 <span style=''></span><span style='background: #AEF1AE'>            }
</span>198 <span style=''></span><span style='background: #AEF1AE'>            if (!onDisk.isEmpty) {
</span>199 <span style=''></span><span style='background: #AEF1AE'>              val (count, partitions) = buildPartitionConfigs()
</span>200 <span style=''></span><span style='background: #AEF1AE'>              Command.user.info(s&quot;Registering $count missing metadata references...&quot;)
</span>201 <span style=''></span><span style='background: #AEF1AE'>              partitions.foreach(storage.metadata.addPartition)
</span>202 <span style=''></span><span style='background: #AEF1AE'>              Command.user.info(&quot;Done&quot;)
</span>203 <span style=''></span><span style='background: #AEF1AE'>            }
</span>204 <span style=''></span><span style='background: #AEF1AE'>            // TODO if (params.analyze) {} // update metadata
</span>205 <span style=''></span><span style='background: #AEF1AE'>          } else </span><span style='background: #F0ADAD'>{
</span>206 <span style=''></span><span style='background: #F0ADAD'>            if (!onDisk.isEmpty) {
</span>207 <span style=''></span><span style='background: #F0ADAD'>              lazy val strings = onDisk.asScala.toSeq.flatMap { case (partition, files) =&gt;
</span>208 <span style=''></span><span style='background: #F0ADAD'>                files.asScala.map { case (f, _) =&gt; s&quot;$partition,$f&quot; }
</span>209 <span style=''></span><span style='background: #F0ADAD'>              }
</span>210 <span style=''></span><span style='background: #F0ADAD'>              Command.user.warn(s&quot;Found ${strings.length} data files that do not have metadata entries:&quot;)
</span>211 <span style=''></span><span style='background: #F0ADAD'>              Command.output.info(strings.sorted.mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
</span>212 <span style=''></span><span style='background: #F0ADAD'>            }
</span>213 <span style=''></span><span style='background: #F0ADAD'>            if (inconsistencies.nonEmpty) {
</span>214 <span style=''></span><span style='background: #F0ADAD'>              lazy val strings = inconsistencies.toSeq.flatMap { case (p, buf) =&gt;
</span>215 <span style=''></span><span style='background: #F0ADAD'>                buf.map { case Inconsistency(f, d) =&gt; s&quot;$p,${if (d) { &quot;duplicate&quot; } else { &quot;missing&quot; }},${f.name}&quot; }
</span>216 <span style=''></span><span style='background: #F0ADAD'>              }
</span>217 <span style=''></span><span style='background: #F0ADAD'>              Command.user.warn(s&quot;Found $inconsistentCount metadata entries that do not correspond to a data file:&quot;)
</span>218 <span style=''></span><span style='background: #F0ADAD'>              Command.output.info(strings.sorted.mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
</span>219 <span style=''></span><span style='background: #F0ADAD'>            }
</span>220 <span style=''></span><span style='background: #F0ADAD'>          }</span><span style='background: #AEF1AE'>
</span>221 <span style=''></span><span style='background: #AEF1AE'>        }</span><span style=''>
</span>222 <span style=''>      }
</span>223 <span style=''>
</span>224 <span style=''>      override def close(): Unit = </span><span style='background: #AEF1AE'>pool.shutdown()</span><span style=''>
</span>225 <span style=''>
</span>226 <span style=''>      /**
</span>227 <span style=''>       * List the files in the root directory. Excludes known file-based metadata files. Results are
</span>228 <span style=''>       * added to onDisk
</span>229 <span style=''>       */
</span>230 <span style=''>      private def listRoot(): Unit = {
</span>231 <span style=''>        val iter = </span><span style='background: #AEF1AE'>storage.context.fc.listStatus(storage.context.root)</span><span style=''>
</span>232 <span style=''>        // use a phaser to track worker thread completion
</span>233 <span style=''>        val phaser = </span><span style='background: #AEF1AE'>new Phaser(2)</span><span style=''> // 1 for this thread + 1 for the worker
</span>234 <span style=''>        </span><span style='background: #AEF1AE'>pool.submit(new TopLevelListWorker(phaser, iter))</span><span style=''>
</span>235 <span style=''>        // wait for the worker threads to complete
</span>236 <span style=''>        </span><span style='background: #AEF1AE'>phaser.awaitAdvanceInterruptibly(phaser.arrive())</span><span style=''>
</span>237 <span style=''>      }
</span>238 <span style=''>
</span>239 <span style=''>      private def buildPartitionConfigs(): (Int, Seq[PartitionMetadata]) = {
</span>240 <span style=''>        var count = </span><span style='background: #AEF1AE'>0</span><span style=''>
</span>241 <span style=''>        val partitions = </span><span style='background: #AEF1AE'>Seq.newBuilder[PartitionMetadata]</span><span style=''>
</span>242 <span style=''>        </span><span style='background: #AEF1AE'>onDisk.asScala.foreach { case (partition, files) =&gt;
</span>243 <span style=''></span><span style='background: #AEF1AE'>          val update = Seq.newBuilder[StorageFile]
</span>244 <span style=''></span><span style='background: #AEF1AE'>          files.asScala.foreach { case (name, _) =&gt;
</span>245 <span style=''></span><span style='background: #AEF1AE'>            update += StorageFile(name, System.currentTimeMillis())
</span>246 <span style=''></span><span style='background: #AEF1AE'>            count += 1
</span>247 <span style=''></span><span style='background: #AEF1AE'>          }
</span>248 <span style=''></span><span style='background: #AEF1AE'>          partitions += PartitionMetadata(partition, update.result, None, 0L)
</span>249 <span style=''></span><span style='background: #AEF1AE'>        }</span><span style=''>
</span>250 <span style=''>        </span><span style='background: #AEF1AE'>(count, partitions.result)</span><span style=''>
</span>251 <span style=''>      }
</span>252 <span style=''>
</span>253 <span style=''>      private class TopLevelListWorker(phaser: Phaser, list: RemoteIterator[FileStatus]) extends Runnable {
</span>254 <span style=''>        override def run(): Unit = {
</span>255 <span style=''>          try {
</span>256 <span style=''>            </span><span style='background: #AEF1AE'>var i = phaser.getRegisteredParties + 1
</span>257 <span style=''></span><span style='background: #AEF1AE'>            while (list.hasNext &amp;&amp; i &lt; PhaserUtils.MaxParties) {
</span>258 <span style=''></span><span style='background: #AEF1AE'>              val status = list.next
</span>259 <span style=''></span><span style='background: #AEF1AE'>              val path = status.getPath
</span>260 <span style=''></span><span style='background: #AEF1AE'>              val name = path.getName
</span>261 <span style=''></span><span style='background: #AEF1AE'>              if (status.isDirectory) {
</span>262 <span style=''></span><span style='background: #AEF1AE'>                if (name != FileBasedMetadataFactory.MetadataDirectory &amp;&amp;
</span>263 <span style=''></span><span style='background: #AEF1AE'>                    partitions.forall(</span><span style='background: #F0ADAD'>_.exists(p =&gt; p == name || p.startsWith(s&quot;$name/&quot;))</span><span style='background: #AEF1AE'>)) {
</span>264 <span style=''></span><span style='background: #AEF1AE'>                  i += 1
</span>265 <span style=''></span><span style='background: #AEF1AE'>                  // use a tiered phaser on each directory avoid the limit of 65535 registered parties
</span>266 <span style=''></span><span style='background: #AEF1AE'>                  pool.submit(new ListWorker(new Phaser(phaser, 1), name, storage.context.fc.listStatus(path)))
</span>267 <span style=''></span><span style='background: #AEF1AE'>                }
</span>268 <span style=''></span><span style='background: #AEF1AE'>              } else if (name != MetadataJson.MetadataPath) {
</span>269 <span style=''></span><span style='background: #AEF1AE'>                </span><span style='background: #F0ADAD'>onDisk.computeIfAbsent(&quot;&quot;, computeFunction).put(name, java.lang.Boolean.TRUE)</span><span style='background: #AEF1AE'>
</span>270 <span style=''></span><span style='background: #AEF1AE'>              }
</span>271 <span style=''></span><span style='background: #AEF1AE'>            }
</span>272 <span style=''></span><span style='background: #AEF1AE'>            if (list.hasNext) {
</span>273 <span style=''></span><span style='background: #AEF1AE'>              </span><span style='background: #F0ADAD'>pool.submit(new TopLevelListWorker(new Phaser(phaser, 1), list))</span><span style='background: #AEF1AE'>
</span>274 <span style=''></span><span style='background: #AEF1AE'>            }</span><span style=''>
</span>275 <span style=''>          } finally {
</span>276 <span style=''>            </span><span style='background: #AEF1AE'>phaser.arriveAndDeregister()</span><span style=''>
</span>277 <span style=''>          }
</span>278 <span style=''>        }
</span>279 <span style=''>      }
</span>280 <span style=''>
</span>281 <span style=''>      private class ListWorker(phaser: Phaser, partition: String, listDirectory: =&gt; RemoteIterator[FileStatus])
</span>282 <span style=''>          extends Runnable {
</span>283 <span style=''>        override def run(): Unit = {
</span>284 <span style=''>          try {
</span>285 <span style=''>            </span><span style='background: #AEF1AE'>var i = phaser.getRegisteredParties + 1
</span>286 <span style=''></span><span style='background: #AEF1AE'>            val iter = listDirectory
</span>287 <span style=''></span><span style='background: #AEF1AE'>            while (iter.hasNext &amp;&amp; i &lt; PhaserUtils.MaxParties) {
</span>288 <span style=''></span><span style='background: #AEF1AE'>              val status = iter.next
</span>289 <span style=''></span><span style='background: #AEF1AE'>              val path = status.getPath
</span>290 <span style=''></span><span style='background: #AEF1AE'>              val name = path.getName
</span>291 <span style=''></span><span style='background: #AEF1AE'>              if (status.isDirectory) {
</span>292 <span style=''></span><span style='background: #AEF1AE'>                val nextPartition = s&quot;$partition/$name&quot;
</span>293 <span style=''></span><span style='background: #AEF1AE'>                if (partitions.forall(</span><span style='background: #F0ADAD'>_.exists(p =&gt; p == nextPartition || p.startsWith(s&quot;$nextPartition/&quot;))</span><span style='background: #AEF1AE'>)) {
</span>294 <span style=''></span><span style='background: #AEF1AE'>                  i += 1
</span>295 <span style=''></span><span style='background: #AEF1AE'>                  // use a tiered phaser on each directory avoid the limit of 65535 registered parties
</span>296 <span style=''></span><span style='background: #AEF1AE'>                  pool.submit(new ListWorker(new Phaser(phaser, 1), nextPartition, storage.context.fc.listStatus(path)))
</span>297 <span style=''></span><span style='background: #AEF1AE'>                }
</span>298 <span style=''></span><span style='background: #AEF1AE'>              } else {
</span>299 <span style=''></span><span style='background: #AEF1AE'>                val leafPartition =
</span>300 <span style=''></span><span style='background: #AEF1AE'>                  if (storage.metadata.leafStorage) { s&quot;$partition/${StorageUtils.leaf(name)}&quot; } else { </span><span style='background: #F0ADAD'>partition</span><span style='background: #AEF1AE'> }
</span>301 <span style=''></span><span style='background: #AEF1AE'>                if (partitions.forall(</span><span style='background: #F0ADAD'>_.contains(leafPartition)</span><span style='background: #AEF1AE'>)) {
</span>302 <span style=''></span><span style='background: #AEF1AE'>                  onDisk.computeIfAbsent(leafPartition, computeFunction).put(name, java.lang.Boolean.TRUE)
</span>303 <span style=''></span><span style='background: #AEF1AE'>                }
</span>304 <span style=''></span><span style='background: #AEF1AE'>              }
</span>305 <span style=''></span><span style='background: #AEF1AE'>            }
</span>306 <span style=''></span><span style='background: #AEF1AE'>            if (iter.hasNext) {
</span>307 <span style=''></span><span style='background: #AEF1AE'>              </span><span style='background: #F0ADAD'>pool.submit(new ListWorker(new Phaser(phaser, 1), partition, iter))</span><span style='background: #AEF1AE'>
</span>308 <span style=''></span><span style='background: #AEF1AE'>            }</span><span style=''>
</span>309 <span style=''>          } catch {
</span>310 <span style=''>            case _: FileNotFoundException </span><span style='background: #F0ADAD'>=&gt;</span><span style=''> // the partition dir was deleted... just return
</span>311 <span style=''>            case NonFatal(e) =&gt; </span><span style='background: #F0ADAD'>logger.error(&quot;Error scanning metadata directory:&quot;, e)</span><span style=''>
</span>312 <span style=''>          } finally {
</span>313 <span style=''>            </span><span style='background: #AEF1AE'>phaser.arriveAndDeregister()</span><span style=''> // notify that this thread is done
</span>314 <span style=''>          }
</span>315 <span style=''>        }
</span>316 <span style=''>      }
</span>317 <span style=''>    }
</span>318 <span style=''>
</span>319 <span style=''>    private case class Inconsistency(file: StorageFile, duplicate: Boolean)
</span>320 <span style=''>  }
</span>321 <span style=''>
</span>322 <span style=''>  @Parameters(commandDescription = &quot;Manage the metadata for a storage instance&quot;)
</span>323 <span style=''>  class ManageMetadataParams
</span>324 <span style=''>
</span>325 <span style=''>  @Parameters(commandDescription = &quot;Compact the metadata for a storage instance&quot;)
</span>326 <span style=''>  class CompactParams extends FsParams with RequiredTypeNameParam {
</span>327 <span style=''>    @Parameter(names = Array(&quot;-t&quot;, &quot;--threads&quot;), description = &quot;Number of threads to use for compaction&quot;)
</span>328 <span style=''>    var threads: Integer = </span><span style='background: #AEF1AE'>4</span><span style=''>
</span>329 <span style=''>  }
</span>330 <span style=''>
</span>331 <span style=''>  @Parameters(commandDescription = &quot;Register new data files with a storage instance&quot;)
</span>332 <span style=''>  class RegisterParams extends FsParams with RequiredTypeNameParam {
</span>333 <span style=''>    @Parameter(names = Array(&quot;--partition&quot;), description = &quot;Partition to update&quot;, required = true)
</span>334 <span style=''>    var partition: String = _
</span>335 <span style=''>
</span>336 <span style=''>    @Parameter(names = Array(&quot;--files&quot;), description = &quot;Names of the files to register, must already exist in the appropriate partition folder&quot;, required = true, variableArity = true)
</span>337 <span style=''>    var files: java.util.List[String] = </span><span style='background: #AEF1AE'>new util.ArrayList[String]()</span><span style=''>
</span>338 <span style=''>
</span>339 <span style=''>    @Parameter(names = Array(&quot;--bounds&quot;), description = &quot;Geographic bounds of the data files being registered, in the form xmin,ymin,xmax,ymax&quot;, required = false, converter = classOf[BoundsConverter])
</span>340 <span style=''>    var bounds: (Double, Double, Double, Double) = _
</span>341 <span style=''>
</span>342 <span style=''>    @Parameter(names = Array(&quot;--count&quot;), description = &quot;Number of features in the data files being registered&quot;, required = false)
</span>343 <span style=''>    var count: java.lang.Long = _
</span>344 <span style=''>  }
</span>345 <span style=''>
</span>346 <span style=''>  @Parameters(commandDescription = &quot;Unregister data files from a storage instance&quot;)
</span>347 <span style=''>  class UnregisterParams extends FsParams with RequiredTypeNameParam {
</span>348 <span style=''>    @Parameter(names = Array(&quot;--partition&quot;), description = &quot;Partition to update&quot;, required = true)
</span>349 <span style=''>    var partition: String = _
</span>350 <span style=''>
</span>351 <span style=''>    @Parameter(names = Array(&quot;--files&quot;), description = &quot;Names of the files to unregister, must already exist in the appropriate partition folder&quot;, required = true, variableArity = true)
</span>352 <span style=''>    var files: java.util.List[String] = </span><span style='background: #AEF1AE'>new util.ArrayList[String]()</span><span style=''>
</span>353 <span style=''>
</span>354 <span style=''>    @Parameter(names = Array(&quot;--count&quot;), description = &quot;Number of features in the data files being unregistered&quot;, required = false)
</span>355 <span style=''>    var count: java.lang.Long = _
</span>356 <span style=''>  }
</span>357 <span style=''>
</span>358 <span style=''>  @Parameters(commandDescription = &quot;Check consistency between metadata and data files&quot;)
</span>359 <span style=''>  class CheckConsistencyParams
</span>360 <span style=''>      extends FsParams with RequiredTypeNameParam with PartitionParam with OptionalForceParam {
</span>361 <span style=''>
</span>362 <span style=''>    @Parameter(names = Array(&quot;--repair&quot;), description = &quot;Update metadata based on consistency check&quot;)
</span>363 <span style=''>    var repair: java.lang.Boolean = </span><span style='background: #AEF1AE'>false</span><span style=''>
</span>364 <span style=''>
</span>365 <span style=''>    @Parameter(names = Array(&quot;--rebuild&quot;), description = &quot;Replace all current metadata from the data files&quot;)
</span>366 <span style=''>    var rebuild: java.lang.Boolean = </span><span style='background: #AEF1AE'>false</span><span style=''>
</span>367 <span style=''>
</span>368 <span style=''>    // TODO GEOMESA-2963
</span>369 <span style=''>    // @Parameter(names = Array(&quot;--analyze&quot;), description = &quot;Rebuild file data statistics (may be slow)&quot;)
</span>370 <span style=''>    // var analyze: java.lang.Boolean = false
</span>371 <span style=''>
</span>372 <span style=''>    @Parameter(
</span>373 <span style=''>      names = Array(&quot;-t&quot;, &quot;--threads&quot;),
</span>374 <span style=''>      description = &quot;Number of concurrent threads to use&quot;,
</span>375 <span style=''>      validateWith = Array(classOf[PositiveInteger]))
</span>376 <span style=''>    var threads: Integer = </span><span style='background: #AEF1AE'>4</span><span style=''>
</span>377 <span style=''>  }
</span>378 <span style=''>
</span>379 <span style=''>  class BoundsConverter(name: String) extends BaseConverter[(Double, Double, Double, Double)](name) {
</span>380 <span style=''>    override def convert(value: String): (Double, Double, Double, Double) = {
</span>381 <span style=''>      try {
</span>382 <span style=''>        </span><span style='background: #F0ADAD'>val Array(xmin, ymin, xmax, ymax) = value.split(&quot;,&quot;).map(_.trim.toDouble)
</span>383 <span style=''></span><span style='background: #F0ADAD'>        (xmin, ymin, xmax, ymax)</span><span style=''>
</span>384 <span style=''>      } catch {
</span>385 <span style=''>        case NonFatal(e) =&gt; </span><span style='background: #F0ADAD'>throw new ParameterException(getErrorString(value, s&quot;format: $e&quot;))</span><span style=''>
</span>386 <span style=''>      }
</span>387 <span style=''>    }
</span>388 <span style=''>  }
</span>389 <span style=''>}
</span></pre>
          </div>
          <div class="tab-pane" id="statementlist">
            <table cellspacing="0" cellpadding="0" class="table statementlist">
      <tr>
        <th>Line</th>
        <th>Stmt Id</th>
        <th>Pos</th>
        <th>Tree</th>
        <th>Symbol</th>
        <th>Tests</th>
        <th>Code</th>
      </tr><tr>
        <td>
          37
        </td>
        <td>
          85851
        </td>
        <td>
          2117
          -
          2134
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;manage-metadata&quot;
        </td>
      </tr><tr>
        <td>
          38
        </td>
        <td>
          85852
        </td>
        <td>
          2159
          -
          2183
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.ManageMetadataParams.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.ManageMetadataParams()
        </td>
      </tr><tr>
        <td>
          40
        </td>
        <td>
          85853
        </td>
        <td>
          2235
          -
          2255
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CompactCommand.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CompactCommand()
        </td>
      </tr><tr>
        <td>
          40
        </td>
        <td>
          85855
        </td>
        <td>
          2280
          -
          2303
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterCommand.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterCommand()
        </td>
      </tr><tr>
        <td>
          40
        </td>
        <td>
          85854
        </td>
        <td>
          2257
          -
          2278
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterCommand.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterCommand()
        </td>
      </tr><tr>
        <td>
          40
        </td>
        <td>
          85857
        </td>
        <td>
          2231
          -
          2335
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.generic.GenericCompanion.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.Seq.apply[org.locationtech.geomesa.fs.tools.FsDataStoreCommand{def params: org.locationtech.geomesa.tools.RequiredTypeNameParam with org.locationtech.geomesa.fs.tools.FsDataStoreCommand.FsParams}](new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CompactCommand(), new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterCommand(), new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterCommand(), new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand())
        </td>
      </tr><tr>
        <td>
          40
        </td>
        <td>
          85856
        </td>
        <td>
          2305
          -
          2334
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand()
        </td>
      </tr><tr>
        <td>
          49
        </td>
        <td>
          85858
        </td>
        <td>
          2494
          -
          2503
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;compact&quot;
        </td>
      </tr><tr>
        <td>
          50
        </td>
        <td>
          85859
        </td>
        <td>
          2530
          -
          2547
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CompactParams.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new FsManageMetadataCommand.this.CompactParams()
        </td>
      </tr><tr>
        <td>
          52
        </td>
        <td>
          85881
        </td>
        <td>
          2584
          -
          2990
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.tools.DataStoreCommand.withDataStore
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          CompactCommand.this.withDataStore[Unit](((ds: org.locationtech.geomesa.fs.data.FileSystemDataStore) =&gt; {
  org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Compacting metadata, please wait...&quot;);
  val metadata: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ds.storage(CompactCommand.this.params.featureName).metadata;
  metadata.compact(scala.None, scala.None, scala.Predef.Integer2int(CompactCommand.this.params.threads));
  val partitions: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata] = metadata.getPartitions(metadata.getPartitions$default$1);
  org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Compacted metadata into &quot;, &quot; partitions consisting of &quot;).s(partitions.length).+(scala.StringContext.apply(&quot;&quot;, &quot; files&quot;).s(partitions.map[Int, Seq[Int]](((x$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; x$1.files.size))(collection.this.Seq.canBuildFrom[Int]).sum[Int](math.this.Numeric.IntIsIntegral))))
}))
        </td>
      </tr><tr>
        <td>
          53
        </td>
        <td>
          85860
        </td>
        <td>
          2612
          -
          2668
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Compacting metadata, please wait...&quot;)
        </td>
      </tr><tr>
        <td>
          54
        </td>
        <td>
          85861
        </td>
        <td>
          2701
          -
          2719
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.tools.RequiredTypeNameParam.featureName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          CompactCommand.this.params.featureName
        </td>
      </tr><tr>
        <td>
          54
        </td>
        <td>
          85862
        </td>
        <td>
          2690
          -
          2729
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.FileSystemStorage.metadata
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ds.storage(CompactCommand.this.params.featureName).metadata
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          85863
        </td>
        <td>
          2753
          -
          2757
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          85865
        </td>
        <td>
          2765
          -
          2779
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CompactParams.threads
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          CompactCommand.this.params.threads
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          85864
        </td>
        <td>
          2759
          -
          2763
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          85867
        </td>
        <td>
          2736
          -
          2780
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.Compactable.compact
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          metadata.compact(scala.None, scala.None, scala.Predef.Integer2int(CompactCommand.this.params.threads))
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          85866
        </td>
        <td>
          2765
          -
          2779
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Integer2int
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.Integer2int(CompactCommand.this.params.threads)
        </td>
      </tr><tr>
        <td>
          56
        </td>
        <td>
          85868
        </td>
        <td>
          2804
          -
          2828
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.getPartitions
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          metadata.getPartitions(metadata.getPartitions$default$1)
        </td>
      </tr><tr>
        <td>
          57
        </td>
        <td>
          85869
        </td>
        <td>
          2855
          -
          2880
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Compacted metadata into &quot;
        </td>
      </tr><tr>
        <td>
          57
        </td>
        <td>
          85871
        </td>
        <td>
          2881
          -
          2898
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.length
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partitions.length
        </td>
      </tr><tr>
        <td>
          57
        </td>
        <td>
          85870
        </td>
        <td>
          2899
          -
          2926
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; partitions consisting of &quot;
        </td>
      </tr><tr>
        <td>
          57
        </td>
        <td>
          85879
        </td>
        <td>
          2853
          -
          2983
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.+
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Compacted metadata into &quot;, &quot; partitions consisting of &quot;).s(partitions.length).+(scala.StringContext.apply(&quot;&quot;, &quot; files&quot;).s(partitions.map[Int, Seq[Int]](((x$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; x$1.files.size))(collection.this.Seq.canBuildFrom[Int]).sum[Int](math.this.Numeric.IntIsIntegral)))
        </td>
      </tr><tr>
        <td>
          57
        </td>
        <td>
          85880
        </td>
        <td>
          2835
          -
          2984
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Compacted metadata into &quot;, &quot; partitions consisting of &quot;).s(partitions.length).+(scala.StringContext.apply(&quot;&quot;, &quot; files&quot;).s(partitions.map[Int, Seq[Int]](((x$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; x$1.files.size))(collection.this.Seq.canBuildFrom[Int]).sum[Int](math.this.Numeric.IntIsIntegral))))
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85873
        </td>
        <td>
          2976
          -
          2983
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; files&quot;
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85872
        </td>
        <td>
          2941
          -
          2942
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85875
        </td>
        <td>
          2957
          -
          2957
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.Seq.canBuildFrom
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          collection.this.Seq.canBuildFrom[Int]
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85874
        </td>
        <td>
          2958
          -
          2970
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.size
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$1.files.size
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85877
        </td>
        <td>
          2943
          -
          2975
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          scala.collection.TraversableOnce.sum
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partitions.map[Int, Seq[Int]](((x$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; x$1.files.size))(collection.this.Seq.canBuildFrom[Int]).sum[Int](math.this.Numeric.IntIsIntegral)
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85876
        </td>
        <td>
          2972
          -
          2972
        </td>
        <td>
          Select
        </td>
        <td>
          scala.math.Numeric.IntIsIntegral
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          math.this.Numeric.IntIsIntegral
        </td>
      </tr><tr>
        <td>
          58
        </td>
        <td>
          85878
        </td>
        <td>
          2939
          -
          2983
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;&quot;, &quot; files&quot;).s(partitions.map[Int, Seq[Int]](((x$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; x$1.files.size))(collection.this.Seq.canBuildFrom[Int]).sum[Int](math.this.Numeric.IntIsIntegral))
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          85882
        </td>
        <td>
          3074
          -
          3084
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;register&quot;
        </td>
      </tr><tr>
        <td>
          65
        </td>
        <td>
          85883
        </td>
        <td>
          3111
          -
          3129
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterParams.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new FsManageMetadataCommand.this.RegisterParams()
        </td>
      </tr><tr>
        <td>
          67
        </td>
        <td>
          85921
        </td>
        <td>
          3166
          -
          4017
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.tools.DataStoreCommand.withDataStore
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.withDataStore[Unit](((ds: org.locationtech.geomesa.fs.data.FileSystemDataStore) =&gt; {
  val metadata: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ds.storage(RegisterCommand.this.params.featureName).metadata;
  val files: scala.collection.mutable.Buffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile] = scala.collection.JavaConverters.asScalaBufferConverter[String](RegisterCommand.this.params.files).asScala.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.Buffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$2: String) =&gt; org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(x$2, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)))(mutable.this.Buffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]);
  val count: Long = scala.Option.apply[Long](RegisterCommand.this.params.count).map[Long](((x$3: Long) =&gt; x$3.longValue())).getOrElse[Long](0L);
  val bounds: org.locationtech.jts.geom.Envelope = new org.locationtech.jts.geom.Envelope();
  scala.Option.apply[(Double, Double, Double, Double)](RegisterCommand.this.params.bounds).foreach[Unit](((x0$1: (Double, Double, Double, Double)) =&gt; x0$1 match {
    case (_1: Double, _2: Double, _3: Double, _4: Double)(Double, Double, Double, Double)((xmin @ _), (ymin @ _), (xmax @ _), (ymax @ _)) =&gt; {
      bounds.expandToInclude(xmin, ymin);
      bounds.expandToInclude(xmax, ymax)
    }
  }));
  metadata.addPartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(RegisterCommand.this.params.partition, files.toSeq, org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionBounds.apply(bounds), count));
  val partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata = metadata.getPartition(RegisterCommand.this.params.partition).getOrElse[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata](org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(&quot;&quot;, scala.collection.Seq.empty[Nothing], scala.None, 0L));
  org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registered &quot;, &quot; new files. Updated partition: &quot;, &quot; &quot;).s(RegisterCommand.this.params.files.size(), partition.files.size).+(scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count)))
}))
        </td>
      </tr><tr>
        <td>
          68
        </td>
        <td>
          85885
        </td>
        <td>
          3209
          -
          3248
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.FileSystemStorage.metadata
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ds.storage(RegisterCommand.this.params.featureName).metadata
        </td>
      </tr><tr>
        <td>
          68
        </td>
        <td>
          85884
        </td>
        <td>
          3220
          -
          3238
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.tools.RequiredTypeNameParam.featureName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.params.featureName
        </td>
      </tr><tr>
        <td>
          69
        </td>
        <td>
          85887
        </td>
        <td>
          3307
          -
          3333
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.System.currentTimeMillis
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          java.lang.System.currentTimeMillis()
        </td>
      </tr><tr>
        <td>
          69
        </td>
        <td>
          85886
        </td>
        <td>
          3267
          -
          3279
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterParams.files
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.params.files
        </td>
      </tr><tr>
        <td>
          69
        </td>
        <td>
          85889
        </td>
        <td>
          3291
          -
          3291
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.mutable.Buffer.canBuildFrom
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          mutable.this.Buffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]
        </td>
      </tr><tr>
        <td>
          69
        </td>
        <td>
          85888
        </td>
        <td>
          3292
          -
          3334
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(x$2, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)
        </td>
      </tr><tr>
        <td>
          69
        </td>
        <td>
          85890
        </td>
        <td>
          3267
          -
          3335
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          scala.collection.TraversableLike.map
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.JavaConverters.asScalaBufferConverter[String](RegisterCommand.this.params.files).asScala.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.Buffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$2: String) =&gt; org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(x$2, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)))(mutable.this.Buffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile])
        </td>
      </tr><tr>
        <td>
          70
        </td>
        <td>
          85891
        </td>
        <td>
          3354
          -
          3407
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.getOrElse
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Option.apply[Long](RegisterCommand.this.params.count).map[Long](((x$3: Long) =&gt; x$3.longValue())).getOrElse[Long](0L)
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          85892
        </td>
        <td>
          3427
          -
          3439
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.jts.geom.Envelope.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new org.locationtech.jts.geom.Envelope()
        </td>
      </tr><tr>
        <td>
          72
        </td>
        <td>
          85893
        </td>
        <td>
          3453
          -
          3466
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterParams.bounds
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.params.bounds
        </td>
      </tr><tr>
        <td>
          72
        </td>
        <td>
          85897
        </td>
        <td>
          3446
          -
          3604
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Option.apply[(Double, Double, Double, Double)](RegisterCommand.this.params.bounds).foreach[Unit](((x0$1: (Double, Double, Double, Double)) =&gt; x0$1 match {
  case (_1: Double, _2: Double, _3: Double, _4: Double)(Double, Double, Double, Double)((xmin @ _), (ymin @ _), (xmax @ _), (ymax @ _)) =&gt; {
    bounds.expandToInclude(xmin, ymin);
    bounds.expandToInclude(xmax, ymax)
  }
}))
        </td>
      </tr><tr>
        <td>
          72
        </td>
        <td>
          85896
        </td>
        <td>
          3508
          -
          3596
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  bounds.expandToInclude(xmin, ymin);
  bounds.expandToInclude(xmax, ymax)
}
        </td>
      </tr><tr>
        <td>
          73
        </td>
        <td>
          85894
        </td>
        <td>
          3519
          -
          3553
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.jts.geom.Envelope.expandToInclude
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          bounds.expandToInclude(xmin, ymin)
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          85895
        </td>
        <td>
          3562
          -
          3596
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.jts.geom.Envelope.expandToInclude
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          bounds.expandToInclude(xmax, ymax)
        </td>
      </tr><tr>
        <td>
          76
        </td>
        <td>
          85899
        </td>
        <td>
          3669
          -
          3680
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.toSeq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          files.toSeq
        </td>
      </tr><tr>
        <td>
          76
        </td>
        <td>
          85898
        </td>
        <td>
          3651
          -
          3667
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterParams.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.params.partition
        </td>
      </tr><tr>
        <td>
          76
        </td>
        <td>
          85901
        </td>
        <td>
          3633
          -
          3713
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(RegisterCommand.this.params.partition, files.toSeq, org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionBounds.apply(bounds), count)
        </td>
      </tr><tr>
        <td>
          76
        </td>
        <td>
          85900
        </td>
        <td>
          3682
          -
          3705
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionBounds.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionBounds.apply(bounds)
        </td>
      </tr><tr>
        <td>
          76
        </td>
        <td>
          85902
        </td>
        <td>
          3611
          -
          3714
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.addPartition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          metadata.addPartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(RegisterCommand.this.params.partition, files.toSeq, org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionBounds.apply(bounds), count))
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85903
        </td>
        <td>
          3759
          -
          3775
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.RegisterParams.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.params.partition
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85905
        </td>
        <td>
          3809
          -
          3818
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.generic.GenericCompanion.empty
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.Seq.empty[Nothing]
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85904
        </td>
        <td>
          3805
          -
          3807
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85907
        </td>
        <td>
          3826
          -
          3828
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          0L
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85906
        </td>
        <td>
          3820
          -
          3824
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85909
        </td>
        <td>
          3737
          -
          3830
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.getOrElse
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          metadata.getPartition(RegisterCommand.this.params.partition).getOrElse[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata](org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(&quot;&quot;, scala.collection.Seq.empty[Nothing], scala.None, 0L))
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          85908
        </td>
        <td>
          3787
          -
          3829
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(&quot;&quot;, scala.collection.Seq.empty[Nothing], scala.None, 0L)
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85911
        </td>
        <td>
          3888
          -
          3920
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; new files. Updated partition: &quot;
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85910
        </td>
        <td>
          3857
          -
          3869
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Registered &quot;
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85913
        </td>
        <td>
          3870
          -
          3887
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.List.size
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RegisterCommand.this.params.files.size()
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85912
        </td>
        <td>
          3942
          -
          3944
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; &quot;
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85914
        </td>
        <td>
          3921
          -
          3941
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.size
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partition.files.size
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85919
        </td>
        <td>
          3855
          -
          4010
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.+
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Registered &quot;, &quot; new files. Updated partition: &quot;, &quot; &quot;).s(RegisterCommand.this.params.files.size(), partition.files.size).+(scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count))
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          85920
        </td>
        <td>
          3837
          -
          4011
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registered &quot;, &quot; new files. Updated partition: &quot;, &quot; &quot;).s(RegisterCommand.this.params.files.size(), partition.files.size).+(scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count)))
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          85915
        </td>
        <td>
          3959
          -
          3977
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;files containing &quot;
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          85917
        </td>
        <td>
          3978
          -
          3993
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.count
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partition.count
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          85916
        </td>
        <td>
          3994
          -
          4010
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; known features&quot;
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          85918
        </td>
        <td>
          3957
          -
          4010
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count)
        </td>
      </tr><tr>
        <td>
          85
        </td>
        <td>
          85922
        </td>
        <td>
          4103
          -
          4115
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;unregister&quot;
        </td>
      </tr><tr>
        <td>
          86
        </td>
        <td>
          85923
        </td>
        <td>
          4142
          -
          4162
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterParams.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new FsManageMetadataCommand.this.UnregisterParams()
        </td>
      </tr><tr>
        <td>
          88
        </td>
        <td>
          85955
        </td>
        <td>
          4199
          -
          4811
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.tools.DataStoreCommand.withDataStore
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          UnregisterCommand.this.withDataStore[Unit](((ds: org.locationtech.geomesa.fs.data.FileSystemDataStore) =&gt; {
  val metadata: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ds.storage(UnregisterCommand.this.params.featureName).metadata;
  val files: scala.collection.mutable.Buffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile] = scala.collection.JavaConverters.asScalaBufferConverter[String](UnregisterCommand.this.params.files).asScala.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.Buffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$4: String) =&gt; org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(x$4, 0L, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)))(mutable.this.Buffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]);
  val count: Long = scala.Option.apply[Long](UnregisterCommand.this.params.count).map[Long](((x$5: Long) =&gt; x$5.longValue())).getOrElse[Long](0L);
  metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(UnregisterCommand.this.params.partition, files.toSeq, scala.None, count));
  val partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata = metadata.getPartition(UnregisterCommand.this.params.partition).getOrElse[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata](org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(&quot;&quot;, scala.collection.Seq.empty[Nothing], scala.None, 0L));
  org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Unregistered &quot;, &quot; files. Updated partition: &quot;, &quot; &quot;).s(UnregisterCommand.this.params.files.size(), partition.files.size).+(scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count)))
}))
        </td>
      </tr><tr>
        <td>
          89
        </td>
        <td>
          85925
        </td>
        <td>
          4242
          -
          4281
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.FileSystemStorage.metadata
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ds.storage(UnregisterCommand.this.params.featureName).metadata
        </td>
      </tr><tr>
        <td>
          89
        </td>
        <td>
          85924
        </td>
        <td>
          4253
          -
          4271
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.tools.RequiredTypeNameParam.featureName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          UnregisterCommand.this.params.featureName
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          85927
        </td>
        <td>
          4340
          -
          4342
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          0L
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          85926
        </td>
        <td>
          4300
          -
          4312
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterParams.files
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          UnregisterCommand.this.params.files
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          85929
        </td>
        <td>
          4324
          -
          4324
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.mutable.Buffer.canBuildFrom
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          mutable.this.Buffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          85928
        </td>
        <td>
          4325
          -
          4343
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(x$4, 0L, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          85930
        </td>
        <td>
          4300
          -
          4344
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          scala.collection.TraversableLike.map
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.JavaConverters.asScalaBufferConverter[String](UnregisterCommand.this.params.files).asScala.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.Buffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$4: String) =&gt; org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(x$4, 0L, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)))(mutable.this.Buffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile])
        </td>
      </tr><tr>
        <td>
          91
        </td>
        <td>
          85931
        </td>
        <td>
          4363
          -
          4416
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.getOrElse
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Option.apply[Long](UnregisterCommand.this.params.count).map[Long](((x$5: Long) =&gt; x$5.longValue())).getOrElse[Long](0L)
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          85933
        </td>
        <td>
          4484
          -
          4495
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.toSeq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          files.toSeq
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          85932
        </td>
        <td>
          4466
          -
          4482
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterParams.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          UnregisterCommand.this.params.partition
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          85935
        </td>
        <td>
          4448
          -
          4509
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(UnregisterCommand.this.params.partition, files.toSeq, scala.None, count)
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          85934
        </td>
        <td>
          4497
          -
          4501
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          85936
        </td>
        <td>
          4423
          -
          4510
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.removePartition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(UnregisterCommand.this.params.partition, files.toSeq, scala.None, count))
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85937
        </td>
        <td>
          4555
          -
          4571
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.UnregisterParams.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          UnregisterCommand.this.params.partition
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85939
        </td>
        <td>
          4605
          -
          4614
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.generic.GenericCompanion.empty
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.Seq.empty[Nothing]
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85938
        </td>
        <td>
          4601
          -
          4603
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85941
        </td>
        <td>
          4622
          -
          4624
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          0L
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85940
        </td>
        <td>
          4616
          -
          4620
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85943
        </td>
        <td>
          4533
          -
          4626
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.getOrElse
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          metadata.getPartition(UnregisterCommand.this.params.partition).getOrElse[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata](org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(&quot;&quot;, scala.collection.Seq.empty[Nothing], scala.None, 0L))
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          85942
        </td>
        <td>
          4583
          -
          4625
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(&quot;&quot;, scala.collection.Seq.empty[Nothing], scala.None, 0L)
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85945
        </td>
        <td>
          4686
          -
          4714
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; files. Updated partition: &quot;
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85944
        </td>
        <td>
          4653
          -
          4667
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Unregistered &quot;
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85947
        </td>
        <td>
          4668
          -
          4685
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.List.size
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          UnregisterCommand.this.params.files.size()
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85946
        </td>
        <td>
          4736
          -
          4738
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; &quot;
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85948
        </td>
        <td>
          4715
          -
          4735
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.size
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partition.files.size
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85953
        </td>
        <td>
          4651
          -
          4804
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.+
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Unregistered &quot;, &quot; files. Updated partition: &quot;, &quot; &quot;).s(UnregisterCommand.this.params.files.size(), partition.files.size).+(scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count))
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          85954
        </td>
        <td>
          4633
          -
          4805
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Unregistered &quot;, &quot; files. Updated partition: &quot;, &quot; &quot;).s(UnregisterCommand.this.params.files.size(), partition.files.size).+(scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count)))
        </td>
      </tr><tr>
        <td>
          95
        </td>
        <td>
          85949
        </td>
        <td>
          4753
          -
          4771
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;files containing &quot;
        </td>
      </tr><tr>
        <td>
          95
        </td>
        <td>
          85951
        </td>
        <td>
          4772
          -
          4787
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.count
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partition.count
        </td>
      </tr><tr>
        <td>
          95
        </td>
        <td>
          85950
        </td>
        <td>
          4788
          -
          4804
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; known features&quot;
        </td>
      </tr><tr>
        <td>
          95
        </td>
        <td>
          85952
        </td>
        <td>
          4751
          -
          4804
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;files containing &quot;, &quot; known features&quot;).s(partition.count)
        </td>
      </tr><tr>
        <td>
          101
        </td>
        <td>
          85956
        </td>
        <td>
          4920
          -
          4939
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;check-consistency&quot;
        </td>
      </tr><tr>
        <td>
          102
        </td>
        <td>
          85957
        </td>
        <td>
          4966
          -
          4994
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new FsManageMetadataCommand.this.CheckConsistencyParams()
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          85959
        </td>
        <td>
          5083
          -
          5097
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.rebuild
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          CheckConsistencyCommand.this.params.rebuild
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          85958
        </td>
        <td>
          5066
          -
          5079
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.repair
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          CheckConsistencyCommand.this.params.repair
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          85961
        </td>
        <td>
          5066
          -
          5097
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.repair).&amp;&amp;(scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild))
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          85960
        </td>
        <td>
          5083
          -
          5097
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Boolean2boolean
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild)
        </td>
      </tr><tr>
        <td>
          106
        </td>
        <td>
          85963
        </td>
        <td>
          5109
          -
          5193
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Some.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Some.apply[com.beust.jcommander.ParameterException](new com.beust.jcommander.ParameterException(&quot;Please specify at most one of --repair and --rebuild&quot;))
        </td>
      </tr><tr>
        <td>
          106
        </td>
        <td>
          85962
        </td>
        <td>
          5114
          -
          5192
        </td>
        <td>
          Apply
        </td>
        <td>
          com.beust.jcommander.ParameterException.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new com.beust.jcommander.ParameterException(&quot;Please specify at most one of --repair and --rebuild&quot;)
        </td>
      </tr><tr>
        <td>
          106
        </td>
        <td>
          85964
        </td>
        <td>
          5109
          -
          5193
        </td>
        <td>
          Block
        </td>
        <td>
          scala.Some.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Some.apply[com.beust.jcommander.ParameterException](new com.beust.jcommander.ParameterException(&quot;Please specify at most one of --repair and --rebuild&quot;))
        </td>
      </tr><tr>
        <td>
          108
        </td>
        <td>
          85965
        </td>
        <td>
          5217
          -
          5221
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          108
        </td>
        <td>
          85966
        </td>
        <td>
          5217
          -
          5221
        </td>
        <td>
          Block
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.None
        </td>
      </tr><tr>
        <td>
          113
        </td>
        <td>
          85967
        </td>
        <td>
          5284
          -
          5298
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.rebuild
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.rebuild
        </td>
      </tr><tr>
        <td>
          113
        </td>
        <td>
          85969
        </td>
        <td>
          5284
          -
          5328
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild).&amp;&amp;(CheckConsistencyCommand.this.params.partitions.isEmpty().unary_!)
        </td>
      </tr><tr>
        <td>
          113
        </td>
        <td>
          85968
        </td>
        <td>
          5302
          -
          5328
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.partitions.isEmpty().unary_!
        </td>
      </tr><tr>
        <td>
          113
        </td>
        <td>
          85983
        </td>
        <td>
          5280
          -
          5280
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          113
        </td>
        <td>
          85982
        </td>
        <td>
          5330
          -
          5669
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Rebuilding all metadata using only &quot;, &quot; partitions - &quot;).s(CheckConsistencyCommand.this.params.partitions.size()).+(&quot;metadata will not exist for any other partitions&quot;));
  if (CheckConsistencyCommand.this.params.force.unary_!.&amp;&amp;({
  &lt;artifact&gt; val x$1: String = &quot;Continue (y/n)? &quot;;
  &lt;artifact&gt; val x$2: List[String] @scala.reflect.internal.annotations.uncheckedBounds = org.locationtech.geomesa.tools.utils.Prompt.confirm$default$2;
  &lt;artifact&gt; val x$3: org.locationtech.geomesa.tools.utils.Prompt.SystemConsole = org.locationtech.geomesa.tools.utils.Prompt.confirm$default$3(x$1, x$2);
  org.locationtech.geomesa.tools.utils.Prompt.confirm(x$1, x$2)(x$3)
}.unary_!))
    {
      org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Cancelling operation&quot;);
      return ()
    }
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          113
        </td>
        <td>
          85984
        </td>
        <td>
          5280
          -
          5280
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          114
        </td>
        <td>
          85971
        </td>
        <td>
          5340
          -
          5514
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.warn
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Rebuilding all metadata using only &quot;, &quot; partitions - &quot;).s(CheckConsistencyCommand.this.params.partitions.size()).+(&quot;metadata will not exist for any other partitions&quot;))
        </td>
      </tr><tr>
        <td>
          115
        </td>
        <td>
          85970
        </td>
        <td>
          5369
          -
          5513
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.+
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Rebuilding all metadata using only &quot;, &quot; partitions - &quot;).s(CheckConsistencyCommand.this.params.partitions.size()).+(&quot;metadata will not exist for any other partitions&quot;)
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85973
        </td>
        <td>
          5559
          -
          5559
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.tools.utils.Prompt.confirm$default$3
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.utils.Prompt.confirm$default$3(x$1, x$2)
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85972
        </td>
        <td>
          5560
          -
          5578
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Continue (y/n)? &quot;
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85975
        </td>
        <td>
          5544
          -
          5579
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  &lt;artifact&gt; val x$1: String = &quot;Continue (y/n)? &quot;;
  &lt;artifact&gt; val x$2: List[String] @scala.reflect.internal.annotations.uncheckedBounds = org.locationtech.geomesa.tools.utils.Prompt.confirm$default$2;
  &lt;artifact&gt; val x$3: org.locationtech.geomesa.tools.utils.Prompt.SystemConsole = org.locationtech.geomesa.tools.utils.Prompt.confirm$default$3(x$1, x$2);
  org.locationtech.geomesa.tools.utils.Prompt.confirm(x$1, x$2)(x$3)
}.unary_!
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85974
        </td>
        <td>
          5545
          -
          5579
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.tools.utils.Prompt.confirm
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.utils.Prompt.confirm(x$1, x$2)(x$3)
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85976
        </td>
        <td>
          5527
          -
          5579
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          CheckConsistencyCommand.this.params.force.unary_!.&amp;&amp;({
  &lt;artifact&gt; val x$1: String = &quot;Continue (y/n)? &quot;;
  &lt;artifact&gt; val x$2: List[String] @scala.reflect.internal.annotations.uncheckedBounds = org.locationtech.geomesa.tools.utils.Prompt.confirm$default$2;
  &lt;artifact&gt; val x$3: org.locationtech.geomesa.tools.utils.Prompt.SystemConsole = org.locationtech.geomesa.tools.utils.Prompt.confirm$default$3(x$1, x$2);
  org.locationtech.geomesa.tools.utils.Prompt.confirm(x$1, x$2)(x$3)
}.unary_!)
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85979
        </td>
        <td>
          5581
          -
          5661
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Cancelling operation&quot;);
  return ()
}
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85981
        </td>
        <td>
          5523
          -
          5523
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          117
        </td>
        <td>
          85980
        </td>
        <td>
          5523
          -
          5523
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          118
        </td>
        <td>
          85977
        </td>
        <td>
          5593
          -
          5634
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Cancelling operation&quot;)
        </td>
      </tr><tr>
        <td>
          119
        </td>
        <td>
          85978
        </td>
        <td>
          5645
          -
          5651
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          123
        </td>
        <td>
          86004
        </td>
        <td>
          5677
          -
          6047
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.tools.DataStoreCommand.withDataStore
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.withDataStore[Unit](((ds: org.locationtech.geomesa.fs.data.FileSystemDataStore) =&gt; {
  org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Checking consistency, please wait...&quot;);
  val storage: org.locationtech.geomesa.fs.storage.api.FileSystemStorage = ds.storage(CheckConsistencyCommand.this.params.featureName);
  val partitions: Option[Seq[String]] = scala.Option.apply[java.util.List[String]](CheckConsistencyCommand.this.params.partitions).collect[Seq[String]](({
    @SerialVersionUID(value = 0) final &lt;synthetic&gt; class $anonfun extends scala.runtime.AbstractPartialFunction[java.util.List[String],Seq[String]] with Serializable {
      def &lt;init&gt;(): &lt;$anon: java.util.List[String] =&gt; Seq[String]&gt; = {
        $anonfun.super.&lt;init&gt;();
        ()
      };
      final override def applyOrElse[A1 &lt;: java.util.List[String], B1 &gt;: Seq[String]](x1: A1, default: A1 =&gt; B1): B1 = ((x1.asInstanceOf[java.util.List[String]]: java.util.List[String]): java.util.List[String] @unchecked) match {
        case (p @ _) if p.isEmpty().unary_! =&gt; scala.collection.JavaConverters.asScalaBufferConverter[String](p).asScala.toSeq
        case (defaultCase$ @ _) =&gt; default.apply(x1)
      };
      final def isDefinedAt(x1: java.util.List[String]): Boolean = ((x1.asInstanceOf[java.util.List[String]]: java.util.List[String]): java.util.List[String] @unchecked) match {
        case (p @ _) if p.isEmpty().unary_! =&gt; true
        case (defaultCase$ @ _) =&gt; false
      }
    };
    new $anonfun()
  }: PartialFunction[java.util.List[String],Seq[String]]));
  org.locationtech.geomesa.utils.io.`package`.WithClose.apply[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker, Unit](new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker(storage, partitions, scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild), scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.repair), scala.Predef.Integer2int(CheckConsistencyCommand.this.params.threads)))(((x$6: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker) =&gt; x$6.run()))(io.this.IsCloseable.closeableIsCloseable)
}))
        </td>
      </tr><tr>
        <td>
          124
        </td>
        <td>
          85985
        </td>
        <td>
          5707
          -
          5764
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Checking consistency, please wait...&quot;)
        </td>
      </tr><tr>
        <td>
          125
        </td>
        <td>
          85987
        </td>
        <td>
          5787
          -
          5817
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.data.FileSystemDataStore.storage
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ds.storage(CheckConsistencyCommand.this.params.featureName)
        </td>
      </tr><tr>
        <td>
          125
        </td>
        <td>
          85986
        </td>
        <td>
          5798
          -
          5816
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.tools.RequiredTypeNameParam.featureName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.featureName
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          85989
        </td>
        <td>
          5889
          -
          5899
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          p.isEmpty().unary_!
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          85988
        </td>
        <td>
          5850
          -
          5867
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.FsDataStoreCommand.PartitionParam.partitions
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.partitions
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          85991
        </td>
        <td>
          5903
          -
          5918
        </td>
        <td>
          Block
        </td>
        <td>
          scala.collection.SeqLike.toSeq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.JavaConverters.asScalaBufferConverter[String](p).asScala.toSeq
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          85990
        </td>
        <td>
          5903
          -
          5918
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.toSeq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.JavaConverters.asScalaBufferConverter[String](p).asScala.toSeq
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          85993
        </td>
        <td>
          5843
          -
          5920
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.collect
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Option.apply[java.util.List[String]](CheckConsistencyCommand.this.params.partitions).collect[Seq[String]](({
  @SerialVersionUID(value = 0) final &lt;synthetic&gt; class $anonfun extends scala.runtime.AbstractPartialFunction[java.util.List[String],Seq[String]] with Serializable {
    def &lt;init&gt;(): &lt;$anon: java.util.List[String] =&gt; Seq[String]&gt; = {
      $anonfun.super.&lt;init&gt;();
      ()
    };
    final override def applyOrElse[A1 &lt;: java.util.List[String], B1 &gt;: Seq[String]](x1: A1, default: A1 =&gt; B1): B1 = ((x1.asInstanceOf[java.util.List[String]]: java.util.List[String]): java.util.List[String] @unchecked) match {
      case (p @ _) if p.isEmpty().unary_! =&gt; scala.collection.JavaConverters.asScalaBufferConverter[String](p).asScala.toSeq
      case (defaultCase$ @ _) =&gt; default.apply(x1)
    };
    final def isDefinedAt(x1: java.util.List[String]): Boolean = ((x1.asInstanceOf[java.util.List[String]]: java.util.List[String]): java.util.List[String] @unchecked) match {
      case (p @ _) if p.isEmpty().unary_! =&gt; true
      case (defaultCase$ @ _) =&gt; false
    }
  };
  new $anonfun()
}: PartialFunction[java.util.List[String],Seq[String]]))
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          85992
        </td>
        <td>
          5877
          -
          5877
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.$anonfun.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new $anonfun()
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          85995
        </td>
        <td>
          5983
          -
          5997
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Boolean2boolean
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild)
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          85994
        </td>
        <td>
          5983
          -
          5997
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.rebuild
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.rebuild
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          85997
        </td>
        <td>
          5999
          -
          6012
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Boolean2boolean
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.repair)
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          85996
        </td>
        <td>
          5999
          -
          6012
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.repair
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.repair
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          85999
        </td>
        <td>
          6014
          -
          6028
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Integer2int
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.Integer2int(CheckConsistencyCommand.this.params.threads)
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          85998
        </td>
        <td>
          6014
          -
          6028
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyParams.threads
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.params.threads
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          86001
        </td>
        <td>
          6031
          -
          6038
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.run
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$6.run()
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          86000
        </td>
        <td>
          5939
          -
          6029
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker(storage, partitions, scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild), scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.repair), scala.Predef.Integer2int(CheckConsistencyCommand.this.params.threads))
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          86003
        </td>
        <td>
          5929
          -
          6039
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker, Unit](new org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker(storage, partitions, scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.rebuild), scala.Predef.Boolean2boolean(CheckConsistencyCommand.this.params.repair), scala.Predef.Integer2int(CheckConsistencyCommand.this.params.threads)))(((x$6: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker) =&gt; x$6.run()))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          86002
        </td>
        <td>
          6030
          -
          6030
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          142
        </td>
        <td>
          86005
        </td>
        <td>
          6380
          -
          6387
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.threads
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.threads
        </td>
      </tr><tr>
        <td>
          142
        </td>
        <td>
          86006
        </td>
        <td>
          6359
          -
          6388
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.utils.concurrent.CachedThreadPool.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.utils.concurrent.CachedThreadPool(ConsistencyChecker.this.threads)
        </td>
      </tr><tr>
        <td>
          143
        </td>
        <td>
          86007
        </td>
        <td>
          6416
          -
          6483
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.concurrent.ConcurrentHashMap[String,java.util.concurrent.ConcurrentHashMap[String,Boolean]]()
        </td>
      </tr><tr>
        <td>
          145
        </td>
        <td>
          86009
        </td>
        <td>
          6521
          -
          6524
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.$anon.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new $anon()
        </td>
      </tr><tr>
        <td>
          146
        </td>
        <td>
          86008
        </td>
        <td>
          6675
          -
          6715
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.concurrent.ConcurrentHashMap[String,Boolean]()
        </td>
      </tr><tr>
        <td>
          150
        </td>
        <td>
          86010
        </td>
        <td>
          6768
          -
          6797
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.invalidate
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.metadata.invalidate()
        </td>
      </tr><tr>
        <td>
          153
        </td>
        <td>
          86011
        </td>
        <td>
          6924
          -
          6934
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.listRoot
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.listRoot()
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          86012
        </td>
        <td>
          6948
          -
          6955
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.rebuild
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.rebuild
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          86023
        </td>
        <td>
          6957
          -
          7233
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$7: (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) = (ConsistencyChecker.this.buildPartitionConfigs(): (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) @unchecked) match {
    case (_1: Int, _2: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])(Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])((count @ _), (partitions @ _)) =&gt; scala.Tuple2.apply[Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]](count, partitions)
  };
  val count: Int = x$7._1;
  val partitions: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata] = x$7._2;
  org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Setting metadata to &quot;, &quot; partitions containing &quot;, &quot; data files...&quot;).s(partitions.length, count));
  ConsistencyChecker.this.storage.metadata.setPartitions(partitions);
  org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
}
        </td>
      </tr><tr>
        <td>
          156
        </td>
        <td>
          86013
        </td>
        <td>
          6974
          -
          6974
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$7._1
        </td>
      </tr><tr>
        <td>
          156
        </td>
        <td>
          86014
        </td>
        <td>
          6981
          -
          6981
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$7._2
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          86015
        </td>
        <td>
          7049
          -
          7070
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;Setting metadata to &quot;
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          86017
        </td>
        <td>
          7118
          -
          7133
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot; data files...&quot;
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          86016
        </td>
        <td>
          7089
          -
          7113
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot; partitions containing &quot;
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          86019
        </td>
        <td>
          7047
          -
          7133
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;Setting metadata to &quot;, &quot; partitions containing &quot;, &quot; data files...&quot;).s(partitions.length, count)
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          86018
        </td>
        <td>
          7071
          -
          7088
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.length
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partitions.length
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          86020
        </td>
        <td>
          7029
          -
          7134
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Setting metadata to &quot;, &quot; partitions containing &quot;, &quot; data files...&quot;).s(partitions.length, count))
        </td>
      </tr><tr>
        <td>
          158
        </td>
        <td>
          86021
        </td>
        <td>
          7145
          -
          7187
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.setPartitions
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.metadata.setPartitions(partitions)
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          86022
        </td>
        <td>
          7198
          -
          7223
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
        </td>
      </tr><tr>
        <td>
          160
        </td>
        <td>
          86114
        </td>
        <td>
          7239
          -
          10397
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val inconsistencies: scala.collection.mutable.Map[String,scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]] = scala.collection.mutable.Map.empty[String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]];
  var inconsistentCount: Int = 0;
  {
  &lt;artifact&gt; val qual$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
  &lt;artifact&gt; val x$1: Option[String] @scala.reflect.internal.annotations.uncheckedBounds = qual$1.getPartitions$default$1;
  qual$1.getPartitions(x$1)
}.foreach[Any](((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; if (ConsistencyChecker.this.partitions.forall(((x$8: Seq[String]) =&gt; x$8.contains[String](partition.name))))
    {
      val checked: scala.collection.mutable.Set[String] = scala.collection.mutable.Set.empty[String];
      val partitionOnDisk: java.util.concurrent.ConcurrentHashMap[String,Boolean] = ConsistencyChecker.this.onDisk.getOrDefault(partition.name, new java.util.concurrent.ConcurrentHashMap[String,Boolean]());
      partition.files.foreach[AnyVal](((file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile) =&gt; if (partitionOnDisk.remove(file.name))
        checked.add(file.name)
      else
        {
          val buf: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency] = inconsistencies.getOrElseUpdate(partition.name, scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]);
          val duplicate: Boolean = checked.add(file.name).unary_!;
          buf.+=(CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate));
          inconsistentCount = inconsistentCount.+(1)
        }));
      if (partitionOnDisk.isEmpty())
        ConsistencyChecker.this.onDisk.remove(partition.name)
      else
        ()
    }
  else
    ()));
  if (ConsistencyChecker.this.onDisk.isEmpty().&amp;&amp;(inconsistencies.isEmpty))
    org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;No inconsistencies detected&quot;)
  else
    if (ConsistencyChecker.this.repair)
      {
        if (inconsistencies.nonEmpty)
          {
            org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Removing &quot;, &quot; inconsistent metadata references...&quot;).s(inconsistentCount));
            inconsistencies.foreach[Unit](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
              case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((partition @ _), (files @ _)) =&gt; ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
            }));
            org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
          }
        else
          ();
        if (ConsistencyChecker.this.onDisk.isEmpty().unary_!)
          {
            &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$10: (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) = (ConsistencyChecker.this.buildPartitionConfigs(): (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) @unchecked) match {
              case (_1: Int, _2: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])(Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])((count @ _), (partitions @ _)) =&gt; scala.Tuple2.apply[Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]](count, partitions)
            };
            val count: Int = x$10._1;
            val partitions: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata] = x$10._2;
            org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registering &quot;, &quot; missing metadata references...&quot;).s(count));
            partitions.foreach[Unit]({
              &lt;synthetic&gt; val eta$0$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
              ((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; eta$0$1.addPartition(partition))
            });
            org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
          }
        else
          ()
      }
    else
      {
        if (ConsistencyChecker.this.onDisk.isEmpty().unary_!)
          {
            &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, java.util.concurrent.ConcurrentHashMap[String,Boolean]](ConsistencyChecker.this.onDisk).asScala.toSeq.flatMap[String, Seq[String]](((x0$1: (String, java.util.concurrent.ConcurrentHashMap[String,Boolean])) =&gt; x0$1 match {
              case (_1: String, _2: java.util.concurrent.ConcurrentHashMap[String,Boolean])(String, java.util.concurrent.ConcurrentHashMap[String,Boolean])((partition @ _), (files @ _)) =&gt; scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.map[String, scala.collection.mutable.Iterable[String]](((x0$2: (String, Boolean)) =&gt; x0$2 match {
                case (_1: String, _2: Boolean)(String, Boolean)((f @ _), _) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;&quot;).s(partition, f)
              }))(mutable.this.Iterable.canBuildFrom[String])
            }))(collection.this.Seq.canBuildFrom[String]);
            org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; data files that do not have metadata entries:&quot;).s(strings.length));
            org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
          }
        else
          ();
        if (inconsistencies.nonEmpty)
          {
            &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = inconsistencies.toSeq.flatMap[String, Seq[String]](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
              case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((p @ _), (buf @ _)) =&gt; buf.map[String, scala.collection.mutable.ArrayBuffer[String]](((x0$2: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x0$2 match {
                case (file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, duplicate: Boolean)org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency((f @ _), (d @ _)) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;,&quot;, &quot;&quot;).s(p, if (d)
                  &quot;duplicate&quot;
                else
                  &quot;missing&quot;, f.name)
              }))(mutable.this.ArrayBuffer.canBuildFrom[String])
            }))(collection.this.Seq.canBuildFrom[String]);
            org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; metadata entries that do not correspond to a data file:&quot;).s(inconsistentCount));
            org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
          }
        else
          ()
      }
}
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          86024
        </td>
        <td>
          7273
          -
          7343
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.mutable.Map.empty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.mutable.Map.empty[String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]]
        </td>
      </tr><tr>
        <td>
          162
        </td>
        <td>
          86025
        </td>
        <td>
          7378
          -
          7379
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          165
        </td>
        <td>
          86027
        </td>
        <td>
          7464
          -
          7496
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.getPartitions
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          qual$1.getPartitions(x$1)
        </td>
      </tr><tr>
        <td>
          165
        </td>
        <td>
          86026
        </td>
        <td>
          7464
          -
          7480
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.FileSystemStorage.metadata
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.metadata
        </td>
      </tr><tr>
        <td>
          165
        </td>
        <td>
          86059
        </td>
        <td>
          7464
          -
          8568
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  &lt;artifact&gt; val qual$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
  &lt;artifact&gt; val x$1: Option[String] @scala.reflect.internal.annotations.uncheckedBounds = qual$1.getPartitions$default$1;
  qual$1.getPartitions(x$1)
}.foreach[Any](((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; if (ConsistencyChecker.this.partitions.forall(((x$8: Seq[String]) =&gt; x$8.contains[String](partition.name))))
  {
    val checked: scala.collection.mutable.Set[String] = scala.collection.mutable.Set.empty[String];
    val partitionOnDisk: java.util.concurrent.ConcurrentHashMap[String,Boolean] = ConsistencyChecker.this.onDisk.getOrDefault(partition.name, new java.util.concurrent.ConcurrentHashMap[String,Boolean]());
    partition.files.foreach[AnyVal](((file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile) =&gt; if (partitionOnDisk.remove(file.name))
      checked.add(file.name)
    else
      {
        val buf: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency] = inconsistencies.getOrElseUpdate(partition.name, scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]);
        val duplicate: Boolean = checked.add(file.name).unary_!;
        buf.+=(CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate));
        inconsistentCount = inconsistentCount.+(1)
      }));
    if (partitionOnDisk.isEmpty())
      ConsistencyChecker.this.onDisk.remove(partition.name)
    else
      ()
  }
else
  ()))
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          86029
        </td>
        <td>
          7554
          -
          7580
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.SeqLike.contains
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$8.contains[String](partition.name)
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          86028
        </td>
        <td>
          7565
          -
          7579
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.name
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          partition.name
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          86030
        </td>
        <td>
          7536
          -
          7581
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.forall
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.partitions.forall(((x$8: Seq[String]) =&gt; x$8.contains[String](partition.name)))
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          86057
        </td>
        <td>
          7532
          -
          7532
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          86056
        </td>
        <td>
          7583
          -
          8556
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val checked: scala.collection.mutable.Set[String] = scala.collection.mutable.Set.empty[String];
  val partitionOnDisk: java.util.concurrent.ConcurrentHashMap[String,Boolean] = ConsistencyChecker.this.onDisk.getOrDefault(partition.name, new java.util.concurrent.ConcurrentHashMap[String,Boolean]());
  partition.files.foreach[AnyVal](((file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile) =&gt; if (partitionOnDisk.remove(file.name))
    checked.add(file.name)
  else
    {
      val buf: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency] = inconsistencies.getOrElseUpdate(partition.name, scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]);
      val duplicate: Boolean = checked.add(file.name).unary_!;
      buf.+=(CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate));
      inconsistentCount = inconsistentCount.+(1)
    }));
  if (partitionOnDisk.isEmpty())
    ConsistencyChecker.this.onDisk.remove(partition.name)
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          86058
        </td>
        <td>
          7532
          -
          7532
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          86031
        </td>
        <td>
          7613
          -
          7655
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.mutable.Set.empty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.mutable.Set.empty[String]
        </td>
      </tr><tr>
        <td>
          168
        </td>
        <td>
          86033
        </td>
        <td>
          7728
          -
          7768
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.concurrent.ConcurrentHashMap[String,Boolean]()
        </td>
      </tr><tr>
        <td>
          168
        </td>
        <td>
          86032
        </td>
        <td>
          7712
          -
          7726
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.name
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partition.name
        </td>
      </tr><tr>
        <td>
          168
        </td>
        <td>
          86034
        </td>
        <td>
          7692
          -
          7769
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.getOrDefault
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.getOrDefault(partition.name, new java.util.concurrent.ConcurrentHashMap[String,Boolean]())
        </td>
      </tr><tr>
        <td>
          169
        </td>
        <td>
          86049
        </td>
        <td>
          7784
          -
          8435
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partition.files.foreach[AnyVal](((file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile) =&gt; if (partitionOnDisk.remove(file.name))
  checked.add(file.name)
else
  {
    val buf: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency] = inconsistencies.getOrElseUpdate(partition.name, scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]);
    val duplicate: Boolean = checked.add(file.name).unary_!;
    buf.+=(CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate));
    inconsistentCount = inconsistentCount.+(1)
  }))
        </td>
      </tr><tr>
        <td>
          170
        </td>
        <td>
          86035
        </td>
        <td>
          7861
          -
          7870
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.name
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          file.name
        </td>
      </tr><tr>
        <td>
          170
        </td>
        <td>
          86036
        </td>
        <td>
          7838
          -
          7871
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.remove
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partitionOnDisk.remove(file.name)
        </td>
      </tr><tr>
        <td>
          172
        </td>
        <td>
          86037
        </td>
        <td>
          7959
          -
          7968
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.name
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          file.name
        </td>
      </tr><tr>
        <td>
          172
        </td>
        <td>
          86039
        </td>
        <td>
          7947
          -
          7969
        </td>
        <td>
          Block
        </td>
        <td>
          scala.collection.mutable.SetLike.add
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          checked.add(file.name)
        </td>
      </tr><tr>
        <td>
          172
        </td>
        <td>
          86038
        </td>
        <td>
          7947
          -
          7969
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.SetLike.add
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          checked.add(file.name)
        </td>
      </tr><tr>
        <td>
          174
        </td>
        <td>
          86048
        </td>
        <td>
          8061
          -
          8419
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val buf: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency] = inconsistencies.getOrElseUpdate(partition.name, scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]);
  val duplicate: Boolean = checked.add(file.name).unary_!;
  buf.+=(CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate));
  inconsistentCount = inconsistentCount.+(1)
}
        </td>
      </tr><tr>
        <td>
          175
        </td>
        <td>
          86041
        </td>
        <td>
          8139
          -
          8156
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.generic.GenericCompanion.empty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency]
        </td>
      </tr><tr>
        <td>
          175
        </td>
        <td>
          86040
        </td>
        <td>
          8123
          -
          8137
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.name
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partition.name
        </td>
      </tr><tr>
        <td>
          175
        </td>
        <td>
          86042
        </td>
        <td>
          8091
          -
          8157
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.MapLike.getOrElseUpdate
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inconsistencies.getOrElseUpdate(partition.name, scala.collection.mutable.ArrayBuffer.empty[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])
        </td>
      </tr><tr>
        <td>
          177
        </td>
        <td>
          86043
        </td>
        <td>
          8294
          -
          8303
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.name
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          file.name
        </td>
      </tr><tr>
        <td>
          177
        </td>
        <td>
          86044
        </td>
        <td>
          8281
          -
          8304
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          checked.add(file.name).unary_!
        </td>
      </tr><tr>
        <td>
          178
        </td>
        <td>
          86045
        </td>
        <td>
          8330
          -
          8360
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate)
        </td>
      </tr><tr>
        <td>
          178
        </td>
        <td>
          86046
        </td>
        <td>
          8323
          -
          8360
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.ArrayBuffer.+=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          buf.+=(CheckConsistencyCommand.this.Inconsistency.apply(file, duplicate))
        </td>
      </tr><tr>
        <td>
          179
        </td>
        <td>
          86047
        </td>
        <td>
          8379
          -
          8401
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inconsistentCount.+(1)
        </td>
      </tr><tr>
        <td>
          182
        </td>
        <td>
          86050
        </td>
        <td>
          8454
          -
          8477
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.isEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partitionOnDisk.isEmpty()
        </td>
      </tr><tr>
        <td>
          182
        </td>
        <td>
          86055
        </td>
        <td>
          8450
          -
          8450
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          182
        </td>
        <td>
          86054
        </td>
        <td>
          8450
          -
          8450
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          183
        </td>
        <td>
          86051
        </td>
        <td>
          8511
          -
          8525
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.name
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partition.name
        </td>
      </tr><tr>
        <td>
          183
        </td>
        <td>
          86053
        </td>
        <td>
          8497
          -
          8526
        </td>
        <td>
          Block
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.remove
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.remove(partition.name)
        </td>
      </tr><tr>
        <td>
          183
        </td>
        <td>
          86052
        </td>
        <td>
          8497
          -
          8526
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.remove
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.remove(partition.name)
        </td>
      </tr><tr>
        <td>
          188
        </td>
        <td>
          86061
        </td>
        <td>
          8584
          -
          8625
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.isEmpty().&amp;&amp;(inconsistencies.isEmpty)
        </td>
      </tr><tr>
        <td>
          188
        </td>
        <td>
          86060
        </td>
        <td>
          8602
          -
          8625
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.MapLike.isEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          inconsistencies.isEmpty
        </td>
      </tr><tr>
        <td>
          189
        </td>
        <td>
          86063
        </td>
        <td>
          8641
          -
          8689
        </td>
        <td>
          Block
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;No inconsistencies detected&quot;)
        </td>
      </tr><tr>
        <td>
          189
        </td>
        <td>
          86062
        </td>
        <td>
          8641
          -
          8689
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;No inconsistencies detected&quot;)
        </td>
      </tr><tr>
        <td>
          190
        </td>
        <td>
          86064
        </td>
        <td>
          8711
          -
          8717
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.repair
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.repair
        </td>
      </tr><tr>
        <td>
          190
        </td>
        <td>
          86092
        </td>
        <td>
          8719
          -
          9492
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  if (inconsistencies.nonEmpty)
    {
      org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Removing &quot;, &quot; inconsistent metadata references...&quot;).s(inconsistentCount));
      inconsistencies.foreach[Unit](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
        case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((partition @ _), (files @ _)) =&gt; ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
      }));
      org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
    }
  else
    ();
  if (ConsistencyChecker.this.onDisk.isEmpty().unary_!)
    {
      &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$10: (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) = (ConsistencyChecker.this.buildPartitionConfigs(): (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) @unchecked) match {
        case (_1: Int, _2: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])(Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])((count @ _), (partitions @ _)) =&gt; scala.Tuple2.apply[Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]](count, partitions)
      };
      val count: Int = x$10._1;
      val partitions: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata] = x$10._2;
      org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registering &quot;, &quot; missing metadata references...&quot;).s(count));
      partitions.foreach[Unit]({
        &lt;synthetic&gt; val eta$0$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
        ((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; eta$0$1.addPartition(partition))
      });
      org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
    }
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          190
        </td>
        <td>
          86113
        </td>
        <td>
          8707
          -
          10387
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          if (ConsistencyChecker.this.repair)
  {
    if (inconsistencies.nonEmpty)
      {
        org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Removing &quot;, &quot; inconsistent metadata references...&quot;).s(inconsistentCount));
        inconsistencies.foreach[Unit](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
          case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((partition @ _), (files @ _)) =&gt; ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
        }));
        org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
      }
    else
      ();
    if (ConsistencyChecker.this.onDisk.isEmpty().unary_!)
      {
        &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$10: (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) = (ConsistencyChecker.this.buildPartitionConfigs(): (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) @unchecked) match {
          case (_1: Int, _2: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])(Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])((count @ _), (partitions @ _)) =&gt; scala.Tuple2.apply[Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]](count, partitions)
        };
        val count: Int = x$10._1;
        val partitions: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata] = x$10._2;
        org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registering &quot;, &quot; missing metadata references...&quot;).s(count));
        partitions.foreach[Unit]({
          &lt;synthetic&gt; val eta$0$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
          ((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; eta$0$1.addPartition(partition))
        });
        org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
      }
    else
      ()
  }
else
  {
    if (ConsistencyChecker.this.onDisk.isEmpty().unary_!)
      {
        &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, java.util.concurrent.ConcurrentHashMap[String,Boolean]](ConsistencyChecker.this.onDisk).asScala.toSeq.flatMap[String, Seq[String]](((x0$1: (String, java.util.concurrent.ConcurrentHashMap[String,Boolean])) =&gt; x0$1 match {
          case (_1: String, _2: java.util.concurrent.ConcurrentHashMap[String,Boolean])(String, java.util.concurrent.ConcurrentHashMap[String,Boolean])((partition @ _), (files @ _)) =&gt; scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.map[String, scala.collection.mutable.Iterable[String]](((x0$2: (String, Boolean)) =&gt; x0$2 match {
            case (_1: String, _2: Boolean)(String, Boolean)((f @ _), _) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;&quot;).s(partition, f)
          }))(mutable.this.Iterable.canBuildFrom[String])
        }))(collection.this.Seq.canBuildFrom[String]);
        org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; data files that do not have metadata entries:&quot;).s(strings.length));
        org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
      }
    else
      ();
    if (inconsistencies.nonEmpty)
      {
        &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = inconsistencies.toSeq.flatMap[String, Seq[String]](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
          case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((p @ _), (buf @ _)) =&gt; buf.map[String, scala.collection.mutable.ArrayBuffer[String]](((x0$2: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x0$2 match {
            case (file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, duplicate: Boolean)org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency((f @ _), (d @ _)) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;,&quot;, &quot;&quot;).s(p, if (d)
              &quot;duplicate&quot;
            else
              &quot;missing&quot;, f.name)
          }))(mutable.this.ArrayBuffer.canBuildFrom[String])
        }))(collection.this.Seq.canBuildFrom[String]);
        org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; metadata entries that do not correspond to a data file:&quot;).s(inconsistentCount));
        org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
      }
    else
      ()
  }
        </td>
      </tr><tr>
        <td>
          191
        </td>
        <td>
          86065
        </td>
        <td>
          8737
          -
          8761
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.TraversableOnce.nonEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inconsistencies.nonEmpty
        </td>
      </tr><tr>
        <td>
          191
        </td>
        <td>
          86079
        </td>
        <td>
          8733
          -
          8733
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          191
        </td>
        <td>
          86078
        </td>
        <td>
          8763
          -
          9115
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Removing &quot;, &quot; inconsistent metadata references...&quot;).s(inconsistentCount));
  inconsistencies.foreach[Unit](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
    case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((partition @ _), (files @ _)) =&gt; ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
  }));
  org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
}
        </td>
      </tr><tr>
        <td>
          191
        </td>
        <td>
          86080
        </td>
        <td>
          8733
          -
          8733
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          192
        </td>
        <td>
          86067
        </td>
        <td>
          8779
          -
          8864
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Removing &quot;, &quot; inconsistent metadata references...&quot;).s(inconsistentCount))
        </td>
      </tr><tr>
        <td>
          192
        </td>
        <td>
          86066
        </td>
        <td>
          8797
          -
          8863
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;Removing &quot;, &quot; inconsistent metadata references...&quot;).s(inconsistentCount)
        </td>
      </tr><tr>
        <td>
          193
        </td>
        <td>
          86076
        </td>
        <td>
          8879
          -
          9061
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inconsistencies.foreach[Unit](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
  case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((partition @ _), (files @ _)) =&gt; ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
}))
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86069
        </td>
        <td>
          9019
          -
          9019
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.mutable.ArrayBuffer.canBuildFrom
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86068
        </td>
        <td>
          9020
          -
          9026
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency.file
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$9.file
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86071
        </td>
        <td>
          9035
          -
          9039
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.None
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86070
        </td>
        <td>
          9010
          -
          9033
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.toSeq
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86073
        </td>
        <td>
          8981
          -
          9044
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L)
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86072
        </td>
        <td>
          9041
          -
          9043
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0L
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86075
        </td>
        <td>
          8948
          -
          9045
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.removePartition
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
        </td>
      </tr><tr>
        <td>
          194
        </td>
        <td>
          86074
        </td>
        <td>
          8948
          -
          9045
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.removePartition
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.metadata.removePartition(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, files.map[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]](((x$9: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x$9.file))(mutable.this.ArrayBuffer.canBuildFrom[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]).toSeq, scala.None, 0L))
        </td>
      </tr><tr>
        <td>
          196
        </td>
        <td>
          86077
        </td>
        <td>
          9076
          -
          9101
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          86081
        </td>
        <td>
          9132
          -
          9147
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.isEmpty().unary_!
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          86089
        </td>
        <td>
          9149
          -
          9418
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$10: (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) = (ConsistencyChecker.this.buildPartitionConfigs(): (Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]) @unchecked) match {
    case (_1: Int, _2: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])(Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata])((count @ _), (partitions @ _)) =&gt; scala.Tuple2.apply[Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]](count, partitions)
  };
  val count: Int = x$10._1;
  val partitions: Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata] = x$10._2;
  org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registering &quot;, &quot; missing metadata references...&quot;).s(count));
  partitions.foreach[Unit]({
    &lt;synthetic&gt; val eta$0$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
    ((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; eta$0$1.addPartition(partition))
  });
  org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
}
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          86091
        </td>
        <td>
          9128
          -
          9128
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          86090
        </td>
        <td>
          9128
          -
          9128
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          199
        </td>
        <td>
          86083
        </td>
        <td>
          9177
          -
          9177
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$10._2
        </td>
      </tr><tr>
        <td>
          199
        </td>
        <td>
          86082
        </td>
        <td>
          9170
          -
          9170
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$10._1
        </td>
      </tr><tr>
        <td>
          200
        </td>
        <td>
          86085
        </td>
        <td>
          9229
          -
          9300
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(scala.StringContext.apply(&quot;Registering &quot;, &quot; missing metadata references...&quot;).s(count))
        </td>
      </tr><tr>
        <td>
          200
        </td>
        <td>
          86084
        </td>
        <td>
          9247
          -
          9299
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;Registering &quot;, &quot; missing metadata references...&quot;).s(count)
        </td>
      </tr><tr>
        <td>
          201
        </td>
        <td>
          86087
        </td>
        <td>
          9315
          -
          9364
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partitions.foreach[Unit]({
  &lt;synthetic&gt; val eta$0$1: org.locationtech.geomesa.fs.storage.api.StorageMetadata = ConsistencyChecker.this.storage.metadata;
  ((partition: org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata) =&gt; eta$0$1.addPartition(partition))
})
        </td>
      </tr><tr>
        <td>
          201
        </td>
        <td>
          86086
        </td>
        <td>
          9334
          -
          9363
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.addPartition
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          eta$0$1.addPartition(partition)
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          86088
        </td>
        <td>
          9379
          -
          9404
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.tools.`package`.Command.user.info(&quot;Done&quot;)
        </td>
      </tr><tr>
        <td>
          205
        </td>
        <td>
          86112
        </td>
        <td>
          9498
          -
          10387
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  if (ConsistencyChecker.this.onDisk.isEmpty().unary_!)
    {
      &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, java.util.concurrent.ConcurrentHashMap[String,Boolean]](ConsistencyChecker.this.onDisk).asScala.toSeq.flatMap[String, Seq[String]](((x0$1: (String, java.util.concurrent.ConcurrentHashMap[String,Boolean])) =&gt; x0$1 match {
        case (_1: String, _2: java.util.concurrent.ConcurrentHashMap[String,Boolean])(String, java.util.concurrent.ConcurrentHashMap[String,Boolean])((partition @ _), (files @ _)) =&gt; scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.map[String, scala.collection.mutable.Iterable[String]](((x0$2: (String, Boolean)) =&gt; x0$2 match {
          case (_1: String, _2: Boolean)(String, Boolean)((f @ _), _) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;&quot;).s(partition, f)
        }))(mutable.this.Iterable.canBuildFrom[String])
      }))(collection.this.Seq.canBuildFrom[String]);
      org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; data files that do not have metadata entries:&quot;).s(strings.length));
      org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
    }
  else
    ();
  if (inconsistencies.nonEmpty)
    {
      &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = inconsistencies.toSeq.flatMap[String, Seq[String]](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
        case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((p @ _), (buf @ _)) =&gt; buf.map[String, scala.collection.mutable.ArrayBuffer[String]](((x0$2: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x0$2 match {
          case (file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, duplicate: Boolean)org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency((f @ _), (d @ _)) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;,&quot;, &quot;&quot;).s(p, if (d)
            &quot;duplicate&quot;
          else
            &quot;missing&quot;, f.name)
        }))(mutable.this.ArrayBuffer.canBuildFrom[String])
      }))(collection.this.Seq.canBuildFrom[String]);
      org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; metadata entries that do not correspond to a data file:&quot;).s(inconsistentCount));
      org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
    }
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          206
        </td>
        <td>
          86093
        </td>
        <td>
          9516
          -
          9531
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ConsistencyChecker.this.onDisk.isEmpty().unary_!
        </td>
      </tr><tr>
        <td>
          206
        </td>
        <td>
          86101
        </td>
        <td>
          9533
          -
          9908
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, java.util.concurrent.ConcurrentHashMap[String,Boolean]](ConsistencyChecker.this.onDisk).asScala.toSeq.flatMap[String, Seq[String]](((x0$1: (String, java.util.concurrent.ConcurrentHashMap[String,Boolean])) =&gt; x0$1 match {
    case (_1: String, _2: java.util.concurrent.ConcurrentHashMap[String,Boolean])(String, java.util.concurrent.ConcurrentHashMap[String,Boolean])((partition @ _), (files @ _)) =&gt; scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.map[String, scala.collection.mutable.Iterable[String]](((x0$2: (String, Boolean)) =&gt; x0$2 match {
      case (_1: String, _2: Boolean)(String, Boolean)((f @ _), _) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;&quot;).s(partition, f)
    }))(mutable.this.Iterable.canBuildFrom[String])
  }))(collection.this.Seq.canBuildFrom[String]);
  org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; data files that do not have metadata entries:&quot;).s(strings.length));
  org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
}
        </td>
      </tr><tr>
        <td>
          206
        </td>
        <td>
          86103
        </td>
        <td>
          9512
          -
          9512
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          206
        </td>
        <td>
          86102
        </td>
        <td>
          9512
          -
          9512
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          86095
        </td>
        <td>
          9769
          -
          9816
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot; data files that do not have metadata entries:&quot;
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          86094
        </td>
        <td>
          9746
          -
          9753
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Found &quot;
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          86097
        </td>
        <td>
          9744
          -
          9816
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Found &quot;, &quot; data files that do not have metadata entries:&quot;).s(strings.length)
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          86096
        </td>
        <td>
          9754
          -
          9768
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.length
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          strings.length
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          86098
        </td>
        <td>
          9726
          -
          9817
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.warn
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; data files that do not have metadata entries:&quot;).s(strings.length))
        </td>
      </tr><tr>
        <td>
          211
        </td>
        <td>
          86099
        </td>
        <td>
          9852
          -
          9893
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.TraversableOnce.mkString
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;)
        </td>
      </tr><tr>
        <td>
          211
        </td>
        <td>
          86100
        </td>
        <td>
          9832
          -
          9894
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
        </td>
      </tr><tr>
        <td>
          213
        </td>
        <td>
          86104
        </td>
        <td>
          9925
          -
          9949
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.TraversableOnce.nonEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          inconsistencies.nonEmpty
        </td>
      </tr><tr>
        <td>
          213
        </td>
        <td>
          86109
        </td>
        <td>
          9951
          -
          10375
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  &lt;stable&gt; &lt;accessor&gt; lazy val strings: Seq[String] = inconsistencies.toSeq.flatMap[String, Seq[String]](((x0$1: (String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])) =&gt; x0$1 match {
    case (_1: String, _2: scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])(String, scala.collection.mutable.ArrayBuffer[org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency])((p @ _), (buf @ _)) =&gt; buf.map[String, scala.collection.mutable.ArrayBuffer[String]](((x0$2: org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency) =&gt; x0$2 match {
      case (file: org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile, duplicate: Boolean)org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.Inconsistency((f @ _), (d @ _)) =&gt; scala.StringContext.apply(&quot;&quot;, &quot;,&quot;, &quot;,&quot;, &quot;&quot;).s(p, if (d)
        &quot;duplicate&quot;
      else
        &quot;missing&quot;, f.name)
    }))(mutable.this.ArrayBuffer.canBuildFrom[String])
  }))(collection.this.Seq.canBuildFrom[String]);
  org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; metadata entries that do not correspond to a data file:&quot;).s(inconsistentCount));
  org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
}
        </td>
      </tr><tr>
        <td>
          213
        </td>
        <td>
          86111
        </td>
        <td>
          9921
          -
          9921
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          213
        </td>
        <td>
          86110
        </td>
        <td>
          9921
          -
          9921
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          217
        </td>
        <td>
          86105
        </td>
        <td>
          10200
          -
          10283
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Found &quot;, &quot; metadata entries that do not correspond to a data file:&quot;).s(inconsistentCount)
        </td>
      </tr><tr>
        <td>
          217
        </td>
        <td>
          86106
        </td>
        <td>
          10182
          -
          10284
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.warn
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.user.warn(scala.StringContext.apply(&quot;Found &quot;, &quot; metadata entries that do not correspond to a data file:&quot;).s(inconsistentCount))
        </td>
      </tr><tr>
        <td>
          218
        </td>
        <td>
          86107
        </td>
        <td>
          10319
          -
          10360
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.TraversableOnce.mkString
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;)
        </td>
      </tr><tr>
        <td>
          218
        </td>
        <td>
          86108
        </td>
        <td>
          10299
          -
          10361
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.info
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.tools.`package`.Command.output.info(strings.sorted[String](math.this.Ordering.String).mkString(&quot;  &quot;, &quot;\n  &quot;, &quot;&quot;))
        </td>
      </tr><tr>
        <td>
          224
        </td>
        <td>
          86115
        </td>
        <td>
          10442
          -
          10457
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.utils.concurrent.CachedThreadPool.shutdown
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.pool.shutdown()
        </td>
      </tr><tr>
        <td>
          231
        </td>
        <td>
          86117
        </td>
        <td>
          10663
          -
          10714
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileContext.listStatus
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.context.fc.listStatus(ConsistencyChecker.this.storage.context.root)
        </td>
      </tr><tr>
        <td>
          231
        </td>
        <td>
          86116
        </td>
        <td>
          10693
          -
          10713
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.FileSystemContext.root
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.context.root
        </td>
      </tr><tr>
        <td>
          233
        </td>
        <td>
          86118
        </td>
        <td>
          10794
          -
          10807
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.concurrent.Phaser(2)
        </td>
      </tr><tr>
        <td>
          234
        </td>
        <td>
          86119
        </td>
        <td>
          10868
          -
          10904
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.TopLevelListWorker.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new ConsistencyChecker.this.TopLevelListWorker(phaser, iter)
        </td>
      </tr><tr>
        <td>
          234
        </td>
        <td>
          86120
        </td>
        <td>
          10856
          -
          10905
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.AbstractExecutorService.submit
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.TopLevelListWorker(phaser, iter))
        </td>
      </tr><tr>
        <td>
          236
        </td>
        <td>
          86121
        </td>
        <td>
          10998
          -
          11013
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.arrive
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          phaser.arrive()
        </td>
      </tr><tr>
        <td>
          236
        </td>
        <td>
          86123
        </td>
        <td>
          10997
          -
          10997
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          236
        </td>
        <td>
          86122
        </td>
        <td>
          10965
          -
          11014
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.awaitAdvanceInterruptibly
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          phaser.awaitAdvanceInterruptibly(phaser.arrive())
        </td>
      </tr><tr>
        <td>
          240
        </td>
        <td>
          86124
        </td>
        <td>
          11121
          -
          11122
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          241
        </td>
        <td>
          86125
        </td>
        <td>
          11148
          -
          11181
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.Seq.newBuilder
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.Seq.newBuilder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          86126
        </td>
        <td>
          11190
          -
          11196
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.onDisk
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          86139
        </td>
        <td>
          11239
          -
          11525
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val update: scala.collection.mutable.Builder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile,Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]] = scala.collection.Seq.newBuilder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile];
  scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.foreach[Unit](((x0$2: (String, Boolean)) =&gt; x0$2 match {
    case (_1: String, _2: Boolean)(String, Boolean)((name @ _), _) =&gt; {
      update.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(name, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5));
      count = count.+(1)
    }
  }));
  partitions.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, update.result(), scala.None, 0L))
}
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          86140
        </td>
        <td>
          11190
          -
          11535
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, java.util.concurrent.ConcurrentHashMap[String,Boolean]](ConsistencyChecker.this.onDisk).asScala.foreach[scala.collection.mutable.Builder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata,Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]]](((x0$1: (String, java.util.concurrent.ConcurrentHashMap[String,Boolean])) =&gt; x0$1 match {
  case (_1: String, _2: java.util.concurrent.ConcurrentHashMap[String,Boolean])(String, java.util.concurrent.ConcurrentHashMap[String,Boolean])((partition @ _), (files @ _)) =&gt; {
    val update: scala.collection.mutable.Builder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile,Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]] = scala.collection.Seq.newBuilder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile];
    scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.foreach[Unit](((x0$2: (String, Boolean)) =&gt; x0$2 match {
      case (_1: String, _2: Boolean)(String, Boolean)((name @ _), _) =&gt; {
        update.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(name, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5));
        count = count.+(1)
      }
    }));
    partitions.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, update.result(), scala.None, 0L))
  }
}))
        </td>
      </tr><tr>
        <td>
          243
        </td>
        <td>
          86127
        </td>
        <td>
          11265
          -
          11292
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.Seq.newBuilder
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.Seq.newBuilder[org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile]
        </td>
      </tr><tr>
        <td>
          244
        </td>
        <td>
          86133
        </td>
        <td>
          11303
          -
          11447
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.JavaConverters.mapAsScalaConcurrentMapConverter[String, Boolean](files).asScala.foreach[Unit](((x0$2: (String, Boolean)) =&gt; x0$2 match {
  case (_1: String, _2: Boolean)(String, Boolean)((name @ _), _) =&gt; {
    update.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(name, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5));
    count = count.+(1)
  }
}))
        </td>
      </tr><tr>
        <td>
          244
        </td>
        <td>
          86132
        </td>
        <td>
          11342
          -
          11435
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  update.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(name, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5));
  count = count.+(1)
}
        </td>
      </tr><tr>
        <td>
          245
        </td>
        <td>
          86129
        </td>
        <td>
          11367
          -
          11412
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(name, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5)
        </td>
      </tr><tr>
        <td>
          245
        </td>
        <td>
          86128
        </td>
        <td>
          11385
          -
          11411
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.System.currentTimeMillis
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.System.currentTimeMillis()
        </td>
      </tr><tr>
        <td>
          245
        </td>
        <td>
          86130
        </td>
        <td>
          11357
          -
          11412
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.Builder.+=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          update.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply(name, java.lang.System.currentTimeMillis(), org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$3, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$4, org.locationtech.geomesa.fs.storage.api.StorageMetadata.StorageFile.apply$default$5))
        </td>
      </tr><tr>
        <td>
          246
        </td>
        <td>
          86131
        </td>
        <td>
          11425
          -
          11435
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          count.+(1)
        </td>
      </tr><tr>
        <td>
          248
        </td>
        <td>
          86135
        </td>
        <td>
          11516
          -
          11520
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.None
        </td>
      </tr><tr>
        <td>
          248
        </td>
        <td>
          86134
        </td>
        <td>
          11501
          -
          11514
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.Builder.result
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          update.result()
        </td>
      </tr><tr>
        <td>
          248
        </td>
        <td>
          86137
        </td>
        <td>
          11472
          -
          11525
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, update.result(), scala.None, 0L)
        </td>
      </tr><tr>
        <td>
          248
        </td>
        <td>
          86136
        </td>
        <td>
          11522
          -
          11524
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0L
        </td>
      </tr><tr>
        <td>
          248
        </td>
        <td>
          86138
        </td>
        <td>
          11458
          -
          11525
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.Builder.+=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partitions.+=(org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata.apply(partition, update.result(), scala.None, 0L))
        </td>
      </tr><tr>
        <td>
          250
        </td>
        <td>
          86141
        </td>
        <td>
          11552
          -
          11569
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.Builder.result
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          partitions.result()
        </td>
      </tr><tr>
        <td>
          250
        </td>
        <td>
          86142
        </td>
        <td>
          11544
          -
          11570
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Tuple2.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Tuple2.apply[Int, Seq[org.locationtech.geomesa.fs.storage.api.StorageMetadata.PartitionMetadata]](count, partitions.result())
        </td>
      </tr><tr>
        <td>
          255
        </td>
        <td>
          86195
        </td>
        <td>
          11753
          -
          12749
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  var i: Int = TopLevelListWorker.this.phaser.getRegisteredParties().+(1);
  while$1(){
    if (TopLevelListWorker.this.list.hasNext().&amp;&amp;(i.&lt;(org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties)))
      {
        {
          val status: org.apache.hadoop.fs.FileStatus = TopLevelListWorker.this.list.next();
          val path: org.apache.hadoop.fs.Path = status.getPath();
          val name: String = path.getName();
          if (status.isDirectory())
            if (name.!=(org.locationtech.geomesa.fs.storage.common.metadata.FileBasedMetadataFactory.MetadataDirectory).&amp;&amp;(ConsistencyChecker.this.partitions.forall(((x$11: Seq[String]) =&gt; x$11.exists(((p: String) =&gt; p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)))))))))
              {
                i = i.+(1);
                ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), name, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
              }
            else
              ()
          else
            if (name.!=(org.locationtech.geomesa.fs.storage.common.metadata.MetadataJson.MetadataPath))
              ConsistencyChecker.this.onDisk.computeIfAbsent(&quot;&quot;, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
            else
              ()
        };
        while$1()
      }
    else
      ()
  };
  if (TopLevelListWorker.this.list.hasNext())
    {
      ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.TopLevelListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), TopLevelListWorker.this.list));
      ()
    }
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          256
        </td>
        <td>
          86143
        </td>
        <td>
          11761
          -
          11792
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          TopLevelListWorker.this.phaser.getRegisteredParties().+(1)
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86145
        </td>
        <td>
          11828
          -
          11854
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.&lt;(org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties)
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86144
        </td>
        <td>
          11832
          -
          11854
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.concurrent.PhaserUtils.MaxParties
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86146
        </td>
        <td>
          11812
          -
          11854
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          TopLevelListWorker.this.list.hasNext().&amp;&amp;(i.&lt;(org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties))
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86181
        </td>
        <td>
          11856
          -
          12624
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  {
    val status: org.apache.hadoop.fs.FileStatus = TopLevelListWorker.this.list.next();
    val path: org.apache.hadoop.fs.Path = status.getPath();
    val name: String = path.getName();
    if (status.isDirectory())
      if (name.!=(org.locationtech.geomesa.fs.storage.common.metadata.FileBasedMetadataFactory.MetadataDirectory).&amp;&amp;(ConsistencyChecker.this.partitions.forall(((x$11: Seq[String]) =&gt; x$11.exists(((p: String) =&gt; p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)))))))))
        {
          i = i.+(1);
          ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), name, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
        }
      else
        ()
    else
      if (name.!=(org.locationtech.geomesa.fs.storage.common.metadata.MetadataJson.MetadataPath))
        ConsistencyChecker.this.onDisk.computeIfAbsent(&quot;&quot;, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
      else
        ()
  };
  while$1()
}
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86180
        </td>
        <td>
          11856
          -
          11856
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.TopLevelListWorker.while$1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          while$1()
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86183
        </td>
        <td>
          11805
          -
          11805
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          86182
        </td>
        <td>
          11805
          -
          11805
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          258
        </td>
        <td>
          86147
        </td>
        <td>
          11885
          -
          11894
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.RemoteIterator.next
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          TopLevelListWorker.this.list.next()
        </td>
      </tr><tr>
        <td>
          259
        </td>
        <td>
          86148
        </td>
        <td>
          11920
          -
          11934
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileStatus.getPath
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          status.getPath()
        </td>
      </tr><tr>
        <td>
          260
        </td>
        <td>
          86149
        </td>
        <td>
          11960
          -
          11972
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.Path.getName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          path.getName()
        </td>
      </tr><tr>
        <td>
          261
        </td>
        <td>
          86150
        </td>
        <td>
          11991
          -
          12009
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileStatus.isDirectory
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          status.isDirectory()
        </td>
      </tr><tr>
        <td>
          262
        </td>
        <td>
          86151
        </td>
        <td>
          12041
          -
          12083
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.common.metadata.FileBasedMetadataFactory.MetadataDirectory
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.fs.storage.common.metadata.FileBasedMetadataFactory.MetadataDirectory
        </td>
      </tr><tr>
        <td>
          262
        </td>
        <td>
          86157
        </td>
        <td>
          12033
          -
          12177
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          name.!=(org.locationtech.geomesa.fs.storage.common.metadata.FileBasedMetadataFactory.MetadataDirectory).&amp;&amp;(ConsistencyChecker.this.partitions.forall(((x$11: Seq[String]) =&gt; x$11.exists(((p: String) =&gt; p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name))))))))
        </td>
      </tr><tr>
        <td>
          262
        </td>
        <td>
          86167
        </td>
        <td>
          12029
          -
          12029
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          262
        </td>
        <td>
          86166
        </td>
        <td>
          12029
          -
          12029
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          262
        </td>
        <td>
          86168
        </td>
        <td>
          12029
          -
          12438
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          if (name.!=(org.locationtech.geomesa.fs.storage.common.metadata.FileBasedMetadataFactory.MetadataDirectory).&amp;&amp;(ConsistencyChecker.this.partitions.forall(((x$11: Seq[String]) =&gt; x$11.exists(((p: String) =&gt; p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)))))))))
  {
    i = i.+(1);
    ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), name, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
  }
else
  ()
        </td>
      </tr><tr>
        <td>
          263
        </td>
        <td>
          86153
        </td>
        <td>
          12152
          -
          12175
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.startsWith
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name))
        </td>
      </tr><tr>
        <td>
          263
        </td>
        <td>
          86152
        </td>
        <td>
          12165
          -
          12174
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)
        </td>
      </tr><tr>
        <td>
          263
        </td>
        <td>
          86155
        </td>
        <td>
          12125
          -
          12176
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.exists
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$11.exists(((p: String) =&gt; p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)))))
        </td>
      </tr><tr>
        <td>
          263
        </td>
        <td>
          86154
        </td>
        <td>
          12139
          -
          12175
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.||
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)))
        </td>
      </tr><tr>
        <td>
          263
        </td>
        <td>
          86156
        </td>
        <td>
          12107
          -
          12177
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.forall
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.partitions.forall(((x$11: Seq[String]) =&gt; x$11.exists(((p: String) =&gt; p.==(name).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(name)))))))
        </td>
      </tr><tr>
        <td>
          263
        </td>
        <td>
          86165
        </td>
        <td>
          12179
          -
          12438
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  i = i.+(1);
  ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), name, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
}
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          86158
        </td>
        <td>
          12199
          -
          12205
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.+(1)
        </td>
      </tr><tr>
        <td>
          266
        </td>
        <td>
          86159
        </td>
        <td>
          12365
          -
          12371
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.TopLevelListWorker.phaser
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          TopLevelListWorker.this.phaser
        </td>
      </tr><tr>
        <td>
          266
        </td>
        <td>
          86161
        </td>
        <td>
          12354
          -
          12375
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1)
        </td>
      </tr><tr>
        <td>
          266
        </td>
        <td>
          86160
        </td>
        <td>
          12373
          -
          12374
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1
        </td>
      </tr><tr>
        <td>
          266
        </td>
        <td>
          86163
        </td>
        <td>
          12339
          -
          12419
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), name, ConsistencyChecker.this.storage.context.fc.listStatus(path))
        </td>
      </tr><tr>
        <td>
          266
        </td>
        <td>
          86162
        </td>
        <td>
          12383
          -
          12418
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileContext.listStatus
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.context.fc.listStatus(path)
        </td>
      </tr><tr>
        <td>
          266
        </td>
        <td>
          86164
        </td>
        <td>
          12327
          -
          12420
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.AbstractExecutorService.submit
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), name, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          86169
        </td>
        <td>
          12472
          -
          12497
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.common.metadata.MetadataJson.MetadataPath
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.fs.storage.common.metadata.MetadataJson.MetadataPath
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          86170
        </td>
        <td>
          12464
          -
          12497
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.!=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          name.!=(org.locationtech.geomesa.fs.storage.common.metadata.MetadataJson.MetadataPath)
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          86177
        </td>
        <td>
          12460
          -
          12460
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          86179
        </td>
        <td>
          12460
          -
          12610
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          if (name.!=(org.locationtech.geomesa.fs.storage.common.metadata.MetadataJson.MetadataPath))
  ConsistencyChecker.this.onDisk.computeIfAbsent(&quot;&quot;, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
else
  ()
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          86178
        </td>
        <td>
          12460
          -
          12460
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          86171
        </td>
        <td>
          12540
          -
          12542
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          86173
        </td>
        <td>
          12571
          -
          12593
        </td>
        <td>
          Select
        </td>
        <td>
          java.lang.Boolean.TRUE
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          java.lang.Boolean.TRUE
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          86172
        </td>
        <td>
          12544
          -
          12559
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.computeFunction
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ConsistencyChecker.this.computeFunction
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          86175
        </td>
        <td>
          12517
          -
          12594
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.put
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ConsistencyChecker.this.onDisk.computeIfAbsent(&quot;&quot;, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          86174
        </td>
        <td>
          12571
          -
          12593
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Boolean2boolean
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE)
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          86176
        </td>
        <td>
          12517
          -
          12594
        </td>
        <td>
          Block
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.put
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ConsistencyChecker.this.onDisk.computeIfAbsent(&quot;&quot;, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
        </td>
      </tr><tr>
        <td>
          272
        </td>
        <td>
          86184
        </td>
        <td>
          12641
          -
          12653
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.RemoteIterator.hasNext
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          TopLevelListWorker.this.list.hasNext()
        </td>
      </tr><tr>
        <td>
          272
        </td>
        <td>
          86193
        </td>
        <td>
          12637
          -
          12637
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          272
        </td>
        <td>
          86194
        </td>
        <td>
          12637
          -
          12637
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86185
        </td>
        <td>
          12717
          -
          12723
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.TopLevelListWorker.phaser
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          TopLevelListWorker.this.phaser
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86187
        </td>
        <td>
          12706
          -
          12727
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1)
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86186
        </td>
        <td>
          12725
          -
          12726
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          1
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86189
        </td>
        <td>
          12683
          -
          12734
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.TopLevelListWorker.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new ConsistencyChecker.this.TopLevelListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), TopLevelListWorker.this.list)
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86188
        </td>
        <td>
          12729
          -
          12733
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.TopLevelListWorker.list
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          TopLevelListWorker.this.list
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86191
        </td>
        <td>
          12682
          -
          12682
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86190
        </td>
        <td>
          12671
          -
          12735
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.AbstractExecutorService.submit
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.TopLevelListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), TopLevelListWorker.this.list))
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          86192
        </td>
        <td>
          12671
          -
          12735
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.TopLevelListWorker(new java.util.concurrent.Phaser(TopLevelListWorker.this.phaser, 1), TopLevelListWorker.this.list));
  ()
}
        </td>
      </tr><tr>
        <td>
          276
        </td>
        <td>
          86197
        </td>
        <td>
          12810
          -
          12810
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          276
        </td>
        <td>
          86196
        </td>
        <td>
          12784
          -
          12812
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.arriveAndDeregister
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          TopLevelListWorker.this.phaser.arriveAndDeregister()
        </td>
      </tr><tr>
        <td>
          276
        </td>
        <td>
          86198
        </td>
        <td>
          12784
          -
          12812
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  TopLevelListWorker.this.phaser.arriveAndDeregister();
  ()
}
        </td>
      </tr><tr>
        <td>
          284
        </td>
        <td>
          86264
        </td>
        <td>
          13050
          -
          14307
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  var i: Int = ListWorker.this.phaser.getRegisteredParties().+(1);
  val iter: org.apache.hadoop.fs.RemoteIterator[org.apache.hadoop.fs.FileStatus] = ListWorker.this.listDirectory;
  while$2(){
    if (iter.hasNext().&amp;&amp;(i.&lt;(org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties)))
      {
        {
          val status: org.apache.hadoop.fs.FileStatus = iter.next();
          val path: org.apache.hadoop.fs.Path = status.getPath();
          val name: String = path.getName();
          if (status.isDirectory())
            {
              val nextPartition: String = scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, name);
              if (ConsistencyChecker.this.partitions.forall(((x$12: Seq[String]) =&gt; x$12.exists(((p: String) =&gt; p.==(nextPartition).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition))))))))
                {
                  i = i.+(1);
                  ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), nextPartition, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
                }
              else
                ()
            }
          else
            {
              val leafPartition: String = if (ConsistencyChecker.this.storage.metadata.leafStorage)
                scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf(name))
              else
                ListWorker.this.partition;
              if (ConsistencyChecker.this.partitions.forall(((x$13: Seq[String]) =&gt; x$13.contains[String](leafPartition))))
                ConsistencyChecker.this.onDisk.computeIfAbsent(leafPartition, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
              else
                ()
            }
        };
        while$2()
      }
    else
      ()
  };
  if (iter.hasNext())
    {
      ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), ListWorker.this.partition, iter));
      ()
    }
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          285
        </td>
        <td>
          86199
        </td>
        <td>
          13058
          -
          13089
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ListWorker.this.phaser.getRegisteredParties().+(1)
        </td>
      </tr><tr>
        <td>
          286
        </td>
        <td>
          86200
        </td>
        <td>
          13113
          -
          13126
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.listDirectory
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ListWorker.this.listDirectory
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86201
        </td>
        <td>
          13166
          -
          13188
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.concurrent.PhaserUtils.MaxParties
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86203
        </td>
        <td>
          13146
          -
          13188
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          iter.hasNext().&amp;&amp;(i.&lt;(org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties))
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86202
        </td>
        <td>
          13162
          -
          13188
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.&lt;(org.locationtech.geomesa.utils.concurrent.`package`.PhaserUtils.MaxParties)
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86249
        </td>
        <td>
          13190
          -
          13190
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.while$2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          while$2()
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86251
        </td>
        <td>
          13139
          -
          13139
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86250
        </td>
        <td>
          13190
          -
          14179
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  {
    val status: org.apache.hadoop.fs.FileStatus = iter.next();
    val path: org.apache.hadoop.fs.Path = status.getPath();
    val name: String = path.getName();
    if (status.isDirectory())
      {
        val nextPartition: String = scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, name);
        if (ConsistencyChecker.this.partitions.forall(((x$12: Seq[String]) =&gt; x$12.exists(((p: String) =&gt; p.==(nextPartition).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition))))))))
          {
            i = i.+(1);
            ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), nextPartition, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
          }
        else
          ()
      }
    else
      {
        val leafPartition: String = if (ConsistencyChecker.this.storage.metadata.leafStorage)
          scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf(name))
        else
          ListWorker.this.partition;
        if (ConsistencyChecker.this.partitions.forall(((x$13: Seq[String]) =&gt; x$13.contains[String](leafPartition))))
          ConsistencyChecker.this.onDisk.computeIfAbsent(leafPartition, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
        else
          ()
      }
  };
  while$2()
}
        </td>
      </tr><tr>
        <td>
          287
        </td>
        <td>
          86252
        </td>
        <td>
          13139
          -
          13139
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          288
        </td>
        <td>
          86204
        </td>
        <td>
          13219
          -
          13228
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.RemoteIterator.next
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          iter.next()
        </td>
      </tr><tr>
        <td>
          289
        </td>
        <td>
          86205
        </td>
        <td>
          13254
          -
          13268
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileStatus.getPath
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          status.getPath()
        </td>
      </tr><tr>
        <td>
          290
        </td>
        <td>
          86206
        </td>
        <td>
          13294
          -
          13306
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.Path.getName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          path.getName()
        </td>
      </tr><tr>
        <td>
          291
        </td>
        <td>
          86207
        </td>
        <td>
          13325
          -
          13343
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileStatus.isDirectory
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          status.isDirectory()
        </td>
      </tr><tr>
        <td>
          291
        </td>
        <td>
          86228
        </td>
        <td>
          13345
          -
          13797
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val nextPartition: String = scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, name);
  if (ConsistencyChecker.this.partitions.forall(((x$12: Seq[String]) =&gt; x$12.exists(((p: String) =&gt; p.==(nextPartition).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition))))))))
    {
      i = i.+(1);
      ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), nextPartition, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
    }
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          86209
        </td>
        <td>
          13395
          -
          13397
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;/&quot;
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          86208
        </td>
        <td>
          13385
          -
          13386
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          86211
        </td>
        <td>
          13386
          -
          13395
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.partition
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ListWorker.this.partition
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          86210
        </td>
        <td>
          13401
          -
          13402
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          86212
        </td>
        <td>
          13383
          -
          13402
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, name)
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86213
        </td>
        <td>
          13490
          -
          13508
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition)
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86215
        </td>
        <td>
          13455
          -
          13509
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.||
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          p.==(nextPartition).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition)))
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86214
        </td>
        <td>
          13477
          -
          13509
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.startsWith
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition))
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86217
        </td>
        <td>
          13423
          -
          13511
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.forall
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.partitions.forall(((x$12: Seq[String]) =&gt; x$12.exists(((p: String) =&gt; p.==(nextPartition).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition)))))))
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86216
        </td>
        <td>
          13441
          -
          13510
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.exists
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$12.exists(((p: String) =&gt; p.==(nextPartition).||(p.startsWith(scala.StringContext.apply(&quot;&quot;, &quot;/&quot;).s(nextPartition)))))
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86225
        </td>
        <td>
          13513
          -
          13781
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  i = i.+(1);
  ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), nextPartition, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
}
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86227
        </td>
        <td>
          13419
          -
          13419
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          86226
        </td>
        <td>
          13419
          -
          13419
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          294
        </td>
        <td>
          86218
        </td>
        <td>
          13533
          -
          13539
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.+(1)
        </td>
      </tr><tr>
        <td>
          296
        </td>
        <td>
          86219
        </td>
        <td>
          13699
          -
          13705
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.phaser
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ListWorker.this.phaser
        </td>
      </tr><tr>
        <td>
          296
        </td>
        <td>
          86221
        </td>
        <td>
          13688
          -
          13709
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.concurrent.Phaser(ListWorker.this.phaser, 1)
        </td>
      </tr><tr>
        <td>
          296
        </td>
        <td>
          86220
        </td>
        <td>
          13707
          -
          13708
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1
        </td>
      </tr><tr>
        <td>
          296
        </td>
        <td>
          86223
        </td>
        <td>
          13673
          -
          13762
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), nextPartition, ConsistencyChecker.this.storage.context.fc.listStatus(path))
        </td>
      </tr><tr>
        <td>
          296
        </td>
        <td>
          86222
        </td>
        <td>
          13726
          -
          13761
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.FileContext.listStatus
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.context.fc.listStatus(path)
        </td>
      </tr><tr>
        <td>
          296
        </td>
        <td>
          86224
        </td>
        <td>
          13661
          -
          13763
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.AbstractExecutorService.submit
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), nextPartition, ConsistencyChecker.this.storage.context.fc.listStatus(path)))
        </td>
      </tr><tr>
        <td>
          298
        </td>
        <td>
          86248
        </td>
        <td>
          13803
          -
          14165
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val leafPartition: String = if (ConsistencyChecker.this.storage.metadata.leafStorage)
    scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf(name))
  else
    ListWorker.this.partition;
  if (ConsistencyChecker.this.partitions.forall(((x$13: Seq[String]) =&gt; x$13.contains[String](leafPartition))))
    ConsistencyChecker.this.onDisk.computeIfAbsent(leafPartition, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86229
        </td>
        <td>
          13863
          -
          13891
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.api.StorageMetadata.leafStorage
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.storage.metadata.leafStorage
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86231
        </td>
        <td>
          13907
          -
          13909
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;/&quot;
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86230
        </td>
        <td>
          13897
          -
          13898
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86233
        </td>
        <td>
          13898
          -
          13907
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.partition
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ListWorker.this.partition
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86232
        </td>
        <td>
          13934
          -
          13935
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86235
        </td>
        <td>
          13895
          -
          13935
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf(name))
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86234
        </td>
        <td>
          13910
          -
          13933
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf(name)
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86237
        </td>
        <td>
          13945
          -
          13954
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ListWorker.this.partition
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86236
        </td>
        <td>
          13895
          -
          13935
        </td>
        <td>
          Block
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;&quot;, &quot;/&quot;, &quot;&quot;).s(ListWorker.this.partition, org.locationtech.geomesa.fs.storage.common.utils.StorageUtils.leaf(name))
        </td>
      </tr><tr>
        <td>
          300
        </td>
        <td>
          86238
        </td>
        <td>
          13945
          -
          13954
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ListWorker.this.partition
        </td>
      </tr><tr>
        <td>
          301
        </td>
        <td>
          86239
        </td>
        <td>
          13995
          -
          14020
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.SeqLike.contains
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$13.contains[String](leafPartition)
        </td>
      </tr><tr>
        <td>
          301
        </td>
        <td>
          86240
        </td>
        <td>
          13977
          -
          14021
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.forall
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.partitions.forall(((x$13: Seq[String]) =&gt; x$13.contains[String](leafPartition)))
        </td>
      </tr><tr>
        <td>
          301
        </td>
        <td>
          86247
        </td>
        <td>
          13973
          -
          13973
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          301
        </td>
        <td>
          86246
        </td>
        <td>
          13973
          -
          13973
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          302
        </td>
        <td>
          86241
        </td>
        <td>
          14081
          -
          14096
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.computeFunction
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.computeFunction
        </td>
      </tr><tr>
        <td>
          302
        </td>
        <td>
          86243
        </td>
        <td>
          14108
          -
          14130
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.Boolean2boolean
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE)
        </td>
      </tr><tr>
        <td>
          302
        </td>
        <td>
          86242
        </td>
        <td>
          14108
          -
          14130
        </td>
        <td>
          Select
        </td>
        <td>
          java.lang.Boolean.TRUE
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Boolean.TRUE
        </td>
      </tr><tr>
        <td>
          302
        </td>
        <td>
          86245
        </td>
        <td>
          14043
          -
          14131
        </td>
        <td>
          Block
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.put
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.computeIfAbsent(leafPartition, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
        </td>
      </tr><tr>
        <td>
          302
        </td>
        <td>
          86244
        </td>
        <td>
          14043
          -
          14131
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ConcurrentHashMap.put
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ConsistencyChecker.this.onDisk.computeIfAbsent(leafPartition, ConsistencyChecker.this.computeFunction).put(name, scala.Predef.Boolean2boolean(java.lang.Boolean.TRUE))
        </td>
      </tr><tr>
        <td>
          306
        </td>
        <td>
          86253
        </td>
        <td>
          14196
          -
          14208
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.hadoop.fs.RemoteIterator.hasNext
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          iter.hasNext()
        </td>
      </tr><tr>
        <td>
          306
        </td>
        <td>
          86263
        </td>
        <td>
          14192
          -
          14192
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          306
        </td>
        <td>
          86262
        </td>
        <td>
          14192
          -
          14192
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86255
        </td>
        <td>
          14272
          -
          14273
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          1
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86254
        </td>
        <td>
          14264
          -
          14270
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.phaser
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ListWorker.this.phaser
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86257
        </td>
        <td>
          14276
          -
          14285
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.partition
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ListWorker.this.partition
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86256
        </td>
        <td>
          14253
          -
          14274
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new java.util.concurrent.Phaser(ListWorker.this.phaser, 1)
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86259
        </td>
        <td>
          14226
          -
          14293
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.AbstractExecutorService.submit
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), ListWorker.this.partition, iter))
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86258
        </td>
        <td>
          14238
          -
          14292
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.fs.tools.ingest.FsManageMetadataCommand.CheckConsistencyCommand.ConsistencyChecker.ListWorker.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), ListWorker.this.partition, iter)
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86261
        </td>
        <td>
          14226
          -
          14293
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  ConsistencyChecker.this.pool.submit(new ConsistencyChecker.this.ListWorker(new java.util.concurrent.Phaser(ListWorker.this.phaser, 1), ListWorker.this.partition, iter));
  ()
}
        </td>
      </tr><tr>
        <td>
          307
        </td>
        <td>
          86260
        </td>
        <td>
          14237
          -
          14237
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          310
        </td>
        <td>
          86265
        </td>
        <td>
          14370
          -
          14372
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          310
        </td>
        <td>
          86266
        </td>
        <td>
          14370
          -
          14372
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          311
        </td>
        <td>
          86267
        </td>
        <td>
          14453
          -
          14506
        </td>
        <td>
          Typed
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          (if (ConsistencyChecker.this.logger.underlying.isErrorEnabled())
  ConsistencyChecker.this.logger.underlying.error(&quot;Error scanning metadata directory:&quot;, e)
else
  (): Unit)
        </td>
      </tr><tr>
        <td>
          313
        </td>
        <td>
          86269
        </td>
        <td>
          14567
          -
          14567
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          313
        </td>
        <td>
          86268
        </td>
        <td>
          14541
          -
          14569
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Phaser.arriveAndDeregister
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ListWorker.this.phaser.arriveAndDeregister()
        </td>
      </tr><tr>
        <td>
          313
        </td>
        <td>
          86270
        </td>
        <td>
          14541
          -
          14569
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  ListWorker.this.phaser.arriveAndDeregister();
  ()
}
        </td>
      </tr><tr>
        <td>
          328
        </td>
        <td>
          86271
        </td>
        <td>
          15117
          -
          15118
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.int2Integer
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.int2Integer(4)
        </td>
      </tr><tr>
        <td>
          337
        </td>
        <td>
          86272
        </td>
        <td>
          15633
          -
          15661
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.ArrayList.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.ArrayList[String]()
        </td>
      </tr><tr>
        <td>
          352
        </td>
        <td>
          86273
        </td>
        <td>
          16598
          -
          16626
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.ArrayList.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.ArrayList[String]()
        </td>
      </tr><tr>
        <td>
          363
        </td>
        <td>
          86274
        </td>
        <td>
          17153
          -
          17158
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.boolean2Boolean
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.boolean2Boolean(false)
        </td>
      </tr><tr>
        <td>
          366
        </td>
        <td>
          86275
        </td>
        <td>
          17306
          -
          17311
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.boolean2Boolean
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.boolean2Boolean(false)
        </td>
      </tr><tr>
        <td>
          376
        </td>
        <td>
          86276
        </td>
        <td>
          17687
          -
          17688
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.int2Integer
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.int2Integer(4)
        </td>
      </tr><tr>
        <td>
          381
        </td>
        <td>
          86282
        </td>
        <td>
          17894
          -
          18000
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$15: (Double, Double, Double, Double) = (scala.Predef.refArrayOps[String](value.split(&quot;,&quot;)).map[Double, Array[Double]](((x$14: String) =&gt; scala.Predef.augmentString(x$14.trim()).toDouble))(scala.this.Array.canBuildFrom[Double]((ClassTag.Double: scala.reflect.ClassTag[Double]))): Array[Double] @unchecked) match {
    case scala.Array.unapplySeq[Double](&lt;unapply-selector&gt;) &lt;unapply&gt; ((xmin @ _), (ymin @ _), (xmax @ _), (ymax @ _)) =&gt; scala.Tuple4.apply[Double, Double, Double, Double](xmin, ymin, xmax, ymax)
  };
  val xmin: Double = x$15._1;
  val ymin: Double = x$15._2;
  val xmax: Double = x$15._3;
  val ymax: Double = x$15._4;
  scala.Tuple4.apply[Double, Double, Double, Double](xmin, ymin, xmax, ymax)
}
        </td>
      </tr><tr>
        <td>
          382
        </td>
        <td>
          86277
        </td>
        <td>
          17904
          -
          17904
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple4._1
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$15._1
        </td>
      </tr><tr>
        <td>
          382
        </td>
        <td>
          86279
        </td>
        <td>
          17916
          -
          17916
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple4._3
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$15._3
        </td>
      </tr><tr>
        <td>
          382
        </td>
        <td>
          86278
        </td>
        <td>
          17910
          -
          17910
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple4._2
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$15._2
        </td>
      </tr><tr>
        <td>
          382
        </td>
        <td>
          86280
        </td>
        <td>
          17922
          -
          17922
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple4._4
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$15._4
        </td>
      </tr><tr>
        <td>
          383
        </td>
        <td>
          86281
        </td>
        <td>
          17976
          -
          18000
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Tuple4.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Tuple4.apply[Double, Double, Double, Double](xmin, ymin, xmax, ymax)
        </td>
      </tr><tr>
        <td>
          385
        </td>
        <td>
          86283
        </td>
        <td>
          18045
          -
          18111
        </td>
        <td>
          Throw
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          throw new com.beust.jcommander.ParameterException(BoundsConverter.this.getErrorString(value, scala.StringContext.apply(&quot;format: &quot;, &quot;&quot;).s(e)))
        </td>
      </tr><tr>
        <td>
          385
        </td>
        <td>
          86284
        </td>
        <td>
          18045
          -
          18111
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          throw new com.beust.jcommander.ParameterException(BoundsConverter.this.getErrorString(value, scala.StringContext.apply(&quot;format: &quot;, &quot;&quot;).s(e)))
        </td>
      </tr>
    </table>
          </div>
        </div>
      </body>
    </html>