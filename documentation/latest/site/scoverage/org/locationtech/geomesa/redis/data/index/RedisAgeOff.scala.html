<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title id="title">
          org/locationtech/geomesa/redis/data/index/RedisAgeOff.scala.html
        </title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/css/theme.default.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/js/jquery.tablesorter.min.js"></script><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" type="text/css"/><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script><script type="text/javascript">
        $(document).ready(function() {$(".tablesorter").tablesorter();});
      </script>
        <style>
          table.codegrid { font-family: monospace; font-size: 12px; width: auto!important; }table.statementlist { width: auto!important; font-size: 13px; } table.codegrid td { padding: 0!important; border: 0!important } table td.linenumber { width: 40px!important; } 
        </style>
      </head>
      <body style="font-family: monospace;">
        <ul class="nav nav-tabs">
          <li>
            <a href="#codegrid" data-toggle="tab">Codegrid</a>
          </li>
          <li>
            <a href="#statementlist" data-toggle="tab">Statement List</a>
          </li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="codegrid">
            <pre style='font-size: 12pt; font-family: courier, monospace;'>1 <span style=''>/***********************************************************************
</span>2 <span style=''> * Copyright (c) 2013-2025 General Atomics Integrated Intelligence, Inc.
</span>3 <span style=''> * All rights reserved. This program and the accompanying materials
</span>4 <span style=''> * are made available under the terms of the Apache License, Version 2.0
</span>5 <span style=''> * which accompanies this distribution and is available at
</span>6 <span style=''> * http://www.opensource.org/licenses/apache2.0.php.
</span>7 <span style=''> ***********************************************************************/
</span>8 <span style=''>
</span>9 <span style=''>package org.locationtech.geomesa.redis.data.index
</span>10 <span style=''>
</span>11 <span style=''>import com.typesafe.scalalogging.StrictLogging
</span>12 <span style=''>import org.geotools.api.data.Transaction
</span>13 <span style=''>import org.geotools.api.feature.simple.SimpleFeatureType
</span>14 <span style=''>import org.geotools.api.filter.identity.Identifier
</span>15 <span style=''>import org.locationtech.geomesa.filter.FilterHelper
</span>16 <span style=''>import org.locationtech.geomesa.redis.data.index.RedisAgeOff.{AgeOffExecutor, AgeOffWriter}
</span>17 <span style=''>import org.locationtech.geomesa.redis.data.util.RedisLocking
</span>18 <span style=''>import org.locationtech.geomesa.redis.data.{CloseableJedisCommands, RedisDataStore, RedisSystemProperties}
</span>19 <span style=''>import org.locationtech.geomesa.utils.conf.GeoMesaSystemProperties.SystemProperty
</span>20 <span style=''>import org.locationtech.geomesa.utils.io.WithClose
</span>21 <span style=''>import redis.clients.jedis.{Jedis, UnifiedJedis}
</span>22 <span style=''>import redis.clients.jedis.params.ZAddParams
</span>23 <span style=''>import redis.clients.jedis.util.Pool
</span>24 <span style=''>
</span>25 <span style=''>import java.io.{Closeable, Flushable}
</span>26 <span style=''>import java.nio.charset.StandardCharsets
</span>27 <span style=''>import java.util.Collections
</span>28 <span style=''>import java.util.concurrent.{Executors, ScheduledFuture, TimeUnit}
</span>29 <span style=''>import scala.collection.mutable.{ArrayBuffer, ListBuffer}
</span>30 <span style=''>import scala.concurrent.duration.Duration
</span>31 <span style=''>import scala.util.control.NonFatal
</span>32 <span style=''>
</span>33 <span style=''>/**
</span>34 <span style=''>  * Tracks and deletes features based on a time-to-live.
</span>35 <span style=''>  *
</span>36 <span style=''>  * TTLs are stored in a separate sorted set for each feature type, with the score of the set being the
</span>37 <span style=''>  * system time in millis when the feature should be expired. We do a two-step process to expire features:
</span>38 <span style=''>  *
</span>39 <span style=''>  * 1. Scan and remove the TTL set by score range, which will return all the feature IDs for expired features
</span>40 <span style=''>  * 2. Remove the features from the index tables based on the feature ID
</span>41 <span style=''>  *
</span>42 <span style=''>  * @param ds data store
</span>43 <span style=''>  */
</span>44 <span style=''>class RedisAgeOff(ds: RedisDataStore) extends Closeable {
</span>45 <span style=''>
</span>46 <span style=''>  import RedisAgeOff.key
</span>47 <span style=''>  import org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType
</span>48 <span style=''>
</span>49 <span style=''>  private val executor = </span><span style='background: #AEF1AE'>RedisSystemProperties.AgeOffInterval.toDuration.collect {
</span>50 <span style=''></span><span style='background: #AEF1AE'>    case i if i.isFinite =&gt; new AgeOffExecutor(ds, i)
</span>51 <span style=''></span><span style='background: #AEF1AE'>  }</span><span style=''>
</span>52 <span style=''>
</span>53 <span style=''>  /**
</span>54 <span style=''>    * Start the age-off for a feature type
</span>55 <span style=''>    *
</span>56 <span style=''>    * @param sft simple feature type
</span>57 <span style=''>    */
</span>58 <span style=''>  def add(sft: SimpleFeatureType): Unit = {
</span>59 <span style=''>    if (</span><span style='background: #AEF1AE'>sft.isFeatureExpirationEnabled</span><span style=''>) {
</span>60 <span style=''>      </span><span style='background: #AEF1AE'>executor.foreach(_.schedule(sft.getTypeName))</span><span style=''>
</span>61 <span style=''>    }
</span>62 <span style=''>  }
</span>63 <span style=''>
</span>64 <span style=''>  /**
</span>65 <span style=''>    * Update the age-off for a modified feature type
</span>66 <span style=''>    *
</span>67 <span style=''>    * @param sft modified simple feature type
</span>68 <span style=''>    * @param previous previous simple feature type
</span>69 <span style=''>    */
</span>70 <span style=''>  def update(sft: SimpleFeatureType, previous: SimpleFeatureType): Unit = {
</span>71 <span style=''>    if (</span><span style='background: #F0ADAD'>previous.isFeatureExpirationEnabled</span><span style=''>) {
</span>72 <span style=''>      </span><span style='background: #F0ADAD'>if (!sft.isFeatureExpirationEnabled) {
</span>73 <span style=''></span><span style='background: #F0ADAD'>        remove(previous)
</span>74 <span style=''></span><span style='background: #F0ADAD'>      } else if (sft.getTypeName != previous.getTypeName) {
</span>75 <span style=''></span><span style='background: #F0ADAD'>        executor.foreach(_.cancel(previous.getTypeName))
</span>76 <span style=''></span><span style='background: #F0ADAD'>        // rename the ttl table to match the new type name
</span>77 <span style=''></span><span style='background: #F0ADAD'>        WithClose(ds.connection.getResource)(_.renamenx(key(ds, previous.getTypeName), key(ds, sft.getTypeName)))
</span>78 <span style=''></span><span style='background: #F0ADAD'>        executor.foreach(_.schedule(sft.getTypeName))
</span>79 <span style=''></span><span style='background: #F0ADAD'>      }</span><span style=''>
</span>80 <span style=''>    } else </span><span style='background: #F0ADAD'>if (sft.isFeatureExpirationEnabled) {
</span>81 <span style=''></span><span style='background: #F0ADAD'>      executor.foreach(_.schedule(sft.getTypeName))
</span>82 <span style=''></span><span style='background: #F0ADAD'>    }</span><span style=''>
</span>83 <span style=''>  }
</span>84 <span style=''>
</span>85 <span style=''>  /**
</span>86 <span style=''>    * Remove the age-off for a feature type
</span>87 <span style=''>    *
</span>88 <span style=''>    * @param sft simple feature type
</span>89 <span style=''>    */
</span>90 <span style=''>  def remove(sft: SimpleFeatureType): Unit = {
</span>91 <span style=''>    if (</span><span style='background: #AEF1AE'>sft.isFeatureExpirationEnabled</span><span style=''>) </span><span style='background: #AEF1AE'>{
</span>92 <span style=''></span><span style='background: #AEF1AE'>      executor.foreach(_.cancel(sft.getTypeName))
</span>93 <span style=''></span><span style='background: #AEF1AE'>      WithClose(ds.connection.getResource)(_.del(key(ds, sft.getTypeName)))
</span>94 <span style=''></span><span style='background: #AEF1AE'>    }</span><span style=''>
</span>95 <span style=''>  }
</span>96 <span style=''>
</span>97 <span style=''>  /**
</span>98 <span style=''>    * Gets a writer to track ttl for features
</span>99 <span style=''>    *
</span>100 <span style=''>    * @param sft simple feature type
</span>101 <span style=''>    * @return
</span>102 <span style=''>    */
</span>103 <span style=''>  def writer(sft: SimpleFeatureType): Option[AgeOffWriter] = {
</span>104 <span style=''>    if (</span><span style='background: #AEF1AE'>sft.isFeatureExpirationEnabled</span><span style=''>) {
</span>105 <span style=''>      </span><span style='background: #AEF1AE'>Some(new AgeOffWriter(ds.connection, key(ds, sft.getTypeName)))</span><span style=''>
</span>106 <span style=''>    } else {
</span>107 <span style=''>      </span><span style='background: #AEF1AE'>None</span><span style=''>
</span>108 <span style=''>    }
</span>109 <span style=''>  }
</span>110 <span style=''>
</span>111 <span style=''>  override def close(): Unit = </span><span style='background: #AEF1AE'>executor.foreach(_.close())</span><span style=''>
</span>112 <span style=''>}
</span>113 <span style=''>
</span>114 <span style=''>object RedisAgeOff extends StrictLogging {
</span>115 <span style=''>
</span>116 <span style=''>  import redis.clients.jedis.resps.{Tuple =&gt; JedisTuple}
</span>117 <span style=''>
</span>118 <span style=''>  val TtlUserDataKey = </span><span style='background: #AEF1AE'>&quot;t&quot;</span><span style=''> // the user data is cleared, so no chance of key collision - save space with a short key
</span>119 <span style=''>
</span>120 <span style=''>  val AgeOffLockTimeout: SystemProperty = </span><span style='background: #AEF1AE'>SystemProperty(&quot;geomesa.redis.age.off.lock.timeout&quot;, &quot;1 second&quot;)</span><span style=''>
</span>121 <span style=''>
</span>122 <span style=''>  /**
</span>123 <span style=''>    * Initialize the age-off for the data store
</span>124 <span style=''>    *
</span>125 <span style=''>    * @param ds data store
</span>126 <span style=''>    */
</span>127 <span style=''>  def init(ds: RedisDataStore): Unit = </span><span style='background: #AEF1AE'>ds.getTypeNames.foreach(n =&gt; ds.aging.add(ds.getSchema(n)))</span><span style=''>
</span>128 <span style=''>
</span>129 <span style=''>  /**
</span>130 <span style=''>    * Key of the Redis SortedSet containing the ttl for the given feature type
</span>131 <span style=''>    *
</span>132 <span style=''>    * @param ds data store
</span>133 <span style=''>    * @param typeName simple feature type name
</span>134 <span style=''>    * @return
</span>135 <span style=''>    */
</span>136 <span style=''>  private def key(ds: RedisDataStore, typeName: String): Array[Byte] =
</span>137 <span style=''>    </span><span style='background: #AEF1AE'>s&quot;${ds.config.catalog}_${typeName}_ttl&quot;.getBytes(StandardCharsets.UTF_8)</span><span style=''>
</span>138 <span style=''>
</span>139 <span style=''>  /**
</span>140 <span style=''>    * Writes time-to-lives for new features
</span>141 <span style=''>    *
</span>142 <span style=''>    * @param connection jedis connection
</span>143 <span style=''>    * @param table ttl table for the feature type
</span>144 <span style=''>    */
</span>145 <span style=''>  class AgeOffWriter(connection: Pool[_ &lt;: CloseableJedisCommands], table: Array[Byte]) extends Closeable with Flushable {
</span>146 <span style=''>
</span>147 <span style=''>    private val writes = </span><span style='background: #AEF1AE'>new java.util.HashMap[Array[Byte], java.lang.Double]</span><span style=''>
</span>148 <span style=''>    private val deletes = </span><span style='background: #AEF1AE'>ArrayBuffer.empty[Array[Byte]]</span><span style=''>
</span>149 <span style=''>
</span>150 <span style=''>    // note: the regular feature ids have the length pre-pended as a 2-byte short, so use the raw id instead
</span>151 <span style=''>    def write(feature: RedisWritableFeature): Unit = </span><span style='background: #AEF1AE'>writes.put(feature.rawId, feature.ttl)</span><span style=''>
</span>152 <span style=''>    def delete(feature: RedisWritableFeature): Unit = </span><span style='background: #AEF1AE'>deletes += feature.rawId</span><span style=''>
</span>153 <span style=''>
</span>154 <span style=''>    override def flush(): Unit = {
</span>155 <span style=''>      if (</span><span style='background: #AEF1AE'>!writes.isEmpty || deletes.nonEmpty</span><span style=''>) {
</span>156 <span style=''>        </span><span style='background: #AEF1AE'>try {
</span>157 <span style=''></span><span style='background: #AEF1AE'>          WithClose(connection.getResource) { jedis =&gt;
</span>158 <span style=''></span><span style='background: #AEF1AE'>            if (deletes.nonEmpty) {
</span>159 <span style=''></span><span style='background: #AEF1AE'>              jedis.zrem(table, deletes.toSeq: _*)
</span>160 <span style=''></span><span style='background: #AEF1AE'>            }
</span>161 <span style=''></span><span style='background: #AEF1AE'>            if (!writes.isEmpty) {
</span>162 <span style=''></span><span style='background: #AEF1AE'>              jedis.zadd(table, writes)
</span>163 <span style=''></span><span style='background: #AEF1AE'>            }
</span>164 <span style=''></span><span style='background: #AEF1AE'>          }
</span>165 <span style=''></span><span style='background: #AEF1AE'>        } finally {
</span>166 <span style=''></span><span style='background: #AEF1AE'>          writes.clear()
</span>167 <span style=''></span><span style='background: #AEF1AE'>          deletes.clear()
</span>168 <span style=''></span><span style='background: #AEF1AE'>        }</span><span style=''>
</span>169 <span style=''>      }
</span>170 <span style=''>    }
</span>171 <span style=''>
</span>172 <span style=''>    override def close(): Unit = </span><span style='background: #AEF1AE'>flush()</span><span style=''>
</span>173 <span style=''>  }
</span>174 <span style=''>
</span>175 <span style=''>  /**
</span>176 <span style=''>    * Class for tracking scheduled expiration tasks
</span>177 <span style=''>    *
</span>178 <span style=''>    * @param ds data store
</span>179 <span style=''>    * @param frequency run frequency
</span>180 <span style=''>    */
</span>181 <span style=''>  private class AgeOffExecutor(ds: RedisDataStore, frequency: Duration) extends Closeable {
</span>182 <span style=''>
</span>183 <span style=''>    // expiration tasks, keyed by feature type name
</span>184 <span style=''>    // note: synchronize access to ensure thread safety
</span>185 <span style=''>    private val tasks = </span><span style='background: #AEF1AE'>scala.collection.mutable.Map.empty[String, ScheduledFuture[_]]</span><span style=''>
</span>186 <span style=''>    private val rate = </span><span style='background: #AEF1AE'>frequency.toMillis</span><span style=''>
</span>187 <span style=''>    private val es = </span><span style='background: #AEF1AE'>Executors.newScheduledThreadPool(3)</span><span style=''>
</span>188 <span style=''>
</span>189 <span style=''>    /**
</span>190 <span style=''>      * Schedule the removal of features for the feature type
</span>191 <span style=''>      *
</span>192 <span style=''>      * @param typeName simple feature type name
</span>193 <span style=''>      */
</span>194 <span style=''>    def schedule(typeName: String): Unit = {
</span>195 <span style=''>      // schedule with a short initial delay to quickly remove any features that may
</span>196 <span style=''>      // have expired since the last time there was an active datastore running
</span>197 <span style=''>      val future = </span><span style='background: #AEF1AE'>es.scheduleAtFixedRate(new AgeOffRunner(ds, typeName), 5000L, rate, TimeUnit.MILLISECONDS)</span><span style=''>
</span>198 <span style=''>      </span><span style='background: #AEF1AE'>synchronized {
</span>199 <span style=''></span><span style='background: #AEF1AE'>        tasks.put(typeName, future).foreach(</span><span style='background: #F0ADAD'>_.cancel(false)</span><span style='background: #AEF1AE'>)
</span>200 <span style=''></span><span style='background: #AEF1AE'>      }</span><span style=''>
</span>201 <span style=''>    }
</span>202 <span style=''>
</span>203 <span style=''>    /**
</span>204 <span style=''>      * Cancel any scheduled tasks for the feature type
</span>205 <span style=''>      *
</span>206 <span style=''>      * @param typeName simple feature type name
</span>207 <span style=''>      */
</span>208 <span style=''>    def cancel(typeName: String): Unit = {
</span>209 <span style=''>      </span><span style='background: #AEF1AE'>synchronized {
</span>210 <span style=''></span><span style='background: #AEF1AE'>        tasks.remove(typeName).foreach(_.cancel(false))
</span>211 <span style=''></span><span style='background: #AEF1AE'>      }</span><span style=''>
</span>212 <span style=''>    }
</span>213 <span style=''>
</span>214 <span style=''>    override def close(): Unit = </span><span style='background: #AEF1AE'>es.shutdown()</span><span style=''>
</span>215 <span style=''>  }
</span>216 <span style=''>
</span>217 <span style=''>  /**
</span>218 <span style=''>    * Runnable class to check and remove expired features
</span>219 <span style=''>    *
</span>220 <span style=''>    * @param ds data store
</span>221 <span style=''>    * @param typeName simple feature type name to check
</span>222 <span style=''>    */
</span>223 <span style=''>  private class AgeOffRunner(ds: RedisDataStore, typeName: String) extends Runnable with RedisLocking {
</span>224 <span style=''>
</span>225 <span style=''>    import scala.collection.JavaConverters._
</span>226 <span style=''>
</span>227 <span style=''>    private val table = </span><span style='background: #AEF1AE'>key(ds, typeName)</span><span style=''>
</span>228 <span style=''>    private val lockPath = </span><span style='background: #AEF1AE'>s&quot;/org.locationtech.geomesa.redis.${ds.config.catalog}.ttl.$typeName&quot;</span><span style=''>
</span>229 <span style=''>
</span>230 <span style=''>    private val timeout = </span><span style='background: #AEF1AE'>AgeOffLockTimeout.toDuration.map(_.toMillis).getOrElse {
</span>231 <span style=''></span><span style='background: #AEF1AE'>      // note: should always be valid due to the default
</span>232 <span style=''></span><span style='background: #AEF1AE'>      </span><span style='background: #F0ADAD'>throw new IllegalStateException(&quot;Invalid age-off lock timeout&quot;)</span><span style='background: #AEF1AE'>
</span>233 <span style=''></span><span style='background: #AEF1AE'>    }</span><span style=''>
</span>234 <span style=''>
</span>235 <span style=''>    override def connection: Pool[_ &lt;: CloseableJedisCommands] = </span><span style='background: #AEF1AE'>ds.connection</span><span style=''>
</span>236 <span style=''>
</span>237 <span style=''>    override def run(): Unit = {
</span>238 <span style=''>      val timestamp = </span><span style='background: #AEF1AE'>System.currentTimeMillis()</span><span style=''>
</span>239 <span style=''>      logger.debug(s&quot;Age-off for schema '$typeName' starting with timestamp $timestamp&quot;)
</span>240 <span style=''>
</span>241 <span style=''>      val ids = </span><span style='background: #AEF1AE'>removeExpiredIds(timestamp)</span><span style=''>
</span>242 <span style=''>      if (</span><span style='background: #AEF1AE'>!ids.isEmpty</span><span style=''>) {
</span>243 <span style=''>        </span><span style='background: #AEF1AE'>removeExpiredFeatures(ids, timestamp)</span><span style=''>
</span>244 <span style=''>      }
</span>245 <span style=''>    }
</span>246 <span style=''>
</span>247 <span style=''>    /**
</span>248 <span style=''>      * Queries and removes expired ids and ttls
</span>249 <span style=''>      *
</span>250 <span style=''>      * @param timestamp expiration time
</span>251 <span style=''>      * @return
</span>252 <span style=''>      */
</span>253 <span style=''>    private def removeExpiredIds(timestamp: Long): java.util.List[JedisTuple] = {
</span>254 <span style=''>      def exec: java.util.List[JedisTuple] = {
</span>255 <span style=''>        </span><span style='background: #AEF1AE'>WithClose(ds.connection.getResource) { jedis =&gt;
</span>256 <span style=''></span><span style='background: #AEF1AE'>          // Use Lua script to atomically get and remove expired entries
</span>257 <span style=''></span><span style='background: #AEF1AE'>          val script = &quot;&quot;&quot;
</span>258 <span style=''></span><span style='background: #AEF1AE'>            local scores = redis.call('zrangebyscore', KEYS[1], 0, ARGV[1], 'WITHSCORES')
</span>259 <span style=''></span><span style='background: #AEF1AE'>            if #scores &gt; 0 then
</span>260 <span style=''></span><span style='background: #AEF1AE'>              redis.call('zremrangebyscore', KEYS[1], 0, ARGV[1])
</span>261 <span style=''></span><span style='background: #AEF1AE'>            end
</span>262 <span style=''></span><span style='background: #AEF1AE'>            return scores
</span>263 <span style=''></span><span style='background: #AEF1AE'>          &quot;&quot;&quot;
</span>264 <span style=''></span><span style='background: #AEF1AE'>          val result = jedis.eval(script.getBytes(StandardCharsets.UTF_8), 1, table, timestamp.toString.getBytes(StandardCharsets.UTF_8))
</span>265 <span style=''></span><span style='background: #AEF1AE'>          // Convert the result to a List[JedisTuple]
</span>266 <span style=''></span><span style='background: #AEF1AE'>          result match {
</span>267 <span style=''></span><span style='background: #AEF1AE'>            case list: java.util.List[_] if list.size() &gt; 0 =&gt;
</span>268 <span style=''></span><span style='background: #AEF1AE'>              val tuples = new java.util.ArrayList[JedisTuple](list.size() / 2)
</span>269 <span style=''></span><span style='background: #AEF1AE'>              var i = 0
</span>270 <span style=''></span><span style='background: #AEF1AE'>              while (i &lt; list.size()) {
</span>271 <span style=''></span><span style='background: #AEF1AE'>                val member = list.get(i).asInstanceOf[Array[Byte]]
</span>272 <span style=''></span><span style='background: #AEF1AE'>                val score = list.get(i + 1) match {
</span>273 <span style=''></span><span style='background: #AEF1AE'>                  case s: String =&gt; </span><span style='background: #F0ADAD'>s.toDouble</span><span style='background: #AEF1AE'>
</span>274 <span style=''></span><span style='background: #AEF1AE'>                  case b: Array[Byte] =&gt; new String(b, StandardCharsets.UTF_8).toDouble
</span>275 <span style=''></span><span style='background: #AEF1AE'>                  case _ =&gt; </span><span style='background: #F0ADAD'>throw new IllegalStateException(s&quot;Unexpected score type: ${list.get(i + 1).getClass}&quot;)</span><span style='background: #AEF1AE'>
</span>276 <span style=''></span><span style='background: #AEF1AE'>                }
</span>277 <span style=''></span><span style='background: #AEF1AE'>                tuples.add(new JedisTuple(member, score))
</span>278 <span style=''></span><span style='background: #AEF1AE'>                i += 2
</span>279 <span style=''></span><span style='background: #AEF1AE'>              }
</span>280 <span style=''></span><span style='background: #AEF1AE'>              tuples
</span>281 <span style=''></span><span style='background: #AEF1AE'>            case _ =&gt; Collections.emptyList[JedisTuple]()
</span>282 <span style=''></span><span style='background: #AEF1AE'>          }
</span>283 <span style=''></span><span style='background: #AEF1AE'>        }</span><span style=''>
</span>284 <span style=''>      }
</span>285 <span style=''>
</span>286 <span style=''>      def noLock: java.util.List[JedisTuple] = {
</span>287 <span style=''>        logger.debug(s&quot;Could not acquire distributed lock for schema '$typeName' after ${timeout}ms&quot;)
</span>288 <span style=''>        </span><span style='background: #F0ADAD'>Collections.emptyList[JedisTuple]()</span><span style=''>
</span>289 <span style=''>      }
</span>290 <span style=''>
</span>291 <span style=''>      // acquire a lock so that we're not repeating work in multiple data store instances
</span>292 <span style=''>      val ids = try { </span><span style='background: #AEF1AE'>withLock(lockPath, timeout, exec, noLock)</span><span style=''> } catch {
</span>293 <span style=''>        case NonFatal(e) </span><span style='background: #F0ADAD'>=&gt;
</span>294 <span style=''></span><span style='background: #F0ADAD'>          logger.error(&quot;Error executing ttl script:&quot;, e)
</span>295 <span style=''></span><span style='background: #F0ADAD'>          Collections.emptyList[JedisTuple]()</span><span style=''>
</span>296 <span style=''>      }
</span>297 <span style=''>
</span>298 <span style=''>      logger.debug(s&quot;Age-off for schema '$typeName' found ${ids.size} features for expiration&quot;)
</span>299 <span style=''>
</span>300 <span style=''>      ids
</span>301 <span style=''>    }
</span>302 <span style=''>
</span>303 <span style=''>    /**
</span>304 <span style=''>      * Removes expired features from the data store
</span>305 <span style=''>      *
</span>306 <span style=''>      * @param ids expired ids and ttls
</span>307 <span style=''>      * @param timestamp expiration time
</span>308 <span style=''>      */
</span>309 <span style=''>    private def removeExpiredFeatures(ids: java.util.List[JedisTuple], timestamp: Long): Unit = {
</span>310 <span style=''>      try {
</span>311 <span style=''>        </span><span style='background: #AEF1AE'>val fids = new java.util.HashSet[Identifier](ids.size)
</span>312 <span style=''></span><span style='background: #AEF1AE'>        ids.asScala.foreach(id =&gt; fids.add(FilterHelper.ff.featureId(id.getElement)))
</span>313 <span style=''></span><span style='background: #AEF1AE'>
</span>314 <span style=''></span><span style='background: #AEF1AE'>        logger.trace(s&quot;Age-off for schema '$typeName' found the following features: $fids&quot;)
</span>315 <span style=''></span><span style='background: #AEF1AE'>        val trace = logger.underlying.isTraceEnabled
</span>316 <span style=''></span><span style='background: #AEF1AE'>        lazy val results = ListBuffer.empty[String]
</span>317 <span style=''></span><span style='background: #AEF1AE'>
</span>318 <span style=''></span><span style='background: #AEF1AE'>        var i = 0
</span>319 <span style=''></span><span style='background: #AEF1AE'>        WithClose(ds.getFeatureWriter(typeName, FilterHelper.ff.id(fids), Transaction.AUTO_COMMIT)) { writer =&gt;
</span>320 <span style=''></span><span style='background: #AEF1AE'>          while (writer.hasNext) {
</span>321 <span style=''></span><span style='background: #AEF1AE'>            val sf = writer.next()
</span>322 <span style=''></span><span style='background: #AEF1AE'>            // verify that the feature hasn't been updated since we fetched the expired ids
</span>323 <span style=''></span><span style='background: #AEF1AE'>            // note: if the feature is updated between our call to `next` and `remove`, the
</span>324 <span style=''></span><span style='background: #AEF1AE'>            // member keys won't match and our deletion will not affect anything, as desired
</span>325 <span style=''></span><span style='background: #AEF1AE'>            val ttl = sf.getUserData.get(TtlUserDataKey)
</span>326 <span style=''></span><span style='background: #AEF1AE'>            if (ttl != null &amp;&amp; ttl.asInstanceOf[Long] &lt;= timestamp) {
</span>327 <span style=''></span><span style='background: #AEF1AE'>              writer.remove()
</span>328 <span style=''></span><span style='background: #AEF1AE'>              i += 1
</span>329 <span style=''></span><span style='background: #AEF1AE'>              if (trace) {
</span>330 <span style=''></span><span style='background: #AEF1AE'>                </span><span style='background: #F0ADAD'>results += sf.getID</span><span style='background: #AEF1AE'>
</span>331 <span style=''></span><span style='background: #AEF1AE'>              }
</span>332 <span style=''></span><span style='background: #AEF1AE'>            } else {
</span>333 <span style=''></span><span style='background: #AEF1AE'>              </span><span style='background: #F0ADAD'>logger.debug(s&quot;Age-off for schema '$typeName' ignoring updated feature: ${sf.getID}&quot;)</span><span style='background: #AEF1AE'>
</span>334 <span style=''></span><span style='background: #AEF1AE'>            }
</span>335 <span style=''></span><span style='background: #AEF1AE'>          }
</span>336 <span style=''></span><span style='background: #AEF1AE'>        }
</span>337 <span style=''></span><span style='background: #AEF1AE'>        logger.debug(s&quot;Age-off for schema '$typeName' removed $i features&quot;)
</span>338 <span style=''></span><span style='background: #AEF1AE'>        logger.trace(s&quot;Age-off for schema '$typeName' removed the following features: [${results.mkString(&quot;, &quot;)}]&quot;)</span><span style=''>
</span>339 <span style=''>      } catch {
</span>340 <span style=''>        case NonFatal(e) </span><span style='background: #F0ADAD'>=&gt;
</span>341 <span style=''></span><span style='background: #F0ADAD'>          logger.error(s&quot;Error executing age-off for schema '$typeName':&quot;, e)
</span>342 <span style=''></span><span style='background: #F0ADAD'>          // try to re-insert the keys, otherwise they might never expire
</span>343 <span style=''></span><span style='background: #F0ADAD'>          reinsertFailedIds(ids)</span><span style=''>
</span>344 <span style=''>      }
</span>345 <span style=''>    }
</span>346 <span style=''>
</span>347 <span style=''>    /**
</span>348 <span style=''>      * Reinserts ids for features that were not deleted from the data store
</span>349 <span style=''>      *
</span>350 <span style=''>      * @param ids expired ids and ttls
</span>351 <span style=''>      */
</span>352 <span style=''>    private def reinsertFailedIds(ids: java.util.List[JedisTuple]): Unit = {
</span>353 <span style=''>      try {
</span>354 <span style=''>        </span><span style='background: #F0ADAD'>logger.debug(s&quot;Age-off for schema '$typeName' re-inserting ttls&quot;)
</span>355 <span style=''></span><span style='background: #F0ADAD'>        val reinserts = new java.util.HashMap[Array[Byte], java.lang.Double](ids.size)
</span>356 <span style=''></span><span style='background: #F0ADAD'>        ids.asScala.foreach(id =&gt; reinserts.put(id.getBinaryElement, id.getScore))
</span>357 <span style=''></span><span style='background: #F0ADAD'>        // use nx so that if a feature update has come through we don't overwrite the new ttl
</span>358 <span style=''></span><span style='background: #F0ADAD'>        WithClose(ds.connection.getResource)(_.zadd(table, reinserts, new ZAddParams().nx()))</span><span style=''>
</span>359 <span style=''>      } catch {
</span>360 <span style=''>        case NonFatal(e) =&gt;
</span>361 <span style=''>          </span><span style='background: #F0ADAD'>logger.error(s&quot;Error re-inserting ttls for schema '$typeName'. The following features &quot; +
</span>362 <span style=''></span><span style='background: #F0ADAD'>              s&quot;may never expire: [${ids.asScala.map(_.getElement).mkString(&quot;, &quot;)}]&quot;, e)</span><span style=''>
</span>363 <span style=''>      }
</span>364 <span style=''>    }
</span>365 <span style=''>  }
</span>366 <span style=''>}
</span></pre>
          </div>
          <div class="tab-pane" id="statementlist">
            <table cellspacing="0" cellpadding="0" class="table statementlist">
      <tr>
        <th>Line</th>
        <th>Stmt Id</th>
        <th>Pos</th>
        <th>Tree</th>
        <th>Symbol</th>
        <th>Tests</th>
        <th>Code</th>
      </tr><tr>
        <td>
          49
        </td>
        <td>
          99555
        </td>
        <td>
          2365
          -
          2365
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.$anonfun.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new $anonfun()
        </td>
      </tr><tr>
        <td>
          49
        </td>
        <td>
          99556
        </td>
        <td>
          2309
          -
          2424
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.collect
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.redis.data.`package`.RedisSystemProperties.AgeOffInterval.toDuration.collect[org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor](({
  @SerialVersionUID(value = 0) final &lt;synthetic&gt; class $anonfun extends scala.runtime.AbstractPartialFunction[scala.concurrent.duration.Duration,org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor] with Serializable {
    def &lt;init&gt;(): &lt;$anon: scala.concurrent.duration.Duration =&gt; org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor&gt; = {
      $anonfun.super.&lt;init&gt;();
      ()
    };
    final override def applyOrElse[A1 &lt;: scala.concurrent.duration.Duration, B1 &gt;: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor](x1: A1, default: A1 =&gt; B1): B1 = ((x1.asInstanceOf[scala.concurrent.duration.Duration]: scala.concurrent.duration.Duration): scala.concurrent.duration.Duration @unchecked) match {
      case (i @ _) if i.isFinite() =&gt; new org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor(RedisAgeOff.this.ds, i)
      case (defaultCase$ @ _) =&gt; default.apply(x1)
    };
    final def isDefinedAt(x1: scala.concurrent.duration.Duration): Boolean = ((x1.asInstanceOf[scala.concurrent.duration.Duration]: scala.concurrent.duration.Duration): scala.concurrent.duration.Duration @unchecked) match {
      case (i @ _) if i.isFinite() =&gt; true
      case (defaultCase$ @ _) =&gt; false
    }
  };
  new $anonfun()
}: PartialFunction[scala.concurrent.duration.Duration,org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor]))
        </td>
      </tr><tr>
        <td>
          50
        </td>
        <td>
          99551
        </td>
        <td>
          2381
          -
          2391
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.concurrent.duration.Duration.isFinite
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.isFinite()
        </td>
      </tr><tr>
        <td>
          50
        </td>
        <td>
          99553
        </td>
        <td>
          2395
          -
          2420
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor(RedisAgeOff.this.ds, i)
        </td>
      </tr><tr>
        <td>
          50
        </td>
        <td>
          99552
        </td>
        <td>
          2414
          -
          2416
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.ds
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.ds
        </td>
      </tr><tr>
        <td>
          50
        </td>
        <td>
          99554
        </td>
        <td>
          2395
          -
          2420
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor(RedisAgeOff.this.ds, i)
        </td>
      </tr><tr>
        <td>
          59
        </td>
        <td>
          99557
        </td>
        <td>
          2577
          -
          2607
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType.isFeatureExpirationEnabled
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled
        </td>
      </tr><tr>
        <td>
          59
        </td>
        <td>
          99563
        </td>
        <td>
          2573
          -
          2573
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          59
        </td>
        <td>
          99562
        </td>
        <td>
          2573
          -
          2573
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          60
        </td>
        <td>
          99559
        </td>
        <td>
          2634
          -
          2661
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.schedule
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$1.schedule(sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          60
        </td>
        <td>
          99558
        </td>
        <td>
          2645
          -
          2660
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          60
        </td>
        <td>
          99561
        </td>
        <td>
          2617
          -
          2662
        </td>
        <td>
          Block
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.executor.foreach[Unit](((x$1: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$1.schedule(sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          60
        </td>
        <td>
          99560
        </td>
        <td>
          2617
          -
          2662
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.executor.foreach[Unit](((x$1: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$1.schedule(sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          99564
        </td>
        <td>
          2927
          -
          2962
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType.isFeatureExpirationEnabled
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(previous).isFeatureExpirationEnabled
        </td>
      </tr><tr>
        <td>
          72
        </td>
        <td>
          99565
        </td>
        <td>
          2976
          -
          3007
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled.unary_!
        </td>
      </tr><tr>
        <td>
          72
        </td>
        <td>
          99590
        </td>
        <td>
          2972
          -
          3387
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          if (org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled.unary_!)
  RedisAgeOff.this.remove(previous)
else
  if (sft.getTypeName().!=(previous.getTypeName()))
    {
      RedisAgeOff.this.executor.foreach[Unit](((x$2: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$2.cancel(previous.getTypeName())));
      org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](RedisAgeOff.this.ds.connection.getResource())(((x$3: _$1) =&gt; x$3.renamenx(RedisAgeOff.key(RedisAgeOff.this.ds, previous.getTypeName()), RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))))(io.this.IsCloseable.closeableIsCloseable);
      RedisAgeOff.this.executor.foreach[Unit](((x$4: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$4.schedule(sft.getTypeName())))
    }
  else
    ()
        </td>
      </tr><tr>
        <td>
          73
        </td>
        <td>
          99567
        </td>
        <td>
          3019
          -
          3035
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.remove
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.remove(previous)
        </td>
      </tr><tr>
        <td>
          73
        </td>
        <td>
          99566
        </td>
        <td>
          3019
          -
          3035
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.remove
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.remove(previous)
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          99569
        </td>
        <td>
          3053
          -
          3092
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.!=
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          sft.getTypeName().!=(previous.getTypeName())
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          99568
        </td>
        <td>
          3072
          -
          3092
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          previous.getTypeName()
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          99587
        </td>
        <td>
          3049
          -
          3049
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          99586
        </td>
        <td>
          3094
          -
          3387
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  RedisAgeOff.this.executor.foreach[Unit](((x$2: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$2.cancel(previous.getTypeName())));
  org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](RedisAgeOff.this.ds.connection.getResource())(((x$3: _$1) =&gt; x$3.renamenx(RedisAgeOff.key(RedisAgeOff.this.ds, previous.getTypeName()), RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))))(io.this.IsCloseable.closeableIsCloseable);
  RedisAgeOff.this.executor.foreach[Unit](((x$4: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$4.schedule(sft.getTypeName())))
}
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          99589
        </td>
        <td>
          3049
          -
          3387
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          if (sft.getTypeName().!=(previous.getTypeName()))
  {
    RedisAgeOff.this.executor.foreach[Unit](((x$2: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$2.cancel(previous.getTypeName())));
    org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](RedisAgeOff.this.ds.connection.getResource())(((x$3: _$1) =&gt; x$3.renamenx(RedisAgeOff.key(RedisAgeOff.this.ds, previous.getTypeName()), RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))))(io.this.IsCloseable.closeableIsCloseable);
    RedisAgeOff.this.executor.foreach[Unit](((x$4: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$4.schedule(sft.getTypeName())))
  }
else
  ()
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          99588
        </td>
        <td>
          3049
          -
          3049
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          99571
        </td>
        <td>
          3121
          -
          3151
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.cancel
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$2.cancel(previous.getTypeName())
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          99570
        </td>
        <td>
          3130
          -
          3150
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          previous.getTypeName()
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          99572
        </td>
        <td>
          3104
          -
          3152
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.executor.foreach[Unit](((x$2: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$2.cancel(previous.getTypeName())))
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99573
        </td>
        <td>
          3230
          -
          3255
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.util.Pool.getResource
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.ds.connection.getResource()
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99575
        </td>
        <td>
          3276
          -
          3296
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          previous.getTypeName()
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99574
        </td>
        <td>
          3272
          -
          3274
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.ds
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.ds
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99577
        </td>
        <td>
          3303
          -
          3305
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.ds
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.ds
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99576
        </td>
        <td>
          3268
          -
          3297
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.key
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.key(RedisAgeOff.this.ds, previous.getTypeName())
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99579
        </td>
        <td>
          3299
          -
          3323
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.key
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99578
        </td>
        <td>
          3307
          -
          3322
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99581
        </td>
        <td>
          3256
          -
          3256
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99580
        </td>
        <td>
          3257
          -
          3324
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.commands.KeyBinaryCommands.renamenx
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$3.renamenx(RedisAgeOff.key(RedisAgeOff.this.ds, previous.getTypeName()), RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          99582
        </td>
        <td>
          3220
          -
          3325
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](RedisAgeOff.this.ds.connection.getResource())(((x$3: _$1) =&gt; x$3.renamenx(RedisAgeOff.key(RedisAgeOff.this.ds, previous.getTypeName()), RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          99583
        </td>
        <td>
          3362
          -
          3377
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          99585
        </td>
        <td>
          3334
          -
          3379
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.executor.foreach[Unit](((x$4: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$4.schedule(sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          78
        </td>
        <td>
          99584
        </td>
        <td>
          3351
          -
          3378
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.schedule
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$4.schedule(sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          99591
        </td>
        <td>
          3403
          -
          3433
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType.isFeatureExpirationEnabled
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          99597
        </td>
        <td>
          3399
          -
          3399
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          99596
        </td>
        <td>
          3399
          -
          3399
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          99598
        </td>
        <td>
          3399
          -
          3494
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          if (org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled)
  RedisAgeOff.this.executor.foreach[Unit](((x$5: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$5.schedule(sft.getTypeName())))
else
  ()
        </td>
      </tr><tr>
        <td>
          81
        </td>
        <td>
          99593
        </td>
        <td>
          3460
          -
          3487
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.schedule
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$5.schedule(sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          81
        </td>
        <td>
          99592
        </td>
        <td>
          3471
          -
          3486
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          81
        </td>
        <td>
          99595
        </td>
        <td>
          3443
          -
          3488
        </td>
        <td>
          Block
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.executor.foreach[Unit](((x$5: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$5.schedule(sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          81
        </td>
        <td>
          99594
        </td>
        <td>
          3443
          -
          3488
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          RedisAgeOff.this.executor.foreach[Unit](((x$5: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$5.schedule(sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          91
        </td>
        <td>
          99599
        </td>
        <td>
          3655
          -
          3685
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType.isFeatureExpirationEnabled
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled
        </td>
      </tr><tr>
        <td>
          91
        </td>
        <td>
          99611
        </td>
        <td>
          3687
          -
          3820
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  RedisAgeOff.this.executor.foreach[Unit](((x$6: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$6.cancel(sft.getTypeName())));
  {
    org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](RedisAgeOff.this.ds.connection.getResource())(((x$7: _$1) =&gt; x$7.del(RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))))(io.this.IsCloseable.closeableIsCloseable);
    ()
  }
}
        </td>
      </tr><tr>
        <td>
          91
        </td>
        <td>
          99613
        </td>
        <td>
          3651
          -
          3651
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          91
        </td>
        <td>
          99612
        </td>
        <td>
          3651
          -
          3651
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          99601
        </td>
        <td>
          3712
          -
          3737
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.cancel
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$6.cancel(sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          99600
        </td>
        <td>
          3721
          -
          3736
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          99602
        </td>
        <td>
          3695
          -
          3738
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.executor.foreach[Unit](((x$6: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$6.cancel(sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99603
        </td>
        <td>
          3755
          -
          3780
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.util.Pool.getResource
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.ds.connection.getResource()
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99605
        </td>
        <td>
          3796
          -
          3811
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99604
        </td>
        <td>
          3792
          -
          3794
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.ds
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.ds
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99607
        </td>
        <td>
          3782
          -
          3813
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.commands.KeyBinaryCommands.del
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$7.del(RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99606
        </td>
        <td>
          3788
          -
          3812
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.key
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99609
        </td>
        <td>
          3745
          -
          3814
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](RedisAgeOff.this.ds.connection.getResource())(((x$7: _$1) =&gt; x$7.del(RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99608
        </td>
        <td>
          3781
          -
          3781
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          93
        </td>
        <td>
          99610
        </td>
        <td>
          3781
          -
          3781
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          104
        </td>
        <td>
          99614
        </td>
        <td>
          4013
          -
          4043
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType.isFeatureExpirationEnabled
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.geotools.RichSimpleFeatureType.RichSimpleFeatureType(sft).isFeatureExpirationEnabled
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99615
        </td>
        <td>
          4075
          -
          4088
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.RedisDataStore.connection
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.ds.connection
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99617
        </td>
        <td>
          4098
          -
          4113
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getTypeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          sft.getTypeName()
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99616
        </td>
        <td>
          4094
          -
          4096
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.ds
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.ds
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99619
        </td>
        <td>
          4058
          -
          4115
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter(RedisAgeOff.this.ds.connection, RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName()))
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99618
        </td>
        <td>
          4090
          -
          4114
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.key
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName())
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99621
        </td>
        <td>
          4053
          -
          4116
        </td>
        <td>
          Block
        </td>
        <td>
          scala.Some.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Some.apply[org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter](new org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter(RedisAgeOff.this.ds.connection, RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          105
        </td>
        <td>
          99620
        </td>
        <td>
          4053
          -
          4116
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Some.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Some.apply[org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter](new org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter(RedisAgeOff.this.ds.connection, RedisAgeOff.key(RedisAgeOff.this.ds, sft.getTypeName())))
        </td>
      </tr><tr>
        <td>
          107
        </td>
        <td>
          99623
        </td>
        <td>
          4136
          -
          4140
        </td>
        <td>
          Block
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.None
        </td>
      </tr><tr>
        <td>
          107
        </td>
        <td>
          99622
        </td>
        <td>
          4136
          -
          4140
        </td>
        <td>
          Select
        </td>
        <td>
          scala.None
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.None
        </td>
      </tr><tr>
        <td>
          111
        </td>
        <td>
          99625
        </td>
        <td>
          4183
          -
          4210
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.executor.foreach[Unit](((x$8: org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor) =&gt; x$8.close()))
        </td>
      </tr><tr>
        <td>
          111
        </td>
        <td>
          99624
        </td>
        <td>
          4200
          -
          4209
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.close
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$8.close()
        </td>
      </tr><tr>
        <td>
          118
        </td>
        <td>
          99626
        </td>
        <td>
          4339
          -
          4342
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;t&quot;
        </td>
      </tr><tr>
        <td>
          120
        </td>
        <td>
          99627
        </td>
        <td>
          4475
          -
          4539
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.utils.conf.GeoMesaSystemProperties.SystemProperty.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.conf.GeoMesaSystemProperties.SystemProperty.apply(&quot;geomesa.redis.age.off.lock.timeout&quot;, &quot;1 second&quot;)
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          99629
        </td>
        <td>
          4716
          -
          4731
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.index.geotools.GeoMesaDataStore.getSchema
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ds.getSchema(n)
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          99628
        </td>
        <td>
          4674
          -
          4689
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.index.geotools.MetadataBackedDataStore.getTypeNames
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ds.getTypeNames()
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          99631
        </td>
        <td>
          4674
          -
          4733
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IndexedSeqOptimized.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.refArrayOps[String](ds.getTypeNames()).foreach[Unit](((n: String) =&gt; ds.aging.add(ds.getSchema(n))))
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          99630
        </td>
        <td>
          4703
          -
          4732
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.add
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ds.aging.add(ds.getSchema(n))
        </td>
      </tr><tr>
        <td>
          137
        </td>
        <td>
          99633
        </td>
        <td>
          5018
          -
          5020
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;_&quot;
        </td>
      </tr><tr>
        <td>
          137
        </td>
        <td>
          99632
        </td>
        <td>
          4998
          -
          4999
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          137
        </td>
        <td>
          99635
        </td>
        <td>
          5000
          -
          5017
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.RedisDataStoreFactory.RedisDataStoreConfig.catalog
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ds.config.catalog
        </td>
      </tr><tr>
        <td>
          137
        </td>
        <td>
          99634
        </td>
        <td>
          5030
          -
          5035
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;_ttl&quot;
        </td>
      </tr><tr>
        <td>
          137
        </td>
        <td>
          99637
        </td>
        <td>
          4996
          -
          5068
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.getBytes
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;&quot;, &quot;_&quot;, &quot;_ttl&quot;).s(ds.config.catalog, typeName).getBytes(java.nio.charset.StandardCharsets.UTF_8)
        </td>
      </tr><tr>
        <td>
          137
        </td>
        <td>
          99636
        </td>
        <td>
          5045
          -
          5067
        </td>
        <td>
          Select
        </td>
        <td>
          java.nio.charset.StandardCharsets.UTF_8
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.charset.StandardCharsets.UTF_8
        </td>
      </tr><tr>
        <td>
          147
        </td>
        <td>
          99638
        </td>
        <td>
          5373
          -
          5425
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashMap.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.HashMap[Array[Byte],Double]()
        </td>
      </tr><tr>
        <td>
          148
        </td>
        <td>
          99639
        </td>
        <td>
          5452
          -
          5482
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.generic.GenericCompanion.empty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.mutable.ArrayBuffer.empty[Array[Byte]]
        </td>
      </tr><tr>
        <td>
          151
        </td>
        <td>
          99641
        </td>
        <td>
          5646
          -
          5684
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashMap.put
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.writes.put(feature.rawId, scala.Predef.double2Double(feature.ttl))
        </td>
      </tr><tr>
        <td>
          151
        </td>
        <td>
          99640
        </td>
        <td>
          5672
          -
          5683
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.double2Double
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.double2Double(feature.ttl)
        </td>
      </tr><tr>
        <td>
          151
        </td>
        <td>
          99642
        </td>
        <td>
          5656
          -
          5656
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          152
        </td>
        <td>
          99643
        </td>
        <td>
          5739
          -
          5763
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.ArrayBuffer.+=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.deletes.+=(feature.rawId)
        </td>
      </tr><tr>
        <td>
          152
        </td>
        <td>
          99644
        </td>
        <td>
          5747
          -
          5747
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          99645
        </td>
        <td>
          5829
          -
          5845
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.TraversableOnce.nonEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.deletes.nonEmpty
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          99646
        </td>
        <td>
          5810
          -
          5845
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.||
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.writes.isEmpty().unary_!.||(AgeOffWriter.this.deletes.nonEmpty)
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          99671
        </td>
        <td>
          5806
          -
          5806
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          99670
        </td>
        <td>
          5806
          -
          5806
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          156
        </td>
        <td>
          99669
        </td>
        <td>
          5857
          -
          6200
        </td>
        <td>
          Try
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          try {
  org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, AnyVal](AgeOffWriter.this.connection.getResource())(((jedis: _$1) =&gt; {
    if (AgeOffWriter.this.deletes.nonEmpty)
      jedis.zrem(AgeOffWriter.this.table, (AgeOffWriter.this.deletes.toSeq: _*))
    else
      ();
    if (AgeOffWriter.this.writes.isEmpty().unary_!)
      jedis.zadd(AgeOffWriter.this.table, AgeOffWriter.this.writes)
    else
      ()
  }))(io.this.IsCloseable.closeableIsCloseable);
  ()
} finally {
  AgeOffWriter.this.writes.clear();
  AgeOffWriter.this.deletes.clear()
}
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          99647
        </td>
        <td>
          5883
          -
          5905
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.util.Pool.getResource
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.connection.getResource()
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          99663
        </td>
        <td>
          5873
          -
          6119
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, AnyVal](AgeOffWriter.this.connection.getResource())(((jedis: _$1) =&gt; {
  if (AgeOffWriter.this.deletes.nonEmpty)
    jedis.zrem(AgeOffWriter.this.table, (AgeOffWriter.this.deletes.toSeq: _*))
  else
    ();
  if (AgeOffWriter.this.writes.isEmpty().unary_!)
    jedis.zadd(AgeOffWriter.this.table, AgeOffWriter.this.writes)
  else
    ()
}))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          99662
        </td>
        <td>
          5907
          -
          5907
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          99665
        </td>
        <td>
          5873
          -
          6119
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, AnyVal](AgeOffWriter.this.connection.getResource())(((jedis: _$1) =&gt; {
    if (AgeOffWriter.this.deletes.nonEmpty)
      jedis.zrem(AgeOffWriter.this.table, (AgeOffWriter.this.deletes.toSeq: _*))
    else
      ();
    if (AgeOffWriter.this.writes.isEmpty().unary_!)
      jedis.zadd(AgeOffWriter.this.table, AgeOffWriter.this.writes)
    else
      ()
  }))(io.this.IsCloseable.closeableIsCloseable);
  ()
}
        </td>
      </tr><tr>
        <td>
          157
        </td>
        <td>
          99664
        </td>
        <td>
          5907
          -
          5907
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          158
        </td>
        <td>
          99648
        </td>
        <td>
          5934
          -
          5950
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.TraversableOnce.nonEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.deletes.nonEmpty
        </td>
      </tr><tr>
        <td>
          158
        </td>
        <td>
          99653
        </td>
        <td>
          5930
          -
          5930
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          158
        </td>
        <td>
          99654
        </td>
        <td>
          5930
          -
          5930
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          99649
        </td>
        <td>
          5979
          -
          5984
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter.table
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.table
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          99651
        </td>
        <td>
          5968
          -
          6004
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.commands.SortedSetBinaryCommands.zrem
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          jedis.zrem(AgeOffWriter.this.table, (AgeOffWriter.this.deletes.toSeq: _*))
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          99650
        </td>
        <td>
          5986
          -
          5999
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.SeqLike.toSeq
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.deletes.toSeq
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          99652
        </td>
        <td>
          5968
          -
          6004
        </td>
        <td>
          Block
        </td>
        <td>
          redis.clients.jedis.commands.SortedSetBinaryCommands.zrem
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          jedis.zrem(AgeOffWriter.this.table, (AgeOffWriter.this.deletes.toSeq: _*))
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          99655
        </td>
        <td>
          6035
          -
          6050
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.writes.isEmpty().unary_!
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          99661
        </td>
        <td>
          6031
          -
          6031
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          99660
        </td>
        <td>
          6031
          -
          6031
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          162
        </td>
        <td>
          99657
        </td>
        <td>
          6086
          -
          6092
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter.writes
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.writes
        </td>
      </tr><tr>
        <td>
          162
        </td>
        <td>
          99656
        </td>
        <td>
          6079
          -
          6084
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter.table
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.table
        </td>
      </tr><tr>
        <td>
          162
        </td>
        <td>
          99659
        </td>
        <td>
          6068
          -
          6093
        </td>
        <td>
          Block
        </td>
        <td>
          redis.clients.jedis.commands.SortedSetBinaryCommands.zadd
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          jedis.zadd(AgeOffWriter.this.table, AgeOffWriter.this.writes)
        </td>
      </tr><tr>
        <td>
          162
        </td>
        <td>
          99658
        </td>
        <td>
          6068
          -
          6093
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.commands.SortedSetBinaryCommands.zadd
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          jedis.zadd(AgeOffWriter.this.table, AgeOffWriter.this.writes)
        </td>
      </tr><tr>
        <td>
          165
        </td>
        <td>
          99668
        </td>
        <td>
          6138
          -
          6200
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  AgeOffWriter.this.writes.clear();
  AgeOffWriter.this.deletes.clear()
}
        </td>
      </tr><tr>
        <td>
          166
        </td>
        <td>
          99666
        </td>
        <td>
          6150
          -
          6164
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashMap.clear
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.writes.clear()
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          99667
        </td>
        <td>
          6175
          -
          6190
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.ArrayBuffer.clear
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.deletes.clear()
        </td>
      </tr><tr>
        <td>
          172
        </td>
        <td>
          99672
        </td>
        <td>
          6249
          -
          6256
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffWriter.flush
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffWriter.this.flush()
        </td>
      </tr><tr>
        <td>
          185
        </td>
        <td>
          99673
        </td>
        <td>
          6622
          -
          6684
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.collection.mutable.Map.empty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.mutable.Map.empty[String, java.util.concurrent.ScheduledFuture[_]]
        </td>
      </tr><tr>
        <td>
          186
        </td>
        <td>
          99674
        </td>
        <td>
          6708
          -
          6726
        </td>
        <td>
          Select
        </td>
        <td>
          scala.concurrent.duration.Duration.toMillis
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.frequency.toMillis
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          99675
        </td>
        <td>
          6748
          -
          6783
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Executors.newScheduledThreadPool
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.util.concurrent.Executors.newScheduledThreadPool(3)
        </td>
      </tr><tr>
        <td>
          197
        </td>
        <td>
          99677
        </td>
        <td>
          7173
          -
          7203
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new RedisAgeOff.this.AgeOffRunner(AgeOffExecutor.this.ds, typeName)
        </td>
      </tr><tr>
        <td>
          197
        </td>
        <td>
          99676
        </td>
        <td>
          7190
          -
          7192
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.ds
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.ds
        </td>
      </tr><tr>
        <td>
          197
        </td>
        <td>
          99679
        </td>
        <td>
          7212
          -
          7216
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffExecutor.rate
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.rate
        </td>
      </tr><tr>
        <td>
          197
        </td>
        <td>
          99678
        </td>
        <td>
          7205
          -
          7210
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          5000L
        </td>
      </tr><tr>
        <td>
          197
        </td>
        <td>
          99681
        </td>
        <td>
          7150
          -
          7240
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ScheduledExecutorService.scheduleAtFixedRate
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.es.scheduleAtFixedRate(new RedisAgeOff.this.AgeOffRunner(AgeOffExecutor.this.ds, typeName), 5000L, AgeOffExecutor.this.rate, MILLISECONDS)
        </td>
      </tr><tr>
        <td>
          197
        </td>
        <td>
          99680
        </td>
        <td>
          7218
          -
          7239
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          MILLISECONDS
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          99684
        </td>
        <td>
          7247
          -
          7330
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.synchronized
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.synchronized[Unit](AgeOffExecutor.this.tasks.put(typeName, future).foreach[Boolean](((x$9: java.util.concurrent.ScheduledFuture[_]) =&gt; x$9.cancel(false))))
        </td>
      </tr><tr>
        <td>
          199
        </td>
        <td>
          99683
        </td>
        <td>
          7270
          -
          7322
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.tasks.put(typeName, future).foreach[Boolean](((x$9: java.util.concurrent.ScheduledFuture[_]) =&gt; x$9.cancel(false)))
        </td>
      </tr><tr>
        <td>
          199
        </td>
        <td>
          99682
        </td>
        <td>
          7306
          -
          7321
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Future.cancel
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$9.cancel(false)
        </td>
      </tr><tr>
        <td>
          209
        </td>
        <td>
          99687
        </td>
        <td>
          7517
          -
          7595
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.synchronized
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.synchronized[Unit](AgeOffExecutor.this.tasks.remove(typeName).foreach[Boolean](((x$10: java.util.concurrent.ScheduledFuture[_]) =&gt; x$10.cancel(false))))
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          99685
        </td>
        <td>
          7571
          -
          7586
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.Future.cancel
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$10.cancel(false)
        </td>
      </tr><tr>
        <td>
          210
        </td>
        <td>
          99686
        </td>
        <td>
          7540
          -
          7587
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.tasks.remove(typeName).foreach[Boolean](((x$10: java.util.concurrent.ScheduledFuture[_]) =&gt; x$10.cancel(false)))
        </td>
      </tr><tr>
        <td>
          214
        </td>
        <td>
          99688
        </td>
        <td>
          7636
          -
          7649
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.concurrent.ExecutorService.shutdown
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffExecutor.this.es.shutdown()
        </td>
      </tr><tr>
        <td>
          227
        </td>
        <td>
          99689
        </td>
        <td>
          7994
          -
          7996
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.ds
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.ds
        </td>
      </tr><tr>
        <td>
          227
        </td>
        <td>
          99691
        </td>
        <td>
          7990
          -
          8007
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.key
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.key(AgeOffRunner.this.ds, AgeOffRunner.this.typeName)
        </td>
      </tr><tr>
        <td>
          227
        </td>
        <td>
          99690
        </td>
        <td>
          7998
          -
          8006
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.typeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.typeName
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          99693
        </td>
        <td>
          8089
          -
          8095
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;.ttl.&quot;
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          99692
        </td>
        <td>
          8037
          -
          8070
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;/org.locationtech.geomesa.redis.&quot;
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          99695
        </td>
        <td>
          8071
          -
          8088
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.RedisDataStoreFactory.RedisDataStoreConfig.catalog
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.ds.config.catalog
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          99694
        </td>
        <td>
          8103
          -
          8104
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          99697
        </td>
        <td>
          8035
          -
          8104
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.StringContext.apply(&quot;/org.locationtech.geomesa.redis.&quot;, &quot;.ttl.&quot;, &quot;&quot;).s(AgeOffRunner.this.ds.config.catalog, AgeOffRunner.this.typeName)
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          99696
        </td>
        <td>
          8095
          -
          8103
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.typeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.typeName
        </td>
      </tr><tr>
        <td>
          230
        </td>
        <td>
          99698
        </td>
        <td>
          8165
          -
          8175
        </td>
        <td>
          Select
        </td>
        <td>
          scala.concurrent.duration.Duration.toMillis
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$11.toMillis
        </td>
      </tr><tr>
        <td>
          230
        </td>
        <td>
          99700
        </td>
        <td>
          8132
          -
          8321
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Option.getOrElse
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.AgeOffLockTimeout.toDuration.map[Long](((x$11: scala.concurrent.duration.Duration) =&gt; x$11.toMillis)).getOrElse[Long](throw new java.lang.IllegalStateException(&quot;Invalid age-off lock timeout&quot;))
        </td>
      </tr><tr>
        <td>
          232
        </td>
        <td>
          99699
        </td>
        <td>
          8252
          -
          8315
        </td>
        <td>
          Throw
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          throw new java.lang.IllegalStateException(&quot;Invalid age-off lock timeout&quot;)
        </td>
      </tr><tr>
        <td>
          235
        </td>
        <td>
          99701
        </td>
        <td>
          8388
          -
          8401
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.RedisDataStore.connection
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.ds.connection
        </td>
      </tr><tr>
        <td>
          238
        </td>
        <td>
          99702
        </td>
        <td>
          8458
          -
          8484
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.System.currentTimeMillis
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.System.currentTimeMillis()
        </td>
      </tr><tr>
        <td>
          241
        </td>
        <td>
          99703
        </td>
        <td>
          8591
          -
          8618
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.removeExpiredIds
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.removeExpiredIds(timestamp)
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          99704
        </td>
        <td>
          8629
          -
          8641
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Boolean.unary_!
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ids.isEmpty().unary_!
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          99707
        </td>
        <td>
          8625
          -
          8625
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          99708
        </td>
        <td>
          8625
          -
          8625
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          243
        </td>
        <td>
          99705
        </td>
        <td>
          8653
          -
          8690
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.removeExpiredFeatures
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.removeExpiredFeatures(ids, timestamp)
        </td>
      </tr><tr>
        <td>
          243
        </td>
        <td>
          99706
        </td>
        <td>
          8653
          -
          8690
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.removeExpiredFeatures
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.removeExpiredFeatures(ids, timestamp)
        </td>
      </tr><tr>
        <td>
          255
        </td>
        <td>
          99709
        </td>
        <td>
          8984
          -
          9009
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.util.Pool.getResource
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.ds.connection.getResource()
        </td>
      </tr><tr>
        <td>
          255
        </td>
        <td>
          99747
        </td>
        <td>
          8974
          -
          10374
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, java.util.List[redis.clients.jedis.resps.Tuple]](AgeOffRunner.this.ds.connection.getResource())(((jedis: _$1) =&gt; {
  val script: String = &quot;\n            local scores = redis.call(\'zrangebyscore\', KEYS[1], 0, ARGV[1], \'WITHSCORES\')\n            if #scores &gt; 0 then\n              redis.call(\'zremrangebyscore\', KEYS[1], 0, ARGV[1])\n            end\n            return scores\n          &quot;;
  val result: Object = jedis.eval(script.getBytes(java.nio.charset.StandardCharsets.UTF_8), 1, AgeOffRunner.this.table, timestamp.toString().getBytes(java.nio.charset.StandardCharsets.UTF_8));
  result match {
    case (list @ (_: java.util.List[_])) if list.size().&gt;(0) =&gt; {
      val tuples: java.util.ArrayList[redis.clients.jedis.resps.Tuple] = new java.util.ArrayList[redis.clients.jedis.resps.Tuple](list.size()./(2));
      var i: Int = 0;
      while$1(){
        if (i.&lt;(list.size()))
          {
            {
              val member: Array[Byte] = list.get(i).asInstanceOf[Array[Byte]];
              val score: Double = list.get(i.+(1)) match {
                case (s @ (_: String)) =&gt; scala.Predef.augmentString(s).toDouble
                case (b @ (_: Array[Byte])) =&gt; scala.Predef.augmentString(new scala.Predef.String(b, java.nio.charset.StandardCharsets.UTF_8)).toDouble
                case _ =&gt; throw new java.lang.IllegalStateException(scala.StringContext.apply(&quot;Unexpected score type: &quot;, &quot;&quot;).s(list.get(i.+(1)).getClass()))
              };
              tuples.add(new redis.clients.jedis.resps.Tuple(member, scala.Predef.double2Double(score)));
              i = i.+(2)
            };
            while$1()
          }
        else
          ()
      };
      tuples
    }
    case _ =&gt; java.util.Collections.emptyList[redis.clients.jedis.resps.Tuple]()
  }
}))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          255
        </td>
        <td>
          99746
        </td>
        <td>
          9011
          -
          9011
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          99710
        </td>
        <td>
          9118
          -
          9365
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          &quot;\n            local scores = redis.call(\'zrangebyscore\', KEYS[1], 0, ARGV[1], \'WITHSCORES\')\n            if #scores &gt; 0 then\n              redis.call(\'zremrangebyscore\', KEYS[1], 0, ARGV[1])\n            end\n            return scores\n          &quot;
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99711
        </td>
        <td>
          9416
          -
          9438
        </td>
        <td>
          Select
        </td>
        <td>
          java.nio.charset.StandardCharsets.UTF_8
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.charset.StandardCharsets.UTF_8
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99713
        </td>
        <td>
          9441
          -
          9442
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99712
        </td>
        <td>
          9400
          -
          9439
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.getBytes
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          script.getBytes(java.nio.charset.StandardCharsets.UTF_8)
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99715
        </td>
        <td>
          9479
          -
          9501
        </td>
        <td>
          Select
        </td>
        <td>
          java.nio.charset.StandardCharsets.UTF_8
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.charset.StandardCharsets.UTF_8
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99714
        </td>
        <td>
          9444
          -
          9449
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.table
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.table
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99717
        </td>
        <td>
          9389
          -
          9503
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.commands.ScriptingKeyBinaryCommands.eval
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          jedis.eval(script.getBytes(java.nio.charset.StandardCharsets.UTF_8), 1, AgeOffRunner.this.table, timestamp.toString().getBytes(java.nio.charset.StandardCharsets.UTF_8))
        </td>
      </tr><tr>
        <td>
          264
        </td>
        <td>
          99716
        </td>
        <td>
          9451
          -
          9502
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.getBytes
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          timestamp.toString().getBytes(java.nio.charset.StandardCharsets.UTF_8)
        </td>
      </tr><tr>
        <td>
          267
        </td>
        <td>
          99718
        </td>
        <td>
          9627
          -
          9642
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          list.size().&gt;(0)
        </td>
      </tr><tr>
        <td>
          267
        </td>
        <td>
          99743
        </td>
        <td>
          9643
          -
          10294
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val tuples: java.util.ArrayList[redis.clients.jedis.resps.Tuple] = new java.util.ArrayList[redis.clients.jedis.resps.Tuple](list.size()./(2));
  var i: Int = 0;
  while$1(){
    if (i.&lt;(list.size()))
      {
        {
          val member: Array[Byte] = list.get(i).asInstanceOf[Array[Byte]];
          val score: Double = list.get(i.+(1)) match {
            case (s @ (_: String)) =&gt; scala.Predef.augmentString(s).toDouble
            case (b @ (_: Array[Byte])) =&gt; scala.Predef.augmentString(new scala.Predef.String(b, java.nio.charset.StandardCharsets.UTF_8)).toDouble
            case _ =&gt; throw new java.lang.IllegalStateException(scala.StringContext.apply(&quot;Unexpected score type: &quot;, &quot;&quot;).s(list.get(i.+(1)).getClass()))
          };
          tuples.add(new redis.clients.jedis.resps.Tuple(member, scala.Predef.double2Double(score)));
          i = i.+(2)
        };
        while$1()
      }
    else
      ()
  };
  tuples
}
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          99719
        </td>
        <td>
          9709
          -
          9724
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          list.size()./(2)
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          99720
        </td>
        <td>
          9673
          -
          9725
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.ArrayList.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.ArrayList[redis.clients.jedis.resps.Tuple](list.size()./(2))
        </td>
      </tr><tr>
        <td>
          269
        </td>
        <td>
          99721
        </td>
        <td>
          9748
          -
          9749
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          270
        </td>
        <td>
          99723
        </td>
        <td>
          9771
          -
          9786
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.&lt;(list.size())
        </td>
      </tr><tr>
        <td>
          270
        </td>
        <td>
          99722
        </td>
        <td>
          9775
          -
          9786
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.List.size
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          list.size()
        </td>
      </tr><tr>
        <td>
          270
        </td>
        <td>
          99739
        </td>
        <td>
          9788
          -
          9788
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.while$1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          while$1()
        </td>
      </tr><tr>
        <td>
          270
        </td>
        <td>
          99741
        </td>
        <td>
          9764
          -
          9764
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          270
        </td>
        <td>
          99740
        </td>
        <td>
          9788
          -
          10273
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  {
    val member: Array[Byte] = list.get(i).asInstanceOf[Array[Byte]];
    val score: Double = list.get(i.+(1)) match {
      case (s @ (_: String)) =&gt; scala.Predef.augmentString(s).toDouble
      case (b @ (_: Array[Byte])) =&gt; scala.Predef.augmentString(new scala.Predef.String(b, java.nio.charset.StandardCharsets.UTF_8)).toDouble
      case _ =&gt; throw new java.lang.IllegalStateException(scala.StringContext.apply(&quot;Unexpected score type: &quot;, &quot;&quot;).s(list.get(i.+(1)).getClass()))
    };
    tuples.add(new redis.clients.jedis.resps.Tuple(member, scala.Predef.double2Double(score)));
    i = i.+(2)
  };
  while$1()
}
        </td>
      </tr><tr>
        <td>
          270
        </td>
        <td>
          99742
        </td>
        <td>
          9764
          -
          9764
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          271
        </td>
        <td>
          99724
        </td>
        <td>
          9819
          -
          9856
        </td>
        <td>
          TypeApply
        </td>
        <td>
          scala.Any.asInstanceOf
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          list.get(i).asInstanceOf[Array[Byte]]
        </td>
      </tr><tr>
        <td>
          272
        </td>
        <td>
          99725
        </td>
        <td>
          9894
          -
          9899
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.+(1)
        </td>
      </tr><tr>
        <td>
          272
        </td>
        <td>
          99726
        </td>
        <td>
          9885
          -
          9900
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.List.get
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          list.get(i.+(1))
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          99727
        </td>
        <td>
          9945
          -
          9955
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.immutable.StringLike.toDouble
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.augmentString(s).toDouble
        </td>
      </tr><tr>
        <td>
          273
        </td>
        <td>
          99728
        </td>
        <td>
          9945
          -
          9955
        </td>
        <td>
          Block
        </td>
        <td>
          scala.collection.immutable.StringLike.toDouble
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.augmentString(s).toDouble
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          99729
        </td>
        <td>
          10011
          -
          10033
        </td>
        <td>
          Select
        </td>
        <td>
          java.nio.charset.StandardCharsets.UTF_8
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.charset.StandardCharsets.UTF_8
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          99731
        </td>
        <td>
          9997
          -
          10043
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.immutable.StringLike.toDouble
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.augmentString(new scala.Predef.String(b, java.nio.charset.StandardCharsets.UTF_8)).toDouble
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          99730
        </td>
        <td>
          9997
          -
          10034
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.String.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new scala.Predef.String(b, java.nio.charset.StandardCharsets.UTF_8)
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          99732
        </td>
        <td>
          9997
          -
          10043
        </td>
        <td>
          Block
        </td>
        <td>
          scala.collection.immutable.StringLike.toDouble
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.augmentString(new scala.Predef.String(b, java.nio.charset.StandardCharsets.UTF_8)).toDouble
        </td>
      </tr><tr>
        <td>
          275
        </td>
        <td>
          99733
        </td>
        <td>
          10072
          -
          10158
        </td>
        <td>
          Throw
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          throw new java.lang.IllegalStateException(scala.StringContext.apply(&quot;Unexpected score type: &quot;, &quot;&quot;).s(list.get(i.+(1)).getClass()))
        </td>
      </tr><tr>
        <td>
          275
        </td>
        <td>
          99734
        </td>
        <td>
          10072
          -
          10158
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          throw new java.lang.IllegalStateException(scala.StringContext.apply(&quot;Unexpected score type: &quot;, &quot;&quot;).s(list.get(i.+(1)).getClass()))
        </td>
      </tr><tr>
        <td>
          277
        </td>
        <td>
          99735
        </td>
        <td>
          10227
          -
          10232
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.double2Double
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.double2Double(score)
        </td>
      </tr><tr>
        <td>
          277
        </td>
        <td>
          99737
        </td>
        <td>
          10193
          -
          10234
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.ArrayList.add
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          tuples.add(new redis.clients.jedis.resps.Tuple(member, scala.Predef.double2Double(score)))
        </td>
      </tr><tr>
        <td>
          277
        </td>
        <td>
          99736
        </td>
        <td>
          10204
          -
          10233
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.resps.Tuple.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new redis.clients.jedis.resps.Tuple(member, scala.Predef.double2Double(score))
        </td>
      </tr><tr>
        <td>
          278
        </td>
        <td>
          99738
        </td>
        <td>
          10251
          -
          10257
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.+(2)
        </td>
      </tr><tr>
        <td>
          281
        </td>
        <td>
          99745
        </td>
        <td>
          10317
          -
          10352
        </td>
        <td>
          Block
        </td>
        <td>
          java.util.Collections.emptyList
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.util.Collections.emptyList[redis.clients.jedis.resps.Tuple]()
        </td>
      </tr><tr>
        <td>
          281
        </td>
        <td>
          99744
        </td>
        <td>
          10317
          -
          10352
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.Collections.emptyList
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.util.Collections.emptyList[redis.clients.jedis.resps.Tuple]()
        </td>
      </tr><tr>
        <td>
          288
        </td>
        <td>
          99748
        </td>
        <td>
          10543
          -
          10578
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.Collections.emptyList
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          java.util.Collections.emptyList[redis.clients.jedis.resps.Tuple]()
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          99749
        </td>
        <td>
          10709
          -
          10717
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.lockPath
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.lockPath
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          99751
        </td>
        <td>
          10700
          -
          10741
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.index.utils.DistributedLocking.withLock
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.withLock[java.util.List[redis.clients.jedis.resps.Tuple]](AgeOffRunner.this.lockPath, AgeOffRunner.this.timeout, exec, noLock)
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          99750
        </td>
        <td>
          10719
          -
          10726
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.timeout
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.timeout
        </td>
      </tr><tr>
        <td>
          292
        </td>
        <td>
          99752
        </td>
        <td>
          10700
          -
          10741
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.index.utils.DistributedLocking.withLock
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.withLock[java.util.List[redis.clients.jedis.resps.Tuple]](AgeOffRunner.this.lockPath, AgeOffRunner.this.timeout, exec, noLock)
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          99754
        </td>
        <td>
          10777
          -
          10882
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  (if (RedisAgeOff.this.logger.underlying.isErrorEnabled())
    RedisAgeOff.this.logger.underlying.error(&quot;Error executing ttl script:&quot;, e)
  else
    (): Unit);
  java.util.Collections.emptyList[redis.clients.jedis.resps.Tuple]()
}
        </td>
      </tr><tr>
        <td>
          295
        </td>
        <td>
          99753
        </td>
        <td>
          10847
          -
          10882
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.Collections.emptyList
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          java.util.Collections.emptyList[redis.clients.jedis.resps.Tuple]()
        </td>
      </tr><tr>
        <td>
          310
        </td>
        <td>
          99789
        </td>
        <td>
          11283
          -
          12705
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val fids: java.util.HashSet[org.geotools.api.filter.identity.Identifier] = new java.util.HashSet[org.geotools.api.filter.identity.Identifier](ids.size());
  scala.collection.JavaConverters.asScalaBufferConverter[redis.clients.jedis.resps.Tuple](ids).asScala.foreach[Boolean](((id: redis.clients.jedis.resps.Tuple) =&gt; fids.add(org.locationtech.geomesa.filter.FilterHelper.ff.featureId(id.getElement()))));
  (if (RedisAgeOff.this.logger.underlying.isTraceEnabled())
    RedisAgeOff.this.logger.underlying.trace(&quot;Age-off for schema \'{}\' found the following features: {}&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), (fids: AnyRef))((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
  else
    (): Unit);
  val trace: Boolean = RedisAgeOff.this.logger.underlying.isTraceEnabled();
  &lt;stable&gt; &lt;accessor&gt; lazy val results: scala.collection.mutable.ListBuffer[String] = scala.collection.mutable.ListBuffer.empty[String];
  var i: Int = 0;
  org.locationtech.geomesa.utils.io.`package`.WithClose.apply[org.locationtech.geomesa.index.FlushableFeatureWriter, Unit](AgeOffRunner.this.ds.getFeatureWriter(AgeOffRunner.this.typeName, org.locationtech.geomesa.filter.FilterHelper.ff.id(fids), org.geotools.api.data.Transaction.AUTO_COMMIT))(((writer: org.locationtech.geomesa.index.FlushableFeatureWriter) =&gt; while$2(){
    if (writer.hasNext())
      {
        {
          val sf: org.geotools.api.feature.simple.SimpleFeature = writer.next();
          val ttl: Object = sf.getUserData().get(RedisAgeOff.this.TtlUserDataKey);
          if (ttl.!=(null).&amp;&amp;(ttl.asInstanceOf[Long].&lt;=(timestamp)))
            {
              writer.remove();
              i = i.+(1);
              if (trace)
                results.+=(sf.getID())
              else
                ()
            }
          else
            (if (RedisAgeOff.this.logger.underlying.isDebugEnabled())
              RedisAgeOff.this.logger.underlying.debug(&quot;Age-off for schema \'{}\' ignoring updated feature: {}&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), (sf.getID(): AnyRef))((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
            else
              (): Unit)
        };
        while$2()
      }
    else
      ()
  }))(io.this.IsCloseable.closeableIsCloseable);
  (if (RedisAgeOff.this.logger.underlying.isDebugEnabled())
    RedisAgeOff.this.logger.underlying.debug(&quot;Age-off for schema \'{}\' removed {} features&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), i.asInstanceOf[AnyRef])((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
  else
    (): Unit);
  (if (RedisAgeOff.this.logger.underlying.isTraceEnabled())
    RedisAgeOff.this.logger.underlying.trace(&quot;Age-off for schema \'{}\' removed the following features: [{}]&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), (results.mkString(&quot;, &quot;): AnyRef))((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
  else
    (): Unit)
}
        </td>
      </tr><tr>
        <td>
          311
        </td>
        <td>
          99755
        </td>
        <td>
          11328
          -
          11336
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.List.size
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ids.size()
        </td>
      </tr><tr>
        <td>
          311
        </td>
        <td>
          99756
        </td>
        <td>
          11294
          -
          11337
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashSet.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new java.util.HashSet[org.geotools.api.filter.identity.Identifier](ids.size())
        </td>
      </tr><tr>
        <td>
          312
        </td>
        <td>
          99757
        </td>
        <td>
          11407
          -
          11420
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.resps.Tuple.getElement
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          id.getElement()
        </td>
      </tr><tr>
        <td>
          312
        </td>
        <td>
          99759
        </td>
        <td>
          11372
          -
          11422
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashSet.add
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          fids.add(org.locationtech.geomesa.filter.FilterHelper.ff.featureId(id.getElement()))
        </td>
      </tr><tr>
        <td>
          312
        </td>
        <td>
          99758
        </td>
        <td>
          11381
          -
          11421
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.filter.FilterFactory.featureId
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.filter.FilterHelper.ff.featureId(id.getElement())
        </td>
      </tr><tr>
        <td>
          312
        </td>
        <td>
          99760
        </td>
        <td>
          11346
          -
          11423
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.collection.JavaConverters.asScalaBufferConverter[redis.clients.jedis.resps.Tuple](ids).asScala.foreach[Boolean](((id: redis.clients.jedis.resps.Tuple) =&gt; fids.add(org.locationtech.geomesa.filter.FilterHelper.ff.featureId(id.getElement()))))
        </td>
      </tr><tr>
        <td>
          315
        </td>
        <td>
          99761
        </td>
        <td>
          11537
          -
          11569
        </td>
        <td>
          Apply
        </td>
        <td>
          org.slf4j.Logger.isTraceEnabled
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.logger.underlying.isTraceEnabled()
        </td>
      </tr><tr>
        <td>
          318
        </td>
        <td>
          99762
        </td>
        <td>
          11639
          -
          11640
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          319
        </td>
        <td>
          99763
        </td>
        <td>
          11679
          -
          11687
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.typeName
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.typeName
        </td>
      </tr><tr>
        <td>
          319
        </td>
        <td>
          99765
        </td>
        <td>
          11715
          -
          11738
        </td>
        <td>
          Select
        </td>
        <td>
          org.geotools.api.data.Transaction.AUTO_COMMIT
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.geotools.api.data.Transaction.AUTO_COMMIT
        </td>
      </tr><tr>
        <td>
          319
        </td>
        <td>
          99764
        </td>
        <td>
          11689
          -
          11713
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.filter.FilterFactory.id
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.filter.FilterHelper.ff.id(fids)
        </td>
      </tr><tr>
        <td>
          319
        </td>
        <td>
          99766
        </td>
        <td>
          11659
          -
          11739
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.index.geotools.MetadataBackedDataStore.getFeatureWriter
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          AgeOffRunner.this.ds.getFeatureWriter(AgeOffRunner.this.typeName, org.locationtech.geomesa.filter.FilterHelper.ff.id(fids), org.geotools.api.data.Transaction.AUTO_COMMIT)
        </td>
      </tr><tr>
        <td>
          319
        </td>
        <td>
          99787
        </td>
        <td>
          11741
          -
          11741
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          319
        </td>
        <td>
          99788
        </td>
        <td>
          11649
          -
          12513
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[org.locationtech.geomesa.index.FlushableFeatureWriter, Unit](AgeOffRunner.this.ds.getFeatureWriter(AgeOffRunner.this.typeName, org.locationtech.geomesa.filter.FilterHelper.ff.id(fids), org.geotools.api.data.Transaction.AUTO_COMMIT))(((writer: org.locationtech.geomesa.index.FlushableFeatureWriter) =&gt; while$2(){
  if (writer.hasNext())
    {
      {
        val sf: org.geotools.api.feature.simple.SimpleFeature = writer.next();
        val ttl: Object = sf.getUserData().get(RedisAgeOff.this.TtlUserDataKey);
        if (ttl.!=(null).&amp;&amp;(ttl.asInstanceOf[Long].&lt;=(timestamp)))
          {
            writer.remove();
            i = i.+(1);
            if (trace)
              results.+=(sf.getID())
            else
              ()
          }
        else
          (if (RedisAgeOff.this.logger.underlying.isDebugEnabled())
            RedisAgeOff.this.logger.underlying.debug(&quot;Age-off for schema \'{}\' ignoring updated feature: {}&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), (sf.getID(): AnyRef))((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
          else
            (): Unit)
      };
      while$2()
    }
  else
    ()
}))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          320
        </td>
        <td>
          99767
        </td>
        <td>
          11770
          -
          11784
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.data.FeatureWriter.hasNext
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          writer.hasNext()
        </td>
      </tr><tr>
        <td>
          320
        </td>
        <td>
          99783
        </td>
        <td>
          11786
          -
          11786
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.while$2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          while$2()
        </td>
      </tr><tr>
        <td>
          320
        </td>
        <td>
          99785
        </td>
        <td>
          11763
          -
          11763
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          320
        </td>
        <td>
          99784
        </td>
        <td>
          11786
          -
          12503
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  {
    val sf: org.geotools.api.feature.simple.SimpleFeature = writer.next();
    val ttl: Object = sf.getUserData().get(RedisAgeOff.this.TtlUserDataKey);
    if (ttl.!=(null).&amp;&amp;(ttl.asInstanceOf[Long].&lt;=(timestamp)))
      {
        writer.remove();
        i = i.+(1);
        if (trace)
          results.+=(sf.getID())
        else
          ()
      }
    else
      (if (RedisAgeOff.this.logger.underlying.isDebugEnabled())
        RedisAgeOff.this.logger.underlying.debug(&quot;Age-off for schema \'{}\' ignoring updated feature: {}&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), (sf.getID(): AnyRef))((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
      else
        (): Unit)
  };
  while$2()
}
        </td>
      </tr><tr>
        <td>
          320
        </td>
        <td>
          99786
        </td>
        <td>
          11763
          -
          11763
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          321
        </td>
        <td>
          99768
        </td>
        <td>
          11809
          -
          11822
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.data.FeatureWriter.next
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          writer.next()
        </td>
      </tr><tr>
        <td>
          325
        </td>
        <td>
          99769
        </td>
        <td>
          12141
          -
          12155
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.TtlUserDataKey
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          RedisAgeOff.this.TtlUserDataKey
        </td>
      </tr><tr>
        <td>
          325
        </td>
        <td>
          99770
        </td>
        <td>
          12122
          -
          12156
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.Map.get
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          sf.getUserData().get(RedisAgeOff.this.TtlUserDataKey)
        </td>
      </tr><tr>
        <td>
          326
        </td>
        <td>
          99771
        </td>
        <td>
          12180
          -
          12184
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          null
        </td>
      </tr><tr>
        <td>
          326
        </td>
        <td>
          99773
        </td>
        <td>
          12173
          -
          12223
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ttl.!=(null).&amp;&amp;(ttl.asInstanceOf[Long].&lt;=(timestamp))
        </td>
      </tr><tr>
        <td>
          326
        </td>
        <td>
          99772
        </td>
        <td>
          12188
          -
          12223
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Long.&lt;=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ttl.asInstanceOf[Long].&lt;=(timestamp)
        </td>
      </tr><tr>
        <td>
          326
        </td>
        <td>
          99781
        </td>
        <td>
          12225
          -
          12370
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  writer.remove();
  i = i.+(1);
  if (trace)
    results.+=(sf.getID())
  else
    ()
}
        </td>
      </tr><tr>
        <td>
          327
        </td>
        <td>
          99774
        </td>
        <td>
          12241
          -
          12256
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.data.FeatureWriter.remove
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          writer.remove()
        </td>
      </tr><tr>
        <td>
          328
        </td>
        <td>
          99775
        </td>
        <td>
          12271
          -
          12277
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.+(1)
        </td>
      </tr><tr>
        <td>
          329
        </td>
        <td>
          99779
        </td>
        <td>
          12292
          -
          12292
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          329
        </td>
        <td>
          99780
        </td>
        <td>
          12292
          -
          12292
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          330
        </td>
        <td>
          99777
        </td>
        <td>
          12321
          -
          12340
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.ListBuffer.+=
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          results.+=(sf.getID())
        </td>
      </tr><tr>
        <td>
          330
        </td>
        <td>
          99776
        </td>
        <td>
          12332
          -
          12340
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeature.getID
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          sf.getID()
        </td>
      </tr><tr>
        <td>
          330
        </td>
        <td>
          99778
        </td>
        <td>
          12321
          -
          12340
        </td>
        <td>
          Block
        </td>
        <td>
          scala.collection.mutable.ListBuffer.+=
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          results.+=(sf.getID())
        </td>
      </tr><tr>
        <td>
          333
        </td>
        <td>
          99782
        </td>
        <td>
          12392
          -
          12477
        </td>
        <td>
          Typed
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          (if (RedisAgeOff.this.logger.underlying.isDebugEnabled())
  RedisAgeOff.this.logger.underlying.debug(&quot;Age-off for schema \'{}\' ignoring updated feature: {}&quot;, (scala.Array.apply[AnyRef]((AgeOffRunner.this.typeName: AnyRef), (sf.getID(): AnyRef))((ClassTag.AnyRef: scala.reflect.ClassTag[AnyRef])): _*))
else
  (): Unit)
        </td>
      </tr><tr>
        <td>
          340
        </td>
        <td>
          99791
        </td>
        <td>
          12747
          -
          12934
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  (if (RedisAgeOff.this.logger.underlying.isErrorEnabled())
    RedisAgeOff.this.logger.underlying.error(scala.StringContext.apply(&quot;Error executing age-off for schema \'&quot;, &quot;\':&quot;).s(AgeOffRunner.this.typeName), e)
  else
    (): Unit);
  AgeOffRunner.this.reinsertFailedIds(ids)
}
        </td>
      </tr><tr>
        <td>
          343
        </td>
        <td>
          99790
        </td>
        <td>
          12912
          -
          12934
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.reinsertFailedIds
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          AgeOffRunner.this.reinsertFailedIds(ids)
        </td>
      </tr><tr>
        <td>
          353
        </td>
        <td>
          99806
        </td>
        <td>
          13189
          -
          13612
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  (if (RedisAgeOff.this.logger.underlying.isDebugEnabled())
    RedisAgeOff.this.logger.underlying.debug(&quot;Age-off for schema \'{}\' re-inserting ttls&quot;, (AgeOffRunner.this.typeName: AnyRef))
  else
    (): Unit);
  val reinserts: java.util.HashMap[Array[Byte],Double] = new java.util.HashMap[Array[Byte],Double](ids.size());
  scala.collection.JavaConverters.asScalaBufferConverter[redis.clients.jedis.resps.Tuple](ids).asScala.foreach[Double](((id: redis.clients.jedis.resps.Tuple) =&gt; reinserts.put(id.getBinaryElement(), scala.Predef.double2Double(id.getScore()))));
  {
    org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](AgeOffRunner.this.ds.connection.getResource())(((x$12: _$1) =&gt; x$12.zadd(AgeOffRunner.this.table, reinserts, new redis.clients.jedis.params.ZAddParams().nx())))(io.this.IsCloseable.closeableIsCloseable);
    ()
  }
}
        </td>
      </tr><tr>
        <td>
          355
        </td>
        <td>
          99793
        </td>
        <td>
          13279
          -
          13341
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashMap.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new java.util.HashMap[Array[Byte],Double](ids.size())
        </td>
      </tr><tr>
        <td>
          355
        </td>
        <td>
          99792
        </td>
        <td>
          13332
          -
          13340
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.List.size
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ids.size()
        </td>
      </tr><tr>
        <td>
          356
        </td>
        <td>
          99795
        </td>
        <td>
          13411
          -
          13422
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.resps.Tuple.getScore
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          id.getScore()
        </td>
      </tr><tr>
        <td>
          356
        </td>
        <td>
          99794
        </td>
        <td>
          13390
          -
          13409
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.resps.Tuple.getBinaryElement
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          id.getBinaryElement()
        </td>
      </tr><tr>
        <td>
          356
        </td>
        <td>
          99797
        </td>
        <td>
          13376
          -
          13423
        </td>
        <td>
          Apply
        </td>
        <td>
          java.util.HashMap.put
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          reinserts.put(id.getBinaryElement(), scala.Predef.double2Double(id.getScore()))
        </td>
      </tr><tr>
        <td>
          356
        </td>
        <td>
          99796
        </td>
        <td>
          13411
          -
          13422
        </td>
        <td>
          ApplyImplicitView
        </td>
        <td>
          scala.Predef.double2Double
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.Predef.double2Double(id.getScore())
        </td>
      </tr><tr>
        <td>
          356
        </td>
        <td>
          99798
        </td>
        <td>
          13350
          -
          13424
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IterableLike.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.collection.JavaConverters.asScalaBufferConverter[redis.clients.jedis.resps.Tuple](ids).asScala.foreach[Double](((id: redis.clients.jedis.resps.Tuple) =&gt; reinserts.put(id.getBinaryElement(), scala.Predef.double2Double(id.getScore()))))
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99799
        </td>
        <td>
          13537
          -
          13562
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.util.Pool.getResource
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          AgeOffRunner.this.ds.connection.getResource()
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99801
        </td>
        <td>
          13589
          -
          13610
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.params.ZAddParams.nx
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          new redis.clients.jedis.params.ZAddParams().nx()
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99800
        </td>
        <td>
          13571
          -
          13576
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.redis.data.index.RedisAgeOff.AgeOffRunner.table
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          AgeOffRunner.this.table
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99803
        </td>
        <td>
          13563
          -
          13563
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99802
        </td>
        <td>
          13564
          -
          13611
        </td>
        <td>
          Apply
        </td>
        <td>
          redis.clients.jedis.commands.SortedSetBinaryCommands.zadd
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          x$12.zadd(AgeOffRunner.this.table, reinserts, new redis.clients.jedis.params.ZAddParams().nx())
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99805
        </td>
        <td>
          13563
          -
          13563
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          358
        </td>
        <td>
          99804
        </td>
        <td>
          13527
          -
          13612
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.WithClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.utils.io.`package`.WithClose.apply[_$1, Long](AgeOffRunner.this.ds.connection.getResource())(((x$12: _$1) =&gt; x$12.zadd(AgeOffRunner.this.table, reinserts, new redis.clients.jedis.params.ZAddParams().nx())))(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          361
        </td>
        <td>
          99807
        </td>
        <td>
          13667
          -
          13845
        </td>
        <td>
          Typed
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          (if (RedisAgeOff.this.logger.underlying.isErrorEnabled())
  RedisAgeOff.this.logger.underlying.error(scala.StringContext.apply(&quot;Error re-inserting ttls for schema \'&quot;, &quot;\'. The following features &quot;).s(AgeOffRunner.this.typeName).+(scala.StringContext.apply(&quot;may never expire: [&quot;, &quot;]&quot;).s(scala.collection.JavaConverters.asScalaBufferConverter[redis.clients.jedis.resps.Tuple](ids).asScala.map[String, scala.collection.mutable.Buffer[String]](((x$13: redis.clients.jedis.resps.Tuple) =&gt; x$13.getElement()))(mutable.this.Buffer.canBuildFrom[String]).mkString(&quot;, &quot;))), e)
else
  (): Unit)
        </td>
      </tr>
    </table>
          </div>
        </div>
      </body>
    </html>