<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title id="title">
          org/locationtech/geomesa/arrow/io/BatchWriter.scala.html
        </title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/css/theme.default.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/js/jquery.tablesorter.min.js"></script><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" type="text/css"/><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script><script type="text/javascript">
        $(document).ready(function() {$(".tablesorter").tablesorter();});
      </script>
        <style>
          table.codegrid { font-family: monospace; font-size: 12px; width: auto!important; }table.statementlist { width: auto!important; font-size: 13px; } table.codegrid td { padding: 0!important; border: 0!important } table td.linenumber { width: 40px!important; } 
        </style>
      </head>
      <body style="font-family: monospace;">
        <ul class="nav nav-tabs">
          <li>
            <a href="#codegrid" data-toggle="tab">Codegrid</a>
          </li>
          <li>
            <a href="#statementlist" data-toggle="tab">Statement List</a>
          </li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="codegrid">
            <pre style='font-size: 12pt; font-family: courier, monospace;'>1 <span style=''>/***********************************************************************
</span>2 <span style=''> * Copyright (c) 2013-2025 General Atomics Integrated Intelligence, Inc.
</span>3 <span style=''> * All rights reserved. This program and the accompanying materials
</span>4 <span style=''> * are made available under the terms of the Apache License, Version 2.0
</span>5 <span style=''> * which accompanies this distribution and is available at
</span>6 <span style=''> * https://www.apache.org/licenses/LICENSE-2.0
</span>7 <span style=''> ***********************************************************************/
</span>8 <span style=''>
</span>9 <span style=''>package org.locationtech.geomesa.arrow.io
</span>10 <span style=''>
</span>11 <span style=''>import org.apache.arrow.vector.ipc.message.IpcOption
</span>12 <span style=''>import org.geotools.api.feature.simple.SimpleFeatureType
</span>13 <span style=''>import org.locationtech.geomesa.arrow.io.records.{RecordBatchLoader, RecordBatchUnloader}
</span>14 <span style=''>import org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.{ArrowDictionaryReader, ArrowListDictionaryReader}
</span>15 <span style=''>import org.locationtech.geomesa.arrow.vector.SimpleFeatureVector.SimpleFeatureEncoding
</span>16 <span style=''>import org.locationtech.geomesa.arrow.vector._
</span>17 <span style=''>import org.locationtech.geomesa.utils.collection.CloseableIterator
</span>18 <span style=''>import org.locationtech.geomesa.utils.geotools.{AttributeOrdering, ObjectType}
</span>19 <span style=''>import org.locationtech.geomesa.utils.io.{CloseQuietly, CloseWithLogging}
</span>20 <span style=''>
</span>21 <span style=''>object BatchWriter {
</span>22 <span style=''>
</span>23 <span style=''>  import org.locationtech.geomesa.utils.geotools.RichAttributeDescriptors.RichAttributeDescriptor
</span>24 <span style=''>
</span>25 <span style=''>  /**
</span>26 <span style=''>   * Reduce function for batches with a common dictionary
</span>27 <span style=''>   *
</span>28 <span style=''>   * @param sft simple feature type
</span>29 <span style=''>   * @param dictionaries dictionaries
</span>30 <span style=''>   * @param encoding simple feature encoding
</span>31 <span style=''>   * @param sort sort metadata, if defined each batch is assumed to be sorted
</span>32 <span style=''>   * @param sorted whether the batches are already globally sorted
</span>33 <span style=''>   * @param batchSize batch size
</span>34 <span style=''>   * @param batches record batches
</span>35 <span style=''>   * @return
</span>36 <span style=''>   */
</span>37 <span style=''>  def reduce(
</span>38 <span style=''>      sft: SimpleFeatureType,
</span>39 <span style=''>      dictionaries: Map[String, ArrowDictionary],
</span>40 <span style=''>      encoding: SimpleFeatureEncoding,
</span>41 <span style=''>      ipcOpts: IpcOption,
</span>42 <span style=''>      sort: Option[(String, Boolean)],
</span>43 <span style=''>      sorted: Boolean,
</span>44 <span style=''>      batchSize: Int,
</span>45 <span style=''>      batches: CloseableIterator[Array[Byte]]): CloseableIterator[Array[Byte]] = {
</span>46 <span style=''>    val (iter, firstBatchHasHeader) = if (sorted || sort.isEmpty) { (batches, false) } else {
</span>47 <span style=''>      val Some((f, r)) = sort
</span>48 <span style=''>      (new BatchSortingIterator(sft, dictionaries, encoding, ipcOpts, f, r, batchSize, batches), true)
</span>49 <span style=''>    }
</span>50 <span style=''>    </span><span style='background: #AEF1AE'>createFileFromBatches(sft, dictionaries, encoding, ipcOpts, sort, iter, firstBatchHasHeader)</span><span style=''>
</span>51 <span style=''>  }
</span>52 <span style=''>
</span>53 <span style=''>  /**
</span>54 <span style=''>   * Globally sorts batches. Each batch is expected to already be locally sorted.
</span>55 <span style=''>   *
</span>56 <span style=''>   * By default, the first batch will include the arrow file header metadata.
</span>57 <span style=''>   *
</span>58 <span style=''>   * @param sft simple feature type
</span>59 <span style=''>   * @param dictionaries dictionaries
</span>60 <span style=''>   * @param encoding encoding
</span>61 <span style=''>   * @param sortBy sort by field
</span>62 <span style=''>   * @param reverse sort is reversed?
</span>63 <span style=''>   * @param batchSize number of records per batch
</span>64 <span style=''>   * @param batches locally sorted batches
</span>65 <span style=''>   * @param writeHeader if true, the first batch will include the arrow file header
</span>66 <span style=''>   */
</span>67 <span style=''>  private [io] class BatchSortingIterator(
</span>68 <span style=''>      sft: SimpleFeatureType,
</span>69 <span style=''>      dictionaries: Map[String, ArrowDictionary],
</span>70 <span style=''>      encoding: SimpleFeatureEncoding,
</span>71 <span style=''>      ipcOpts: IpcOption,
</span>72 <span style=''>      sortBy: String,
</span>73 <span style=''>      reverse: Boolean,
</span>74 <span style=''>      batchSize: Int,
</span>75 <span style=''>      batches: CloseableIterator[Array[Byte]],
</span>76 <span style=''>      private var writeHeader: Boolean = true
</span>77 <span style=''>    ) extends CloseableIterator[Array[Byte]] {
</span>78 <span style=''>
</span>79 <span style=''>    private val result = </span><span style='background: #AEF1AE'>SimpleFeatureVector.create(sft, dictionaries, encoding)</span><span style=''>
</span>80 <span style=''>    private val unloader = </span><span style='background: #AEF1AE'>new RecordBatchUnloader(result, ipcOpts)</span><span style=''>
</span>81 <span style=''>
</span>82 <span style=''>    private var batch: Array[Byte] = _
</span>83 <span style=''>
</span>84 <span style=''>    // gets the attribute we're sorting by from the i-th feature in the vector
</span>85 <span style=''>    val getSortAttribute: (SimpleFeatureVector, Int) =&gt; AnyRef = {
</span>86 <span style=''>      val sortByIndex = </span><span style='background: #AEF1AE'>sft.indexOf(sortBy)</span><span style=''>
</span>87 <span style=''>      if (</span><span style='background: #AEF1AE'>dictionaries.contains(sortBy)</span><span style=''>) {
</span>88 <span style=''>        // since we've sorted the dictionaries, we can just compare the encoded index values
</span>89 <span style=''>        </span><span style='background: #F0ADAD'>if (sft.getDescriptor(sortBy).isList) {
</span>90 <span style=''></span><span style='background: #F0ADAD'>          (vector, i) =&gt; vector.reader.feature.getReader(sortByIndex).asInstanceOf[ArrowListDictionaryReader].getEncoded(i)
</span>91 <span style=''></span><span style='background: #F0ADAD'>        } else {
</span>92 <span style=''></span><span style='background: #F0ADAD'>          (vector, i) =&gt; vector.reader.feature.getReader(sortByIndex).asInstanceOf[ArrowDictionaryReader].getEncoded(i)
</span>93 <span style=''></span><span style='background: #F0ADAD'>        }</span><span style=''>
</span>94 <span style=''>      } else {
</span>95 <span style=''>        </span><span style='background: #AEF1AE'>(vector, i) =&gt; vector.reader.feature.getReader(sortByIndex).apply(i)</span><span style=''>
</span>96 <span style=''>      }
</span>97 <span style=''>    }
</span>98 <span style=''>
</span>99 <span style=''>    // this is lazy to allow the query plan to be instantiated without pulling back all the batches first
</span>100 <span style=''>    private lazy val inputs: Array[(SimpleFeatureVector, (Int, Int) =&gt; Unit)] = {
</span>101 <span style=''>      val builder = Array.newBuilder[(SimpleFeatureVector, (Int, Int) =&gt; Unit)]
</span>102 <span style=''>      var vector: SimpleFeatureVector = null
</span>103 <span style=''>      try {
</span>104 <span style=''>        while (batches.hasNext) {
</span>105 <span style=''>          vector = SimpleFeatureVector.create(sft, dictionaries, encoding)
</span>106 <span style=''>          val batch = batches.next
</span>107 <span style=''>          RecordBatchLoader.load(vector.underlying, batch)
</span>108 <span style=''>
</span>109 <span style=''>          val transfers: Seq[(Int, Int) =&gt; Unit] = {
</span>110 <span style=''>            val fromVectors = vector.underlying.getChildrenFromFields
</span>111 <span style=''>            val toVectors = result.underlying.getChildrenFromFields
</span>112 <span style=''>            val builder = Seq.newBuilder[(Int, Int) =&gt; Unit]
</span>113 <span style=''>            builder.sizeHint(fromVectors.size())
</span>114 <span style=''>            var i = 0
</span>115 <span style=''>            while (i &lt; fromVectors.size()) {
</span>116 <span style=''>              builder += createTransferPair(sft, fromVectors.get(i), toVectors.get(i))
</span>117 <span style=''>              i += 1
</span>118 <span style=''>            }
</span>119 <span style=''>            builder.result()
</span>120 <span style=''>          }
</span>121 <span style=''>          val transfer: (Int, Int) =&gt; Unit = (from, to) =&gt; transfers.foreach(_.apply(from, to))
</span>122 <span style=''>          builder += vector -&gt; transfer
</span>123 <span style=''>        }
</span>124 <span style=''>        builder.result
</span>125 <span style=''>      } catch {
</span>126 <span style=''>        case t: Throwable =&gt;
</span>127 <span style=''>          CloseWithLogging(result, batches)
</span>128 <span style=''>          CloseWithLogging(builder.result().map(_._1))
</span>129 <span style=''>          if (vector != null) {
</span>130 <span style=''>            CloseQuietly(vector).foreach(t.addSuppressed)
</span>131 <span style=''>          }
</span>132 <span style=''>          throw t
</span>133 <span style=''>      }
</span>134 <span style=''>    }
</span>135 <span style=''>
</span>136 <span style=''>    // we do a merge sort of each batch
</span>137 <span style=''>    // sorted queue of [(current batch value, current index in that batch, number of the batch)]
</span>138 <span style=''>    private lazy val queue = {
</span>139 <span style=''>      // populate with the first element from each batch
</span>140 <span style=''>      // note: need to flip ordering here as highest sorted values come off the queue first
</span>141 <span style=''>      val order = {
</span>142 <span style=''>        val descriptor = sft.getDescriptor(sortBy)
</span>143 <span style=''>        val bindings = if (dictionaries.contains(sortBy)) {
</span>144 <span style=''>          if (descriptor.isList) { Seq(ObjectType.LIST, ObjectType.INT) } else { Seq(ObjectType.INT) }
</span>145 <span style=''>        } else {
</span>146 <span style=''>          ObjectType.selectType(descriptor)
</span>147 <span style=''>        }
</span>148 <span style=''>        val base = AttributeOrdering(bindings)
</span>149 <span style=''>        Ordering.by[(AnyRef, Int, Int), AnyRef](_._1)(if (reverse) { base } else { base.reverse })
</span>150 <span style=''>      }
</span>151 <span style=''>      val heads = scala.collection.mutable.PriorityQueue.empty[(AnyRef, Int, Int)](order)
</span>152 <span style=''>      var i = 0
</span>153 <span style=''>      while (i &lt; inputs.length) {
</span>154 <span style=''>        val vector = inputs(i)._1
</span>155 <span style=''>        if (vector.reader.getValueCount &gt; 0) {
</span>156 <span style=''>          heads.+=((getSortAttribute(vector, 0), 0, i))
</span>157 <span style=''>        } else {
</span>158 <span style=''>          CloseWithLogging(vector)
</span>159 <span style=''>        }
</span>160 <span style=''>        i += 1
</span>161 <span style=''>      }
</span>162 <span style=''>      heads
</span>163 <span style=''>    }
</span>164 <span style=''>
</span>165 <span style=''>    // gets the next record batch to write - returns null if no further records
</span>166 <span style=''>    private def nextBatch(): Array[Byte] = {
</span>167 <span style=''>      if (</span><span style='background: #AEF1AE'>queue.isEmpty</span><span style=''>) { </span><span style='background: #AEF1AE'>null</span><span style=''> } else </span><span style='background: #AEF1AE'>{
</span>168 <span style=''></span><span style='background: #AEF1AE'>        result.clear()
</span>169 <span style=''></span><span style='background: #AEF1AE'>        var resultIndex = 0
</span>170 <span style=''></span><span style='background: #AEF1AE'>        // copy the next sorted value and then queue and sort the next element out of the batch we copied from
</span>171 <span style=''></span><span style='background: #AEF1AE'>        while (queue.nonEmpty &amp;&amp; resultIndex &lt; batchSize) {
</span>172 <span style=''></span><span style='background: #AEF1AE'>          val (_, i, batch) = queue.dequeue()
</span>173 <span style=''></span><span style='background: #AEF1AE'>          val (vector, transfer) = inputs(batch)
</span>174 <span style=''></span><span style='background: #AEF1AE'>          transfer.apply(i, resultIndex)
</span>175 <span style=''></span><span style='background: #AEF1AE'>          result.underlying.setIndexDefined(resultIndex)
</span>176 <span style=''></span><span style='background: #AEF1AE'>          resultIndex += 1
</span>177 <span style=''></span><span style='background: #AEF1AE'>          val nextBatchIndex = i + 1
</span>178 <span style=''></span><span style='background: #AEF1AE'>          if (vector.reader.getValueCount &gt; nextBatchIndex) {
</span>179 <span style=''></span><span style='background: #AEF1AE'>            val value = getSortAttribute(vector, nextBatchIndex)
</span>180 <span style=''></span><span style='background: #AEF1AE'>            queue.+=((value, nextBatchIndex, batch))
</span>181 <span style=''></span><span style='background: #AEF1AE'>          } else {
</span>182 <span style=''></span><span style='background: #AEF1AE'>            CloseWithLogging(vector)
</span>183 <span style=''></span><span style='background: #AEF1AE'>          }
</span>184 <span style=''></span><span style='background: #AEF1AE'>        }
</span>185 <span style=''></span><span style='background: #AEF1AE'>        if (writeHeader) {
</span>186 <span style=''></span><span style='background: #AEF1AE'>          writeHeader = false
</span>187 <span style=''></span><span style='background: #AEF1AE'>          writeHeaderAndFirstBatch(result, dictionaries, ipcOpts, Some(sortBy -&gt; reverse), resultIndex)
</span>188 <span style=''></span><span style='background: #AEF1AE'>        } else {
</span>189 <span style=''></span><span style='background: #AEF1AE'>          unloader.unload(resultIndex)
</span>190 <span style=''></span><span style='background: #AEF1AE'>        }
</span>191 <span style=''></span><span style='background: #AEF1AE'>      }</span><span style=''>
</span>192 <span style=''>    }
</span>193 <span style=''>
</span>194 <span style=''>    override def hasNext: Boolean = {
</span>195 <span style=''>      if (</span><span style='background: #AEF1AE'>batch == null</span><span style=''>) {
</span>196 <span style=''>        </span><span style='background: #AEF1AE'>batch = nextBatch()</span><span style=''>
</span>197 <span style=''>      }
</span>198 <span style=''>      </span><span style='background: #AEF1AE'>batch != null</span><span style=''>
</span>199 <span style=''>    }
</span>200 <span style=''>
</span>201 <span style=''>    override def next(): Array[Byte] = {
</span>202 <span style=''>      val res = </span><span style='background: #AEF1AE'>batch</span><span style=''>
</span>203 <span style=''>      </span><span style='background: #AEF1AE'>batch = null</span><span style=''>
</span>204 <span style=''>      res
</span>205 <span style=''>    }
</span>206 <span style=''>
</span>207 <span style=''>    override def close(): Unit = {
</span>208 <span style=''>      </span><span style='background: #AEF1AE'>CloseWithLogging(result, batches)</span><span style=''>
</span>209 <span style=''>      </span><span style='background: #AEF1AE'>inputs.foreach { case (vector, _) =&gt; CloseWithLogging(vector) }</span><span style=''>
</span>210 <span style=''>    }
</span>211 <span style=''>  }
</span>212 <span style=''>}
</span></pre>
          </div>
          <div class="tab-pane" id="statementlist">
            <table cellspacing="0" cellpadding="0" class="table statementlist">
      <tr>
        <th>Line</th>
        <th>Stmt Id</th>
        <th>Pos</th>
        <th>Tree</th>
        <th>Symbol</th>
        <th>Tests</th>
        <th>Code</th>
      </tr><tr>
        <td>
          46
        </td>
        <td>
          27988
        </td>
        <td>
          2059
          -
          2059
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$2._1
        </td>
      </tr><tr>
        <td>
          46
        </td>
        <td>
          27989
        </td>
        <td>
          2065
          -
          2065
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$2._2
        </td>
      </tr><tr>
        <td>
          50
        </td>
        <td>
          27990
        </td>
        <td>
          2287
          -
          2379
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.createFileFromBatches
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.`package`.createFileFromBatches(sft, dictionaries, encoding, ipcOpts, sort, iter, firstBatchHasHeader)
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          27991
        </td>
        <td>
          3368
          -
          3371
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.sft
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.sft
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          27992
        </td>
        <td>
          3373
          -
          3385
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.dictionaries
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.dictionaries
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          27993
        </td>
        <td>
          3387
          -
          3395
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.encoding
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.encoding
        </td>
      </tr><tr>
        <td>
          79
        </td>
        <td>
          27994
        </td>
        <td>
          3341
          -
          3396
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.vector.SimpleFeatureVector.create
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.arrow.vector.SimpleFeatureVector.create(BatchSortingIterator.this.sft, BatchSortingIterator.this.dictionaries, BatchSortingIterator.this.encoding, org.locationtech.geomesa.arrow.vector.SimpleFeatureVector.create$default$4)
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          27995
        </td>
        <td>
          3448
          -
          3454
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.result
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.result
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          27996
        </td>
        <td>
          3456
          -
          3463
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.ipcOpts
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.ipcOpts
        </td>
      </tr><tr>
        <td>
          80
        </td>
        <td>
          27997
        </td>
        <td>
          3424
          -
          3464
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.records.RecordBatchUnloader.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new org.locationtech.geomesa.arrow.io.records.RecordBatchUnloader(BatchSortingIterator.this.result, BatchSortingIterator.this.ipcOpts)
        </td>
      </tr><tr>
        <td>
          86
        </td>
        <td>
          27998
        </td>
        <td>
          3688
          -
          3694
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.sortBy
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.sortBy
        </td>
      </tr><tr>
        <td>
          86
        </td>
        <td>
          27999
        </td>
        <td>
          3676
          -
          3695
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.indexOf
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.sft.indexOf(BatchSortingIterator.this.sortBy)
        </td>
      </tr><tr>
        <td>
          87
        </td>
        <td>
          28000
        </td>
        <td>
          3728
          -
          3734
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.sortBy
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.sortBy
        </td>
      </tr><tr>
        <td>
          87
        </td>
        <td>
          28001
        </td>
        <td>
          3706
          -
          3735
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.MapLike.contains
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.dictionaries.contains(BatchSortingIterator.this.sortBy)
        </td>
      </tr><tr>
        <td>
          89
        </td>
        <td>
          28002
        </td>
        <td>
          3862
          -
          3868
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.sortBy
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BatchSortingIterator.this.sortBy
        </td>
      </tr><tr>
        <td>
          89
        </td>
        <td>
          28003
        </td>
        <td>
          3844
          -
          3869
        </td>
        <td>
          Apply
        </td>
        <td>
          org.geotools.api.feature.simple.SimpleFeatureType.getDescriptor
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BatchSortingIterator.this.sft.getDescriptor(BatchSortingIterator.this.sortBy)
        </td>
      </tr><tr>
        <td>
          89
        </td>
        <td>
          28004
        </td>
        <td>
          3844
          -
          3876
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.geotools.RichAttributeDescriptors.RichAttributeDescriptor.isList
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          org.locationtech.geomesa.utils.geotools.RichAttributeDescriptors.RichAttributeDescriptor(BatchSortingIterator.this.sft.getDescriptor(BatchSortingIterator.this.sortBy)).isList
        </td>
      </tr><tr>
        <td>
          89
        </td>
        <td>
          28009
        </td>
        <td>
          3840
          -
          4150
        </td>
        <td>
          If
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          if (org.locationtech.geomesa.utils.geotools.RichAttributeDescriptors.RichAttributeDescriptor(BatchSortingIterator.this.sft.getDescriptor(BatchSortingIterator.this.sortBy)).isList)
  ((vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, i: Int) =&gt; vector.reader.feature.getReader(sortByIndex).asInstanceOf[org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowListDictionaryReader].getEncoded(i))
else
  ((vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, i: Int) =&gt; vector.reader.feature.getReader(sortByIndex).asInstanceOf[org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowDictionaryReader].getEncoded(i))
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          28005
        </td>
        <td>
          3905
          -
          4003
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowListDictionaryReader.getEncoded
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          vector.reader.feature.getReader(sortByIndex).asInstanceOf[org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowListDictionaryReader].getEncoded(i)
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          28006
        </td>
        <td>
          3890
          -
          4003
        </td>
        <td>
          Function
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.$anonfun
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ((vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, i: Int) =&gt; vector.reader.feature.getReader(sortByIndex).asInstanceOf[org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowListDictionaryReader].getEncoded(i))
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          28007
        </td>
        <td>
          4046
          -
          4140
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowDictionaryReader.getEncoded
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          vector.reader.feature.getReader(sortByIndex).asInstanceOf[org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowDictionaryReader].getEncoded(i)
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          28008
        </td>
        <td>
          4031
          -
          4140
        </td>
        <td>
          Function
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.$anonfun
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ((vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, i: Int) =&gt; vector.reader.feature.getReader(sortByIndex).asInstanceOf[org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.ArrowDictionaryReader].getEncoded(i))
        </td>
      </tr><tr>
        <td>
          95
        </td>
        <td>
          28010
        </td>
        <td>
          4189
          -
          4242
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.vector.ArrowAttributeReader.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          vector.reader.feature.getReader(sortByIndex).apply(i)
        </td>
      </tr><tr>
        <td>
          95
        </td>
        <td>
          28011
        </td>
        <td>
          4174
          -
          4242
        </td>
        <td>
          Function
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.$anonfun
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ((vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, i: Int) =&gt; vector.reader.feature.getReader(sortByIndex).apply(i))
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          28012
        </td>
        <td>
          7058
          -
          7071
        </td>
        <td>
          Select
        </td>
        <td>
          scala.collection.mutable.PriorityQueue.isEmpty
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.queue.isEmpty
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          28013
        </td>
        <td>
          7075
          -
          7079
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          null
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          28014
        </td>
        <td>
          7075
          -
          7079
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          null
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          28053
        </td>
        <td>
          7087
          -
          8060
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  BatchSortingIterator.this.result.clear();
  var resultIndex: Int = 0;
  while$4(){
    if (BatchSortingIterator.this.queue.nonEmpty.&amp;&amp;(resultIndex.&lt;(BatchSortingIterator.this.batchSize)))
      {
        {
          &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$6: (Int, Int) = (BatchSortingIterator.this.queue.dequeue(): (AnyRef, Int, Int) @unchecked) match {
            case (_1: AnyRef, _2: Int, _3: Int)(AnyRef, Int, Int)(_, (i @ _), (batch @ _)) =&gt; scala.Tuple2.apply[Int, Int](i, batch)
          };
          val i: Int = x$6._1;
          val batch: Int = x$6._2;
          &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$7: (org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit) = (BatchSortingIterator.this.inputs.apply(batch): (org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit) @unchecked) match {
            case (_1: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, _2: (Int, Int) =&gt; Unit)(org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit)((vector @ _), (transfer @ _)) =&gt; scala.Tuple2.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit](vector, transfer)
          };
          val vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector = x$7._1;
          val transfer: (Int, Int) =&gt; Unit = x$7._2;
          transfer.apply(i, resultIndex);
          BatchSortingIterator.this.result.underlying.setIndexDefined(resultIndex);
          resultIndex = resultIndex.+(1);
          val nextBatchIndex: Int = i.+(1);
          if (vector.reader.getValueCount.&gt;(nextBatchIndex))
            {
              val value: AnyRef = BatchSortingIterator.this.getSortAttribute.apply(vector, nextBatchIndex);
              BatchSortingIterator.this.queue.+=(scala.Tuple3.apply[AnyRef, Int, Int](value, nextBatchIndex, batch))
            }
          else
            org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
        };
        while$4()
      }
    else
      ()
  };
  if (BatchSortingIterator.this.writeHeader)
    {
      BatchSortingIterator.this.writeHeader_=(false);
      io.this.`package`.writeHeaderAndFirstBatch(BatchSortingIterator.this.result, BatchSortingIterator.this.dictionaries, BatchSortingIterator.this.ipcOpts, scala.Some.apply[(String, Boolean)](scala.Predef.ArrowAssoc[String](BatchSortingIterator.this.sortBy).-&gt;[Boolean](BatchSortingIterator.this.reverse)), resultIndex)
    }
  else
    BatchSortingIterator.this.unloader.unload(resultIndex)
}
        </td>
      </tr><tr>
        <td>
          168
        </td>
        <td>
          28015
        </td>
        <td>
          7097
          -
          7111
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.vector.SimpleFeatureVector.clear
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.result.clear()
        </td>
      </tr><tr>
        <td>
          169
        </td>
        <td>
          28016
        </td>
        <td>
          7138
          -
          7139
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28017
        </td>
        <td>
          7298
          -
          7307
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.batchSize
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batchSize
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28018
        </td>
        <td>
          7284
          -
          7307
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          resultIndex.&lt;(BatchSortingIterator.this.batchSize)
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28019
        </td>
        <td>
          7266
          -
          7307
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.queue.nonEmpty.&amp;&amp;(resultIndex.&lt;(BatchSortingIterator.this.batchSize))
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28036
        </td>
        <td>
          7309
          -
          7309
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.while$4
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          while$4()
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28037
        </td>
        <td>
          7309
          -
          7825
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  {
    &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$6: (Int, Int) = (BatchSortingIterator.this.queue.dequeue(): (AnyRef, Int, Int) @unchecked) match {
      case (_1: AnyRef, _2: Int, _3: Int)(AnyRef, Int, Int)(_, (i @ _), (batch @ _)) =&gt; scala.Tuple2.apply[Int, Int](i, batch)
    };
    val i: Int = x$6._1;
    val batch: Int = x$6._2;
    &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$7: (org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit) = (BatchSortingIterator.this.inputs.apply(batch): (org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit) @unchecked) match {
      case (_1: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, _2: (Int, Int) =&gt; Unit)(org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit)((vector @ _), (transfer @ _)) =&gt; scala.Tuple2.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit](vector, transfer)
    };
    val vector: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector = x$7._1;
    val transfer: (Int, Int) =&gt; Unit = x$7._2;
    transfer.apply(i, resultIndex);
    BatchSortingIterator.this.result.underlying.setIndexDefined(resultIndex);
    resultIndex = resultIndex.+(1);
    val nextBatchIndex: Int = i.+(1);
    if (vector.reader.getValueCount.&gt;(nextBatchIndex))
      {
        val value: AnyRef = BatchSortingIterator.this.getSortAttribute.apply(vector, nextBatchIndex);
        BatchSortingIterator.this.queue.+=(scala.Tuple3.apply[AnyRef, Int, Int](value, nextBatchIndex, batch))
      }
    else
      org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
  };
  while$4()
}
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28038
        </td>
        <td>
          7259
          -
          7259
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          171
        </td>
        <td>
          28039
        </td>
        <td>
          7259
          -
          7259
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          172
        </td>
        <td>
          28020
        </td>
        <td>
          7329
          -
          7329
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$6._1
        </td>
      </tr><tr>
        <td>
          172
        </td>
        <td>
          28021
        </td>
        <td>
          7332
          -
          7332
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$6._2
        </td>
      </tr><tr>
        <td>
          173
        </td>
        <td>
          28022
        </td>
        <td>
          7372
          -
          7372
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._1
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$7._1
        </td>
      </tr><tr>
        <td>
          173
        </td>
        <td>
          28023
        </td>
        <td>
          7380
          -
          7380
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Tuple2._2
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          x$7._2
        </td>
      </tr><tr>
        <td>
          174
        </td>
        <td>
          28024
        </td>
        <td>
          7416
          -
          7446
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Function2.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          transfer.apply(i, resultIndex)
        </td>
      </tr><tr>
        <td>
          175
        </td>
        <td>
          28025
        </td>
        <td>
          7457
          -
          7503
        </td>
        <td>
          Apply
        </td>
        <td>
          org.apache.arrow.vector.complex.StructVector.setIndexDefined
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.result.underlying.setIndexDefined(resultIndex)
        </td>
      </tr><tr>
        <td>
          176
        </td>
        <td>
          28026
        </td>
        <td>
          7514
          -
          7530
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          resultIndex.+(1)
        </td>
      </tr><tr>
        <td>
          177
        </td>
        <td>
          28027
        </td>
        <td>
          7562
          -
          7567
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          i.+(1)
        </td>
      </tr><tr>
        <td>
          178
        </td>
        <td>
          28028
        </td>
        <td>
          7582
          -
          7626
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          vector.reader.getValueCount.&gt;(nextBatchIndex)
        </td>
      </tr><tr>
        <td>
          178
        </td>
        <td>
          28032
        </td>
        <td>
          7628
          -
          7759
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  val value: AnyRef = BatchSortingIterator.this.getSortAttribute.apply(vector, nextBatchIndex);
  BatchSortingIterator.this.queue.+=(scala.Tuple3.apply[AnyRef, Int, Int](value, nextBatchIndex, batch))
}
        </td>
      </tr><tr>
        <td>
          179
        </td>
        <td>
          28029
        </td>
        <td>
          7654
          -
          7694
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Function2.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.getSortAttribute.apply(vector, nextBatchIndex)
        </td>
      </tr><tr>
        <td>
          180
        </td>
        <td>
          28030
        </td>
        <td>
          7716
          -
          7746
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Tuple3.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Tuple3.apply[AnyRef, Int, Int](value, nextBatchIndex, batch)
        </td>
      </tr><tr>
        <td>
          180
        </td>
        <td>
          28031
        </td>
        <td>
          7707
          -
          7747
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.mutable.PriorityQueue.+=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.queue.+=(scala.Tuple3.apply[AnyRef, Int, Int](value, nextBatchIndex, batch))
        </td>
      </tr><tr>
        <td>
          182
        </td>
        <td>
          28033
        </td>
        <td>
          7795
          -
          7795
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          182
        </td>
        <td>
          28034
        </td>
        <td>
          7779
          -
          7803
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.CloseWithLogging.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          182
        </td>
        <td>
          28035
        </td>
        <td>
          7779
          -
          7803
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.utils.io.CloseWithLogging.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          185
        </td>
        <td>
          28040
        </td>
        <td>
          7838
          -
          7849
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.writeHeader
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.writeHeader
        </td>
      </tr><tr>
        <td>
          185
        </td>
        <td>
          28050
        </td>
        <td>
          7851
          -
          7996
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          {
  BatchSortingIterator.this.writeHeader_=(false);
  io.this.`package`.writeHeaderAndFirstBatch(BatchSortingIterator.this.result, BatchSortingIterator.this.dictionaries, BatchSortingIterator.this.ipcOpts, scala.Some.apply[(String, Boolean)](scala.Predef.ArrowAssoc[String](BatchSortingIterator.this.sortBy).-&gt;[Boolean](BatchSortingIterator.this.reverse)), resultIndex)
}
        </td>
      </tr><tr>
        <td>
          186
        </td>
        <td>
          28041
        </td>
        <td>
          7863
          -
          7882
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.writeHeader_=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.writeHeader_=(false)
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28042
        </td>
        <td>
          7918
          -
          7924
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.result
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.result
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28043
        </td>
        <td>
          7926
          -
          7938
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.dictionaries
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.dictionaries
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28044
        </td>
        <td>
          7940
          -
          7947
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.ipcOpts
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.ipcOpts
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28045
        </td>
        <td>
          7954
          -
          7960
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.sortBy
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.sortBy
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28046
        </td>
        <td>
          7964
          -
          7971
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.reverse
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.reverse
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28047
        </td>
        <td>
          7954
          -
          7971
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Predef.ArrowAssoc.-&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.ArrowAssoc[String](BatchSortingIterator.this.sortBy).-&gt;[Boolean](BatchSortingIterator.this.reverse)
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28048
        </td>
        <td>
          7949
          -
          7972
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Some.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Some.apply[(String, Boolean)](scala.Predef.ArrowAssoc[String](BatchSortingIterator.this.sortBy).-&gt;[Boolean](BatchSortingIterator.this.reverse))
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          28049
        </td>
        <td>
          7893
          -
          7986
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.writeHeaderAndFirstBatch
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.`package`.writeHeaderAndFirstBatch(BatchSortingIterator.this.result, BatchSortingIterator.this.dictionaries, BatchSortingIterator.this.ipcOpts, scala.Some.apply[(String, Boolean)](scala.Predef.ArrowAssoc[String](BatchSortingIterator.this.sortBy).-&gt;[Boolean](BatchSortingIterator.this.reverse)), resultIndex)
        </td>
      </tr><tr>
        <td>
          189
        </td>
        <td>
          28051
        </td>
        <td>
          8014
          -
          8042
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.records.RecordBatchUnloader.unload
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.unloader.unload(resultIndex)
        </td>
      </tr><tr>
        <td>
          189
        </td>
        <td>
          28052
        </td>
        <td>
          8014
          -
          8042
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.records.RecordBatchUnloader.unload
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.unloader.unload(resultIndex)
        </td>
      </tr><tr>
        <td>
          195
        </td>
        <td>
          28054
        </td>
        <td>
          8116
          -
          8129
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.==
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batch.==(null)
        </td>
      </tr><tr>
        <td>
          195
        </td>
        <td>
          28058
        </td>
        <td>
          8112
          -
          8112
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          195
        </td>
        <td>
          28059
        </td>
        <td>
          8112
          -
          8112
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          196
        </td>
        <td>
          28055
        </td>
        <td>
          8149
          -
          8160
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.nextBatch
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.nextBatch()
        </td>
      </tr><tr>
        <td>
          196
        </td>
        <td>
          28056
        </td>
        <td>
          8141
          -
          8160
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.batch_=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batch_=(BatchSortingIterator.this.nextBatch())
        </td>
      </tr><tr>
        <td>
          196
        </td>
        <td>
          28057
        </td>
        <td>
          8141
          -
          8160
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.batch_=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batch_=(BatchSortingIterator.this.nextBatch())
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          28060
        </td>
        <td>
          8175
          -
          8188
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.!=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batch.!=(null)
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          28061
        </td>
        <td>
          8253
          -
          8258
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.batch
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batch
        </td>
      </tr><tr>
        <td>
          203
        </td>
        <td>
          28062
        </td>
        <td>
          8265
          -
          8277
        </td>
        <td>
          Apply
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.batch_=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batch_=(null)
        </td>
      </tr><tr>
        <td>
          208
        </td>
        <td>
          28063
        </td>
        <td>
          8353
          -
          8359
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.result
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.result
        </td>
      </tr><tr>
        <td>
          208
        </td>
        <td>
          28064
        </td>
        <td>
          8361
          -
          8368
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.arrow.io.BatchWriter.BatchSortingIterator.batches
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BatchSortingIterator.this.batches
        </td>
      </tr><tr>
        <td>
          208
        </td>
        <td>
          28065
        </td>
        <td>
          8352
          -
          8352
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          208
        </td>
        <td>
          28066
        </td>
        <td>
          8352
          -
          8352
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          208
        </td>
        <td>
          28067
        </td>
        <td>
          8336
          -
          8369
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.SafeClose.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, org.locationtech.geomesa.utils.collection.CloseableIterator[Array[Byte]]](BatchSortingIterator.this.result, BatchSortingIterator.this.batches)(io.this.IsCloseable.closeableIsCloseable, io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          209
        </td>
        <td>
          28068
        </td>
        <td>
          8429
          -
          8429
        </td>
        <td>
          Select
        </td>
        <td>
          org.locationtech.geomesa.utils.io.IsCloseableImplicits.closeableIsCloseable
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          io.this.IsCloseable.closeableIsCloseable
        </td>
      </tr><tr>
        <td>
          209
        </td>
        <td>
          28069
        </td>
        <td>
          8413
          -
          8437
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          org.locationtech.geomesa.utils.io.CloseWithLogging.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          209
        </td>
        <td>
          28070
        </td>
        <td>
          8413
          -
          8437
        </td>
        <td>
          Block
        </td>
        <td>
          org.locationtech.geomesa.utils.io.CloseWithLogging.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
        </td>
      </tr><tr>
        <td>
          209
        </td>
        <td>
          28071
        </td>
        <td>
          8376
          -
          8439
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.IndexedSeqOptimized.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.refArrayOps[(org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit)](BatchSortingIterator.this.inputs).foreach[Option[Throwable]](((x0$1: (org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit)) =&gt; x0$1 match {
  case (_1: org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, _2: (Int, Int) =&gt; Unit)(org.locationtech.geomesa.arrow.vector.SimpleFeatureVector, (Int, Int) =&gt; Unit)((vector @ _), _) =&gt; org.locationtech.geomesa.utils.io.`package`.CloseWithLogging.apply[org.locationtech.geomesa.arrow.vector.SimpleFeatureVector](vector)(io.this.IsCloseable.closeableIsCloseable)
}))
        </td>
      </tr>
    </table>
          </div>
        </div>
      </body>
    </html>