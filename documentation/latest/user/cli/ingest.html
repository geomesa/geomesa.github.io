<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8.3. Ingest Commands &mdash; GeoMesa 5.0.0 Manuals</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/cli/ingest.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.4. Query and Export Commands" href="export.html" />
    <link rel="prev" title="8.2. Schema Commands" href="schemas.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                5.1.0-SNAPSHOT
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">8. Command-Line Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="status.html">8.1. Environment and Status Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="schemas.html">8.2. Schema Commands</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">8.3. Ingest Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delete-features">8.3.1. <code class="docutils literal notranslate"><span class="pre">delete-features</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ingest">8.3.2. <code class="docutils literal notranslate"><span class="pre">ingest</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="export.html">8.4. Query and Export Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="analytic.html">8.5. Analytic Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfts.html">8.6. Defining Simple Feature Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="converters.html">8.7. Defining Simple Feature Converters</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging.html">8.8. Logging Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="filesystems.html">8.9. Remote File System Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="console.html">8.10. GeoMesa Scala Console</a></li>
<li class="toctree-l3"><a class="reference internal" href="nailgun.html">8.11. Nailgun Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="geotools.html">8.12. GeoTools Command-Line Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">15. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">17. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">18. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">19. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">20. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">23. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">8. </span>Command-Line Tools</a></li>
      <li class="breadcrumb-item active"><span class="section-number">8.3. </span>Ingest Commands</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ingest-commands">
<h1><span class="section-number">8.3. </span>Ingest Commands<a class="headerlink" href="#ingest-commands" title="Permalink to this headline">¶</a></h1>
<p>These commands are used to insert and delete simple features. Required parameters are indicated with a <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<section id="delete-features">
<h2><span class="section-number">8.3.1. </span><code class="docutils literal notranslate"><span class="pre">delete-features</span></code><a class="headerlink" href="#delete-features" title="Permalink to this headline">¶</a></h2>
<p>Delete specific features from a schema. Note that if deleting all features, it may be faster to delete the
schema and re-create it.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-c,</span> <span class="pre">--catalog</span> <span class="pre">*</span></code></p></td>
<td><p>The catalog table containing schema metadata</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-f,</span> <span class="pre">--feature-name</span> <span class="pre">*</span></code></p></td>
<td><p>The name of the schema</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-q,</span> <span class="pre">--cql</span></code></p></td>
<td><p>CQL filter to select features to delete</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--force</span></code></p></td>
<td><p>Suppress confirmation prompt</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ingest">
<span id="cli-ingest"></span><h2><span class="section-number">8.3.2. </span><code class="docutils literal notranslate"><span class="pre">ingest</span></code><a class="headerlink" href="#ingest" title="Permalink to this headline">¶</a></h2>
<p>The ingest command takes files in various formats and ingests them as <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code>s in GeoMesa.
Generally, a GeoMesa ‘converter’ definition is required to map input data to  <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code>s. GeoMesa
supports common input formats such as delimited text (TSV, CSV), fixed width files, JSON, XML, and Avro.
The converter framework is extensible via Java SPI, to allow support for custom formats. See
<a class="reference internal" href="../convert/index.html#converters"><span class="std std-ref">GeoMesa Converters</span></a> for more information on converters.</p>
<p>See <a class="reference internal" href="../datastores/data.html#data-migration"><span class="std std-ref">Moving and Migrating Data</span></a> for details on how the export/import commands can be used to move data between clusters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-c,</span> <span class="pre">--catalog</span> <span class="pre">*</span></code></p></td>
<td><p>The catalog table containing schema metadata</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-f,</span> <span class="pre">--feature-name</span></code></p></td>
<td><p>The name of the schema</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-s,</span> <span class="pre">--spec</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> specification to create</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-C,</span> <span class="pre">--converter</span></code></p></td>
<td><p>The GeoMesa converter used to create <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code>s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--converter-error-mode</span></code></p></td>
<td><p>Override the error mode defined by the converter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-t,</span> <span class="pre">--threads</span></code></p></td>
<td><p>Number of parallel threads used</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--input-format</span></code></p></td>
<td><p>Format of input files (csv, tsv, avro, shp, json, etc)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">`--index</span></code></p></td>
<td><p>Specify a particular GeoMesa index to write to, instead of all indices</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--no-tracking</span></code></p></td>
<td><p>This application closes when ingest job is submitted. Useful for launching jobs with a script</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--run-mode</span></code></p></td>
<td><p>Must be one of <code class="docutils literal notranslate"><span class="pre">local</span></code> or <code class="docutils literal notranslate"><span class="pre">distributed</span></code> (for map/reduce ingest)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--combine-inputs</span></code></p></td>
<td><p>Combine multiple input files into a single input split (distributed jobs only)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--split-max-size</span></code></p></td>
<td><p>Maximum size of a split in bytes (distributed jobs)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--src-list</span></code></p></td>
<td><p>Input files are text files with lists of files, one per line, to ingest</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--force</span></code></p></td>
<td><p>Suppress any confirmation prompts</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;files&gt;...</span></code></p></td>
<td><p>Input files to ingest</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">--converter</span></code> argument may be any of the following:</p>
<ul class="simple">
<li><p>The name of a GeoMesa converter already available on the classpath</p></li>
<li><p>A converter configuration string</p></li>
<li><p>The name of a file containing a converter configuration</p></li>
</ul>
<p>If a converter is not specified, GeoMesa will attempt to infer a converter definition based on the input files.
Currently this supports JSON, XML, self-describing Avro, delimited text (TSV, CSV), and Shapefiles. If GeoMesa is able
to infer a schema and converter definition, the user can accept them as-is, or alternatively use them as the basis
for a fully custom converter. If desired, the user can persist the inferred converter to file, which allows for
easy modification and reuse. When ingesting a large data set, it can be useful to ingest a single file in local
mode, using schema inference to generate the converter. The converter definition can be persisted and tweaked to
satisfaction, then used for the entire data set with a distributed ingest.</p>
<p>See <a class="reference internal" href="converters.html#cli-converter-conf"><span class="std std-ref">Defining Simple Feature Converters</span></a> for more details on specifying the converter.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">converter-error-mode</span></code> argument may be used to override the error mode defined in the converter. It must be
one of <code class="docutils literal notranslate"><span class="pre">log-errors</span></code> or <code class="docutils literal notranslate"><span class="pre">raise-errors</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code> is specified and the schema already exists, then <code class="docutils literal notranslate"><span class="pre">--spec</span></code> is not required. Likewise,
if a converter is not defined, the schema will be inferred alongside the converter. Otherwise, <code class="docutils literal notranslate"><span class="pre">--spec</span></code> may be
any of the following:</p>
<ul class="simple">
<li><p>A string of attributes, for example <code class="docutils literal notranslate"><span class="pre">name:String,dtg:Date,*geom:Point:srid=4326</span></code></p></li>
<li><p>The name of a <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> already available on the classpath</p></li>
<li><p>A string of attributes, defined as a TypeSafe configuration</p></li>
<li><p>The name of a file containing one of the above</p></li>
</ul>
<p>If the schema doesn’t exist, the <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code> argument is required if it is not implied by
the specification string. It may also be used to override the implied feature name.</p>
<p>See <a class="reference internal" href="sfts.html#cli-sft-conf"><span class="std std-ref">Defining Simple Feature Types</span></a> for more details on specifying the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--input-format</span></code> argument can be used to specify the type of files being ingested. Currently
GeoMesa supports Avro, CSV, TSV, Json/GeoJson, GML, and SHP. If not specified, the input file extensions
will be used to determine the file type.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--no-tracking</span></code> argument instructs the application to close when the ingest job has been submitted rather than
tracking and displaying the progress of the ingest. This is useful when a script is submitting the job or it is
undesirable to leave the JVM running. Note that supplying this parameter does not silence the application and it will
still provide information about the status of the job submission.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--run-mode</span></code> argument can be used to run ingestion locally or distributed (using map/reduce). Note that in
order to run in distributed mode, the input files must be in HDFS. By default, input files on the local filesystem
will be ingested in local mode, and input files in HDFS will be ingested in distributed mode. The
<code class="docutils literal notranslate"><span class="pre">--combine-inputs</span></code> flag can be used to process multiple files in each mapper up to the limit specified by
<code class="docutils literal notranslate"><span class="pre">--split-max-size</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--threads</span></code> argument can be used to increase local ingest speed. However, there can not be more threads
than there are input files. The <code class="docutils literal notranslate"><span class="pre">--threads</span></code> argument is ignored for distributed ingest.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--split-max-size</span></code> argument can be used to control the amount of data each mapper processes. This is useful
when used in conjunction with the DistributedCombine <code class="docutils literal notranslate"><span class="pre">--run-mode</span></code> and if input files are small or starting a mapper
for each one becomes prohibitively slow. For example, if you have 100 5MB files then a setting of 100000000 (100MB)
would schedule 5 mappers.</p>
<p id="src-list">The <code class="docutils literal notranslate"><span class="pre">--src-list</span></code> argument is useful when you have more files to ingest than the command line will allow you to
specify. This file instructs GeoMesa to treat input files as new-line-separated file lists. As this makes it very
easy to run ingest jobs that can take days it’s recommended to split lists into reasonable chunks that can be completed
in a couple hours.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--force</span></code> argument can be used to suppress any confirmation prompts (generally from converter inference),
which can be useful when scripting commands.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;files&gt;...</span></code> argument specifies the files to be ingested. <code class="docutils literal notranslate"><span class="pre">*</span></code> may be used as a wild card in file paths.
GeoMesa can handle <strong>gzip</strong>, <strong>bzip</strong> and <strong>xz</strong> file compression as long as the file extensions match the
compression type. GeoMesa supports ingesting files from local disks or HDFS. In addition, Amazon’s S3
and Microsoft’s Azure file systems are supported with a few configuration changes. See
<a class="reference internal" href="filesystems.html"><span class="doc">Remote File System Support</span></a> for details. Note: The behavior of this argument is changed by the <code class="docutils literal notranslate"><span class="pre">--src-list</span></code> argument.</p>
<p>By using a single <code class="docutils literal notranslate"><span class="pre">-</span></code> for the input files, input data may be piped directly to the ingest command using standard
shell redirection. Note that this will only work in local mode, and will only use a single thread for ingestion.
Schema inference is disabled in this case, and progress indicators may not be entirely accurate, as the total size
isn’t known up front.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat foo.csv | geomesa-accumulo ingest ... -
$ geomesa-accumulo ingest ... - &lt;foo.csv
</pre></div>
</div>
<p>For local ingests, feature writers will be pooled and only flushed periodically. The frequency of flushes can be
controlled via the system property <code class="docutils literal notranslate"><span class="pre">geomesa.ingest.local.batch.size</span></code>, and defaults to every 20,000 features.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="schemas.html" class="btn btn-neutral float-left" title="8.2. Schema Commands" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="export.html" class="btn btn-neutral float-right" title="8.4. Query and Export Commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2024 <a href="https://www.ga-ccri.com/">General Atomics</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/cli/ingest.rst">GitHub <img src="../../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>