<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. GeoTools Overview &mdash; GeoMesa 5.4.0-SNAPSHOT Manuals</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/stable/user/geotools.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. GeoMesa Data Stores" href="datastores/index.html" />
    <link rel="prev" title="5. Architecture Overview" href="architecture.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                5.4.0-SNAPSHOT
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6. GeoTools Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simplefeaturetype-and-simplefeature">6.1. SimpleFeatureType and SimpleFeature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-a-data-store-instance">6.2. Getting a Data Store Instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-schema">6.3. Creating a Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-data">6.4. Writing Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#appending-writes">6.4.1. Appending Writes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-writes">6.4.2. Modifying Writes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-data">6.5. Reading Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo/index.html">14. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="hbase/index.html">15. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgis/index.html">17. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka/index.html">18. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis/index.html">19. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem/index.html">20. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">23. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Manual</a></li>
      <li class="breadcrumb-item active"><span class="section-number">6. </span>GeoTools Overview</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geotools-overview">
<h1><span class="section-number">6. </span>GeoTools Overview<a class="headerlink" href="#geotools-overview" title="Permalink to this headline">¶</a></h1>
<p>The main abstraction in GeoMesa is the GeoTools <code class="docutils literal notranslate"><span class="pre">DataStore</span></code>. Understanding the GeoTools API is important
to integrating with GeoMesa. The full GeoTools documentation is available <a class="reference external" href="https://docs.geotools.org/">here</a>,
but this section gives a concise overview of the main ways to interact with a data store.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section is focused on users who want to integrate with GeoMesa through code. Many use cases do not
require this; data can be ingested using the GeoMesa command-line tools or Apache NiFi processors, and
accessed through GeoServer OGC requests or Spark. Even so, this page can provide useful background
on the concepts behind those operations.</p>
</div>
<p>A data store provides read and write access to spatial data. The API itself does not distinguish between different
storage formats. Thus, the API for accessing data stored in a local shape file will be the same as for accessing
data stored in an HBase cluster. GeoMesa provides several different data stores implementations, including HBase,
Accumulo, Kafka, and others. See <a class="reference internal" href="datastores/index.html#geomesa-data-stores"><span class="std std-ref">GeoMesa Data Stores</span></a> for more information on the different data stores
available.</p>
<section id="simplefeaturetype-and-simplefeature">
<h2><span class="section-number">6.1. </span>SimpleFeatureType and SimpleFeature<a class="headerlink" href="#simplefeaturetype-and-simplefeature" title="Permalink to this headline">¶</a></h2>
<p>In GeoTools, a <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> defines the names and types of the attributes in a given schema. It is similar
to the table definition of a relational database. <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>s can be described with a type name and a
specification, typically a string indicating the attributes names and types. A <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> is a struct data
type, equivalent to a single row in a relational database table. Each <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> is associated with a
<code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>, and has a unique identifier (the feature ID) and a list of values corresponding to the
attributes in the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>. See below for examples of creating and managing <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>s.</p>
<p>The “simple” in <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> refers to its flat data structure. It is also possible to have “complex”
feature types, which are similar to joins in a relational database. However, complex feature types are not widely
used or supported.</p>
</section>
<section id="getting-a-data-store-instance">
<h2><span class="section-number">6.2. </span>Getting a Data Store Instance<a class="headerlink" href="#getting-a-data-store-instance" title="Permalink to this headline">¶</a></h2>
<p>Data stores are accessed through <code class="docutils literal notranslate"><span class="pre">org.geotools.api.data.DataStoreFinder#getDataStore</span></code>. The function takes a parameter
map, which is used to dynamically load a data store. For example, to load a GeoMesa HBase data store include the
parameter key <code class="docutils literal notranslate"><span class="pre">&quot;hbase.catalog&quot;</span></code>. Data stores are dynamically loaded; the appropriate data store implementation
and all of its required dependencies must be on the classpath.</p>
<p>GeoMesa data stores are thread-safe (although not all methods on the data store return thread-safe objects).
Generally, a data store should be loaded once and then used repeatedly. When no longer needed, a data store
should be cleaned up by calling the <code class="docutils literal notranslate"><span class="pre">dispose()</span></code> method.</p>
<p>See the links in <a class="reference internal" href="datastores/index.html#geomesa-data-stores"><span class="std std-ref">GeoMesa Data Stores</span></a> for an explanation of the parameters for each data store implementation.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-0-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button></div><div aria-labelledby="tab-0-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.DataStore</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.DataStoreFinder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.hbase.data.HBaseDataStoreParams</span><span class="p">;</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="c1">// HBaseDataStoreParams.HBaseCatalogParam().key is the string &quot;hbase.catalog&quot;</span>
<span class="c1">// the GeoMesa HBase data store will recognize the key and attempt to load itself</span>
<span class="n">parameters</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">HBaseDataStoreParams</span><span class="p">.</span><span class="na">HBaseCatalogParam</span><span class="p">().</span><span class="na">key</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mycatalog&quot;</span><span class="p">);</span>
<span class="n">DataStore</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataStoreFinder</span><span class="p">.</span><span class="na">getDataStore</span><span class="p">(</span><span class="n">parameters</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1">// when finished, be sure to clean up the store</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">store</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">store</span><span class="p">.</span><span class="na">dispose</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">api</span><span class="p">.</span><span class="nn">data</span><span class="p">.</span><span class="nc">DataStoreFinder</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">hbase</span><span class="p">.</span><span class="nn">data</span><span class="p">.</span><span class="nc">HBaseDataStoreParams</span>

<span class="k">import</span><span class="w"> </span><span class="nn">scala</span><span class="p">.</span><span class="nn">collection</span><span class="p">.</span><span class="nc">JavaConverters</span><span class="p">.</span><span class="n">_</span>

<span class="c1">// HBaseDataStoreParams.HBaseCatalogParam.key is the string &quot;hbase.catalog&quot;</span>
<span class="c1">// the GeoMesa HBase data store will recognize the key and attempt to load itself</span>
<span class="kd">val</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span><span class="nc">HBaseDataStoreParams</span><span class="p">.</span><span class="nc">HBaseCatalogParam</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;mycatalog&quot;</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">DataStoreFinder</span><span class="p">.</span><span class="n">getDataStore</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">asJava</span><span class="p">)</span>
<span class="c1">// when finished, be sure to clean up the store</span>
<span class="n">store</span><span class="p">.</span><span class="n">dispose</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
</section>
<section id="creating-a-schema">
<h2><span class="section-number">6.3. </span>Creating a Schema<a class="headerlink" href="#creating-a-schema" title="Permalink to this headline">¶</a></h2>
<p>Each data store can contain multiple <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>s, or schemas. Existing schemas can be listed with
the <code class="docutils literal notranslate"><span class="pre">getTypeNames</span></code> and <code class="docutils literal notranslate"><span class="pre">getSchema</span></code> methods. Schemas can be created, updated and deleted through the
<code class="docutils literal notranslate"><span class="pre">createSchema</span></code>, <code class="docutils literal notranslate"><span class="pre">updateSchema</span></code> and <code class="docutils literal notranslate"><span class="pre">removeSchema</span></code> methods, respectively.</p>
<p>See <a class="reference internal" href="datastores/attributes.html#attribute-types"><span class="std std-ref">GeoTools Feature Types</span></a> for a list of the attribute type bindings available.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-1-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button></div><div aria-labelledby="tab-1-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeatureType</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="na">getTypeNames</span><span class="p">();</span>
<span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">types</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">exists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">exists</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">myType</span><span class="w"> </span><span class="o">=</span>
<span class="w">              </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;item:String,amount:Double,date:Date,location:Point:srid=4326&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">store</span><span class="p">.</span><span class="na">createSchema</span><span class="p">(</span><span class="n">myType</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SimpleFeatureTypes</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">store</span><span class="p">.</span><span class="n">getTypeNames</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="n">myType</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="nc">SimpleFeatureTypes</span><span class="p">.</span><span class="n">createType</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;item:String,amount:Double,date:Date,location:Point:srid=4326&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">store</span><span class="p">.</span><span class="n">createSchema</span><span class="p">(</span><span class="n">myType</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</section>
<section id="writing-data">
<h2><span class="section-number">6.4. </span>Writing Data<a class="headerlink" href="#writing-data" title="Permalink to this headline">¶</a></h2>
<p>Data stores support writing data on a row-by-row basis. There are two different write paths - appending writes and
modifying writes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pay close attention to the use of <code class="docutils literal notranslate"><span class="pre">PROVIDED_FID</span></code> in the following sections. This hint controls the behavior
of each feature ID.</p>
</div>
<p>Some data stores support transactions, which can be used to isolate a group of operations. GeoMesa does not
support transactions, so the default GeoTools <code class="docutils literal notranslate"><span class="pre">Transaction.AUTO_COMMIT</span></code> is used in the examples. Generally,
once a writer is successfully closed, the data has been persisted to the underlying store. Until then,
data may be cached and buffered locally, and may not be persisted or available to query.</p>
<section id="appending-writes">
<h3><span class="section-number">6.4.1. </span>Appending Writes<a class="headerlink" href="#appending-writes" title="Permalink to this headline">¶</a></h3>
<p>An appending writer can be obtained through the <code class="docutils literal notranslate"><span class="pre">getFeatureWriterAppend</span></code> method. A feature writer is similar to
an iterator; <code class="docutils literal notranslate"><span class="pre">next</span></code> is called to obtain a new feature, the feature is updated with the values to be written,
and then <code class="docutils literal notranslate"><span class="pre">write</span></code> is called to persist it. Once all writes are complete, the feature writer should be closed.</p>
<p>The ID used to uniquely identify a feature is called the feature ID, or <code class="docutils literal notranslate"><span class="pre">FID</span></code>. By default, GeoTools will
generate a new feature ID for each feature. To specify a feature ID, set the <code class="docutils literal notranslate"><span class="pre">PROVIDED_FID</span></code> hint in the feature
user data, as shown below.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is a logical error to write the same feature ID more than once with an appending feature writer. This
may result in inconsistencies in the persisted data. Refer to the next section for how to safely update existing
features.</p>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-2-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button></div><div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.FeatureWriter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.Transaction</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeature</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeatureType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.util.factory.Hints</span><span class="p">;</span>

<span class="c1">// use try-with-resources to close the writer when done</span>
<span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FeatureWriter</span><span class="o">&lt;</span><span class="n">SimpleFeatureType</span><span class="p">,</span><span class="w"> </span><span class="n">SimpleFeature</span><span class="o">&gt;</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">store</span><span class="p">.</span><span class="na">getFeatureWriterAppend</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="p">.</span><span class="na">AUTO_COMMIT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// repeat as needed, once per feature</span>
<span class="w">    </span><span class="c1">// note: hasNext() will always return false, but can be ignored</span>
<span class="w">    </span><span class="n">SimpleFeature</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
<span class="w">    </span><span class="n">next</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="n">Hints</span><span class="p">.</span><span class="na">PROVIDED_FID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id-01&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">next</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;swag&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">next</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;amount&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">20.0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// attributes will be converted to the appropriate type if needed</span>
<span class="w">    </span><span class="n">next</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2020-01-01T00:00:00.000Z&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">next</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;location&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT (-82.379 34.1782)&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">();</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">util</span><span class="p">.</span><span class="nn">factory</span><span class="p">.</span><span class="nc">Hints</span>

<span class="kd">val</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="n">getFeatureWriterAppend</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">Transaction</span><span class="p">.</span><span class="nc">AUTO_COMMIT</span><span class="p">)</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// repeat as needed, once per feature</span>
<span class="w">  </span><span class="c1">// note: hasNext will always return false, but can be ignored</span>
<span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer</span><span class="p">.</span><span class="n">next</span><span class="p">()</span>
<span class="w">  </span><span class="n">next</span><span class="p">.</span><span class="n">getUserData</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="nc">Hints</span><span class="p">.</span><span class="nc">PROVIDED_FID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id-01&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">next</span><span class="p">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;swag&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">next</span><span class="p">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s">&quot;amount&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">20.0</span><span class="p">)</span>
<span class="w">  </span><span class="c1">// attributes will be converted to the appropriate type if needed</span>
<span class="w">  </span><span class="n">next</span><span class="p">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2020-01-01T00:00:00.000Z&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">next</span><span class="p">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s">&quot;location&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT (-82.379 34.1782)&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">writer</span><span class="p">.</span><span class="n">write</span><span class="p">()</span>
<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">writer</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>An alternative way to make appending writes is to use a <code class="docutils literal notranslate"><span class="pre">FeatureStore</span></code>. GeoTools defines a <code class="docutils literal notranslate"><span class="pre">FeatureSource</span></code> as
read-only. <code class="docutils literal notranslate"><span class="pre">FeatureStore</span></code> extends <code class="docutils literal notranslate"><span class="pre">FeatureSource</span></code> and provides write functionality, but must be checked with
a runtime cast.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-3-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button></div><div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.data.simple.SimpleFeatureCollection</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.SimpleFeatureSource</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.SimpleFeatureStore</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.feature.DefaultFeatureCollection</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">SimpleFeatureSource</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="na">getFeatureSource</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">SimpleFeatureStore</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SimpleFeatureCollection</span><span class="w"> </span><span class="n">collection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultFeatureCollection</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// omitted - add features to the collection</span>
<span class="w">        </span><span class="p">((</span><span class="n">SimpleFeatureStore</span><span class="p">)</span><span class="w"> </span><span class="n">source</span><span class="p">).</span><span class="na">addFeatures</span><span class="p">(</span><span class="n">collection</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Store is read only&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">api</span><span class="p">.</span><span class="nn">data</span><span class="p">.</span><span class="nc">SimpleFeatureStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">feature</span><span class="p">.</span><span class="nc">DefaultFeatureCollection</span>

<span class="n">store</span><span class="p">.</span><span class="n">getFeatureSource</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">s</span><span class="p">:</span><span class="w"> </span><span class="nc">SimpleFeatureStore</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">collection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">DefaultFeatureCollection</span><span class="p">()</span>
<span class="w">    </span><span class="n">collection</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="o">???</span><span class="p">)</span>
<span class="w">    </span><span class="n">s</span><span class="p">.</span><span class="n">addFeatures</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Store is read only&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</section>
<section id="modifying-writes">
<h3><span class="section-number">6.4.2. </span>Modifying Writes<a class="headerlink" href="#modifying-writes" title="Permalink to this headline">¶</a></h3>
<p>In order to update an existing feature, a modifying writer must be used through the method <code class="docutils literal notranslate"><span class="pre">getFeatureWriter</span></code>,
which requires a filter specifying the features to be updated. A modifying feature writer is similar to an
appending feature writer, except that the method <code class="docutils literal notranslate"><span class="pre">hasNext</span></code> will return <code class="docutils literal notranslate"><span class="pre">true</span></code> as long as there are additional
features to modify. The features returned from <code class="docutils literal notranslate"><span class="pre">next</span></code> will be pre-populated with the current data for each feature.</p>
<p>Filters can be created through the GeoTools method <code class="docutils literal notranslate"><span class="pre">ECQL.toFilter</span></code>. See the GeoTools
<a class="reference external" href="https://docs.geotools.org/stable/userguide/library/cql/ecql.html">documentation</a> for more information
on CQL filters.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-4-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button></div><div aria-labelledby="tab-4-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.FeatureWriter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.Transaction</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeature</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeatureType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.filter.text.cql2.CQLException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.filter.text.ecql.ECQL</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FeatureWriter</span><span class="o">&lt;</span><span class="n">SimpleFeatureType</span><span class="p">,</span><span class="w"> </span><span class="n">SimpleFeature</span><span class="o">&gt;</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span>
<span class="w">             </span><span class="n">store</span><span class="p">.</span><span class="na">getFeatureWriter</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ECQL</span><span class="p">.</span><span class="na">toFilter</span><span class="p">(</span><span class="s">&quot;IN (&#39;id-01&#39;)&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">Transaction</span><span class="p">.</span><span class="na">AUTO_COMMIT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">writer</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SimpleFeature</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
<span class="w">        </span><span class="n">next</span><span class="p">.</span><span class="na">setAttribute</span><span class="p">(</span><span class="s">&quot;amount&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">21.0</span><span class="p">);</span>
<span class="w">        </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">();</span><span class="w"> </span><span class="c1">// or, to delete it: writer.remove();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">api</span><span class="p">.</span><span class="nn">data</span><span class="p">.</span><span class="nc">Transaction</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">filter</span><span class="p">.</span><span class="nn">text</span><span class="p">.</span><span class="nn">ecql</span><span class="p">.</span><span class="nc">ECQL</span>

<span class="kd">val</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ECQL</span><span class="p">.</span><span class="n">toFilter</span><span class="p">(</span><span class="s">&quot;IN (&#39;id-01&#39;)&quot;</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="n">getFeatureWriter</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span><span class="p">,</span><span class="w"> </span><span class="nc">Transaction</span><span class="p">.</span><span class="nc">AUTO_COMMIT</span><span class="p">)</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">writer</span><span class="p">.</span><span class="n">hasNext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer</span><span class="p">.</span><span class="n">next</span>
<span class="w">    </span><span class="n">next</span><span class="p">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s">&quot;amount&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">21.0</span><span class="p">)</span>
<span class="w">    </span><span class="n">writer</span><span class="p">.</span><span class="n">write</span><span class="p">()</span><span class="w"> </span><span class="c1">// or, to delete it: writer.remove()</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">writer</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="reading-data">
<h2><span class="section-number">6.5. </span>Reading Data<a class="headerlink" href="#reading-data" title="Permalink to this headline">¶</a></h2>
<p>Once data has been persisted, it can be read back through the <code class="docutils literal notranslate"><span class="pre">getFeatureReader</span></code> method. GeoTools returns a “live”
iterator of results that may point to a remote location. Generally data is not actually read from the backing store
until it is required, so it is possible to read a few records without fetching the entire result set.</p>
<p>To filter the results that come back, predicates can be created using the “common query language”, CQL. Filters can
be created through the GeoTools method <code class="docutils literal notranslate"><span class="pre">ECQL.toFilter</span></code>. See the GeoTools
<a class="reference external" href="https://docs.geotools.org/stable/userguide/library/cql/ecql.html">documentation</a> for more information
on CQL filters.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-5-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button></div><div aria-labelledby="tab-5-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.FeatureReader</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.Query</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.data.Transaction</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.data.DataUtilities</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.filter.text.cql2.CQLException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.filter.text.ecql.ECQL</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeature</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.geotools.api.feature.simple.SimpleFeatureType</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Query</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Query</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ECQL</span><span class="p">.</span><span class="na">toFilter</span><span class="p">(</span><span class="s">&quot;bbox(location,-85,30,-80,35)&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FeatureReader</span><span class="o">&lt;</span><span class="n">SimpleFeatureType</span><span class="p">,</span><span class="w"> </span><span class="n">SimpleFeature</span><span class="o">&gt;</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span>
<span class="w">               </span><span class="n">store</span><span class="p">.</span><span class="na">getFeatureReader</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="p">.</span><span class="na">AUTO_COMMIT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SimpleFeature</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">DataUtilities</span><span class="p">.</span><span class="na">encodeFeature</span><span class="p">(</span><span class="n">next</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">api</span><span class="p">.</span><span class="nn">data</span><span class="p">.{</span><span class="nc">Query</span><span class="p">,</span><span class="w"> </span><span class="nc">Transaction</span><span class="p">}</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">data</span><span class="p">.</span><span class="nc">DataUtilities</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">filter</span><span class="p">.</span><span class="nn">text</span><span class="p">.</span><span class="nn">ecql</span><span class="p">.</span><span class="nc">ECQL</span>

<span class="kd">val</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="s">&quot;purchases&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">ECQL</span><span class="p">.</span><span class="n">toFilter</span><span class="p">(</span><span class="s">&quot;bbox(location,-85,30,-80,35)&quot;</span><span class="p">))</span>
<span class="kd">val</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="n">getFeatureReader</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="nc">Transaction</span><span class="p">.</span><span class="nc">AUTO_COMMIT</span><span class="p">)</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">hasNext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="n">next</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="nc">DataUtilities</span><span class="p">.</span><span class="n">encodeFeature</span><span class="p">(</span><span class="n">next</span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">reader</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="architecture.html" class="btn btn-neutral float-left" title="5. Architecture Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="datastores/index.html" class="btn btn-neutral float-right" title="7. GeoMesa Data Stores" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2025 <a href="https://www.ga-ccri.com/">General Atomics</a>
    <br/>
    Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/geotools.rst">GitHub <img src="../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>