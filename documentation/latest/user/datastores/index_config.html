<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7.7. Index Configuration &mdash; GeoMesa 5.1.0 Manuals</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/datastores/index_config.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7.8. Runtime Configuration" href="runtime_config.html" />
    <link rel="prev" title="7.6. Additional Index Implementations" href="index_ext.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                5.2.0-SNAPSHOT
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">7. GeoMesa Data Stores</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="attributes.html">7.1. GeoTools Feature Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html">7.2. JSON Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_overview.html">7.3. Index Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_basics.html">7.4. Index Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_basics.html#index-versioning">7.5. Index Versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_ext.html">7.6. Additional Index Implementations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">7.7. Index Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-schema-options">7.7.1. Setting Schema Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-attribute-options">7.7.2. Setting Attribute Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-the-indexed-date-attribute">7.7.3. Setting the Indexed Date Attribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#customizing-index-creation">7.7.4. Customizing Index Creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-index-table-names">7.7.5. Configuring Index Table Names</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-feature-id-encoding">7.7.6. Configuring Feature ID Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-geometry-serialization">7.7.7. Configuring Geometry Serialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-column-groups">7.7.8. Configuring Column Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-z-index-shards">7.7.9. Configuring Z-Index Shards</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-z-index-time-interval">7.7.10. Configuring Z-Index Time Interval</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-xz-index-precision">7.7.11. Configuring XZ-Index Precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-attribute-index-shards">7.7.12. Configuring Attribute Index Shards</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-attribute-cardinality">7.7.13. Configuring Attribute Cardinality</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-partitioned-indices">7.7.14. Configuring Partitioned Indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-index-splits">7.7.15. Configuring Index Splits</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-query-interceptors">7.7.16. Configuring Query Interceptors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-cached-statistics">7.7.17. Configuring Cached Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-temporal-priority">7.7.18. Configuring Temporal Priority</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-required-visibilities">7.7.19. Configuring Required Visibilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mixed-geometry-types">7.7.20. Mixed Geometry Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="runtime_config.html">7.8. Runtime Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_planning.html">7.9. Query Planning</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_planning.html#explaining-query-plans">7.10. Explaining Query Plans</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_interceptor.html">7.11. Query Interceptors and Guards</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_config.html">7.12. Query Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="filter_functions.html">7.13. Filter Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="analytic_queries.html">7.14. Analytic Querying</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html">7.15. Data Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="auditing.html">7.16. Query Auditing</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html">7.17. Moving and Migrating Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="reserved_words.html">7.18. Reserved Words</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">14. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">15. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">17. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">18. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">19. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">20. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">23. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">7. </span>GeoMesa Data Stores</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7.7. </span>Index Configuration</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="index-configuration">
<span id="index-config"></span><h1><span class="section-number">7.7. </span>Index Configuration<a class="headerlink" href="#index-configuration" title="Permalink to this headline">¶</a></h1>
<p>GeoMesa exposes a variety of configuration options that can be used to customize and optimize a given installation.</p>
<section id="setting-schema-options">
<span id="set-sft-options"></span><h2><span class="section-number">7.7.1. </span>Setting Schema Options<a class="headerlink" href="#setting-schema-options" title="Permalink to this headline">¶</a></h2>
<p>Static properties of a <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> must be set when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>, and can’t be changed
afterwards. Most properties are controlled through user-data values, either on the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>
or on a particular attribute. Setting the user data can be done in multiple ways.</p>
<p>If you are using a string to indicate your <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> (e.g. through the command line tools,
or when using <code class="docutils literal notranslate"><span class="pre">SimpleFeatureTypes.createType</span></code>), you can append the type-level options to the end of
the string, like so:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="c1">// append the user-data values to the end of the string, separated by a semi-colon</span>
<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String,dtg:Date,*geom:Point:srid=4326;option.one=&#39;foo&#39;,option.two=&#39;bar&#39;&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
</pre></div>
</div>
<p>If you have an existing simple feature type, or you are not using <code class="docutils literal notranslate"><span class="pre">SimpleFeatureTypes.createType</span></code>,
you may set the values directly in the feature type:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set the hint directly</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;option.one&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>If you are using TypeSafe configuration files to define your simple feature type, you may include
a ‘user-data’ key:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">geomesa</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">sfts</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;mySft&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="w">             </span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dtg</span><span class="p">,</span><span class="w">  </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="w">               </span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">geom</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Point</span><span class="p">,</span><span class="w"> </span><span class="nx">srid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4326</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">      </span><span class="nx">user</span><span class="o">-</span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">option</span><span class="p">.</span><span class="nx">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;foo&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="setting-attribute-options">
<span id="attribute-options"></span><h2><span class="section-number">7.7.2. </span>Setting Attribute Options<a class="headerlink" href="#setting-attribute-options" title="Permalink to this headline">¶</a></h2>
<p>In addition to schema-level user data, each attribute also has user data associated with it. Just like
the schema options, attribute user data can be set in multiple ways.</p>
<p>If you are using a string to indicate your <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> (e.g. through the command line tools,
or when using <code class="docutils literal notranslate"><span class="pre">SimpleFeatureTypes.createType</span></code>), you can append the attribute options after the attribute type,
separated with a colon:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="c1">// append the user-data after the attribute type, separated by a colon</span>
<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String:index=true,dtg:Date,*geom:Point:srid=4326&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
</pre></div>
</div>
<p>If you have an existing simple feature type, or you are not using <code class="docutils literal notranslate"><span class="pre">SimpleFeatureTypes.createType</span></code>,
you may set the user data directly in the attribute descriptor:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set the hint directly</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;index&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>If you are using TypeSafe configuration files to define your simple feature type, you may add user data keys
to the attribute elements:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">geomesa</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">sfts</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;mySft&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dtg</span><span class="p">,</span><span class="w">  </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="w">                 </span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">geom</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Point</span><span class="p">,</span><span class="w"> </span><span class="nx">srid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4326</span><span class="w">   </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="setting-the-indexed-date-attribute">
<span id="set-date-attribute"></span><h2><span class="section-number">7.7.3. </span>Setting the Indexed Date Attribute<a class="headerlink" href="#setting-the-indexed-date-attribute" title="Permalink to this headline">¶</a></h2>
<p>For schemas that contain a date attribute, GeoMesa will use the attribute as part of the primary Z3/XZ3 index.
If a schema contains more than one date attribute, you may specify which attribute to use through the user-data
key <code class="docutils literal notranslate"><span class="pre">geomesa.index.dtg</span></code>. If you would prefer to not index any date, you may disable it through the key
<code class="docutils literal notranslate"><span class="pre">geomesa.ignore.dtg</span></code>. If nothing is specified, the first declared date attribute will be used.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// specify the attribute &#39;myDate&#39; as the indexed date</span>
<span class="n">sft1</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.index.dtg&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;myDate&quot;</span><span class="p">);</span>

<span class="c1">// disable indexing by date</span>
<span class="n">sft2</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.ignore.dtg&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="customizing-index-creation">
<span id="id1"></span><h2><span class="section-number">7.7.4. </span>Customizing Index Creation<a class="headerlink" href="#customizing-index-creation" title="Permalink to this headline">¶</a></h2>
<p>Instead of using the default indices, you may specify the exact indices to create. This may be used to create
fewer indices (to speed up ingestion, or because you are only using certain query patterns), or to create additional
indices (for example on non-default geometries or dates).</p>
<p>The indices are created when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. If nothing is specified, the Z2, Z3 (or XZ2 and XZ3
depending on geometry type) and ID indices will all be created, as well as any attribute indices you have defined.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Certain queries may be much slower if you disable an index.</p>
</div>
<p>To configure the indices, you may set a user data value in your simple feature type. The user data key is
<code class="docutils literal notranslate"><span class="pre">geomesa.indices.enabled</span></code>, and it should contain a comma-delimited list containing a subset of index
identifiers, as specified in <a class="reference internal" href="index_overview.html#index-overview"><span class="std std-ref">Index Overview</span></a>.</p>
<p>In addition to specifying which types of indices to create, you may optionally specify the exact attributes that will
be used in each index, by appending them with <code class="docutils literal notranslate"><span class="pre">:</span></code>s after the index name. The following example shows two index
configurations. The first configuration has a single Z3 index that includes the default attributes. The second
configuration has two Z3 indices on different geometries, as well as an attribute index on name which includes
a secondary index on dtg.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String,dtg:Date,*start:Point:srid=4326,end:Point:srid=4326&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
<span class="c1">// enable a default z3 index on start + dtg</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.indices.enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z3&quot;</span><span class="p">);</span>
<span class="c1">// alternatively, enable a z3 index on start + dtg, end + dtg, and an attribute index on</span>
<span class="c1">// name with a secondary index on dtg. note that this overrides the previous configuration</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.indices.enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z3:start:dtg,z3:end:dtg,attr:name:dtg&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data. If you are using the GeoMesa <code class="docutils literal notranslate"><span class="pre">SchemaBuilder</span></code>,
you may instead call the <code class="docutils literal notranslate"><span class="pre">indexes</span></code> methods:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SchemaBuilder</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">SchemaBuilder</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">addString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addDate</span><span class="p">(</span><span class="s">&quot;dtg&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addPoint</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">userData</span>
<span class="w">    </span><span class="p">.</span><span class="n">indices</span><span class="p">(</span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;attr&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="configuring-index-table-names">
<h2><span class="section-number">7.7.5. </span>Configuring Index Table Names<a class="headerlink" href="#configuring-index-table-names" title="Permalink to this headline">¶</a></h2>
<p>The names used for index tables attempt to be unique, usually being composed of the catalog table name, the feature type name,
and the index identifier. In certain situations, it may be useful to modify the index table names. For example, in Accumulo
you may want to put index tables in different namespaces that have custom configurations. Table name prefixes can be set
using the user data key <code class="docutils literal notranslate"><span class="pre">index.table.prefix</span></code>, or, to configure prefixes for a specific index type, <code class="docutils literal notranslate"><span class="pre">index.table.prefix.&lt;index&gt;</span></code>
where <code class="docutils literal notranslate"><span class="pre">&lt;index&gt;</span></code> is an index name such as <code class="docutils literal notranslate"><span class="pre">z3</span></code> or <code class="docutils literal notranslate"><span class="pre">id</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String,dtg:Date,*geom:Point:srid=4326&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
<span class="c1">// table names will look like geomesa.custom_mySft_id_v4</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;index.table.prefix&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;geomesa.custom&quot;</span><span class="p">);</span>
<span class="c1">// override table names for just the z3 index</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;index.table.prefix.z3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;geomesa_z3.custom&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="configuring-feature-id-encoding">
<h2><span class="section-number">7.7.6. </span>Configuring Feature ID Encoding<a class="headerlink" href="#configuring-feature-id-encoding" title="Permalink to this headline">¶</a></h2>
<p>While feature IDs can be any string, a common use case is to use UUIDs. A UUID is a globally unique, specially
formatted string composed of hex characters in the format <code class="docutils literal notranslate"><span class="pre">{8}-{4}-{4}-{4}-{12}</span></code>, for example
<code class="docutils literal notranslate"><span class="pre">28a12c18-e5ae-4c04-ae7b-bf7cdbfaf234</span></code>. A UUID can also be considered as a 128 bit number, which can
be serialized in a smaller size.</p>
<p>You can indicate that feature IDs are UUIDs using the user data key <code class="docutils literal notranslate"><span class="pre">geomesa.fid.uuid</span></code>. If set before
calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>, then feature IDs will be serialized as 16 byte numbers instead of 36 byte strings,
saving some overhead:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.fid.uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
<span class="n">datastore</span><span class="p">.</span><span class="na">createSchema</span><span class="p">(</span><span class="n">sft</span><span class="p">);</span>
</pre></div>
</div>
<p>If the schema is already created, you may still retroactively indicate that feature IDs are UUIDs, but you
<strong>must also indicate</strong> that they are not serialized that way using <code class="docutils literal notranslate"><span class="pre">geomesa.fid.uuid-encoded</span></code>. This may still
provide some benefit when exporting data in certain formats (e.g. Arrow):</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datastore</span><span class="p">.</span><span class="na">getSchema</span><span class="p">(</span><span class="s">&quot;existing&quot;</span><span class="p">);</span>
<span class="n">existing</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.fid.uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
<span class="n">existing</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.fid.uuid-encoded&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">);</span>
<span class="n">datastore</span><span class="p">.</span><span class="na">updateSchema</span><span class="p">(</span><span class="s">&quot;existing&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">existing</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensure that you use valid UUIDs if you indicate that you are using them. Otherwise you will experience
exceptions writing and/or reading data.</p>
</div>
</section>
<section id="configuring-geometry-serialization">
<h2><span class="section-number">7.7.7. </span>Configuring Geometry Serialization<a class="headerlink" href="#configuring-geometry-serialization" title="Permalink to this headline">¶</a></h2>
<p>By default, geometries are serialized using a modified version of the well-known binary (WKB) format. Alternatively,
geometries may be serialized using the
<a class="reference external" href="https://github.com/TWKB/Specification/blob/master/twkb.md">tiny well-known binary (TWKB)</a> format. TWKB will be
smaller on disk, but does not allow full double floating point precision. For point geometries, TWKB will take
4-12 bytes (depending on the precision specified), compared to 18 bytes for WKB. For line strings, polygons, or
other geometries with multiple coordinates, the space savings will be greater due to TWKB’s delta encoding scheme.</p>
<p>For any geometry type attribute, TWKB serialization can be enabled by setting the floating point precision
through the <code class="docutils literal notranslate"><span class="pre">precision</span></code> user-data key. Precision indicates the number of decimal places that will be stored, and
must be between -7 and 7, inclusive. A negative precision can be used to indicate rounding of whole numbers to the
left of the decimal place. For reference, 6 digits of latitude/longitude precision can store a resolution of
approximately 10cm.</p>
<p>For geometries with more than two dimensions, the precision of the Z and M dimensions may be specified separately.
Generally these dimensions do not need to be stored with the same resolution as X/Y. By default, Z will
be stored with precision 1, and M with precision 0. To change this, specify the additional precisions after
the X/Y precision, separated with commas. For example, <code class="docutils literal notranslate"><span class="pre">6,1,0</span></code> would set the X/Y precision to 6, the Z
precision to 1 and the M precision to 0. Z and M precisions must be between 0 and 7, inclusive.</p>
<p>TWKB serialization can be set when creating a new schema, but can also be enabled at any time through the
<code class="docutils literal notranslate"><span class="pre">updateSchema</span></code> method. If modifying an existing schema, any data already written will not be updated.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;precision&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#attribute-options"><span class="std std-ref">Setting Attribute Options</span></a> for details on how to set attribute options.</p>
</section>
<section id="configuring-column-groups">
<h2><span class="section-number">7.7.8. </span>Configuring Column Groups<a class="headerlink" href="#configuring-column-groups" title="Permalink to this headline">¶</a></h2>
<p>For back-ends that support it (currently HBase and Accumulo), subsets of attributes may be replicated into
separate column groups. When possible, only the reduced column groups will be scanned for a query, which avoids
having to read unused data from disk. For schemas with a large number of attributes, this can speed up some queries,
at the cost of writing more data to disk.</p>
<p>Column groups are specified per attribute, using attribute-level user data. An attribute may belong to multiple
column groups, in which case it will be replicated multiple times. All attributes will belong to the default
column group without having to specify anything. See <a class="reference internal" href="#attribute-options"><span class="std std-ref">Setting Attribute Options</span></a> for details on how to set attribute
options.</p>
<p>Column groups are specified using the user data key <code class="docutils literal notranslate"><span class="pre">column-groups</span></code>, with the value being a comma-delimited list
of groups for that attribute. It is recommended to keep column group names short (ideally a single character), in
order to minimize disk usage. If a column group conflicts with one of the default groups used by GeoMesa, it
will throw an exception when creating the schema. Currently, the reserved groups are <code class="docutils literal notranslate"><span class="pre">d</span></code> for HBase and
<code class="docutils literal notranslate"><span class="pre">F</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">I</span></code>, and <code class="docutils literal notranslate"><span class="pre">B</span></code> for Accumulo.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-0-c3BlYw==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-c3BlYw==" name="c3BlYw==" role="tab" tabindex="-1">spec</button><button aria-controls="panel-0-Y29uZmln" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Y29uZmln" name="Y29uZmln" role="tab" tabindex="-1">config</button><button aria-controls="panel-0-U2NoZW1hQnVpbGRlcg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tab" tabindex="-1">SchemaBuilder</button></div><div aria-labelledby="tab-0-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;column-groups&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a,b&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-c3BlYw==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-c3BlYw==" name="c3BlYw==" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SimpleFeatureTypes</span>
<span class="c1">// for java, use org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span>

<span class="kd">val</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String:column-groups=a,dtg:Date:column-groups=&#39;a,b&#39;,*geom:Point:srid=4326:column-groups=&#39;a,b&#39;&quot;</span>
<span class="nc">SimpleFeatureTypes</span><span class="p">.</span><span class="n">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Y29uZmln" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Y29uZmln" name="Y29uZmln" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">geomesa</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">sfts</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;mySft&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;String&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">column</span><span class="o">-</span><span class="nx">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;dtg&quot;</span><span class="p">,</span><span class="w">  </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Date&quot;</span><span class="p">,</span><span class="w">   </span><span class="nx">column</span><span class="o">-</span><span class="nx">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;a,b&quot;</span><span class="w">              </span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w">  </span><span class="nx">column</span><span class="o">-</span><span class="nx">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;a,b&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">srid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4326</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NoZW1hQnVpbGRlcg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SchemaBuilder</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">SchemaBuilder</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">addString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="n">withColumnGroups</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addDate</span><span class="p">(</span><span class="s">&quot;dtg&quot;</span><span class="p">).</span><span class="n">withColumnGroups</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addPoint</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">).</span><span class="n">withColumnGroups</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="configuring-z-index-shards">
<span id="configuring-z-shards"></span><h2><span class="section-number">7.7.9. </span>Configuring Z-Index Shards<a class="headerlink" href="#configuring-z-index-shards" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa allows configuration of the number of shards (or splits) into which the Z2/Z3/XZ2/XZ3 indices are
divided. This parameter may be changed individually for each <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>. If nothing is specified,
GeoMesa will default to 4 shards. The number of shards must be between 1 and 127.</p>
<p>Shards allow for tables to be pre-split, which provides some initial parallelism for reads and writes. As more data is
written, tables will generally split based on size, thus obviating the need for explicit shards. For small data sets,
shards are more important as the tables might never split due to size. Setting the number of shards too high can
reduce performance, as it requires more calculations to be performed per query.</p>
<p>The number of shards is set when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. It may be specified through the simple feature type
user data using the keys <code class="docutils literal notranslate"><span class="pre">geomesa.z2.splits</span></code> or <code class="docutils literal notranslate"><span class="pre">geomesa.z3.splits</span></code> for two and three dimensional indices
respectively. See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.z3.splits&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="configuring-z-index-time-interval">
<span id="customizing-z-index"></span><h2><span class="section-number">7.7.10. </span>Configuring Z-Index Time Interval<a class="headerlink" href="#configuring-z-index-time-interval" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa uses a z-curve index for time-based queries. By default, time is split into week-long chunks and indexed
per week. If your queries are typically much larger or smaller than one week, you may wish to partition at a
different interval. GeoMesa provides four intervals - <code class="docutils literal notranslate"><span class="pre">day</span></code>, <code class="docutils literal notranslate"><span class="pre">week</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code> or <code class="docutils literal notranslate"><span class="pre">year</span></code>. As the interval
gets larger, fewer partitions must be examined for a query, but the precision of each interval will go down.</p>
<p>If you typically query months of data at a time, then indexing per month may provide better performance.
Alternatively, if you typically query minutes of data at a time, indexing per day may be faster. The default
per week partitioning tends to provides a good balance for most scenarios. Note that the optimal partitioning
depends on query patterns, not the distribution of data.</p>
<p>The time interval is set when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. It may be specified through the simple feature type
user data using the key <code class="docutils literal notranslate"><span class="pre">geomesa.z3.interval</span></code>.  See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.z3.interval&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;month&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="configuring-xz-index-precision">
<span id="customizing-xz-index"></span><h2><span class="section-number">7.7.11. </span>Configuring XZ-Index Precision<a class="headerlink" href="#configuring-xz-index-precision" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa uses an extended z-curve index for storing geometries with extents. The index can be customized
by specifying the resolution level used to store geometries. By default, the resolution level is 12. If
you have very large geometries, you may want to lower this value. Conversely, if you have very small
geometries, you may want to raise it.</p>
<p>The resolution level for an index is set when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. It may be specified through
the simple feature type user data using the key <code class="docutils literal notranslate"><span class="pre">geomesa.xz.precision</span></code>.  See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for
details on setting user data.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.xz.precision&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
<p>For more information on resolution level (g), see
“XZ-Ordering: A Space-Filling Curve for Objects with Spatial Extension” by Böhm, Klump and Kriegel.</p>
</section>
<section id="configuring-attribute-index-shards">
<span id="configuring-attr-shards"></span><h2><span class="section-number">7.7.12. </span>Configuring Attribute Index Shards<a class="headerlink" href="#configuring-attribute-index-shards" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa allows configuration of the number of shards (or splits) into which the attribute indices are
divided. This parameter may be changed individually for each <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>. If nothing is specified,
GeoMesa will default to 4 shards. The number of shards must be between 1 and 127.</p>
<p>See <a class="reference internal" href="#configuring-z-shards"><span class="std std-ref">Configuring Z-Index Shards</span></a> for more background on shards.</p>
<p>The number of shards is set when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. It may be specified through the simple feature type
user data using the key <code class="docutils literal notranslate"><span class="pre">geomesa.attr.splits</span></code>. See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.attr.splits&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="configuring-attribute-cardinality">
<span id="cardinality-config"></span><h2><span class="section-number">7.7.13. </span>Configuring Attribute Cardinality<a class="headerlink" href="#configuring-attribute-cardinality" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa allows attributes to be marked as either high or low cardinality. If set, this hint will be used in
query planning. For more information, see <a class="reference internal" href="query_planning.html#attribute-cardinality"><span class="std std-ref">Cardinality Hints</span></a>.</p>
<p>To set the cardinality of an attribute, use the key <code class="docutils literal notranslate"><span class="pre">cardinality</span></code> on the attribute, with a value of
<code class="docutils literal notranslate"><span class="pre">high</span></code> or <code class="docutils literal notranslate"><span class="pre">low</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-1-U2NoZW1hQnVpbGRlcg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tab" tabindex="-1">SchemaBuilder</button></div><div aria-labelledby="tab-1-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;index&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;cardinality&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;high&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2NoZW1hQnVpbGRlcg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SchemaBuilder</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">stats</span><span class="p">.</span><span class="nc">Cardinality</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">SchemaBuilder</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">addString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="n">withIndex</span><span class="p">(</span><span class="nc">Cardinality</span><span class="p">.</span><span class="nc">HIGH</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addDate</span><span class="p">(</span><span class="s">&quot;dtg&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addPoint</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="configuring-partitioned-indices">
<span id="partitioned-indices"></span><h2><span class="section-number">7.7.14. </span>Configuring Partitioned Indices<a class="headerlink" href="#configuring-partitioned-indices" title="Permalink to this headline">¶</a></h2>
<p>To help with large data sets, GeoMesa can partition each index into separate tables, based on the attributes of
each feature. Having multiple tables for a single index can make it simpler to manage a cluster, for example by
making it trivial to delete old data.</p>
<p>Partitioning must be specified through user data when creating a simple feature type, before calling
<code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. To indicate a partitioning scheme, use the key <code class="docutils literal notranslate"><span class="pre">geomesa.table.partition</span></code>. Currently
the only valid value is <code class="docutils literal notranslate"><span class="pre">time</span></code>, to indicate time-based partitioning:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-2-U2NoZW1hQnVpbGRlcg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tab" tabindex="-1">SchemaBuilder</button></div><div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.table.partition&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U2NoZW1hQnVpbGRlcg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SchemaBuilder</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">SchemaBuilder</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">addString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addDate</span><span class="p">(</span><span class="s">&quot;dtg&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addPoint</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">userData</span>
<span class="w">    </span><span class="p">.</span><span class="n">partitioned</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>Note that to enable partitioning the schema must contain a default date field.</p>
<p>When partitioning is enabled, each index will consist of multiple physical tables. The tables are partitioned
based on the Z-interval (see <a class="reference internal" href="#customizing-z-index"><span class="std std-ref">Configuring Z-Index Time Interval</span></a>). Tables are created dynamically when needed.</p>
<p>Partitioned tables can still be pre-split, as described in <a class="reference internal" href="#table-split-config"><span class="std std-ref">Configuring Index Splits</span></a>. For Z3 splits, the min/max
date configurations are automatically determined by the partition, and do not need to be specified.</p>
<p>When a query must scan multiple tables, by default the tables will be scanned sequentially. To instead scan
the tables in parallel, set the sytem property <code class="docutils literal notranslate"><span class="pre">geomesa.partition.scan.parallel=true</span></code>. Note that when enabled,
queries that span many partitions may place a large load on the system.</p>
<p>The GeoMesa command line tools provide functions for managing partitions; see <a class="reference internal" href="../cli/schemas.html#manage-partitions-cli"><span class="std std-ref">manage-partitions</span></a>
for details.</p>
</section>
<section id="configuring-index-splits">
<span id="table-split-config"></span><h2><span class="section-number">7.7.15. </span>Configuring Index Splits<a class="headerlink" href="#configuring-index-splits" title="Permalink to this headline">¶</a></h2>
<p>When planning to ingest large amounts of data, if the distribution is known up front, it can be useful to
pre-split tables before writing. This provides parallelism across a cluster from the start, and doesn’t
depend on implementation triggers (which typically split tables based on size).</p>
<p>Splits are managed through implementations of the <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.index.conf.TableSplitter</span></code> interface.</p>
<section id="specifying-a-table-splitter">
<h3><span class="section-number">7.7.15.1. </span>Specifying a Table Splitter<a class="headerlink" href="#specifying-a-table-splitter" title="Permalink to this headline">¶</a></h3>
<p>A table splitter may be specified through user data when creating a simple feature type, before calling
<code class="docutils literal notranslate"><span class="pre">createSchema</span></code>.</p>
<p>To indicate the table splitter class, use the key <code class="docutils literal notranslate"><span class="pre">table.splitter.class</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;table.splitter.class&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;org.example.CustomSplitter&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>To indicate any options for the given table splitter, use the key <code class="docutils literal notranslate"><span class="pre">table.splitter.options</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;table.splitter.options&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo,bar,baz&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data.</p>
</section>
<section id="the-default-table-splitter">
<h3><span class="section-number">7.7.15.2. </span>The Default Table Splitter<a class="headerlink" href="#the-default-table-splitter" title="Permalink to this headline">¶</a></h3>
<p>Generally, <code class="docutils literal notranslate"><span class="pre">table.splitter.class</span></code> can be omitted. If so, GeoMesa will use a default implementation that allows
for a flexible configuration using <code class="docutils literal notranslate"><span class="pre">table.splitter.options</span></code>. If no options are specified, then all tables
will generally create 4 splits (based on the number of shards). The default ID index splits assume
that feature IDs are randomly distributed UUIDs.</p>
<p>For the default splitter, <code class="docutils literal notranslate"><span class="pre">table.splitter.options</span></code> should consist of comma-separated entries, in the form
<code class="docutils literal notranslate"><span class="pre">key1:value1,key2:value2</span></code>. Entries related to a given index should start with the index identifier, e.g. one
of <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">z3</span></code>, <code class="docutils literal notranslate"><span class="pre">z2</span></code> or <code class="docutils literal notranslate"><span class="pre">attr</span></code> (<code class="docutils literal notranslate"><span class="pre">xz3</span></code> and <code class="docutils literal notranslate"><span class="pre">xz2</span></code> indices use <code class="docutils literal notranslate"><span class="pre">z3</span></code> and <code class="docutils literal notranslate"><span class="pre">z2</span></code>, respectively).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 39%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>Z3/XZ3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">z3.min</span></code></p></td>
<td><p>The minimum date for the data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z3.max</span></code></p></td>
<td><p>The maximum date for the data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z3.bits</span></code></p></td>
<td><p>The number of leading bits to split on</p></td>
</tr>
<tr class="row-odd"><td><p>Z2/XZ2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">z2.bits</span></code></p></td>
<td><p>The number of leading bits to split on</p></td>
</tr>
<tr class="row-even"><td><p>ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">id.pattern</span></code></p></td>
<td><p>Split pattern</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>Attribute</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">attr.&lt;attribute&gt;.pattern</span></code></p></td>
<td><p>Split pattern for a given attribute</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">attr.&lt;attribute&gt;.date-range</span></code></p></td>
<td><p>Date range for a given attribute</p></td>
</tr>
</tbody>
</table>
<section id="z3-xz3-splits">
<h4><span class="section-number">7.7.15.2.1. </span>Z3/XZ3 Splits<a class="headerlink" href="#z3-xz3-splits" title="Permalink to this headline">¶</a></h4>
<p>Dates are used to split based on the Z3 time prefix (typically weeks). They are specified in the form
<code class="docutils literal notranslate"><span class="pre">yyyy-MM-dd</span></code>. If the minimum date is specified, but the maximum date is not, it will default to the current date.
After the dates, the Z value can be split based on a number of bits (note that due to the index format, bits can
not be specified without dates). For example, specifying two bits would create splits 00, 01, 10 and 11. The total
number of splits created will be <code class="docutils literal notranslate"><span class="pre">&lt;number</span> <span class="pre">of</span> <span class="pre">z</span> <span class="pre">shards&gt;</span> <span class="pre">*</span> <span class="pre">&lt;number</span> <span class="pre">of</span> <span class="pre">time</span> <span class="pre">periods&gt;</span> <span class="pre">*</span> <span class="pre">2</span> <span class="pre">^</span> <span class="pre">&lt;number</span> <span class="pre">of</span> <span class="pre">bits&gt;</span></code>.</p>
</section>
<section id="z2-xz2-splits">
<h4><span class="section-number">7.7.15.2.2. </span>Z2/XZ2 Splits<a class="headerlink" href="#z2-xz2-splits" title="Permalink to this headline">¶</a></h4>
<p>If any options are given, the number of bits must be specified. For example, specifying two bits would create
splits 00, 01, 10 and 11. The total number of splits created will be <code class="docutils literal notranslate"><span class="pre">&lt;number</span> <span class="pre">of</span> <span class="pre">z</span> <span class="pre">shards&gt;</span> <span class="pre">*</span> <span class="pre">2</span> <span class="pre">^</span> <span class="pre">&lt;number</span> <span class="pre">of</span> <span class="pre">bits&gt;</span></code>.</p>
</section>
<section id="id-and-attribute-splits">
<h4><span class="section-number">7.7.15.2.3. </span>ID and Attribute Splits<a class="headerlink" href="#id-and-attribute-splits" title="Permalink to this headline">¶</a></h4>
<p>Splits are defined by patterns. For an ID index, the pattern(s) are applied to the single feature ID. For an
attribute index, each attribute that is indexed can be configured separately, by specifying the attribute name
as part of the option. For example, given the schema <code class="docutils literal notranslate"><span class="pre">name:String:index=true,*geom:Point:srid=4326</span></code>, the
<code class="docutils literal notranslate"><span class="pre">name</span></code> attribute splits can be configured with <code class="docutils literal notranslate"><span class="pre">attr.name.pattern</span></code>.</p>
<p>Patterns consist of one or more single characters or ranges enclosed in square brackets. Valid characters
can be any of the numbers 0 to 9, or any letter a to z, in upper or lower case. Ranges are two characters
separated by a dash. Each set of brackets corresponds to a single character, allowing for nested splits.
For numeric types, negatives may be specified with a leading negative sign.</p>
<p>For example, the pattern <code class="docutils literal notranslate"><span class="pre">[0-9]</span></code> would create 10 splits, based on the numbers 0 through 9. The
pattern <code class="docutils literal notranslate"><span class="pre">[0-9][0-9]</span></code> would create 100 splits. The pattern <code class="docutils literal notranslate"><span class="pre">[-][0-9]</span></code> would create 10 splits based on
the numbers -9 through 0. The pattern <code class="docutils literal notranslate"><span class="pre">[0-9a-f]</span></code> would create 16 splits based on lower-case
hex characters. The pattern <code class="docutils literal notranslate"><span class="pre">[0-9A-F]</span></code> would do the same with upper-case characters.</p>
<p>For data hot-spots, multiple patterns can be specified by adding additional options with a 2, 3, etc appended to
the key. For example, if most of the <code class="docutils literal notranslate"><span class="pre">name</span></code> values start with the letter <code class="docutils literal notranslate"><span class="pre">f</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>, splits could be
specified as <code class="docutils literal notranslate"><span class="pre">attr.name.pattern:[a-z],attr.name.pattern2:[f][a-z],attr.name.pattern3:[t][a-z]</span></code></p>
<p>For number-type attributes, only numbers are considered valid characters. Due to lexicoding, normal number
prefixing will not work correctly. E.g., if the data has numbers in the range 8000-9000, specifying
<code class="docutils literal notranslate"><span class="pre">[8-9][0-9]</span></code> will not split the data properly. Instead, trailing zeros should be added to reach the appropriate
length, e.g. <code class="docutils literal notranslate"><span class="pre">[8-9][0-9][0][0]</span></code>.</p>
<p>For attribute indices with secondary date indexing, each attribute pattern can be further refined with a date
pattern, using the suffix <code class="docutils literal notranslate"><span class="pre">date-range</span></code>. For the example above, you could have any or all of <code class="docutils literal notranslate"><span class="pre">attr.name.date-range</span></code>,
<code class="docutils literal notranslate"><span class="pre">attr.name.date-range2</span></code> and <code class="docutils literal notranslate"><span class="pre">attr.name.date-range3</span></code>. The date range is expected to take the form of
<code class="docutils literal notranslate"><span class="pre">begin-date/end-date/number</span> <span class="pre">of</span> <span class="pre">splits</span></code>, and dates are specified in the form <code class="docutils literal notranslate"><span class="pre">yyyy-MM-dd</span></code>, e.g.
<code class="docutils literal notranslate"><span class="pre">2020-01-01/2023-01-01/8</span></code>. Note that this is mainly useful with low-cardinality attributes, as due to the way
secondary indexing works, date suffixes are only useful after full keys. Continuing the example,
<code class="docutils literal notranslate"><span class="pre">attr.name.pattern:[a][l][i][c][e],attr.name.date-range:2020-01-01/2023-01-01/8</span></code> would effectively partition an
index where everyone is named Alice, but <code class="docutils literal notranslate"><span class="pre">attr.name.pattern:[a-z],attr.name.date-range:2020-01-01/2023-01-01/8</span></code>
would not be effective unless everyone had a single-letter name.</p>
</section>
<section id="full-example">
<h4><span class="section-number">7.7.15.2.4. </span>Full Example<a class="headerlink" href="#full-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String:index=true,age:Int:index=true,dtg:Date,*geom:Point:srid=4326&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;spec&quot;</span><span class="p">);</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;table.splitter.options&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;id.pattern:[0-9a-f],attr.name.pattern:[a-z],z3.min:2018-01-01,z3.max:2018-01-31,z3.bits:2,z2.bits:4&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="configuring-query-interceptors">
<h2><span class="section-number">7.7.16. </span>Configuring Query Interceptors<a class="headerlink" href="#configuring-query-interceptors" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa provides a chance for custom logic to be applied to a query before executing it via
query interceptors and guards.  A full discussion of their use and configuration is at <a class="reference internal" href="query_interceptor.html#query-interceptors"><span class="std std-ref">Query Interceptors and Guards</span></a>.</p>
</section>
<section id="configuring-cached-statistics">
<span id="stat-config"></span><h2><span class="section-number">7.7.17. </span>Configuring Cached Statistics<a class="headerlink" href="#configuring-cached-statistics" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa will collect and store summary statistics for attributes during ingest, which are then available for
lookup and/or query planning. Stat generation can be enabled or disabled through the simple feature type
user data using the key <code class="docutils literal notranslate"><span class="pre">geomesa.stats.enable</span></code>. See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cached statistics are currently only implemented for the Accumulo and Redis data stores</p>
</div>
<p>If enabled, stats are always collected for the default geometry, default date and any indexed attributes. See
<a class="reference internal" href="query_planning.html#stats-collected"><span class="std std-ref">Cost-Based Strategy</span></a> for more details. In addition, other attributes can be flagged for stats by using the key
<code class="docutils literal notranslate"><span class="pre">keep-stats</span></code> on individual attributes, as described in <a class="reference internal" href="#attribute-options"><span class="std std-ref">Setting Attribute Options</span></a>. This will cause the following
stats to be collected for those attributes:</p>
<ul class="simple">
<li><p>Min/max (bounds)</p></li>
<li><p>Top-k</p></li>
</ul>
<p>Only attributes of type <code class="docutils literal notranslate"><span class="pre">String</span></code>, <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Long</span></code>, <code class="docutils literal notranslate"><span class="pre">Float</span></code>, <code class="docutils literal notranslate"><span class="pre">Double</span></code>, <code class="docutils literal notranslate"><span class="pre">Date</span></code> or <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> can be
flagged for stats.</p>
<p>For example:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set the hint directly</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;keep-stats&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../cli/analytic.html#cli-analytic"><span class="std std-ref">Analytic Commands</span></a> and <a class="reference internal" href="analytic_queries.html#stats-api"><span class="std std-ref">Accessing Stats through the GeoMesa API</span></a> for information on reading cached stats.</p>
</section>
<section id="configuring-temporal-priority">
<h2><span class="section-number">7.7.18. </span>Configuring Temporal Priority<a class="headerlink" href="#configuring-temporal-priority" title="Permalink to this headline">¶</a></h2>
<p>For some large time-based datasets, an index that leverages a temporal predicate will almost always be faster
to query than one that doesn’t. A schema can be configured to prioritize temporal predicates by setting the
user-data key <code class="docutils literal notranslate"><span class="pre">geomesa.temporal.priority</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.temporal.priority&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>This may be configured before calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>, or updated by calling <code class="docutils literal notranslate"><span class="pre">updateSchema</span></code>.</p>
</section>
<section id="configuring-required-visibilities">
<span id="required-vis-config"></span><h2><span class="section-number">7.7.19. </span>Configuring Required Visibilities<a class="headerlink" href="#configuring-required-visibilities" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa supports <a class="reference internal" href="security.html#data-security"><span class="std std-ref">Data Security</span></a> through the use of visibility labels to secure access to sensitive data.
To help prevent data spills, a schema can be configured to reject any writes that don’t contain valid visibilities.
To enable this setting, use the user-data key <code class="docutils literal notranslate"><span class="pre">geomesa.vis.required</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.vis.required&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>This may be configured before calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>, or updated by calling <code class="docutils literal notranslate"><span class="pre">updateSchema</span></code>.</p>
<p>Note that this configuration will prevent missing visibility labels in normal write paths, but that
it is still possible to write unlabelled data through older clients, bulk loading, or direct access
to the underlying database.</p>
<p>In Accumulo data stores, setting this configuration will also set the Accumulo <code class="docutils literal notranslate"><span class="pre">ReqVisFilter</span></code> on all data
tables, which will prevent any unlabelled data from being returned in queries.</p>
</section>
<section id="mixed-geometry-types">
<h2><span class="section-number">7.7.20. </span>Mixed Geometry Types<a class="headerlink" href="#mixed-geometry-types" title="Permalink to this headline">¶</a></h2>
<p>A common pitfall is to unnecessarily specify a generic geometry type when creating a schema.
Because GeoMesa relies on the geometry type for indexing decisions, this can negatively impact performance.</p>
<p>If the default geometry type is <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> (i.e. supporting both point and non-point
features), you must explicitly enable “mixed” indexing mode. All other geometry types (<code class="docutils literal notranslate"><span class="pre">Point</span></code>,
<code class="docutils literal notranslate"><span class="pre">LineString</span></code>, <code class="docutils literal notranslate"><span class="pre">Polygon</span></code>, etc) are not affected.</p>
<p>Mixed geometries must be declared when calling <code class="docutils literal notranslate"><span class="pre">createSchema</span></code>. It may be specified through
the simple feature type user data using the key <code class="docutils literal notranslate"><span class="pre">geomesa.mixed.geometries</span></code>. See <a class="reference internal" href="#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for
details on setting user data.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.mixed.geometries&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index_ext.html" class="btn btn-neutral float-left" title="7.6. Additional Index Implementations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="runtime_config.html" class="btn btn-neutral float-right" title="7.8. Runtime Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2024 <a href="https://www.ga-ccri.com/">General Atomics</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/datastores/index_config.rst">GitHub <img src="../../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>