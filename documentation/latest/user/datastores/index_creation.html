<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7.4. Creating Indices &mdash; GeoMesa 6.0.0-SNAPSHOT Manuals</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/stable/user/datastores/index_creation.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7.5. Index Configuration" href="index_config.html" />
    <link rel="prev" title="7.3. Index Overview" href="index_overview.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                6.0.0-SNAPSHOT
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">7. GeoMesa Data Stores</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="attributes.html">7.1. GeoTools Feature Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html">7.2. JSON Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_overview.html">7.3. Index Overview</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">7.4. Creating Indices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spatial-index-z2-xz2">7.4.1. Spatial Index (Z2/XZ2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spatio-temporal-index-z3-xz3">7.4.2. Spatio-temporal Index (Z3/XZ3)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id-index">7.4.3. ID Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attribute-index">7.4.4. Attribute Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specifying-the-indices-to-include">7.4.5. Specifying the Indices to Include</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-versioning">7.4.6. Index Versioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-index-implementations">7.4.7. Additional Index Implementations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index_config.html">7.5. Index Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime_config.html">7.6. Runtime Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_planning.html">7.7. Query Planning</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_interceptor.html">7.8. Query Interceptors and Guards</a></li>
<li class="toctree-l3"><a class="reference internal" href="query_config.html">7.9. Query Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="filter_functions.html">7.10. Filter Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="analytic_queries.html">7.11. Analytic Querying</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html">7.12. Data Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="auditing.html">7.13. Query Auditing</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html">7.14. Data Store Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html">7.15. Moving and Migrating Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="reserved_words.html">7.16. Reserved Words</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/index.html">8. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">9. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">10. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">11. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">12. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/index.html">13. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">14. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">15. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scylladb/index.html">17. ScyllaDB Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">18. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">19. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">20. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">21. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">22. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">23. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/index.html">24. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">7. </span>GeoMesa Data Stores</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7.4. </span>Creating Indices</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creating-indices">
<span id="id1"></span><h1><span class="section-number">7.4. </span>Creating Indices<a class="headerlink" href="#creating-indices" title="Permalink to this headline">¶</a></h1>
<p>GeoMesa will create various indices for a given <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> schema (see <a class="reference internal" href="index_overview.html#index-overview"><span class="std std-ref">Index Overview</span></a>). This
allows the execution of a variety of queries in a optimized manner. GeoMesa will make a best effort to determine
the attributes used for indexing. The attributes to use can also be specified as part of the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> -
see <a class="reference internal" href="#specifying-indices"><span class="std std-ref">Specifying the Indices to Include</span></a> for details.</p>
<section id="spatial-index-z2-xz2">
<h2><span class="section-number">7.4.1. </span>Spatial Index (Z2/XZ2)<a class="headerlink" href="#spatial-index-z2-xz2" title="Permalink to this headline">¶</a></h2>
<p>If the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> has a <code class="docutils literal notranslate"><span class="pre">Geometry</span></code>-type attribute (<code class="docutils literal notranslate"><span class="pre">Point</span></code>, <code class="docutils literal notranslate"><span class="pre">LineString</span></code>, <code class="docutils literal notranslate"><span class="pre">Polygon</span></code>, etc),
GeoMesa will create a spatial index on that attribute. If there is more than one <code class="docutils literal notranslate"><span class="pre">Geometry</span></code>-type attribute,
the default one will be used. The default geometry is generally specified with a <code class="docutils literal notranslate"><span class="pre">*</span></code> prefix in the
<code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> string, and is the one returned by <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType.getGeometryDescriptor</span></code>.</p>
</section>
<section id="spatio-temporal-index-z3-xz3">
<h2><span class="section-number">7.4.2. </span>Spatio-temporal Index (Z3/XZ3)<a class="headerlink" href="#spatio-temporal-index-z3-xz3" title="Permalink to this headline">¶</a></h2>
<p>If the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> has both a <code class="docutils literal notranslate"><span class="pre">Geometry</span></code>-type attribute and a <code class="docutils literal notranslate"><span class="pre">Date</span></code> attribute, GeoMesa will
create a spatio-temporal index on those attributes. The <code class="docutils literal notranslate"><span class="pre">Geometry</span></code>-type attribute used is the same as
for the spatial index, above. The <code class="docutils literal notranslate"><span class="pre">Date</span></code> attribute selected will be the first one declared, or can be
set explicitly. See <a class="reference internal" href="index_config.html#set-date-attribute"><span class="std std-ref">Default Date Attribute</span></a> for details on setting the indexed date.</p>
</section>
<section id="id-index">
<h2><span class="section-number">7.4.3. </span>ID Index<a class="headerlink" href="#id-index" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa will always create an ID index on <code class="docutils literal notranslate"><span class="pre">SimpleFeature.getID()</span></code>, unless explicitly disabled. See <a class="reference internal" href="#specifying-indices"><span class="std std-ref">Specifying the Indices to Include</span></a>,
below, for details on disabling the ID index.</p>
</section>
<section id="attribute-index">
<span id="attribute-indices"></span><h2><span class="section-number">7.4.4. </span>Attribute Index<a class="headerlink" href="#attribute-index" title="Permalink to this headline">¶</a></h2>
<p>Some queries are slow to answer using the default indices. For example, with GPS data with you might want to return all records
associated with a given trip based on a trip identifier. To speed up this type of query, any attribute in your simple feature
type may be indexed individually. See <a class="reference internal" href="#specifying-indices"><span class="std std-ref">Specifying the Indices to Include</span></a>, below, for details on configuring attribute indices.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>List type attributes may be indexed, but querying a list-type index may result in duplicate results. If
duplicate results are a problem, users should implement their own de-duplication logic for list queries.</p>
</div>
<p>Attribute indices also support a secondary, tiered index structure. This can improve attribute queries that also contain a
spatial and/or temporal predicate. Unless configured differently, the default date attribute will be used to create a secondary
temporal index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Secondary indices can only be leveraged for equality queries against the primary attribute, e.g.
<code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">'bob'</span></code> can take advantage of a secondary index, but <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">ilike</span> <span class="pre">'bo%'</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">&gt;</span> <span class="pre">'bo'</span></code>
cannot.</p>
</div>
<p>To prioritize certain attributes over others, see <a class="reference internal" href="query_planning.html#attribute-cardinality"><span class="std std-ref">Cardinality Hints</span></a>.</p>
</section>
<section id="specifying-the-indices-to-include">
<span id="specifying-indices"></span><h2><span class="section-number">7.4.5. </span>Specifying the Indices to Include<a class="headerlink" href="#specifying-the-indices-to-include" title="Permalink to this headline">¶</a></h2>
<p>Instead of using the default indices, you may specify the exact indices to create. This may be used to create fewer indices
(to speed up ingestion, or because you are only using certain query patterns), or to create additional indices (for example on
non-default geometries or dates).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Certain queries may be much slower if you disable an index.</p>
</div>
<p>Indices are configured using the attribute-level user-data key <code class="docutils literal notranslate"><span class="pre">index</span></code>. An index may be identified in several ways:</p>
<ul class="simple">
<li><p>The string <code class="docutils literal notranslate"><span class="pre">true</span></code>, which will select an index based on the attribute type</p></li>
<li><p>The string <code class="docutils literal notranslate"><span class="pre">none</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, which will disable any default index on the attribute</p></li>
<li><p>Name of an index, e.g. <code class="docutils literal notranslate"><span class="pre">z3</span></code> or <code class="docutils literal notranslate"><span class="pre">attr</span></code>, which will use the default secondary attributes for the index type</p></li>
<li><p>Name of an index, plus any secondary attributes, e.g. <code class="docutils literal notranslate"><span class="pre">z3:dtg</span></code> or <code class="docutils literal notranslate"><span class="pre">attr:geom:dtg</span></code></p></li>
<li><p>Name of an index, version of the index, plus any secondary attributes, e.g. <code class="docutils literal notranslate"><span class="pre">z3:7:dtg</span></code> or <code class="docutils literal notranslate"><span class="pre">attr:8:geom:dtg</span></code></p></li>
</ul>
<p>Multiple indices on a single attribute may be separated with a comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>).</p>
<p>For attribute indices, if secondary geometry and date attributes are specified, the secondary index will be Z3 or XZ3, as
appropriate. If just a geometry is specified, the secondary index will be Z2 or XZ2, as appropriate. If just a date
is specified, the secondary index will be a temporal index.</p>
<p>The ID index does not correspond to any attribute, but it can be disabled through the feature-level user-data key
<code class="docutils literal notranslate"><span class="pre">id.index.enabled=false</span></code>.</p>
<section id="examples">
<h3><span class="section-number">7.4.5.1. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-0-U2NoZW1hQnVpbGRlcg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tab" tabindex="-1">SchemaBuilder</button><button aria-controls="panel-0-Q29uZmln" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Q29uZmln" name="Q29uZmln" role="tab" tabindex="-1">Config</button></div><div aria-labelledby="tab-0-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="c1">// creates a default attribute index on name and an implicit default z3 and z2 index on geom</span>
<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String:index=true,dtg:Date,*geom:Point:srid=4326&quot;</span><span class="p">;</span>
<span class="c1">// creates an attribute index on name (with a secondary date index), and a z3 index on geom and dtg</span>
<span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String:index=&#39;attr:dtg&#39;,dtg:Date,*geom:Point:srid=4326:index=&#39;z3:dtg&#39;&quot;</span><span class="p">;</span>
<span class="c1">// creates an attribute index on name (with a secondary date index), and a z3 index on geom and dtg and disables the ID index</span>
<span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String:index=&#39;attr:dtg&#39;,dtg:Date,*geom:Point:srid=4326:index=&#39;z3:dtg&#39;;id.index.enabled=false&quot;</span><span class="p">;</span>

<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;myType&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
<span class="c1">// alternatively, set user data after parsing the type string (but before calling &quot;createSchema&quot;)</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getDescriptor</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;index&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NoZW1hQnVpbGRlcg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NoZW1hQnVpbGRlcg==" name="U2NoZW1hQnVpbGRlcg==" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SchemaBuilder</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="nc">SchemaBuilder</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">addString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="n">withIndex</span><span class="p">(</span><span class="s">&quot;attr:dtg&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// creates an attribute index on name, with a secondary date index</span>
<span class="w">    </span><span class="p">.</span><span class="n">addInt</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">).</span><span class="n">withIndex</span><span class="p">()</span><span class="w"> </span><span class="c1">// creates an attribute index on age, with a default secondary index</span>
<span class="w">    </span><span class="p">.</span><span class="n">addDate</span><span class="p">(</span><span class="s">&quot;dtg&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// not a primary index</span>
<span class="w">    </span><span class="p">.</span><span class="n">addPoint</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">).</span><span class="n">withIndices</span><span class="p">(</span><span class="s">&quot;z3:dtg&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z2&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// creates a z3 index with dtg, and a z2 index</span>
<span class="w">    </span><span class="p">.</span><span class="n">userData</span>
<span class="w">    </span><span class="p">.</span><span class="n">disableIdIndex</span><span class="p">()</span><span class="w"> </span><span class="c1">// disables the ID index</span>
<span class="w">    </span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Q29uZmln" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Q29uZmln" name="Q29uZmln" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nx">type</span><span class="o">-</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">myType</span>
<span class="w">  </span><span class="nx">attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;String&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;attr:dtg&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// creates an attribute index on name, with a secondary date index</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Int&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// creates an attribute index on age, with a default secondary index</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;dtg&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Date&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// not a primary index</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">srid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;4326&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;z3:dtg,z2&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// creates a z3 index with dtg, and a z2 index</span>
<span class="w">  </span><span class="p">]</span>
<span class="w">  </span><span class="nx">user</span><span class="o">-</span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id.index.enabled&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="w"> </span><span class="c1">// disables the default ID index</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</section>
<section id="feature-level-configuration">
<h3><span class="section-number">7.4.5.2. </span>Feature-Level Configuration<a class="headerlink" href="#feature-level-configuration" title="Permalink to this headline">¶</a></h3>
<p>Instead of configuring individual attributes, you may set a top-level user data value in your simple feature type using the key
<code class="docutils literal notranslate"><span class="pre">geomesa.indices.enabled</span></code>. The value should contain a comma-delimited list containing a subset of index identifiers, as
specified in <a class="reference internal" href="index_overview.html#index-overview"><span class="std std-ref">Index Overview</span></a> (and optionally an index version and/or list of attributes to include in the index, as
detailed above). If the <code class="docutils literal notranslate"><span class="pre">attr</span></code> index is specified without any attributes, then attribute-level <code class="docutils literal notranslate"><span class="pre">index</span></code> flags will be
examined to determine the attributes to index. Otherwise, any other attribute-level configuration will be ignored when
using <code class="docutils literal notranslate"><span class="pre">geomesa.indices.enabled</span></code>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name:String,dtg:Date,*start:Point:srid=4326,end:Point:srid=4326&quot;</span><span class="p">;</span>
<span class="n">SimpleFeatureType</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleFeatureTypes</span><span class="p">.</span><span class="na">createType</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">);</span>
<span class="c1">// enable a default z3 index on start + dtg</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.indices.enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z3&quot;</span><span class="p">);</span>
<span class="c1">// alternatively, enable a z3 index on start + dtg, end + dtg, and an attribute index on</span>
<span class="c1">// name with a secondary index on dtg. note that this overrides the previous configuration</span>
<span class="n">sft</span><span class="p">.</span><span class="na">getUserData</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;geomesa.indices.enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z3:start:dtg,z3:end:dtg,attr:name:dtg&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="attributes.html#set-sft-options"><span class="std std-ref">Setting Schema Options</span></a> for details on setting user data. If you are using the GeoMesa <code class="docutils literal notranslate"><span class="pre">SchemaBuilder</span></code>,
you may instead call the <code class="docutils literal notranslate"><span class="pre">indices</span></code> method:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">SchemaBuilder</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sft</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="nc">SchemaBuilder</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">addString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addDate</span><span class="p">(</span><span class="s">&quot;dtg&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">addPoint</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">userData</span>
<span class="w">    </span><span class="p">.</span><span class="n">indices</span><span class="p">(</span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;attr&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;mySft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="index-versioning">
<span id="id2"></span><h2><span class="section-number">7.4.6. </span>Index Versioning<a class="headerlink" href="#index-versioning" title="Permalink to this headline">¶</a></h2>
<p>In order to ensure cross-compatibility, each index created by GeoMesa has a version number that identifies
the layout of data on disk, which is fixed at the time of creation. Updating GeoMesa versions
will provide bug fixes and new features, but will not update existing data to new index formats.</p>
<p>The exact version of an index used for each schema can be read from the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> user data,
or by simply examining the name of the index tables created by GeoMesa.</p>
<p>The following versions are available:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Z3</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Z2</button><button aria-controls="panel-1-1-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-2" name="1-2" role="tab" tabindex="-1">XZ3</button><button aria-controls="panel-1-1-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-3" name="1-3" role="tab" tabindex="-1">XZ2</button><button aria-controls="panel-1-1-4" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-4" name="1-4" role="tab" tabindex="-1">Attribute</button><button aria-controls="panel-1-1-5" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-5" name="1-5" role="tab" tabindex="-1">ID</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index Version</p></th>
<th class="head"><p>GeoMesa Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1.1.0</p></td>
<td><p>Initial implementation</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.2.1</p></td>
<td><p>Support for non-point geometries</p>
<p>Support for shards</p>
</td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.2.5</p></td>
<td><p>Removed support for non-point geometries in favor of xz</p>
<p>Removed redundant feature ID in row value to reduce size on disk</p>
<p>Support for per-attribute visibility</p>
</td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>1.3.1</p></td>
<td><p>Support for table sharing</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>2.0.0</p></td>
<td><p>Uses fixed Z-curve implementation</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>2.3.0</p></td>
<td><p>Configurable attributes</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>3.2.0</p></td>
<td><p>Fixes yearly epoch indexing</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index Version</p></th>
<th class="head"><p>GeoMesa Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1.2.2</p></td>
<td><p>Initial implementation</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.2.5</p></td>
<td><p>Removed support for non-point geometries in favor of xz</p>
<p>Removed redundant feature ID in row value to reduce size on disk</p>
<p>Support for per-attribute visibility</p>
</td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.3.1</p></td>
<td><p>Optimized deletes</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>2.0.0</p></td>
<td><p>Uses fixed Z-curve implementation</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>2.3.0</p></td>
<td><p>Configurable attributes</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-2" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-2" name="1-2" role="tabpanel" tabindex="0"><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index Version</p></th>
<th class="head"><p>GeoMesa Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1.2.5</p></td>
<td><p>Initial implementation</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>2.3.0</p></td>
<td><p>Configurable attributes</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>3.2.0</p></td>
<td><p>Fixes yearly epoch indexing</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-3" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-3" name="1-3" role="tabpanel" tabindex="0"><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index Version</p></th>
<th class="head"><p>GeoMesa Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1.2.5</p></td>
<td><p>Initial implementation</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>2.3.0</p></td>
<td><p>Configurable attributes</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-4" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-4" name="1-4" role="tabpanel" tabindex="0"><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index Version</p></th>
<th class="head"><p>GeoMesa Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1.0.0</p></td>
<td><p>Initial implementation</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.1.0</p></td>
<td><p>Added secondary date index</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.2.5</p></td>
<td><p>Removed redundant feature ID in row value to reduce size on disk</p>
<p>Support for per-attribute visibility</p>
</td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>1.3.1</p></td>
<td><p>Added secondary Z index</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>1.3.2</p></td>
<td><p>Support for shards</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>2.0.0-m.1</p></td>
<td><p>Internal row layout change</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>2.0.0</p></td>
<td><p>Uses fixed Z-curve implementation</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>2.3.0</p></td>
<td><p>Configurable secondary index attributes</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-5" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-5" name="1-5" role="tabpanel" tabindex="0"><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Index Version</p></th>
<th class="head"><p>GeoMesa Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1.0.0</p></td>
<td><p>Initial implementation</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.2.5</p></td>
<td><p>Removed redundant feature ID in row value to reduce size on disk</p>
<p>Support for per-attribute visibility</p>
</td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2.0.0</p></td>
<td><p>Standardized index identifier to ‘id’</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>2.3.0</p></td>
<td><p>Configurable attributes</p></td>
</tr>
</tbody>
</table>
</div></div>
<p>The version numbers here may not correspond exactly to schemas created with GeoMesa versions prior to 2.3.0, as each back-end
implementation initially had its own versioning scheme.</p>
<p>Note that GeoMesa versions prior to 1.2.2 included a geohash index. That index has been replaced with the Z indices and is no
longer supported.</p>
</section>
<section id="additional-index-implementations">
<h2><span class="section-number">7.4.7. </span>Additional Index Implementations<a class="headerlink" href="#additional-index-implementations" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa supports additional index formats at runtime, using
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">Java service providers</a>. To add a new
index, implement <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.index.api.GeoMesaFeatureIndexFactory</span></code> and register your class under
<code class="docutils literal notranslate"><span class="pre">META-INF/services</span></code>, as described in the
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">Java documentation</a>.</p>
<p>Once an index is registered, it can be enabled through the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> user data, as described in
<a class="reference internal" href="#specifying-indices"><span class="std std-ref">Specifying the Indices to Include</span></a>.</p>
<p>Some additional indices are provided out-of-the-box:</p>
<section id="s2-s3-index">
<h3><span class="section-number">7.4.7.1. </span>S2/S3 Index<a class="headerlink" href="#s2-s3-index" title="Permalink to this headline">¶</a></h3>
<p>The S2 and S3 indices are based on the <a class="reference external" href="https://github.com/google/s2geometry">S2 library</a>:</p>
<blockquote class="pull-quote">
<div><p>The S2 library represents all data on a three-dimensional sphere (similar to a globe). This makes it
possible to build a worldwide geographic database with no seams or singularities, using a single coordinate
system, and with low distortion everywhere compared to the true shape of the Earth.</p>
</div></blockquote>
<p>The S2 index is a spatial index, identified by the name <code class="docutils literal notranslate"><span class="pre">s2</span></code>. The S3 index is a composite spatial and time index,
identified by the name <code class="docutils literal notranslate"><span class="pre">s3</span></code>. The default time period for the S3 index can be configured through the user data
key <code class="docutils literal notranslate"><span class="pre">geomesa.s3.interval</span></code> (see <a class="reference internal" href="index_config.html#customizing-z-index"><span class="std std-ref">Z-Index Time Interval</span></a> for reference).</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index_overview.html" class="btn btn-neutral float-left" title="7.3. Index Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="index_config.html" class="btn btn-neutral float-right" title="7.5. Index Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2025 <a href="https://www.ga-intelligence.com/">General Atomics</a>
    <br/>
    Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/datastores/index_creation.rst">GitHub <img src="../../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>