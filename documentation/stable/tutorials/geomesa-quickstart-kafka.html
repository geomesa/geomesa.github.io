<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GeoMesa Kafka Quick Start &mdash; GeoMesa 4.0.1 Manuals</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/tutorials/geomesa-quickstart-kafka.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GeoMesa Kafka Streams Quick Start" href="geomesa-quickstart-kafka-streams.html" />
    <link rel="prev" title="GeoMesa Cassandra Quick Start" href="geomesa-quickstart-cassandra.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                4.0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#quick-starts">Quick Starts</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-hbase.html">GeoMesa HBase Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-accumulo.html">GeoMesa Accumulo Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-cassandra.html">GeoMesa Cassandra Quick Start</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">GeoMesa Kafka Quick Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#about-this-tutorial">About this Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-geoserver-optional">Configure GeoServer (optional)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#download-and-build-the-tutorial">Download and Build the Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-tutorial">Running the Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visualize-data-with-geoserver-optional">Visualize Data With GeoServer (optional)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#looking-at-the-code">Looking at the Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#listening-for-feature-events-optional">Listening for Feature Events (optional)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-kafka-streams.html">GeoMesa Kafka Streams Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-redis.html">GeoMesa Redis Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-fsds.html">GeoMesa FileSystem Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-lambda.html">GeoMesa Lambda Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="geomesa-quickstart-nifi.html">GeoMesa NiFi Quick Start</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-in-out">Data In/Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-analysis">Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#security">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indexing-and-queries">Indexing and Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#about-tutorial-versions">About Tutorial Versions</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">GeoMesa Kafka Quick Start</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geomesa-kafka-quick-start">
<span id="kafka-quickstart"></span><h1>GeoMesa Kafka Quick Start<a class="headerlink" href="#geomesa-kafka-quick-start" title="Permalink to this headline">¶</a></h1>
<p>This tutorial is the fastest and easiest way to get started with GeoMesa using Kafka for streaming data.
It is a good stepping-stone on the path to the other tutorials, that present increasingly
involved examples of how to use GeoMesa.</p>
<section id="about-this-tutorial">
<h2>About this Tutorial<a class="headerlink" href="#about-this-tutorial" title="Permalink to this headline">¶</a></h2>
<p>In the spirit of keeping things simple, the code in this tutorial only
does a few small things:</p>
<ol class="arabic simple">
<li><p>Establishes a new (static) SimpleFeatureType</p></li>
<li><p>Prepares the Kafka topic to write this type of data</p></li>
<li><p>Creates a few thousand example SimpleFeatures</p></li>
<li><p>Writes these SimpleFeatures to the Kafka topic</p></li>
<li><p>Visualize the changing data in GeoServer (optional)</p></li>
<li><p>Creates event listeners for SimpleFeature updates (optional)</p></li>
</ol>
<p>The quick start operates by simultaneously querying and writing several thousand feature updates.
The same feature identifier is used for each update, so there will only be a single “live” feature
at any one time.</p>
<p>The data used is from New York City taxi activity data published by the University
of Illinois. More information about the dataset is available <a class="reference external" href="https://publish.illinois.edu/dbwork/open-data/">here</a>.</p>
<p>For this demo, only a single taxi is being tracked.</p>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://kafka.apache.org/">Apache Kafka</a> is “publish-subscribe
messaging rethought as a distributed commit log.”</p>
<p>In the context of GeoMesa, Kafka is a useful tool for working with
streams of geospatial data. Interaction with Kafka in GeoMesa occurs
through the KafkaDataStore which implements the GeoTools
<a class="reference external" href="https://docs.geotools.org/latest/userguide/library/data/datastore.html">DataStore</a>
interface.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before you begin, you must have the following installed and configured:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://adoptium.net/temurin/releases/">Java</a> JDK 1.8</p></li>
<li><p>Apache <a class="reference external" href="https://maven.apache.org/">Maven</a> 3.6 or later</p></li>
<li><p>a GitHub client</p></li>
<li><p>a Kafka 2.0 or later cluster</p></li>
</ul>
<p>Ensure your Kafka and Zookeeper instances are running. You can use
Kafka’s <a class="reference external" href="https://kafka.apache.org/documentation.html#quickstart">quickstart</a>
to get Kafka/Zookeeper instances up and running quickly.</p>
</section>
<section id="configure-geoserver-optional">
<h2>Configure GeoServer (optional)<a class="headerlink" href="#configure-geoserver-optional" title="Permalink to this headline">¶</a></h2>
<p>You can use GeoServer to access and visualize the data stored in GeoMesa. In order to use GeoServer,
download and install version 2.22.2. Then follow the instructions in <a class="reference internal" href="../user/kafka/install.html#install-kafka-geoserver"><span class="std std-ref">Installing GeoMesa Kafka in GeoServer</span></a>
to enable GeoMesa.</p>
</section>
<section id="download-and-build-the-tutorial">
<h2>Download and Build the Tutorial<a class="headerlink" href="#download-and-build-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Pick a reasonable directory on your machine, and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geomesa/geomesa-tutorials.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>geomesa-tutorials
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that you download or checkout the version of the tutorials project that corresponds to
your GeoMesa version. See <a class="reference internal" href="index.html#tutorial-versions"><span class="std std-ref">About Tutorial Versions</span></a> for more details.</p>
</div>
<p>To ensure that the quick start works with your environment, modify the <code class="docutils literal notranslate"><span class="pre">pom.xml</span></code>
to set the appropriate versions for Kafka, Zookeeper, etc.</p>
<p>For ease of use, the project builds a bundled artifact that contains all the required
dependencies in a single JAR. To build, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mvn<span class="w"> </span>clean<span class="w"> </span>install<span class="w"> </span>-pl<span class="w"> </span>geomesa-tutorials-kafka/geomesa-tutorials-kafka-quickstart<span class="w"> </span>-am
</pre></div>
</div>
</section>
<section id="running-the-tutorial">
<h2>Running the Tutorial<a class="headerlink" href="#running-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>On the command line, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>java<span class="w"> </span>-cp<span class="w"> </span>geomesa-tutorials-kafka/geomesa-tutorials-kafka-quickstart/target/geomesa-tutorials-kafka-quickstart-<span class="nv">$VERSION</span>.jar<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>org.geomesa.example.kafka.KafkaQuickStart<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--kafka.brokers<span class="w"> </span>&lt;brokers&gt;<span class="w">                 </span><span class="se">\</span>
<span class="w">    </span>--kafka.zookeepers<span class="w"> </span>&lt;zookeepers&gt;
</pre></div>
</div>
<p>where you provide the following arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;brokers&gt;</span></code> your Kafka broker instances, comma separated. For a
local install, this would be <code class="docutils literal notranslate"><span class="pre">localhost:9092</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;zookeepers&gt;</span></code> your Zookeeper nodes, comma separated. For a local
install, this would be <code class="docutils literal notranslate"><span class="pre">localhost:2181</span></code></p></li>
</ul>
<p>Optionally, you can also specify that the quick start should delete its data upon completion. Use the
<code class="docutils literal notranslate"><span class="pre">--cleanup</span></code> flag when you run to enable this behavior.</p>
<p>Once run, the quick start will create the Kafka topic, then pause and prompt you to register the layer in
GeoServer. If you do not want to use GeoServer, you can skip this step. Otherwise, follow the instructions in
the next section before returning here.</p>
<p>Once you continue, the tutorial should run for approximately thirty seconds. You should see the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Loading datastore

Creating schema: taxiId:String,dtg:Date,geom:Point

Generating test data

Feature type created - register the layer &#39;tdrive-quickstart&#39; in geoserver with bounds: MinX[116.22366] MinY[39.72925] MaxX[116.58804] MaxY[40.09298]
Press &lt;enter&gt; to continue

Writing features to Kafka... refresh GeoServer layer preview to see changes
Current consumer state:
1277=1277|2008-02-03T04:32:53.000Z|POINT (116.35 39.90003)
Current consumer state:
1277=1277|2008-02-03T17:58:49.000Z|POINT (116.38812 39.93196)
Current consumer state:
1277=1277|2008-02-04T06:46:26.000Z|POINT (116.40218 39.94439)
Current consumer state:
1277=1277|2008-02-04T19:55:45.000Z|POINT (116.3631 39.94646)
Current consumer state:
1277=1277|2008-02-05T09:39:48.000Z|POINT (116.58264 40.07556)
Current consumer state:
1277=1277|2008-02-05T22:24:50.000Z|POINT (116.34112 39.95363)
Current consumer state:
1277=1277|2008-02-06T14:17:29.000Z|POINT (116.54203 39.91476)
Current consumer state:
1277=1277|2008-02-07T02:53:55.000Z|POINT (116.35683 39.89809)
Current consumer state:
1277=1277|2008-02-07T15:48:47.000Z|POINT (116.36785 39.99471)
Current consumer state:
1277=1277|2008-02-08T04:20:19.000Z|POINT (116.42872 39.91531)
Current consumer state:
1277=1277|2008-02-08T17:14:15.000Z|POINT (116.34609 39.93924)

Done
</pre></div>
</div>
</section>
<section id="visualize-data-with-geoserver-optional">
<h2>Visualize Data With GeoServer (optional)<a class="headerlink" href="#visualize-data-with-geoserver-optional" title="Permalink to this headline">¶</a></h2>
<p>You can use GeoServer to access and visualize the data stored in GeoMesa. In order to use GeoServer,
download and install version 2.22.2. Then follow the instructions in <a class="reference internal" href="../user/kafka/install.html#install-kafka-geoserver"><span class="std std-ref">Installing GeoMesa Kafka in GeoServer</span></a>
to enable GeoMesa.</p>
<section id="register-the-geomesa-store-with-geoserver">
<h3>Register the GeoMesa Store with GeoServer<a class="headerlink" href="#register-the-geomesa-store-with-geoserver" title="Permalink to this headline">¶</a></h3>
<p>Log into GeoServer using your user and password credentials. Click
“Stores” and “Add new Store”. Select the <code class="docutils literal notranslate"><span class="pre">Kafka</span> <span class="pre">(GeoMesa)</span></code> vector data
source, and fill in the required parameters.</p>
<p>Basic store info:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">workspace</span></code> this is dependent upon your GeoServer installation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">source</span> <span class="pre">name</span></code> pick a sensible name, such as <code class="docutils literal notranslate"><span class="pre">geomesa_quick_start</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> this is strictly decorative; <code class="docutils literal notranslate"><span class="pre">GeoMesa</span> <span class="pre">quick</span> <span class="pre">start</span></code></p></li>
</ul>
<p>Connection parameters:</p>
<ul class="simple">
<li><p>these are the same parameter values that you supplied on the
command line when you ran the tutorial; they describe how to connect
to the Kafka instance where your data resides</p></li>
</ul>
<p>Click “Save”, and GeoServer will search Zookeeper for any GeoMesa-managed feature types.</p>
</section>
<section id="publish-the-layer">
<h3>Publish the Layer<a class="headerlink" href="#publish-the-layer" title="Permalink to this headline">¶</a></h3>
<p>If you have already run the command to start the tutorial, then GeoServer should recognize the
<code class="docutils literal notranslate"><span class="pre">tdrive-quickstart</span></code> feature type, and should present that as a layer that can be published. Click on the
“Publish” link. If not, then run the tutorial as described above in <strong>Running the Tutorial</strong>. When
the tutorial pauses, go to “Layers” and “Add new Layer”. Select the GeoMesa Kafka store you just
created, and then click “publish” on the <code class="docutils literal notranslate"><span class="pre">tdrive-quickstart</span></code> layer.</p>
<p>You will be taken to the Edit Layer screen. You will need to enter values for the data bounding
boxes. For this demo, use the values MinX: 116.22366, MinY: 39.72925, MaxX: 116.58804, MaxY: 40.09298.</p>
<p>Click on the “Save” button when you are done.</p>
</section>
<section id="take-a-look">
<h3>Take a Look<a class="headerlink" href="#take-a-look" title="Permalink to this headline">¶</a></h3>
<p>Click on the “Layer Preview” link in the left-hand gutter. If you don’t
see the quick-start layer on the first page of results, enter the name
of the layer you just created into the search box, and press
<code class="docutils literal notranslate"><span class="pre">&lt;Enter&gt;</span></code>.</p>
<p>At first, there will be no data displayed. Once you have reached this
point, return to the quick start console and hit “&lt;enter&gt;” to continue the tutorial.
As the data is updated in Kafka, you can refresh the layer preview page to see
the feature moving around.</p>
</section>
<section id="what-s-happening-in-geoserver">
<h3>What’s Happening in GeoServer<a class="headerlink" href="#what-s-happening-in-geoserver" title="Permalink to this headline">¶</a></h3>
<p>The layer preview of GeoServer uses the <code class="docutils literal notranslate"><span class="pre">KafkaFeatureStore</span></code> to show a
real time view of the current state of the data stream. There is a single
<code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> being updated over time in Kafka which is
reflected in the GeoServer display.</p>
<p>As you refresh the page, you should see the <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> move around.
Due to the nature of the taxi’s routes, and the speed up of time in replaying
the data, there isn’t much of a pattern to the movement.</p>
</section>
</section>
<section id="looking-at-the-code">
<h2>Looking at the Code<a class="headerlink" href="#looking-at-the-code" title="Permalink to this headline">¶</a></h2>
<p>The source code is meant to be accessible for this tutorial. The logic is contained in
the generic <code class="docutils literal notranslate"><span class="pre">org.geomesa.example.quickstart.GeoMesaQuickStart</span></code> in the <code class="docutils literal notranslate"><span class="pre">geomesa-quickstart-common</span></code> module,
and the Kafka-specific <code class="docutils literal notranslate"><span class="pre">org.geomesa.example.kafka.KafkaQuickStart</span></code> in the <code class="docutils literal notranslate"><span class="pre">geomesa-quickstart-kafka</span></code> module.
Some relevant methods are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">createDataStore</span></code> overridden in the <code class="docutils literal notranslate"><span class="pre">KafkaQuickStart</span></code>  to use the input configuration to get a pair of datastore instances, one for writing and one for reading data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">createSchema</span></code> create the schema in the datastore, as a pre-requisite to writing data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">writeFeatures</span></code> overridden in the <code class="docutils literal notranslate"><span class="pre">KafkaQuickStart</span></code> to simultaneously write and read features from Kafka</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">queryFeatures</span></code> not used in this tutorial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cleanup</span></code> delete the sample data and dispose of the datastore instance</p></li>
</ul>
<p>The quickstart uses a small subset of taxi data. Code for parsing the data into GeoTools SimpleFeatures is
contained in <code class="docutils literal notranslate"><span class="pre">org.geomesa.example.data.TDriveData</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">getSimpleFeatureType</span></code> creates the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> representing the data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getTestData</span></code> parses an embedded CSV file to create <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> objects</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getTestQueries</span></code> not used in this tutorial</p></li>
</ul>
</section>
<section id="listening-for-feature-events-optional">
<h2>Listening for Feature Events (optional)<a class="headerlink" href="#listening-for-feature-events-optional" title="Permalink to this headline">¶</a></h2>
<p>The GeoTools API also includes a mechanism to fire off a
<a class="reference external" href="https://docs.geotools.org/stable/javadocs/index.html?org/geotools/data/FeatureEvent.Type.html">FeatureEvent</a>
each time there is an event in a <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> (typically when the data is changed). A client may implement a
<a class="reference external" href="https://docs.geotools.org/stable/javadocs/index.html?org/geotools/data/FeatureEvent.Type.html">FeatureListener</a>,
which has a single method called <code class="docutils literal notranslate"><span class="pre">changed()</span></code> that is invoked as each
<code class="docutils literal notranslate"><span class="pre">FeatureEvent</span></code> is fired.</p>
<p>The code in <code class="docutils literal notranslate"><span class="pre">KafkaListener</span></code> implements a simple <code class="docutils literal notranslate"><span class="pre">FeatureListener</span></code>
that prints the messages received. Open up a second terminal window and
run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>java<span class="w"> </span>-cp<span class="w"> </span>geomesa-tutorials-kafka/geomesa-tutorials-kafka-quickstart/target/geomesa-tutorials-kafka-quickstart-<span class="nv">$VERSION</span>.jar<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>org.geomesa.example.kafka.KafkaListener<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--kafka.brokers<span class="w"> </span>&lt;brokers&gt;<span class="w">               </span><span class="se">\</span>
<span class="w">    </span>--kafka.zookeepers<span class="w"> </span>&lt;zookeepers&gt;
</pre></div>
</div>
<p>Use the same settings for <code class="docutils literal notranslate"><span class="pre">&lt;brokers&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;zookeepers&gt;</span></code> that you did previously. Then
in the original terminal window, re-run the <code class="docutils literal notranslate"><span class="pre">KafkaQuickStart</span></code> code as
before. The <code class="docutils literal notranslate"><span class="pre">KafkaListener</span></code> terminal should produce messages like the
following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Received FeatureEvent from schema &#39;tdrive-quickstart&#39; of type &#39;CHANGED&#39;
1277=1277|2008-02-02T13:34:51.000Z|POINT (116.32674 39.89577)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">KafkaListener</span></code> code will run until interrupted (typically with ctrl-c).</p>
<p>The portion of <code class="docutils literal notranslate"><span class="pre">KafkaListener</span></code> that creates and implements the
<code class="docutils literal notranslate"><span class="pre">FeatureListener</span></code> is:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">FeatureListener</span><span class="w"> </span><span class="n">listener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">featureEvent</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received FeatureEvent from schema &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">typeName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; of type &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">featureEvent</span><span class="p">.</span><span class="na">getType</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">featureEvent</span><span class="p">.</span><span class="na">getType</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">FeatureEvent</span><span class="p">.</span><span class="na">Type</span><span class="p">.</span><span class="na">CHANGED</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span><span class="n">featureEvent</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">KafkaFeatureChanged</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">DataUtilities</span><span class="p">.</span><span class="na">encodeFeature</span><span class="p">(((</span><span class="n">KafkaFeatureChanged</span><span class="p">)</span><span class="w"> </span><span class="n">featureEvent</span><span class="p">).</span><span class="na">feature</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">featureEvent</span><span class="p">.</span><span class="na">getType</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">FeatureEvent</span><span class="p">.</span><span class="na">Type</span><span class="p">.</span><span class="na">REMOVED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received Delete for filter: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">featureEvent</span><span class="p">.</span><span class="na">getFilter</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
<span class="n">datastore</span><span class="p">.</span><span class="na">getFeatureSource</span><span class="p">(</span><span class="n">typeName</span><span class="p">).</span><span class="na">addFeatureListener</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
</pre></div>
</div>
<p>(note the use of a lambda expression to create the listener)</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geomesa-quickstart-cassandra.html" class="btn btn-neutral float-left" title="GeoMesa Cassandra Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="geomesa-quickstart-kafka-streams.html" class="btn btn-neutral float-right" title="GeoMesa Kafka Streams Quick Start" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2023 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/tutorials/geomesa-quickstart-kafka.rst">GitHub <img src="../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>