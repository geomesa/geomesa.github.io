<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>15.9. Command Line Examples &mdash; GeoMesa 4.0.1 Manuals</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/accumulo/examples.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="16. Cassandra Data Store" href="../cassandra/index.html" />
    <link rel="prev" title="15.8. Kerberos" href="kerberos.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                4.0.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">15. Accumulo Data Store</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">15.1. Installing GeoMesa Accumulo</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">15.2. Using the Accumulo Data Store Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">15.3. Using the Accumulo Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">15.4. Accumulo Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">15.5. Accumulo Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_config.html">15.6. Accumulo Index Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html">15.7. GeoMesa Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="kerberos.html">15.8. Kerberos</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">15.9. Command Line Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#feature-type-management">15.9.1. Feature Type Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ingesting-data">15.9.2. Ingesting Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-features">15.9.3. Exporting Features</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">17. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">18. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">19. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">20. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">23. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">15. </span>Accumulo Data Store</a></li>
      <li class="breadcrumb-item active"><span class="section-number">15.9. </span>Command Line Examples</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="command-line-examples">
<h1><span class="section-number">15.9. </span>Command Line Examples<a class="headerlink" href="#command-line-examples" title="Permalink to this headline">¶</a></h1>
<p>This chapter provides hands-on examples of some
common tasks in GeoMesa, including the management of registered feature types
in a data store, ingest of data, and export of data in a variety of formats.</p>
<section id="feature-type-management">
<h2><span class="section-number">15.9.1. </span>Feature Type Management<a class="headerlink" href="#feature-type-management" title="Permalink to this headline">¶</a></h2>
<section id="creating-a-feature-type">
<h3><span class="section-number">15.9.1.1. </span>Creating a feature type<a class="headerlink" href="#creating-a-feature-type" title="Permalink to this headline">¶</a></h3>
<p>To begin, let’s start by creating a new feature type in GeoMesa with the
<code class="docutils literal notranslate"><span class="pre">create</span></code> command. The <code class="docutils literal notranslate"><span class="pre">create</span></code> command takes three required and one
optional flag:</p>
<p><strong>Required</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> or <code class="docutils literal notranslate"><span class="pre">--catalog</span></code>: the name of the catalog table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-f</span></code> or <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code>: the name of the feature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-s</span></code> or <code class="docutils literal notranslate"><span class="pre">--spec</span></code>: the <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> specification</p></li>
</ul>
<p><strong>Optional</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--dtg</span></code>: the default date attribute of the
<code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code></p></li>
</ul>
<p>Run the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geomesa-accumulo<span class="w"> </span>create-schema<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span><span class="se">\</span>
-c<span class="w"> </span>cmd_tutorial<span class="w"> </span><span class="se">\</span>
-f<span class="w"> </span>feature<span class="w"> </span><span class="se">\</span>
-s<span class="w"> </span>fid:String:index<span class="o">=</span>true,dtg:Date,geom:Point:srid<span class="o">=</span><span class="m">4326</span><span class="w"> </span><span class="se">\</span>
-dtg<span class="w"> </span>dtg
</pre></div>
</div>
<p>This will create a new feature type, named “feature”, on the GeoMesa
catalog table “cmd_tutorial”. The catalog table stores metadata
information about each feature, and it will be used to prefix each table
name in Accumulo.</p>
<p>If the above command was successful, you should see output similar to
the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Creating<span class="w"> </span><span class="s1">&#39;cmd_tutorial_feature&#39;</span><span class="w"> </span>with<span class="w"> </span>spec<span class="w"> </span><span class="s1">&#39;fid:String:index=true,dtg:Date,geom:Point:srid=4326&#39;</span>.<span class="w"> </span>Just<span class="w"> </span>a<span class="w"> </span>few<span class="w"> </span>moments...
Feature<span class="w"> </span><span class="s1">&#39;cmd_tutorial_feature&#39;</span><span class="w"> </span>with<span class="w"> </span>spec<span class="w"> </span><span class="s1">&#39;fid:String:index=true,dtg:Date,geom:Point:srid=4326&#39;</span><span class="w"> </span>successfully<span class="w"> </span>created.
</pre></div>
</div>
<p>Now that you’ve seen how to create feature types, create another feature
type on catalog table “cmd_tutorial” using your own first name for the
<code class="docutils literal notranslate"><span class="pre">--feature-name</span></code> and the above schema for the <code class="docutils literal notranslate"><span class="pre">--spec</span></code>.</p>
</section>
<section id="listing-known-feature-types">
<h3><span class="section-number">15.9.1.2. </span>Listing known feature types<a class="headerlink" href="#listing-known-feature-types" title="Permalink to this headline">¶</a></h3>
<p>You should have two feature types on catalog table “cmd_tutorial”. To
verify, we’ll use the <code class="docutils literal notranslate"><span class="pre">list</span></code> command. The <code class="docutils literal notranslate"><span class="pre">list</span></code> command takes one
flag:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> or <code class="docutils literal notranslate"><span class="pre">--catalog</span></code>: the name of the catalog table</p></li>
</ul>
<p>Run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geomesa-accumulo<span class="w"> </span>get-type-names<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span>-c<span class="w"> </span>cmd_tutorial
</pre></div>
</div>
<p>The output text should be something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Listing<span class="w"> </span>features<span class="w"> </span>on<span class="w"> </span><span class="s1">&#39;cmd_tutorial&#39;</span>.<span class="w"> </span>Just<span class="w"> </span>a<span class="w"> </span>few<span class="w"> </span>moments...
<span class="m">2</span><span class="w"> </span>features<span class="w"> </span>exist<span class="w"> </span>on<span class="w"> </span><span class="s1">&#39;cmd_tutorial&#39;</span>.<span class="w"> </span>They<span class="w"> </span>are:
feature
gdelt
</pre></div>
</div>
</section>
<section id="finding-the-attributes-of-a-feature-type">
<h3><span class="section-number">15.9.1.3. </span>Finding the attributes of a feature type<a class="headerlink" href="#finding-the-attributes-of-a-feature-type" title="Permalink to this headline">¶</a></h3>
<p>To find out more about the attributes of a feature type, we’ll use the
<code class="docutils literal notranslate"><span class="pre">describe</span></code> command. This command takes two flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> or <code class="docutils literal notranslate"><span class="pre">--catalog</span></code>: the name of the catalog table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-f</span></code> or <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code>: the name of the feature type</p></li>
</ul>
<p>Let’s find out more about the attributes on our first feature type. Run
the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geomesa-accumulo<span class="w"> </span>describe-schema<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span>-c<span class="w"> </span>cmd_tutorial<span class="w"> </span>-f<span class="w"> </span>feature
</pre></div>
</div>
<p>The output should look like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Describing<span class="w"> </span>attributes<span class="w"> </span>of<span class="w"> </span>feature<span class="w"> </span><span class="s1">&#39;cmd_tutorial_feature&#39;</span>.<span class="w"> </span>Just<span class="w"> </span>a<span class="w"> </span>few<span class="w"> </span>moments...
fid:<span class="w"> </span>String<span class="w"> </span><span class="o">(</span>Indexed<span class="o">)</span>
dtg:<span class="w"> </span>Date<span class="w"> </span><span class="o">(</span>Time-index<span class="o">)</span>
geom:<span class="w"> </span>Point<span class="w"> </span><span class="o">(</span>Geo-index<span class="o">)</span>
</pre></div>
</div>
</section>
<section id="deleting-a-feature-type">
<h3><span class="section-number">15.9.1.4. </span>Deleting a feature type<a class="headerlink" href="#deleting-a-feature-type" title="Permalink to this headline">¶</a></h3>
<p>Continuing on, let’s delete the first feature type we created with the
<code class="docutils literal notranslate"><span class="pre">remove-schema</span></code> command. The <code class="docutils literal notranslate"><span class="pre">remove-schema</span></code> command takes two flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> or <code class="docutils literal notranslate"><span class="pre">--catalog</span></code>: the name of the catalog table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-f</span></code> or <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code>: the name of the feature to delete</p></li>
</ul>
<p>Run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geomesa-accumulo<span class="w"> </span>remove-schema<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span>-c<span class="w"> </span>cmd_tutorial<span class="w"> </span>-f<span class="w"> </span>feature
</pre></div>
</div>
<p>NOTE: Running this command will take a bit longer than the previous two,
as it will delete three tables in Accumulo, as well as remove the
metadata rows in the catalog table associated with the feature.</p>
<p>The output should resemble the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Remove<span class="w"> </span>schema<span class="w"> </span>feature<span class="w"> </span>from<span class="w"> </span>catalog<span class="w"> </span>cmd_tutorial?<span class="w"> </span><span class="o">(</span>yes/no<span class="o">)</span>:<span class="w"> </span>yes
Starting
State<span class="w"> </span>change:<span class="w"> </span>CONNECTED
Removed<span class="w"> </span>feature
</pre></div>
</div>
</section>
</section>
<section id="ingesting-data">
<h2><span class="section-number">15.9.2. </span>Ingesting Data<a class="headerlink" href="#ingesting-data" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa Tools is a set of command line tools to add feature management
functions, query planning and explanation, ingest, and export abilities
from the command line. In this tutorial, we’ll cover how to ingest and
export features using GeoMesa Tools.</p>
<section id="getting-data">
<h3><span class="section-number">15.9.2.1. </span>Getting Data<a class="headerlink" href="#getting-data" title="Permalink to this headline">¶</a></h3>
<p>For this tutorial we will be using the GDELT data set, available here:
<a class="reference external" href="http://data.gdeltproject.org/events/index.html">http://data.gdeltproject.org/events/index.html</a>.  Download any daily data file,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">20160119.</span><span class="n">export</span><span class="o">.</span><span class="n">CSV</span><span class="o">.</span><span class="n">zip</span>
</pre></div>
</div>
<p>and unzip the file on your computer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The unpacked files have <code class="docutils literal notranslate"><span class="pre">*.CSV</span></code> extensions but the data within them are
actually <em>tab</em> separated.</p>
</div>
</section>
<section id="ingesting-features">
<h3><span class="section-number">15.9.2.2. </span>Ingesting Features<a class="headerlink" href="#ingesting-features" title="Permalink to this headline">¶</a></h3>
<p>The ingest command currently supports three formats: CSV, TSV, and SHP.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ingest</span></code> command has the following required flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-u</span></code> or <code class="docutils literal notranslate"><span class="pre">--user</span></code>: the Accumulo user</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> or <code class="docutils literal notranslate"><span class="pre">--catalog</span></code>: the name of the GeoMesa catalog table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-f</span></code> or <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code>: the name of the feature to ingest</p></li>
</ul>
<p>One (not both) of the following flags must also be specified:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span></code> or <code class="docutils literal notranslate"><span class="pre">--password</span></code>: the Accumulo password</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--keytab</span></code>: path to a Kerberos keytab file</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">-p</span></code> (or <code class="docutils literal notranslate"><span class="pre">--password</span></code>) and <code class="docutils literal notranslate"><span class="pre">--keytab</span></code> are both omitted, then password authentication is assumed and the user
is prompted for a password.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">$ACCUMULO_HOME</span></code> does not contain the configuration of the Accumulo
instance you wish to connect to, you also must specify the connection
parameters for Accumulo:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-i</span></code> or <code class="docutils literal notranslate"><span class="pre">--instance</span></code>: the Accumulo instance</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-z</span></code> or <code class="docutils literal notranslate"><span class="pre">--zookeepers</span></code>: a comma-separated list of Zookeeper hosts</p></li>
</ul>
<p>The optional <code class="docutils literal notranslate"><span class="pre">-C</span></code> switch lets you specify a converter defined in a JSON-based
instruction file about how to convert the data as GeoMesa reads it. The
converter library handles many of the data transformations necessary to fit a
raw data set into a simple feature type suitable for use in GeoMesa
applications. Conversions can take advantage of a variety of features such as
<code class="docutils literal notranslate"><span class="pre">concatenate()</span></code> and <code class="docutils literal notranslate"><span class="pre">stringToInteger()</span></code> functions as well as the use of regular
expressions. For more information see <a class="reference internal" href="#setting-up-ingest-converter"><span class="std std-ref">Setting up an Ingest Converter</span></a> below.</p>
<p>The last argument that is required for all ingest commands is the path
to the file to ingest. If ingesting CSV/TSV data this can be an HDFS
path, specified by prefixing it with <code class="docutils literal notranslate"><span class="pre">hdfs://</span></code>.</p>
</section>
<section id="setting-up-an-ingest-converter">
<span id="setting-up-ingest-converter"></span><h3><span class="section-number">15.9.2.3. </span>Setting up an Ingest Converter<a class="headerlink" href="#setting-up-an-ingest-converter" title="Permalink to this headline">¶</a></h3>
<p>To use the <code class="docutils literal notranslate"><span class="pre">-C</span></code> switch, create (or edit) the file
<code class="docutils literal notranslate"><span class="pre">$GEOMESA_ACCUMULO_HOME/conf/application.conf</span></code>, which serves as the converter
configuration file, to add the <code class="docutils literal notranslate"><span class="pre">gdelt</span></code> SimpleFeatureType and a converter
<code class="docutils literal notranslate"><span class="pre">gdelt_csv</span></code> for reading the data from tab-separated value files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geomesa</span> <span class="p">{</span>
  <span class="n">sfts</span> <span class="p">{</span>
    <span class="n">gdelt</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">globalEventId</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">String</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">false</span><span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">eventCode</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">String</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">actor1</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">String</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">actor2</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">String</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">dtg</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">Date</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">true</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">geom</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">Point</span><span class="p">,</span> <span class="n">srid</span> <span class="o">=</span> <span class="mi">4326</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">converters</span> <span class="p">{</span>
    <span class="n">gdelt_tsv</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nb">type</span> <span class="o">=</span> <span class="n">delimited</span><span class="o">-</span><span class="n">text</span>
      <span class="nb">format</span> <span class="o">=</span> <span class="n">TDF</span>
      <span class="nb">id</span><span class="o">-</span><span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;$1&quot;</span> <span class="o">//</span> <span class="k">global</span> <span class="n">event</span> <span class="nb">id</span>
      <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">globalEventId</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;$1&quot;</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">eventCode</span><span class="p">,</span>     <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;$27&quot;</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">actor1</span><span class="p">,</span>        <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;$7&quot;</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">actor2</span><span class="p">,</span>        <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;$17&quot;</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">dtg</span><span class="p">,</span>           <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;date(&#39;yyyyMMdd&#39;, $2)&quot;</span> <span class="p">}</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="n">geom</span><span class="p">,</span>          <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;point(stringToDouble($41, 0.0), $40::double)&quot;</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The config file needs to have a <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> defined along with a
converter that specifies instructions on how to turn the raw data file into
that simple feature type. See <a class="reference internal" href="../convert/index.html"><span class="doc">GeoMesa Converters</span></a> for a more details
on converters, including a full list of the transformation functions available
(<a class="reference internal" href="../convert/function_overview.html"><span class="doc">Transformation Function Overview</span></a>).</p>
<p>This example uses the <code class="docutils literal notranslate"><span class="pre">date()</span></code> function to tell the parser what date column
is in. The <code class="docutils literal notranslate"><span class="pre">stringToDouble()</span></code> and <code class="docutils literal notranslate"><span class="pre">::double</span></code> functions give two different
methods for type casting. The <code class="docutils literal notranslate"><span class="pre">stringTo&lt;dataType&gt;()</span></code> methods take in the
value to be cast as well as a prespecified default that will be returned if
there is an exception, whereas the <code class="docutils literal notranslate"><span class="pre">::double</span></code> function will fail (and drop
the record) if the casting fails.</p>
<p>To confirm that GeoMesa can properly parse your edited
<code class="docutils literal notranslate"><span class="pre">$GEOMESA_ACCUMULO_HOME/conf/application.conf</span></code> file, use <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo</span> <span class="pre">env</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ geomesa-accumulo env -s gdelt --format spec
Using GEOMESA_ACCUMULO_HOME = /opt/geomesa/tools
Simple Feature Types:
gdelt = globalEventId:String,eventCode:String,actor1:String,actor2:String,dtg:Date:index=join,*geom:Point:srid=4326;geomesa.index.dtg=&#39;dtg&#39;

$ geomesa-accumulo env -c gdelt_tsv
Using GEOMESA_ACCUMULO_HOME = /opt/geomesa/tools

Simple Feature Type Converters:
converter-name=gdelt_tsv
fields=[
    {
        name=globalEventId
        transform=&quot;$1&quot;
    },
    {
        name=eventCode
        transform=&quot;$27&quot;
    },
    {
        name=actor1
        transform=&quot;$7&quot;
    },
    {
        name=actor2
        transform=&quot;$17&quot;
    },
    {
        name=dtg
        transform=&quot;date(&#39;yyyyMMdd&#39;, $2)&quot;
    },
    {
        name=geom
        transform=&quot;point(stringToDouble($41, 0.0), $40::double)&quot;
    }
]
format=TDF
# global event id
id-field=&quot;$1&quot;
type=delimited-text
</pre></div>
</div>
</section>
<section id="downloading-sample-data">
<h3><span class="section-number">15.9.2.4. </span>Downloading sample data<a class="headerlink" href="#downloading-sample-data" title="Permalink to this headline">¶</a></h3>
<p>Packaged with geomesa script for easily downloading publicly
available data sets and a set of corresponding config files.</p>
<p>The currently available data sets are <a class="reference external" href="https://gdeltproject.org/">GDELT</a>, <a class="reference external" href="https://research.microsoft.com/en-us/projects/geolife/">GeoLife</a>, <a class="reference external" href="https://wiki.openstreetmap.org/wiki/Planet.gpx">OSM-GPX</a>, <a class="reference external" href="https://research.microsoft.com/apps/pubs/?id=152883">T-Drive</a>, <a class="reference external" href="https://www.geonames.org/">GeoNames</a>,
<a class="reference external" href="https://publish.illinois.edu/dbwork/open-data/">NYCTaxi</a>, <a class="reference external" href="https://www.start.umd.edu/gtd/">GTD</a>, and <a class="reference external" href="https://dev.twitter.com/rest/public">Twitter</a>. The first five of these sets are easily downloadable via a provided script.</p>
<p>To download these sets, run the download script found in geomesa-tools/bin and
provide the name of the data set desired.
This can be one of <code class="docutils literal notranslate"><span class="pre">gdelt</span></code>, <code class="docutils literal notranslate"><span class="pre">geolife</span></code>, <code class="docutils literal notranslate"><span class="pre">osm-gpx</span></code>, <code class="docutils literal notranslate"><span class="pre">tdrive</span></code>, or <code class="docutils literal notranslate"><span class="pre">geonames</span></code>:</p>
<p>Example Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./download-data.sh<span class="w"> </span>geolife
</pre></div>
</div>
<p>Depending on the desired data, you may be prompted further information to specify desired dates or locations.</p>
<p>The resulting data will then be downloaded to <code class="docutils literal notranslate"><span class="pre">$GEOMESA_ACCUMULO_HOME/data</span></code>.</p>
<p>Configuration files for these data sets are found under <code class="docutils literal notranslate"><span class="pre">$GEOMESA_ACCUMULO_HOME/conf/sfts</span></code>.
Modifications to them can seen by running <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo</span> <span class="pre">env</span></code> and will be reflected in the next run ingest.</p>
</section>
<section id="running-an-ingest">
<h3><span class="section-number">15.9.2.5. </span>Running an Ingest<a class="headerlink" href="#running-an-ingest" title="Permalink to this headline">¶</a></h3>
<p>Now that we have everything ready, we will now
combine the various parameters into the following complete ingest
command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geomesa-accumulo<span class="w"> </span>ingest<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;instance&gt;<span class="w"> </span>-z<span class="w"> </span>&lt;zookeepers&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>-c<span class="w"> </span>gdelt<span class="w"> </span>-s<span class="w"> </span>gdelt<span class="w"> </span>-C<span class="w"> </span>gdelt_tsv<span class="w"> </span>--threads<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>/path/to/&lt;gdelt-data-file&gt;.csv
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;username&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;password&gt;</span></code> are the credentials associated with
the Accumulo instance. <code class="docutils literal notranslate"><span class="pre">&lt;instance&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;zookeepers&gt;</span></code> are the
connection parameters for Accumulo, if this is not specified in the
configuration files in <code class="docutils literal notranslate"><span class="pre">$ACCUMULO_HOME</span></code>.</p>
</section>
</section>
<section id="exporting-features">
<h2><span class="section-number">15.9.3. </span>Exporting Features<a class="headerlink" href="#exporting-features" title="Permalink to this headline">¶</a></h2>
<p>Let’s export your newly ingested features in a couple of file formats.
Currently, the <code class="docutils literal notranslate"><span class="pre">export</span></code> command supports exports to CSV, TSV,
Shapefile, GeoJSON, and GML. We’ll do one of each format in this next
section.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">export</span></code> command has 3 required flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> or <code class="docutils literal notranslate"><span class="pre">--catalog</span></code>: the name of the catalog table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-f</span></code> or <code class="docutils literal notranslate"><span class="pre">--feature-name</span></code>: the name of the feature to export</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-F</span></code> or <code class="docutils literal notranslate"><span class="pre">--format</span></code>: the output format (<code class="docutils literal notranslate"><span class="pre">csv</span></code>, <code class="docutils literal notranslate"><span class="pre">tsv</span></code>,
<code class="docutils literal notranslate"><span class="pre">shp</span></code>, <code class="docutils literal notranslate"><span class="pre">geojson</span></code>, or <code class="docutils literal notranslate"><span class="pre">gml</span></code>)</p></li>
</ul>
<p>Additionally, you can specify more details about the kind of export you
would like to perform with optional flags for <code class="docutils literal notranslate"><span class="pre">export</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-a</span></code> or <code class="docutils literal notranslate"><span class="pre">--attributes</span></code>: the attributes of the feature to return</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-m</span></code> or <code class="docutils literal notranslate"><span class="pre">--max-features</span></code>: the maximum number of features to
return in an export</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-q</span></code> or <code class="docutils literal notranslate"><span class="pre">--query</span></code>: a <a class="reference external" href="https://docs.geotools.org/latest/userguide/library/cql/index.html">CQL
query</a>
to perform on the features, to return only subset of features
matching the query</p></li>
</ul>
<p>We’ll use the <code class="docutils literal notranslate"><span class="pre">--max-features</span></code> flag to ensure our dataset is small and
quick to export. First, we’ll export to CSV with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geomesa-accumulo<span class="w"> </span><span class="nb">export</span><span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span>-c<span class="w"> </span>gdelt_Ukraine<span class="w"> </span>-fn<span class="w"> </span>gdelt<span class="w"> </span>-fmt<span class="w"> </span>csv<span class="w"> </span>-max<span class="w"> </span><span class="m">50</span>
<span class="c1"># or specifying Accumulo configuration explicitly:</span>
$<span class="w"> </span>geomesa-accumulo<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;password&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;instance&gt;<span class="w"> </span>-z<span class="w"> </span>&lt;zookeepers&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-c<span class="w"> </span>gdelt<span class="w"> </span>-f<span class="w"> </span>gdelt<span class="w"> </span>-f<span class="w"> </span>csv<span class="w"> </span>-m<span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
<p>This command will output the relevant rows to the console. Inspect the
rows now, or pipe the output into a file for later review.</p>
<p>Now, run the above command four additional times, changing the
<code class="docutils literal notranslate"><span class="pre">--format</span></code> flag to <code class="docutils literal notranslate"><span class="pre">tsv</span></code>, <code class="docutils literal notranslate"><span class="pre">shp</span></code>, <code class="docutils literal notranslate"><span class="pre">json</span></code>, and <code class="docutils literal notranslate"><span class="pre">gml</span></code>. The
<code class="docutils literal notranslate"><span class="pre">shp</span></code> format also requires the <code class="docutils literal notranslate"><span class="pre">-o</span></code> option to specify the name of an
output file.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="kerberos.html" class="btn btn-neutral float-left" title="15.8. Kerberos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../cassandra/index.html" class="btn btn-neutral float-right" title="16. Cassandra Data Store" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2023 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/accumulo/examples.rst">GitHub <img src="../../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>