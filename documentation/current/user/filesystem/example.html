

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>14.8. FileSystem Datastore Example &mdash; GeoMesa 2.1.0-SNAPSHOT Manuals</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="GeoMesa 2.1.0-SNAPSHOT Manuals" href="../../index.html"/>
        <link rel="up" title="14. FileSystem Datastore (Amazon S3, HDFS Datastore)" href="index.html"/>
        <link rel="next" title="14.9. GeoMesa FileSystem Data Store with Spark SQL" href="sql.html"/>
        <link rel="prev" title="14.7. FileSystem Command-Line Tools" href="commandline.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                2.1.0-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">7. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">8. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">9. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">10. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">11. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">12. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">13. Lambda Data Store</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">14. FileSystem Datastore (Amazon S3, HDFS Datastore)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="architecture.html">14.1. FileSystem Datastore Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="partition_schemes.html">14.2. Partition Schemes</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html">14.3. Installing GeoMesa FileSystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">14.4. FileSystem DataStore Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">14.5. Using the FileSystem Data Store Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">14.6. Using the FileSystem Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">14.7. FileSystem Command-Line Tools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">14.8. FileSystem Datastore Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="sql.html">14.9. GeoMesa FileSystem Data Store with Spark SQL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">15. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">16. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">17. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">18. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">19. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi.html">20. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blobstore.html">21. GeoMesa Blob Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../native_api.html">22. GeoMesa Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">23. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">24. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GeoMesa</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">User Manual</a> &raquo;</li>
      
          <li><a href="index.html">14. FileSystem Datastore (Amazon S3, HDFS Datastore)</a> &raquo;</li>
      
    <li>14.8. FileSystem Datastore Example</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user/filesystem/example.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="filesystem-datastore-example">
<h1>14.8. FileSystem Datastore Example<a class="headerlink" href="#filesystem-datastore-example" title="Permalink to this headline">Â¶</a></h1>
<p>In this simple example we will ingest a small CSV into a local filesystem datastore partitioned by an daily,z2-2bit
scheme. To begin, start by untaring the geomesa-fs distribution. Inside this distribution you will find an examples
folder which contains an example csv file that we will ingest:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /tmp/
$ tar xvf ~/Downloads/geomesa-fs-dist_2.11-<span class="nv">$VERSION</span>.tar.gz
$ <span class="nb">cd</span> /tmp/geomesa-fs_2.11-<span class="nv">$VERSION</span>

$ cat examples/ingest/csv/example.csv
ID,Name,Age,LastSeen,Friends,Lon,Lat,Vis
<span class="m">23623</span>,Harry,20,2015-05-06,<span class="s2">&quot;Will, Mark, Suzan&quot;</span>,<span class="s2">&quot;patronus-&gt;10,expelliarmus-&gt;9&quot;</span>,-100.236523,23,user
<span class="m">26236</span>,Hermione,25,2015-06-07,<span class="s2">&quot;Edward, Bill, Harry&quot;</span>,<span class="s2">&quot;accio-&gt;10&quot;</span>,40.232,-53.2356,user
<span class="m">3233</span>,Severus,30,2015-10-23,<span class="s2">&quot;Tom, Riddle, Voldemort&quot;</span>,<span class="s2">&quot;potions-&gt;10&quot;</span>,3,-62.23,user<span class="p">&amp;</span>admin
</pre></div>
</div>
<p>As you can see, there are 3 records in the file. GeoMesa ships with a pre-installed SimpleFeatureType and converter
for this example file which can be found in the <code class="docutils literal"><span class="pre">conf/application.conf</span></code> file. Running <code class="docutils literal"><span class="pre">bin/geomesa-fs</span> <span class="pre">env</span></code> will
show that there is an <code class="docutils literal"><span class="pre">example-csv</span></code> type and converter installed along with many other types including twitter, gdelt,
osm, etc:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ bin/geomesa-fs env
    Simple Feature Types:
    example-avro
    example-csv
    example-csv-complex
    ...

    Simple Feature Type Converters:
    example-avro-header
    example-avro-no-header
    example-csv
    ...
</pre></div>
</div>
<p>For this example we&#8217;ll ingest the three rows to a local filesystem. Note that the records are all on different days:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">06</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">07</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">23</span>
</pre></div>
</div>
<p>and that the geometries fall into two quadrants of the world. The first record is in the upper left quadrant and the
second and third records are in the lower right quadrant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Lon</span>          <span class="n">Lat</span>
<span class="o">-</span><span class="mf">100.236523</span>  <span class="mi">23</span>
<span class="mf">40.232</span>      <span class="o">-</span><span class="mf">53.2356</span>
<span class="mi">3</span>           <span class="o">-</span><span class="mf">62.23</span>
</pre></div>
</div>
<p>Now lets ingest.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ bin/geomesa-fs ingest -p file:///tmp/dstest -e parquet -s example-csv -C example-csv <span class="se">\</span>
--partition-scheme daily,z2-2bit examples/ingest/csv/example.csv

INFO  Creating schema example-csv
INFO  Running ingestion in <span class="nb">local</span> mode
INFO  Ingesting <span class="m">1</span> file with <span class="m">1</span> thread
<span class="o">[============================================================]</span> <span class="m">100</span>% <span class="nb">complete</span> <span class="m">3</span> ingested <span class="m">0</span> failed in <span class="m">00</span>:00:01
INFO  Local ingestion <span class="nb">complete</span> in <span class="m">00</span>:00:01
INFO  Ingested <span class="m">3</span> features with no failures.
</pre></div>
</div>
<p>We can verify our ingest by running an export:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ bin/geomesa-fs <span class="nb">export</span> -p file:///tmp/dstest -f example-csv

id,fid:Integer:index<span class="o">=</span>false,name:String:index<span class="o">=</span>true,age:Integer:index<span class="o">=</span>false,lastseen:Date:default<span class="o">=</span>true:index<span class="o">=</span>false,*geom:Point:srid<span class="o">=</span><span class="m">4326</span>
<span class="m">26236</span>,26236,Hermione,25,2015-06-07T00:00:00.000Z,POINT <span class="o">(</span><span class="m">40</span>.232 -53.2356<span class="o">)</span>
<span class="m">3233</span>,3233,Severus,30,2015-10-23T00:00:00.000Z,POINT <span class="o">(</span><span class="m">3</span> -62.23<span class="o">)</span>
<span class="m">23623</span>,23623,Harry,20,2015-05-06T00:00:00.000Z,POINT <span class="o">(</span>-100.236523 <span class="m">23</span><span class="o">)</span>
INFO  Feature <span class="nb">export</span> <span class="nb">complete</span> to standard out in 1676ms <span class="k">for</span> <span class="m">3</span> features
</pre></div>
</div>
<p>Now lets inpsect the filesystem to see what it looks like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ find /tmp/dstest
/tmp/dstest
/tmp/dstest/example-csv
/tmp/dstest/example-csv/2015
/tmp/dstest/example-csv/2015/05
/tmp/dstest/example-csv/2015/05/06
/tmp/dstest/example-csv/2015/05/06/2
/tmp/dstest/example-csv/2015/05/06/2/.0000.parquet.crc
/tmp/dstest/example-csv/2015/05/06/2/0000.parquet
/tmp/dstest/example-csv/2015/10
/tmp/dstest/example-csv/2015/10/23
/tmp/dstest/example-csv/2015/10/23/1
/tmp/dstest/example-csv/2015/10/23/1/.0000.parquet.crc
/tmp/dstest/example-csv/2015/10/23/1/0000.parquet
/tmp/dstest/example-csv/2015/06
/tmp/dstest/example-csv/2015/06/07
/tmp/dstest/example-csv/2015/06/07/1
/tmp/dstest/example-csv/2015/06/07/1/.0000.parquet.crc
/tmp/dstest/example-csv/2015/06/07/1/0000.parquet
/tmp/dstest/example-csv/schema.sft
/tmp/dstest/example-csv/.metadata.crc
/tmp/dstest/example-csv/.schema.sft.crc
/tmp/dstest/example-csv/metadata
</pre></div>
</div>
<p>Notice that we have a directory structure laid out based on our <code class="docutils literal"><span class="pre">daily,z2-2bit</span></code> scheme. Notice the first parquet
file path is composed of a date path <code class="docutils literal"><span class="pre">2016/05/06</span></code> and then a z2 ordinate of <code class="docutils literal"><span class="pre">2</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">dstest</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">csv</span><span class="o">/</span><span class="mi">2015</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mf">0000.</span><span class="n">parquet</span>
</pre></div>
</div>
<p>The parquet file name is <code class="docutils literal"><span class="pre">0000</span></code> which indicates it is the first file we have ingested in this spatio-temporal
filesystem partition. If we were to ingest a second file it would be named <code class="docutils literal"><span class="pre">0001.parquet</span></code> and GeoMesa would read the
contents of both at query time.</p>
<p>We&#8217;ll also take a quick look at the metadata to see that it lists the parquet files in the system:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cat /tmp/dstest/example-csv/metadata
<span class="o">{</span>
    <span class="s2">&quot;partitions&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;2015/05/06/2&quot;</span> : <span class="o">[</span>
            <span class="s2">&quot;0000.parquet&quot;</span>
        <span class="o">]</span>,
        <span class="s2">&quot;2015/06/07/1&quot;</span> : <span class="o">[</span>
            <span class="s2">&quot;0000.parquet&quot;</span>
        <span class="o">]</span>,
        <span class="s2">&quot;2015/10/23/1&quot;</span> : <span class="o">[</span>
            <span class="s2">&quot;0000.parquet&quot;</span>
        <span class="o">]</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sql.html" class="btn btn-neutral float-right" title="14.9. GeoMesa FileSystem Data Store with Spark SQL" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="commandline.html" class="btn btn-neutral" title="14.7. FileSystem Command-Line Tools" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2017 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.1.0-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>