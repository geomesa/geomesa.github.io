

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>19.11. FileSystem Data Store Example &mdash; GeoMesa 3.1.0-SNAPSHOT Manuals</title>
  

  
  
  
  
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/filesystem/example.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="19.12. FileSystem Data Store Spark SQL Example" href="spark_example.html" />
    <link rel="prev" title="19.10. Modifying Features" href="modify_features.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                3.1.0-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">7. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">8. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">9. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">10. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi.html">11. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">12. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">13. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">14. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">15. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">16. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">17. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">18. Redis Data Store</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">19. FileSystem Data Store</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="architecture.html">19.1. Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html">19.2. Installing GeoMesa FileSystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">19.3. Using the FileSystem Data Store Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">19.4. Using the FileSystem Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">19.5. FileSystem Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">19.6. FileSystem DataStore Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_config.html">19.7. Index Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="partition_schemes.html">19.8. Partition Schemes</a></li>
<li class="toctree-l3"><a class="reference internal" href="metadata.html">19.9. FileSystem Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="modify_features.html">19.10. Modifying Features</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">19.11. FileSystem Data Store Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="spark_example.html">19.12. FileSystem Data Store Spark SQL Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kudu/index.html">20. Kudu Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">23. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">24. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">25. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Manual</a> &raquo;</li>
        
          <li><a href="index.html">19. FileSystem Data Store</a> &raquo;</li>
        
      <li>19.11. FileSystem Data Store Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="filesystem-data-store-example">
<h1>19.11. FileSystem Data Store Example<a class="headerlink" href="#filesystem-data-store-example" title="Permalink to this headline">¶</a></h1>
<p>In this simple example we will ingest a small CSV into a local filesystem data store partitioned by an daily,z2-2bit
scheme. To begin, start by untaring the geomesa-fs distribution. Inside this distribution you will find an examples
folder which contains an example csv file that we will ingest:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /tmp/
$ tar xvf ~/Downloads/geomesa-fs_2.11-<span class="nv">$VERSION</span>.tar.gz
$ <span class="nb">cd</span> /tmp/geomesa-fs_2.11-<span class="nv">$VERSION</span>

$ cat examples/ingest/csv/example.csv
ID,Name,Age,LastSeen,Friends,Lon,Lat,Vis
<span class="m">23623</span>,Harry,20,2015-05-06,<span class="s2">&quot;Will, Mark, Suzan&quot;</span>,<span class="s2">&quot;patronus-&gt;10,expelliarmus-&gt;9&quot;</span>,-100.236523,23,user
<span class="m">26236</span>,Hermione,25,2015-06-07,<span class="s2">&quot;Edward, Bill, Harry&quot;</span>,<span class="s2">&quot;accio-&gt;10&quot;</span>,40.232,-53.2356,user
<span class="m">3233</span>,Severus,30,2015-10-23,<span class="s2">&quot;Tom, Riddle, Voldemort&quot;</span>,<span class="s2">&quot;potions-&gt;10&quot;</span>,3,-62.23,user<span class="p">&amp;</span>admin
</pre></div>
</div>
<p>As you can see, there are 3 records in the file. GeoMesa ships with a pre-installed SimpleFeatureType and converter
for this example file which can be found in the <code class="docutils literal notranslate"><span class="pre">conf/application.conf</span></code> file. Running <code class="docutils literal notranslate"><span class="pre">bin/geomesa-fs</span> <span class="pre">env</span></code> will
show that there is an <code class="docutils literal notranslate"><span class="pre">example-csv</span></code> type and converter installed along with many other types including twitter, gdelt,
osm, etc:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bin/geomesa-fs env
    Simple Feature Types:
    example-avro
    example-csv
    example-csv-complex
    ...

    Simple Feature Type Converters:
    example-avro-header
    example-avro-no-header
    example-csv
    ...
</pre></div>
</div>
<p>For this example we’ll ingest the three rows to a local filesystem. Note that the records are all on different days:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">06</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">07</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">23</span>
</pre></div>
</div>
<p>and that the geometries fall into two quadrants of the world. The first record is in the upper left quadrant and the
second and third records are in the lower right quadrant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Lon</span>          <span class="n">Lat</span>
<span class="o">-</span><span class="mf">100.236523</span>  <span class="mi">23</span>
<span class="mf">40.232</span>      <span class="o">-</span><span class="mf">53.2356</span>
<span class="mi">3</span>           <span class="o">-</span><span class="mf">62.23</span>
</pre></div>
</div>
<p>Now lets ingest.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bin/geomesa-fs ingest -p /tmp/dstest -e parquet -s example-csv -C example-csv <span class="se">\</span>
--partition-scheme daily,z2-2bit examples/ingest/csv/example.csv

INFO  Creating schema example-csv
INFO  Running ingestion in <span class="nb">local</span> mode
INFO  Ingesting <span class="m">1</span> file with <span class="m">1</span> thread
<span class="o">[============================================================]</span> <span class="m">100</span>% <span class="nb">complete</span> <span class="m">3</span> ingested <span class="m">0</span> failed in <span class="m">00</span>:00:01
INFO  Local ingestion <span class="nb">complete</span> in <span class="m">00</span>:00:01
INFO  Ingested <span class="m">3</span> features with no failures.
</pre></div>
</div>
<p>We can verify our ingest by running an export:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bin/geomesa-fs <span class="nb">export</span> -p /tmp/dstest -f example-csv

id,fid:Integer:index<span class="o">=</span>false,name:String:index<span class="o">=</span>true,age:Integer:index<span class="o">=</span>false,lastseen:Date:default<span class="o">=</span>true:index<span class="o">=</span>false,*geom:Point:srid<span class="o">=</span><span class="m">4326</span>
<span class="m">26236</span>,26236,Hermione,25,2015-06-07T00:00:00.000Z,POINT <span class="o">(</span><span class="m">40</span>.232 -53.2356<span class="o">)</span>
<span class="m">3233</span>,3233,Severus,30,2015-10-23T00:00:00.000Z,POINT <span class="o">(</span><span class="m">3</span> -62.23<span class="o">)</span>
<span class="m">23623</span>,23623,Harry,20,2015-05-06T00:00:00.000Z,POINT <span class="o">(</span>-100.236523 <span class="m">23</span><span class="o">)</span>
INFO  Feature <span class="nb">export</span> <span class="nb">complete</span> to standard out in 1676ms <span class="k">for</span> <span class="m">3</span> features
</pre></div>
</div>
<p>Now lets inspect the filesystem to see what it looks like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ find /tmp/dstest <span class="p">|</span> sort
/tmp/dstest/
/tmp/dstest/example-csv
/tmp/dstest/example-csv/2015
/tmp/dstest/example-csv/2015/05
/tmp/dstest/example-csv/2015/05/06
/tmp/dstest/example-csv/2015/05/06/2_Wcec6a2ec594a4a2eb7c7980a1baf4ab3.parquet
/tmp/dstest/example-csv/2015/05/06/.2_Wcec6a2ec594a4a2eb7c7980a1baf4ab3.parquet.crc
/tmp/dstest/example-csv/2015/06
/tmp/dstest/example-csv/2015/06/07
/tmp/dstest/example-csv/2015/06/07/1_Wcc082b9cf9bc4965b4cbf64741fee5b6.parquet
/tmp/dstest/example-csv/2015/06/07/.1_Wcc082b9cf9bc4965b4cbf64741fee5b6.parquet.crc
/tmp/dstest/example-csv/2015/10
/tmp/dstest/example-csv/2015/10/23
/tmp/dstest/example-csv/2015/10/23/1_W741f2151a4ed4eec97461a174a8588b7.parquet
/tmp/dstest/example-csv/2015/10/23/.1_W741f2151a4ed4eec97461a174a8588b7.parquet.crc
/tmp/dstest/example-csv/metadata
/tmp/dstest/example-csv/metadata/storage.json
/tmp/dstest/example-csv/metadata/.storage.json.crc
/tmp/dstest/example-csv/metadata/update-2015-05-06-2-12240906-4171-4ab0-acfe-d2ce9c5fff76.json
/tmp/dstest/example-csv/metadata/.update-2015-05-06-2-12240906-4171-4ab0-acfe-d2ce9c5fff76.json.crc
/tmp/dstest/example-csv/metadata/update-2015-06-07-1-ecd68700-88e3-4f04-9438-84b6ab935907.json
/tmp/dstest/example-csv/metadata/.update-2015-06-07-1-ecd68700-88e3-4f04-9438-84b6ab935907.json.crc
/tmp/dstest/example-csv/metadata/update-2015-10-23-1-667f27a7-4f64-472a-80ed-82e8f1e65575.json
/tmp/dstest/example-csv/metadata/.update-2015-10-23-1-667f27a7-4f64-472a-80ed-82e8f1e65575.json.crc
</pre></div>
</div>
<p>Notice that we have a directory structure laid out based on our <code class="docutils literal notranslate"><span class="pre">daily,z2-2bit</span></code> scheme. Notice the first parquet
file path is composed of a date path <code class="docutils literal notranslate"><span class="pre">2016/05/06</span></code> and then a z2 ordinate of <code class="docutils literal notranslate"><span class="pre">2</span></code>, which is part of the file name</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">dstest</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">csv</span><span class="o">/</span><span class="mi">2015</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="n">_Wcec6a2ec594a4a2eb7c7980a1baf4ab3</span><span class="o">.</span><span class="n">parquet</span>
</pre></div>
</div>
<p>The rest of the parquet file name is a UUID, which allows for multiple threads to write different files at once
without interference. If we ingested additional data, another file would be created under the partition, and
GeoMesa would scan them both at query time.</p>
<p>Each new file (or file deletion) will create a separate metadata file, which contains details on the file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cat /tmp/dstest/example-csv/metadata/update-2015-05-06-629788a4-6a70-4009-ae20-c45602a88483.json
<span class="o">{</span>
    <span class="s2">&quot;action&quot;</span> : <span class="s2">&quot;Add&quot;</span>,
    <span class="s2">&quot;count&quot;</span> : <span class="m">1</span>,
    <span class="s2">&quot;envelope&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;xmax&quot;</span> : -100.2365,
        <span class="s2">&quot;xmin&quot;</span> : -100.2365,
        <span class="s2">&quot;ymax&quot;</span> : <span class="m">23</span>.0,
        <span class="s2">&quot;ymin&quot;</span> : <span class="m">23</span>.0
    <span class="o">}</span>,
    <span class="s2">&quot;files&quot;</span> : <span class="o">[</span>
        <span class="s2">&quot;2_Wcec6a2ec594a4a2eb7c7980a1baf4ab3.parquet&quot;</span>
    <span class="o">]</span>,
    <span class="s2">&quot;name&quot;</span> : <span class="s2">&quot;2015/05/06/2&quot;</span>,
    <span class="s2">&quot;timestamp&quot;</span> : <span class="m">1538148168948</span>
<span class="o">}</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spark_example.html" class="btn btn-neutral float-right" title="19.12. FileSystem Data Store Spark SQL Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modify_features.html" class="btn btn-neutral" title="19.10. Modifying Features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2020 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    
    - view <a href="../../_sources/user/filesystem/example.rst.txt" rel="nofollow">page source</a>
    
  </p>
</div>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<!-- analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-53087457-1', 'auto');
ga('send', 'pageview');
</script>




</body>
</html>