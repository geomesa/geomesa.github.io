

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.1. Installing GeoMesa Accumulo &mdash; GeoMesa 1.4.0-SNAPSHOT Manuals</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/segment.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/menu.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="GeoMesa 1.4.0-SNAPSHOT Manuals" href="../../index.html"/>
        <link rel="up" title="7. Accumulo Data Store" href="index.html"/>
        <link rel="next" title="7.2. Accumulo Configuration" href="configuration.html"/>
        <link rel="prev" title="7. Accumulo Data Store" href="index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.4.0-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">2. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">3. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">4. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">5. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">7. Accumulo Data Store</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">7.1. Installing GeoMesa Accumulo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-from-the-binary-distribution">7.1.1. Installing from the Binary Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-from-source">7.1.2. Building from Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-the-accumulo-distributed-runtime-library">7.1.3. Installing the Accumulo Distributed Runtime Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-the-accumulo-command-line-tools">7.1.4. Setting up the Accumulo Command Line Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-geomesa-accumulo-in-geoserver">7.1.5. Installing GeoMesa Accumulo in GeoServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upgrading">7.1.6. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">7.2. Accumulo Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline_tools.html">7.3. Command Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html">7.4. Command Line Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">7.5. Using the Accumulo Data Store Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">7.6. Using the Accumulo Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="visibilities.html">7.7. Accumulo Visibilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_management.html">7.8. Data Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html">7.9. GeoMesa Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="raster.html">7.10. GeoMesa Raster</a></li>
<li class="toctree-l3"><a class="reference internal" href="internals.html">7.11. Internals</a></li>
<li class="toctree-l3"><a class="reference internal" href="kerberos.html">7.12. Kerberos</a></li>
<li class="toctree-l3"><a class="reference internal" href="ageoff.html">7.13. Age-Off Iterators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">8. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">9. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">10. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">11. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">12. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">13. FileSystem Datastore (Amazon S3, HDFS Datastore)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">14. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blobstore.html">15. GeoMesa Blob Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">16. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">17. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html">18. GeoMesa Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../native_api.html">19. GeoMesa Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi.html">20. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">21. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">22. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">23. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../web_data.html">24. GeoMesa Web Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">25. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Manual</a> &raquo;</li>
        
          <li><a href="index.html">7. Accumulo Data Store</a> &raquo;</li>
        
      <li>7.1. Installing GeoMesa Accumulo</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user/accumulo/install.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-geomesa-accumulo">
<h1>7.1. Installing GeoMesa Accumulo<a class="headerlink" href="#installing-geomesa-accumulo" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installing-from-the-binary-distribution">
<h2>7.1.1. Installing from the Binary Distribution<a class="headerlink" href="#installing-from-the-binary-distribution" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa Accumulo artifacts are available for download or can be built from source.
The easiest way to get started is to download the most recent binary version (<code class="docutils literal"><span class="pre">$VERSION</span></code> = 1.4.0-SNAPSHOT)
and untar it somewhere convenient. For example, to download and prepare the geomesa-accumulo binary:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># download and unpackage the most recent distribution</span>
$ wget http://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-accumulo-dist_2.11/<span class="nv">$VERSION</span>/geomesa-accumulo-dist_2.11-<span class="nv">$VERSION</span>-bin.tar.gz
$ tar xvf geomesa-accumulo-dist_2.11-<span class="nv">$VERSION</span>-bin.tar.gz
$ <span class="nb">cd</span> geomesa-accumulo-dist_2.11-<span class="nv">$VERSION</span>
$ ls
bin/  conf/  dist/  docs/  examples/  lib/  LICENSE.txt  logs/
</pre></div>
</div>
</div>
<div class="section" id="building-from-source">
<span id="accumulo-install-source"></span><h2>7.1.2. Building from Source<a class="headerlink" href="#building-from-source" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa Accumulo may also be built from source. For more information refer to <a class="reference internal" href="../../developer/introduction.html#building-from-source"><span class="std std-ref">Building from Source</span></a>
in the developer manual, or to the <code class="docutils literal"><span class="pre">README.md</span></code> file in the the source distribution.
The remainder of the instructions in this chapter assume the use of the binary GeoMesa Accumulo
distribution. If you have built from source, the distribution is created in the <code class="docutils literal"><span class="pre">target</span></code> directory of
<code class="docutils literal"><span class="pre">geomesa-accumulo/geomesa-accumulo-dist</span></code>.</p>
<p>More information about developing with GeoMesa may be found in the <a class="reference internal" href="../../developer/index.html"><span class="doc">Developer Manual</span></a>.</p>
</div>
<div class="section" id="installing-the-accumulo-distributed-runtime-library">
<span id="install-accumulo-runtime"></span><h2>7.1.3. Installing the Accumulo Distributed Runtime Library<a class="headerlink" href="#installing-the-accumulo-distributed-runtime-library" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">geomesa-accumulo-dist_2.11-$VERSION/dist/accumulo/</span></code> directory contains the distributed
runtime JARs that contains server-side code for Accumulo that must be made
available on each of the Accumulo tablet servers in the cluster. These JARs
contain GeoMesa code and the Accumulo iterators required for querying GeoMesa data.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">GeoMesa requires commons-vfs2.jar 2.1 or later. This JAR ships with Accumulo 1.7.2+, but for older
installations the JAR needs to be updated in <code class="docutils literal"><span class="pre">$ACCUMULO_HOME/lib</span></code> on all Accumulo servers.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">There are two runtime JARs available, with and without raster support. Only one is
needed and including both will cause classpath issues.</p>
</div>
<p>The version of the distributed runtime JAR must match the version of the GeoMesa
data store client JAR (usually installed in GeoServer; see below). If not,
queries might not work correctly or at all.</p>
<div class="section" id="manual-install">
<span id="install-accumulo-runtime-manual"></span><h3>7.1.3.1. Manual Install<a class="headerlink" href="#manual-install" title="Permalink to this headline">¶</a></h3>
<p>The desired runtime JAR should be copied into the <code class="docutils literal"><span class="pre">$ACCUMULO_HOME/lib/ext</span></code> folder on
each tablet server.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># something like this for each tablet server</span>
$ scp dist/accumulo/geomesa-accumulo-distributed-runtime_2.11-<span class="nv">$VERSION</span>.jar <span class="se">\</span>
    tserver1:<span class="nv">$ACCUMULO_HOME</span>/lib/ext
<span class="c1"># or for raster support</span>
$ scp dist/accumulo/geomesa-accumulo-distributed-runtime-raster_2.11-<span class="nv">$VERSION</span>.jar <span class="se">\</span>
    tserver1:<span class="nv">$ACCUMULO_HOME</span>/lib/ext
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You do not need the JAR on the Accumulo master server, and including
it there may cause classpath issues later.</p>
</div>
</div>
<div class="section" id="namespace-install">
<span id="install-accumulo-runtime-namespace"></span><h3>7.1.3.2. Namespace Install<a class="headerlink" href="#namespace-install" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa leverages namespaces and classpath contexts to isolate the GeoMesa
classpath from the rest of Accumulo.</p>
<p>To install the distributed runtime JAR, use the <code class="docutils literal"><span class="pre">setup-namespace.sh</span></code>
script in the <code class="docutils literal"><span class="pre">geomesa-accumulo-dist_2.11-$VERSION/bin</span></code> directory.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>$ ./setup-namespace.sh -u myUser -n myNamespace
</pre></div>
</div>
<p>The command line arguments the script accepts are:</p>
<ul class="simple">
<li>-u &lt;Accumulo username&gt;</li>
<li>-n &lt;Accumulo namespace&gt;</li>
<li>-p &lt;Accumulo password&gt;</li>
<li>-t &lt;Use a cached Kerberos TGT&gt;</li>
<li>-g &lt;Path of GeoMesa distributed runtime JAR&gt; (optional, will default to the distribution folder and without raster support)</li>
<li>-h &lt;HDFS URI e.g. hdfs://localhost:54310&gt; (optional, will attempt to determine if not supplied)</li>
</ul>
<p>Since <code class="docutils literal"><span class="pre">accumulo</span> <span class="pre">shell</span></code> does not directly support Kerberos keytabs, if using Kerberos (<code class="docutils literal"><span class="pre">-t</span></code>) then a cached Kerberos
ticket-granting-ticket (TGT) should be obtained using the <code class="docutils literal"><span class="pre">kinit</span></code> command.</p>
<p>If <code class="docutils literal"><span class="pre">-t</span></code> is specified, <code class="docutils literal"><span class="pre">-p</span></code> must not be specified. If both <code class="docutils literal"><span class="pre">-p</span></code> and <code class="docutils literal"><span class="pre">-t</span></code> are omitted, the user is prompted for a password.</p>
<p>Alternatively you can manually install the distributed runtime JAR with these commands:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>$ accumulo shell -u root
&gt; createnamespace myNamespace
&gt; grant NameSpace.CREATE_TABLE -ns myNamespace -u myUser
&gt; config -s general.vfs.context.classpath.myNamespace=hdfs://NAME_NODE_FDQN:54310/accumulo/classpath/myNamespace/[^.].*.jar
&gt; config -ns myNamespace -s table.classpath.context=myNamespace
</pre></div>
</div>
<p>Then copy the distributed runtime JAR into HDFS under the path you specified.
The path above is just an example; you can included nested folders with project
names, version numbers, and other information in order to have different versions of GeoMesa on
the same Accumulo instance. You should remove any GeoMesa JARs under
<code class="docutils literal"><span class="pre">$ACCUMULO_HOME/lib/ext</span></code> to prevent any classpath conflicts.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When connecting to a data store using Accumulo namespaces, you must prefix
the <code class="docutils literal"><span class="pre">tableName</span></code> parameter with the namespace. For example, refer to the
<code class="docutils literal"><span class="pre">my_catalog</span></code> table as <code class="docutils literal"><span class="pre">myNamespace.my_catalog</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="setting-up-the-accumulo-command-line-tools">
<span id="setting-up-accumulo-commandline"></span><h2>7.1.4. Setting up the Accumulo Command Line Tools<a class="headerlink" href="#setting-up-the-accumulo-command-line-tools" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To use the Accumulo data store with the command line tools, you need to install
the distributed runtime first. See <a class="reference internal" href="#install-accumulo-runtime"><span class="std std-ref">Installing the Accumulo Distributed Runtime Library</span></a>.</p>
</div>
<p>GeoMesa comes with a set of command line tools for managing Accumulo features located in <code class="docutils literal"><span class="pre">geomesa-accumulo_2.11-$VERSION/bin/</span></code> of the binary distribution.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can configure environment variables and classpath settings in geomesa-accumulo_2.11-$VERSION/bin/geomesa-env.sh.</p>
</div>
<p>In the <code class="docutils literal"><span class="pre">geomesa-accumulo_2.11-$VERSION</span></code> directory, run <code class="docutils literal"><span class="pre">bin/geomesa</span> <span class="pre">configure</span></code> to set up the tools.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1">### in geomesa-accumulo_2.11-$VERSION/:</span>
$ bin/geomesa configure
Warning: GEOMESA_ACCUMULO_HOME is not set, using /path/to/geomesa-accumulo_2.11-<span class="nv">$VERSION</span>
Using GEOMESA_ACCUMULO_HOME as set: /path/to/geomesa-accumulo_2.11-<span class="nv">$VERSION</span>
Is this intentional? Y<span class="se">\n</span> y
Warning: GEOMESA_LIB already set, probably by a prior configuration.
Current value is /path/to/geomesa-accumulo_2.11-<span class="nv">$VERSION</span>/lib.

Is this intentional? Y<span class="se">\n</span> y

To persist the configuration please update your bashrc file to include:
<span class="nb">export</span> <span class="nv">GEOMESA_ACCUMULO_HOME</span><span class="o">=</span>/path/to/geomesa-accumulo_2.11-<span class="nv">$VERSION</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="si">${</span><span class="nv">GEOMESA_ACCUMULO_HOME</span><span class="si">}</span>/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>Update and re-source your <code class="docutils literal"><span class="pre">~/.bashrc</span></code> file to include the <code class="docutils literal"><span class="pre">$GEOMESA_ACCUMULO_HOME</span></code> and <code class="docutils literal"><span class="pre">$PATH</span></code> updates.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please note that the <code class="docutils literal"><span class="pre">$GEOMESA_ACCUMULO_HOME</span></code> variable points to the location of the <code class="docutils literal"><span class="pre">geomesa-accumulo_2.11-$VERSION</span></code>
directory, not the main geomesa binary distribution directory.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal"><span class="pre">geomesa</span></code> will read the <code class="docutils literal"><span class="pre">$ACCUMULO_HOME</span></code> and <code class="docutils literal"><span class="pre">$HADOOP_HOME</span></code> environment variables to load the
appropriate JAR files for Hadoop, Accumulo, Zookeeper, and Thrift. If possible, we recommend
installing the tools on the Accumulo master server, as you may also need various configuration
files from Hadoop/Accumulo in order to run certain commands.</p>
<p>GeoMesa provides the ability to provide additional jars on the classpath using the environmental variable
<code class="docutils literal"><span class="pre">$GEOMESA_EXTRA_CLASSPATHS</span></code>. GeoMesa will prepend the contents of this environmental variable  to the computed
classpath giving it highest precedence in the classpath. Users can provide directories of jar files or individual
files using a colon (<code class="docutils literal"><span class="pre">:</span></code>) as a delimiter. These entries will also be added the the mapreduce libjars variable.
Use the <code class="docutils literal"><span class="pre">geomesa</span> <span class="pre">classpath</span></code> command to print the final classpath that will be used when executing geomesa
commands.</p>
<p class="last">If you are running the tools on a system without
Accumulo installed and configured, the <code class="docutils literal"><span class="pre">install-hadoop-accumulo.sh</span></code> script
in the <code class="docutils literal"><span class="pre">bin</span></code> directory may be used to download the needed Hadoop/Accumulo JARs into
the <code class="docutils literal"><span class="pre">lib</span></code> directory. You should edit this script to match the versions used by your
installation.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="../datastores/logging.html#slf4j-configuration"><span class="std std-ref">Logging Configuration</span></a> for information about configuring the SLF4J implementation.</p>
</div>
<p>Due to licensing restrictions, dependencies for shape file support and raster
ingest must be separately installed. Do this with the following commands:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ bin/install-jai.sh
$ bin/install-jline.sh
</pre></div>
</div>
<p>Test the command that invokes the GeoMesa Tools:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>$ geomesa-accumulo
Using GEOMESA_ACCUMULO_HOME = /path/to/geomesa-accumulo-dist_2.11-$VERSION
Usage: geomesa-accumulo [command] [command options]
  Commands:
  ...
</pre></div>
</div>
<p>For more details, see <a class="reference internal" href="commandline_tools.html#accumulo-tools"><span class="std std-ref">Command Line Tools</span></a>.</p>
</div>
<div class="section" id="installing-geomesa-accumulo-in-geoserver">
<span id="install-accumulo-geoserver"></span><h2>7.1.5. Installing GeoMesa Accumulo in GeoServer<a class="headerlink" href="#installing-geomesa-accumulo-in-geoserver" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The GeoMesa Accumulo GeoServer plugin requires the use of GeoServer
2.9.x and GeoTools 15.x.</p>
</div>
<p>As described in section <a class="reference internal" href="../architecture.html#geomesa-and-geoserver"><span class="std std-ref">GeoMesa and GeoServer</span></a>, GeoMesa implements a
<a class="reference external" href="http://geotools.org/">GeoTools</a>-compatible data store. This makes it possible
to use GeoMesa Accumulo as a data store in <a class="reference external" href="http://geoserver.org/">GeoServer</a>.
GeoServer&#8217;s web site includes <a class="reference external" href="http://docs.geoserver.org/stable/en/user/installation/index.html">installation instructions for GeoServer</a>.</p>
<p>After GeoServer is running, you will also need to install the WPS plugin to
your GeoServer instance. The GeoServer WPS Plugin must match the version of
GeoServer instance. The GeoServer website includes instructions for downloading
and installing <a class="reference external" href="http://docs.geoserver.org/stable/en/user/services/wps/install.html">the WPS plugin</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If using Tomcat as a web server, it will most likely be necessary to
pass some custom options:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Xmx8g -XX:MaxPermSize=512M -Duser.timezone=UTC </span><span class="se">\</span>
<span class="s2">-server -Djava.awt.headless=true&quot;</span>
</pre></div>
</div>
<p class="last">The value of <code class="docutils literal"><span class="pre">-Xmx</span></code> should be as large as your system will permit; this
is especially important for the Kafka plugin. You
should also consider passing <code class="docutils literal"><span class="pre">-DGEOWEBCACHE_CACHE_DIR=/tmp/$USER-gwc</span></code>
and <code class="docutils literal"><span class="pre">-DEPSG-HSQL.directory=/tmp/$USER-hsql</span></code>
as well. Be sure to restart Tomcat for changes to take place.</p>
</div>
<p>To install GeoMesa&#8217;s Accumulo data store as a GeoServer plugin, we can utilize the script <code class="docutils literal"><span class="pre">manage-geoserver-plugins.sh</span></code> in <code class="docutils literal"><span class="pre">bin</span></code> directory
of the GeoMesa Accumulo or GeoMesa Hadoop distributions. (<code class="docutils literal"><span class="pre">$VERSION</span></code> = 1.4.0-SNAPSHOT)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If $GEOSERVER_HOME is set, then the <code class="docutils literal"><span class="pre">--lib-dir</span></code> parameter is not needed.</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ bin/manage-geoserver-plugins.sh --lib-dir /path/to/geoserver/WEB-INF/lib/ --install
Collecting Installed Jars
Collecting geomesa-gs-plugin Jars

Please choose which modules to install
Multiple may be specified, eg: <span class="m">1</span> <span class="m">4</span> <span class="m">10</span>
Type <span class="s1">&#39;a&#39;</span> to specify all
--------------------------------------
<span class="m">0</span> <span class="p">|</span> geomesa-accumulo-gs-plugin_2.11-<span class="nv">$VERSION</span>
<span class="m">1</span> <span class="p">|</span> geomesa-blobstore-gs-plugin_2.11-<span class="nv">$VERSION</span>
<span class="m">2</span> <span class="p">|</span> geomesa-process-wps_2.11-<span class="nv">$VERSION</span>
<span class="m">3</span> <span class="p">|</span> geomesa-stream-gs-plugin_2.11-<span class="nv">$VERSION</span>

Module<span class="o">(</span>s<span class="o">)</span> to install: <span class="m">0</span> <span class="m">1</span>
<span class="m">0</span> <span class="p">|</span> Installing geomesa-accumulo-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz
<span class="m">1</span> <span class="p">|</span> Installing geomesa-blobstore-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz
Done
</pre></div>
</div>
<p>If you prefer to install the GeoMesa Accumulo GeoServer plugin manually, unpack the contents of the
<code class="docutils literal"><span class="pre">geomesa-accumulo-gs-plugin_2.11-$VERSION-install.tar.gz</span></code> file in <code class="docutils literal"><span class="pre">geomesa-accumulo_2.11-$VERSION/dist/geoserver/</span></code>
in the binary distribution or <code class="docutils literal"><span class="pre">geomesa-$VERSION/geomesa-accumulo/geomesa-accumulo-gs-plugin/target/</span></code> in the source distribution
into your GeoServer&#8217;s <code class="docutils literal"><span class="pre">lib</span></code> directory (<code class="docutils literal"><span class="pre">$VERSION</span></code> = 1.4.0-SNAPSHOT):</p>
<p>If you are using Tomcat:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tar -xzvf <span class="se">\</span>
  geomesa-accumulo_2.11-<span class="nv">$VERSION</span>/dist/gs-plugins/geomesa-accumulo-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz <span class="se">\</span>
  -C /path/to/tomcat/webapps/geoserver/WEB-INF/lib/
</pre></div>
</div>
<p>If you are using GeoServer&#8217;s built in Jetty web server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tar -xzvf <span class="se">\</span>
  geomesa-accumulo_2.11-<span class="nv">$VERSION</span>/dist/gs-plugins/geomesa-accumulo-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz <span class="se">\</span>
  -C /path/to/geoserver/webapps/geoserver/WEB-INF/lib/
</pre></div>
</div>
<p>There are additional JARs for Accumulo, Zookeeper, Hadoop, and Thrift that will
be specific to your installation that you will also need to copy to GeoServer&#8217;s
<code class="docutils literal"><span class="pre">WEB-INF/lib</span></code> directory. For example, GeoMesa only requires Hadoop
2.2 or later, but if you are using Hadoop 2.5.0 you should use the JARs
that match the version of Hadoop you are running.</p>
<p>There is a script in the <code class="docutils literal"><span class="pre">geomesa-accumulo_2.11-$VERSION/bin</span></code> directory
(<code class="docutils literal"><span class="pre">$GEOMESA_ACCUMULO_HOME/bin/install-hadoop-accumulo.sh</span></code>) which will install these
dependencies to a target directory using <code class="docutils literal"><span class="pre">wget</span></code> (requires an internet
connection).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may have to edit the <code class="docutils literal"><span class="pre">install-hadoop-accumulo.sh</span></code> script to set the
versions of Accumulo, Zookeeper, Hadoop, and Thrift you are running.</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nv">$GEOMESA_ACCUMULO_HOME</span>/bin/install-hadoop-accumulo.sh /path/to/tomcat/webapps/geoserver/WEB-INF/lib/
Install accumulo and hadoop dependencies to /path/to/tomcat/webapps/geoserver/WEB-INF/lib/?
Confirm? <span class="o">[</span>Y/n<span class="o">]</span>y
fetching https://search.maven.org/remotecontent?filepath<span class="o">=</span>org/apache/accumulo/accumulo-core/1.8.1/accumulo-core-1.8.1.jar
--2015-09-29 <span class="m">15</span>:06:48--  https://search.maven.org/remotecontent?filepath<span class="o">=</span>org/apache/accumulo/accumulo-core/1.8.1/accumulo-core-1.8.1.jar
Resolving search.maven.org <span class="o">(</span>search.maven.org<span class="o">)</span>... <span class="m">207</span>.223.241.72
Connecting to search.maven.org <span class="o">(</span>search.maven.org<span class="o">)</span><span class="p">|</span><span class="m">207</span>.223.241.72<span class="p">|</span>:443... connected.
HTTP request sent, awaiting response... <span class="m">200</span> OK
Length: <span class="m">5152909</span> <span class="o">(</span><span class="m">4</span>.9M<span class="o">)</span> <span class="o">[</span>application/java-archive<span class="o">]</span>
Saving to: ‘/path/to/tomcat/webapps/geoserver/WEB-INF/lib/accumulo-core-1.8.1.jar’
...
</pre></div>
</div>
<p>If you do no have an internet connection you can download the JARs manually via <a class="reference external" href="http://search.maven.org/">http://search.maven.org/</a>.
These may include the JARs below; the specific JARs needed for some common configurations are listed below:</p>
<p>Accumulo 1.6</p>
<ul class="simple">
<li>accumulo-core-1.6.6.jar</li>
<li>accumulo-fate-1.6.6.jar</li>
<li>accumulo-server-base-1.6.6.jar</li>
<li>accumulo-trace-1.6.6.jar</li>
<li>accumulo-start-1.6.6.jar</li>
<li>libthrift-0.9.1.jar</li>
<li>zookeeper-3.4.10.jar</li>
<li>commons-vfs2-2.1.jar</li>
</ul>
<p>Accumulo 1.7 (note the addition of htrace)</p>
<ul class="simple">
<li>accumulo-core-1.7.3.jar</li>
<li>accumulo-fate-1.7.3.jar</li>
<li>accumulo-server-base-1.7.3.jar</li>
<li>accumulo-trace-1.7.3.jar</li>
<li>accumulo-start-1.7.3.jar</li>
<li>libthrift-0.9.1.jar</li>
<li>zookeeper-3.4.10.jar</li>
<li>htrace-core-3.1.0-incubating.jar</li>
<li>commons-vfs2-2.1.jar</li>
</ul>
<p>Accumulo 1.8 (note the addition of htrace)</p>
<ul class="simple">
<li>accumulo-core-1.8.1.jar</li>
<li>accumulo-fate-1.8.1.jar</li>
<li>accumulo-server-base-1.8.1.jar</li>
<li>accumulo-trace-1.8.1.jar</li>
<li>accumulo-start-1.8.1.jar</li>
<li>libthrift-0.9.3.jar</li>
<li>zookeeper-3.4.10.jar</li>
<li>htrace-core-3.1.0-incubating.jar</li>
<li>commons-vfs2-2.1.jar</li>
</ul>
<p>Hadoop 2.6-2.8 (adjust versions as needed)</p>
<ul class="simple">
<li>commons-configuration-1.6.jar</li>
<li>hadoop-auth-2.7.4.jar</li>
<li>hadoop-client-2.7.4.jar</li>
<li>hadoop-common-2.7.4.jar</li>
<li>hadoop-hdfs-2.7.4.jar</li>
</ul>
<p>Restart GeoServer after the JARs are installed.</p>
<div class="section" id="accumulo-versions">
<h3>7.1.5.1. Accumulo Versions<a class="headerlink" href="#accumulo-versions" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">GeoMesa targets Accumulo 1.8 as a runtime dependency. Most artifacts will work with older versions
of Accumulo without changes, however some artifacts which bundle Accumulo will need to be built manually.
Accumulo 1.8 introduced a dependency on libthrift version 0.9.3 which is not compatible with Accumulo
1.7/libthrift 0.9.1. To target an earlier Accumulo version, modify <code class="docutils literal"><span class="pre">&lt;accumulo.version&gt;</span></code> and
<code class="docutils literal"><span class="pre">&lt;thrift.version&gt;</span></code> in the main pom.xml and re-build.</p>
</div>
</div>
<div class="section" id="geomesa-process">
<span id="install-geomesa-process"></span><h3>7.1.5.2. GeoMesa Process<a class="headerlink" href="#geomesa-process" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some GeoMesa-specific WPS processes such as <code class="docutils literal"><span class="pre">geomesa:Density</span></code>, which is used
in the generation of heat maps, also require <code class="docutils literal"><span class="pre">geomesa-process-wps_2.11-$VERSION.jar</span></code>.
This JAR is included in the <code class="docutils literal"><span class="pre">geomesa-accumulo_2.11-$VERSION/dist/gs-plugins</span></code> directory of the binary
distribution, or is built in the <code class="docutils literal"><span class="pre">geomesa-process</span></code> module of the source
distribution.</p>
</div>
</div>
<div class="section" id="jackson-version">
<h3>7.1.5.3. Jackson Version<a class="headerlink" href="#jackson-version" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Some GeoMesa functions (in particular Arrow conversion) requires <code class="docutils literal"><span class="pre">jackson-core-2.6.x</span></code>. Some versions
of GeoServer ship with an older version, <code class="docutils literal"><span class="pre">jackson-core-2.5.0.jar</span></code>. After installing the GeoMesa
GeoServer plugin, be sure to delete the older JAR from GeoServer&#8217;s <code class="docutils literal"><span class="pre">WEB-INF/lib</span></code> folder.</p>
</div>
</div>
</div>
<div class="section" id="upgrading">
<h2>7.1.6. Upgrading<a class="headerlink" href="#upgrading" title="Permalink to this headline">¶</a></h2>
<p>To upgrade between minor releases of GeoMesa, the versions of all GeoMesa components
<strong>must</strong> match. This means that the version of the <code class="docutils literal"><span class="pre">geomesa-distributed-runtime</span></code>
JAR installed on Accumulo tablet servers <strong>must</strong> match the version of the
<code class="docutils literal"><span class="pre">geomesa-plugin</span></code> JARs installed in the <code class="docutils literal"><span class="pre">WEB-INF/lib</span></code> directory of GeoServer.</p>
<p>We strive to maintain backwards compatibility for data ingested with older
releases of GeoMesa, and in general data ingested with older releases
may be read with newer ones (note that the reverse does not apply). For example,
data ingested into Accumulo with GeoMesa 1.2.2 may be read with 1.2.3.</p>
<p>It should be noted, however, that data ingested with older GeoMesa versions may
not take full advantage of indexing improvements in newer releases. If
it is not feasible to reingest old data, see <a class="reference internal" href="jobs.html#update-index-format-job"><span class="std std-ref">Updating Existing Data to the Latest Index Format</span></a>
for more information on updating its index format.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configuration.html" class="btn btn-neutral float-right" title="7.2. Accumulo Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="7. Accumulo Data Store" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2017 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.4.0-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../../_static/sphinx_tabs/tabs.js"></script>
      <script type="text/javascript" src="../../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>