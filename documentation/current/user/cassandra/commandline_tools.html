

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cassandra Command Line Tools &mdash; GeoMesa 1.3.1-SNAPSHOT Manuals</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  

  

  
    <link rel="top" title="GeoMesa 1.3.1-SNAPSHOT Manuals" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.3.1-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GeoMesa</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Cassandra Command Line Tools</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user/cassandra/commandline_tools.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cassandra-command-line-tools">
<h1>Cassandra Command Line Tools<a class="headerlink" href="#cassandra-command-line-tools" title="Permalink to this headline">¶</a></h1>
<p>The GeoMesa Cassandra distribution comes with a set of command line tools
for working with GeoMesa and Cassandra. This section shows how to use
the tools.</p>
<p>Before starting, check the following:</p>
<ul class="simple">
<li>Make sure Cassandra is running (check by running <tt class="docutils literal"><span class="pre">bin/nodetool</span> <span class="pre">status</span></tt> in your
Cassandra installation directory.)</li>
<li>Make sure you&#8217;ve set the <tt class="docutils literal"><span class="pre">CASSANDRA_LIB</span></tt> environment variable (check by running
<tt class="docutils literal"><span class="pre">echo</span> <span class="pre">$CASSANDRA_LIB</span></tt>)</li>
<li>Make sure you&#8217;ve created a key space within Cassandra (check by starting <tt class="docutils literal"><span class="pre">bin/cqlsh</span></tt> in your
Cassandra installation directory, and then by typing <tt class="docutils literal"><span class="pre">DESCRIBE</span> <span class="pre">KEYSPACES</span></tt>)</li>
</ul>
<p>Then, <tt class="docutils literal"><span class="pre">cd</span></tt> into the <tt class="docutils literal"><span class="pre">GEOMESA_CASSANDRA_HOME</span></tt> directory, and type <tt class="docutils literal"><span class="pre">bin/geomesa-cassandra</span> <span class="pre">help</span></tt>. You should
get a listing of the tools with descriptions.</p>
<p>The first tool we&#8217;ll try is the <tt class="docutils literal"><span class="pre">ingest</span></tt> command. This command takes data from an external source and
ingests it into the Cassandra database. For this example, we&#8217;ll use some sample data located
at <tt class="docutils literal"><span class="pre">examples/ingest/csv/example.csv</span></tt> in the <tt class="docutils literal"><span class="pre">GEOMESA_CASSANDRA_HOME</span></tt> directory. Also, to make
editing and running the command easier, we&#8217;ll use the example bash script at <tt class="docutils literal"><span class="pre">examples/ingest/csv/ingest_csv.sh</span></tt>.
This is the script:</p>
<div class="highlight-python"><div class="highlight"><pre>#!/usr/bin/env bash

# spec and converter for example_csv are registered in $GEOMESA_CASSANDRA_HOME/conf/application.conf
bin/geomesa-cassandra ingest \
    --contact-point 127.0.0.1:9042 \
    --key-space mykeyspace \
    --catalog mycatalog \
    --name-space mynamespace \
    --converter example_csv \
    --spec example_csv \
    examples/ingest/csv/example.csv
</pre></div>
</div>
<ul>
<li><p class="first">The <tt class="docutils literal"><span class="pre">contact-point</span></tt> is the address a Cassandra node. If you&#8217;re running Cassandra locally with
the default configuration, you shouldn&#8217;t have to change this.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">key-space</span></tt> is the Cassandra key space that you created as part of configuring Cassandra (see above).
Edit this argument if needed to match the name of your key space.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">catalog</span></tt> argument specifies the name of a Cassandra table that will be created in your name space
by the <tt class="docutils literal"><span class="pre">ingest</span></tt> command.
You can name the catalog table anything you want.
This table is a metadata table that contains a list of each GeoMesa data table
that you have created. Before you run the <tt class="docutils literal"><span class="pre">ingest</span></tt> command for the first time, this table does
not exist. When you run <tt class="docutils literal"><span class="pre">ingest</span></tt> for the first time, GeoMesa creates two tables: this &#8220;catalog&#8221; metadata
table, and the table that actually stores your data. If you run <tt class="docutils literal"><span class="pre">ingest</span></tt> again with a different dataset,
GeoMesa will append a row to the &#8220;catalog&#8221; table, and also create an additional table for the new data.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">name-space</span></tt> parameter can be anything you want. (It is used by GeoTools to provide a name space for your feature types.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">converter</span></tt> and <tt class="docutils literal"><span class="pre">spec</span></tt> parameters refer to a specific file located at <tt class="docutils literal"><span class="pre">conf/application.conf</span></tt> within the
<tt class="docutils literal"><span class="pre">GEOMESA_CASSANDRA_HOME</span></tt> directory. This file contains specifications for &#8220;converters&#8221; and &#8220;sfts&#8221; (SimpleFeatureTypes) parsed by the <a class="reference internal" href="../convert/index.html#converters"><em>GeoMesa Convert</em></a> library.
In this specific example it only contains one of each: a converter and a SimpleFeatureType which are both called
&#8220;example_csv&#8221;. The converter specifies how a raw data file should be parsed. For example, the converter specifies
that the fourth column of the input file should be converted to a date using a specific date format. The
SimpleFeatureType part specifies how the parsed data should be used to create a SimpleFeatureType. For example, this
files specifies that the SimpleFeatureType&#8217;s first attribute should be one called &#8220;name&#8221;. GeoMesa uses these specifications
to ingest the data from the external data file into the Cassandra database. (For more information on converters see <a class="reference internal" href="../convert/index.html#converters"><em>GeoMesa Convert</em></a>.)</p>
<p>GeoMesa automatically finds the <tt class="docutils literal"><span class="pre">conf/application.conf</span></tt> file based on its name and location. You can add additional
converters and SFT specifications to it as needed for ingesting other datasets. In addition, you can also
specify converters and SFT specifications by adding directories to the
<tt class="docutils literal"><span class="pre">conf/sfts</span></tt> directory. For more details see <a class="reference internal" href="../convert/usage_tools.html#installing-sft-and-converter-definitions"><em>Using SFT and Converter Definitions with Command-Line Tools</em></a>.</p>
</li>
<li><p class="first">The last argument is the location of the data file that we want to ingest.</p>
</li>
</ul>
<p>If needed, edit the parameter arguments in the bash script. Then, <tt class="docutils literal"><span class="pre">cd</span></tt> into the <tt class="docutils literal"><span class="pre">GEOMESA_CASSANDRA_HOME</span></tt>
directory, and run the script by typing:</p>
<div class="highlight-python"><div class="highlight"><pre>source examples/ingest/csv/ingest_csv.sh
</pre></div>
</div>
<p>You should see a message indicating that three features have been ingested.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you see an error message regarding <tt class="docutils literal"><span class="pre">SLF4J</span></tt>, find the <tt class="docutils literal"><span class="pre">logback-classic-1.1.3.jar</span></tt>
file in your <tt class="docutils literal"><span class="pre">CASSANDRA_LIB</span></tt> directory, and rename it to include a <tt class="docutils literal"><span class="pre">.exclude</span></tt> extension.</p>
</div>
<p>You can take a look at what happened
by going to the Cassadra CQL shell (<tt class="docutils literal"><span class="pre">cqlsh</span></tt>) and typing:</p>
<div class="highlight-python"><div class="highlight"><pre>DESCRIBE KEYSPACE mykeyspace ;
</pre></div>
</div>
<p>This will show that two new tables have been created: <tt class="docutils literal"><span class="pre">mycatalog</span></tt> and <tt class="docutils literal"><span class="pre">example_csv</span></tt>. Type:</p>
<div class="highlight-python"><div class="highlight"><pre>SELECT * FROM mykeyspace.mycatalog ;
</pre></div>
</div>
<p>and</p>
<div class="highlight-python"><div class="highlight"><pre>SELECT * FROM mykeyspace.example_csv ;
</pre></div>
</div>
<p>to see the contents of the tables.</p>
<p>Now that we&#8217;ve ingested some data into the Cassandra database, we can try using some other commands. For example,
we list the tables (&#8220;feature types&#8221;) that we&#8217;ve ingested:</p>
<div class="highlight-python"><div class="highlight"><pre>bin/geomesa-cassandra get-type-names \
    --contact-point 127.0.0.1:9042 \
    --key-space mykeyspace \
    --catalog mycatalog \
    --name-space mynamespace \
</pre></div>
</div>
<p>We can also inspect the feature type that we just ingested:</p>
<div class="highlight-python"><div class="highlight"><pre>bin/geomesa-cassandra describe-schema \
    --contact-point 127.0.0.1:9042 \
    --key-space mykeyspace \
    --catalog mycatalog \
    --name-space mynamespace \
    --feature-name example_csv
</pre></div>
</div>
<div class="section" id="configuring-the-command-line-tools">
<h2>Configuring the Command Line Tools<a class="headerlink" href="#configuring-the-command-line-tools" title="Permalink to this headline">¶</a></h2>
<p>You can configure the command line tools using the
<tt class="docutils literal"><span class="pre">conf/geomesa-env.sh</span></tt> file in the <tt class="docutils literal"><span class="pre">GEOMESA_CASSANDRA_HOME</span></tt> directory.
See the comments in that file for instructions.</p>
</div>
<div class="section" id="ingesting-other-datasets">
<h2>Ingesting Other Datasets<a class="headerlink" href="#ingesting-other-datasets" title="Permalink to this headline">¶</a></h2>
<p>To ingest other datasets, you need to provide converter and SimpleFeatureType specifications.
For details on how to provide these specifications, see <a class="reference internal" href="../convert/usage_tools.html#installing-sft-and-converter-definitions"><em>Using SFT and Converter Definitions with Command-Line Tools</em></a>
and <a class="reference internal" href="../accumulo/commandline_tools.html#ingest"><em>ingest</em></a>. For more details on the converter specification syntax see <a class="reference internal" href="../convert/index.html#converters"><em>GeoMesa Convert</em></a>.</p>
<p>When ingesting other datasets, keep the following GeoMesa-Cassandra-specific limitations in mind:</p>
<ul class="simple">
<li>The feature type must have a date/time field in addition to a geometry field.</li>
<li>The geometry type must be &#8220;Point&#8221;. Polygons and other geometry types are not allowed.</li>
<li>The following attribute names may not be used in the feature type specification: <tt class="docutils literal"><span class="pre">pkz</span></tt>, <tt class="docutils literal"><span class="pre">z31</span></tt>, and <tt class="docutils literal"><span class="pre">fid</span></tt> .
However, any field in the original data may be chosen as the ID field. This field will become the
<tt class="docutils literal"><span class="pre">fid</span></tt> table in the Cassandra table.</li>
<li>The name of the feature type must be a valid Cassandra table name.</li>
<li>Complex field types like lists and maps are not allowed.</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2016 Commonwealth Computer Research, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.3.1-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>