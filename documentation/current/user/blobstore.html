

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13. GeoMesa Blob Store &mdash; GeoMesa 1.3.2-SNAPSHOT Manuals</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/sphinx_tabs/tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.7/segment.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.7/menu.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="GeoMesa 1.3.2-SNAPSHOT Manuals" href="../index.html"/>
        <link rel="up" title="User Manual" href="index.html"/>
        <link rel="next" title="14. GeoMesa Convert" href="convert/index.html"/>
        <link rel="prev" title="12. GeoServer Plugins" href="geoserver.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.3.2-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">2. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">3. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html">4. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">5. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo/index.html">7. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka/index.html">8. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="hbase/index.html">9. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="bigtable/index.html">10. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra/index.html">11. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">12. GeoServer Plugins</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">13. GeoMesa Blob Store</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#filehandler-interface">13.1. FileHandler Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blobstore-interface">13.2. BlobStore Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#provided-file-handlers">13.3. Provided File Handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geomesa-blobstore-exif">13.3.1. GeoMesa-BlobStore-EXIF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geomesa-blobstore-gdal">13.3.2. GeoMesa-BlobStore-GDAL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#geomesa-blobstore-accumulo">13.4. GeoMesa-BlobStore-Accumulo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rest-api">13.5. REST API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#servlet-configuration-options">13.6. Servlet Configuration Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="convert/index.html">14. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojson.html">15. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">16. GeoMesa Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="native_api.html">17. GeoMesa Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="nifi.html">18. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html">19. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark/index.html">20. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="stream.html">21. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_data.html">22. GeoMesa Web Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User Manual</a> &raquo;</li>
        
      <li>13. GeoMesa Blob Store</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/blobstore.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geomesa-blob-store">
<h1>13. GeoMesa Blob Store<a class="headerlink" href="#geomesa-blob-store" title="Permalink to this headline">¶</a></h1>
<p>The GeoMesa Blob Store is found in <code class="docutils literal"><span class="pre">geomesa-blobstore</span></code> in the source distribution.</p>
<p>The <code class="docutils literal"><span class="pre">GeoMesaIndexedBlobStore</span></code> is an interface that describes the
function of a GeoMesa BlobStore, which is to store and retrieve files
that have spatio-temporal data associated with them. A GeoMesa Blobstore
is created by combining a geotools data store and a backing blob store
which will contain the blobs separated from the geo index. The
<code class="docutils literal"><span class="pre">BlobStore</span></code> interface can be used to implement compatibility with
other databases or distributed file systems.</p>
<p>During ingest of a file into a GeoMesa BlobStore, a pluggable system of
<code class="docutils literal"><span class="pre">FileHandler</span></code>s examines the files (and associated maps of
parameters) and creates <code class="docutils literal"><span class="pre">SimpleFeature</span></code>s which are the written to a
GeoMesa data store while the blobs are persisted using a class that
implements the <code class="docutils literal"><span class="pre">BlobStore</span></code> interface.</p>
<p>File retrieval is a two-step process. First a query is made to the
GeoMesa <code class="docutils literal"><span class="pre">FeatureStore</span></code>. The returned <code class="docutils literal"><span class="pre">SimpleFeature</span></code>s will contain
a URI field. That URI points to the desired file stored in Accumulo, and
can be retrieved by the <code class="docutils literal"><span class="pre">GeoMesaIndexedBlobStore</span></code> API or by the REST
interface.</p>
<div class="section" id="filehandler-interface">
<h2>13.1. FileHandler Interface<a class="headerlink" href="#filehandler-interface" title="Permalink to this headline">¶</a></h2>
<p>The FileHandler interface is designed to allow file handling in the
Blobstore to be pluggable. Implementors should implement
<code class="docutils literal"><span class="pre">org.locationtech.geomesa.blob.api.handlers.FileHandler</span></code> or extend the
abstract implementation
<code class="docutils literal"><span class="pre">org.locationtech.geomesa.blob.api.handlers.AbstractFileHandler</span></code>. The
class <code class="docutils literal"><span class="pre">WKTFileHandler</span></code> serves as an example of that latter approach.</p>
<p><code class="docutils literal"><span class="pre">FileHandler</span></code> implementations are loaded at runtime by the Java
ServiceLoader. As such, available implementations should have their
classname registered in
<code class="docutils literal"><span class="pre">META-INF/services/org.locationtech.geomesa.blob.api.FileHandler</span></code>.</p>
</div>
<div class="section" id="blobstore-interface">
<h2>13.2. BlobStore Interface<a class="headerlink" href="#blobstore-interface" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">BlobStore</span></code> interface is designed to allow the backing blob store
of a <code class="docutils literal"><span class="pre">GeoMesaIndexedBlobStore</span></code> to be pluggable. Implementors should
implement <code class="docutils literal"><span class="pre">org.locationtech.geomesa.blob.api.BlobStore</span></code> interface. The
<code class="docutils literal"><span class="pre">AccumuloBlobStoreImpl</span></code> serves as an example implementation of a
<code class="docutils literal"><span class="pre">BlobStore</span></code> .</p>
<p>As of this time the <code class="docutils literal"><span class="pre">BlobStore</span></code> interface does not yet use the Service
Provider Interface.</p>
</div>
<div class="section" id="provided-file-handlers">
<h2>13.3. Provided File Handlers<a class="headerlink" href="#provided-file-handlers" title="Permalink to this headline">¶</a></h2>
<p>The BlobStore API contains by default the <code class="docutils literal"><span class="pre">WKTFileHandler</span></code> and
<code class="docutils literal"><span class="pre">ByteArrayHandler</span></code> handlers. The <code class="docutils literal"><span class="pre">WKTFileHandler</span></code> allows users to
ingest any file by associating a WKT geometry to a file. Similarly the
<code class="docutils literal"><span class="pre">ByteArrayHandler</span></code> allows users to ingest arbitrary byte arrays
accompanied with spatio-temporal attributes.</p>
<p>Along with these included handlers, the GeoMesa BlobStore has two sub
modules of additional handlers in the geomesa-blobstore-handlers module.</p>
<div class="section" id="geomesa-blobstore-exif">
<h3>13.3.1. GeoMesa-BlobStore-EXIF<a class="headerlink" href="#geomesa-blobstore-exif" title="Permalink to this headline">¶</a></h3>
<p>The EXIF module contains the <code class="docutils literal"><span class="pre">MetadataFileHandler</span></code> which can parse
EXIF metadata to retrieve geolocation information. This enables ingest
of large collections of geotagged images into a GeoMesa BlobStore.</p>
</div>
<div class="section" id="geomesa-blobstore-gdal">
<h3>13.3.2. GeoMesa-BlobStore-GDAL<a class="headerlink" href="#geomesa-blobstore-gdal" title="Permalink to this headline">¶</a></h3>
<p>The GDAL module contains the <code class="docutils literal"><span class="pre">GDALFileHandler</span></code> which utilizes GDAL to
extract geolocation information and time from raster/imagery files
supported by GDAL 2.0.0. For a complete list of GDAL supported file
formats please refer to: <a class="reference external" href="http://www.gdal.org/formats_list.html">GDAL formats list</a>.</p>
<p>To utilize this handler the user must have compiled GDAL Java bindings
and have placed relevant JNI libraries in the LD_LIBRARY_PATH
environment variable. To build GDAL and the JNI libraries, follow the
instructions here: <a class="reference external" href="https://trac.osgeo.org/gdal/wiki/GdalOgrInJavaBuildInstructionsUnix">GDAL JNI build instructions</a>.</p>
</div>
</div>
<div class="section" id="geomesa-blobstore-accumulo">
<h2>13.4. GeoMesa-BlobStore-Accumulo<a class="headerlink" href="#geomesa-blobstore-accumulo" title="Permalink to this headline">¶</a></h2>
<p>The BlobStore-Accumulo module contains concrete implementations of the
<code class="docutils literal"><span class="pre">GeoMesaIndexedBlobStore</span></code> interface for Accumulo as well as an
implementation of the <code class="docutils literal"><span class="pre">BlobStore</span></code> interface for Accumulo, the
<code class="docutils literal"><span class="pre">AccumuloBlobStoreImpl</span></code> class. The <code class="docutils literal"><span class="pre">GeoMesaAccumuloBlobStore</span></code>
utilizes a GeoMesa Accumulo DataStore as well as the
<code class="docutils literal"><span class="pre">AccumuloBlobStoreImpl</span></code> for the Blob persistance layer.</p>
<p>File retrieval is a two-step process. First a query is made to the
GeoMesa <code class="docutils literal"><span class="pre">FeatureStore</span></code>. The returned <code class="docutils literal"><span class="pre">SimpleFeature</span></code>s will contain
a URI field. That URI points to the desired file stored in Accumulo, and
can be retrieved by the <code class="docutils literal"><span class="pre">GeoMesaIndexedBlobStore</span></code> API or by the REST
interface.</p>
</div>
<div class="section" id="rest-api">
<h2>13.5. REST API<a class="headerlink" href="#rest-api" title="Permalink to this headline">¶</a></h2>
<p>The GeoMesa BlobStore comes with a RESTful web interface servlet that can be used in place of more direct programmatic access via the Java and Scala classes.
As of now the the BlobStore only provides an interface to an Accumulo backed DataStore and BlobStore. Once the servlet is deployed the RESTful api for the Blobstore can be easily utilized via cURL.</p>
<p>DataStores are managed by assigning them to aliases, this allows users to connect to multiple blobstores.
To Register a GeoMesa Blob Store to an alias (in this case myBlobStore):</p>
<div class="highlight-bash"><div class="highlight"><pre>curl -d <span class="s1">&#39;instanceId=myCloud&#39;</span> -d <span class="s1">&#39;zookeepers=zoo1,zoo2,zoo3&#39;</span> -d <span class="s1">&#39;tableName=myBlobStore&#39;</span> -d <span class="s1">&#39;user=user&#39;</span> -d <span class="s1">&#39;password=password&#39;</span> http://localhost:8080/geoserver/geomesa/blobstore/ds/myBlobStore
</pre></div>
</div>
<p>Other Blob Store commands:</p>
<ul class="simple">
<li>DELETE /ds/:alias - Delete a previously registered GeoMesa data store</li>
<li>GET /ds/:alias - Display a registered GeoMesa data store</li>
<li>GET /ds/ - Display all registered BlobStores</li>
</ul>
<p>To ingest a file:</p>
<div class="highlight-bash"><div class="highlight"><pre>curl -X POST -F <span class="nv">file</span><span class="o">=</span>@filename.whatever http://localhost:8080/geoserver/geomesa/blobstore/blob/:alias
</pre></div>
</div>
<p>To GET a file with the original filename preserved via id, run:</p>
<div class="highlight-bash"><div class="highlight"><pre>curl -JO http://localhost:8080/geoserver/geomesa/blobstore/blob/:alias/some-id/
</pre></div>
</div>
<p>The Blobstore servlet also has optional GZip support which can be used
by adding the <code class="docutils literal"><span class="pre">--compressed</span></code> cURL parameter.</p>
<div class="highlight-bash"><div class="highlight"><pre>curl --compressed -JO http://localhost:8080/geoserver/geomesa/blobstore/blob/:alias/some-id
</pre></div>
</div>
<p>To DELETE a file from the blobstore, you must do so by id:</p>
<div class="highlight-bash"><div class="highlight"><pre>curl -X <span class="s2">&quot;DELETE&quot;</span> http://localhost:8080/geoserver/geomesa/blobstore/blob/:alias/some-id
</pre></div>
</div>
</div>
<div class="section" id="servlet-configuration-options">
<h2>13.6. Servlet Configuration Options<a class="headerlink" href="#servlet-configuration-options" title="Permalink to this headline">¶</a></h2>
<p>File upload constraints for the <code class="docutils literal"><span class="pre">BlobstoreServlet</span></code> can be configured with
the following system properties:</p>
<div class="highlight-bash"><div class="highlight"><pre>org.locationtech.geomesa.blob.api.maxFileSizeMB    <span class="o">(</span>defaults to 50MB<span class="o">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre>org.locationtech.geomesa.blob.api.maxRequestSizeMB <span class="o">(</span>defaults to 100MB<span class="o">)</span>
</pre></div>
</div>
<p>The expected unit for these properties is in MB, so setting
<code class="docutils literal"><span class="pre">org.locationtech.geomesa.blob.api.maxFileSizeMB=10</span></code> will result in a
10MB maxFileSize.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="convert/index.html" class="btn btn-neutral float-right" title="14. GeoMesa Convert" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="geoserver.html" class="btn btn-neutral" title="12. GeoServer Plugins" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2017 Commonwealth Computer Research, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.2-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../_static/sphinx_tabs/tabs.js"></script>
      <script type="text/javascript" src="../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>