

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GeoMesa Native API &mdash; GeoMesa 1.3.0-m2-SNAPSHOT Manuals</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
  

  

  
    <link rel="top" title="GeoMesa 1.3.0-m2-SNAPSHOT Manuals" href="../index.html"/>
        <link rel="up" title="Modules and Libraries" href="modules.html"/>
        <link rel="next" title="GeoMesa Processes" href="process.html"/>
        <link rel="prev" title="GeoMesa Metrics" href="metrics.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.3.0-m2-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation_and_configuration.html">Installation and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastores.html">GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo_datastore.html">Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka_datastore.html">Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="hbase_datastore.html">HBase/Bigtable Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra_datastore.html">Cassandra Data Store</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">Modules and Libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="blobstore.html">GeoMesa Blob Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="convert.html">GeoMesa Convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html">GeoMesa Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html">GeoMesa Metrics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">GeoMesa Native API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="process.html">GeoMesa Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="raster.html">GeoMesa Raster</a></li>
<li class="toctree-l3"><a class="reference internal" href="stream.html">GeoMesa Stream Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">GeoMesa Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="web_data.html">GeoMesa Web Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">GeoMesa GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark.html">GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="commandline_tools.html">Command Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_management.html">Data Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">GeoMesa</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">User Manual</a> &raquo;</li>
      
          <li><a href="modules.html">Modules and Libraries</a> &raquo;</li>
      
    <li>GeoMesa Native API</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user/native_api.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geomesa-native-api">
<h1>GeoMesa Native API<a class="headerlink" href="#geomesa-native-api" title="Permalink to this headline">¶</a></h1>
<p>The GeoMesa Native API (<code class="docutils literal"><span class="pre">geomesa-native-api</span></code> in the source distribution) is for developers who prefer not to use GeoTools interfaces and just want to geo index their
data.  It exposes a simple interface for persisting and querying GeoMesa as well as a simple integration point with
Geoserver in cases where OGC access is still desired.</p>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To interact with the GeoMesa Native API, instantiate an instance of a <code class="docutils literal"><span class="pre">GeoMesaIndex&lt;T&gt;</span></code> with your payload type <code class="docutils literal"><span class="pre">T</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">GeoMesaIndex</span><span class="o">&lt;</span><span class="n">DomainObject</span><span class="o">&gt;</span> <span class="n">index</span> <span class="o">=</span>
                <span class="n">AccumuloGeoMesaIndex</span><span class="o">.</span><span class="na">build</span><span class="o">(</span>
                    <span class="s">&quot;hello&quot;</span><span class="o">,</span>
                    <span class="s">&quot;zoo1:2181&quot;</span><span class="o">,</span>
                    <span class="s">&quot;mycloud&quot;</span><span class="o">,</span>
                    <span class="s">&quot;myuser&quot;</span><span class="o">,</span> <span class="s">&quot;mypass&quot;</span><span class="o">,</span>
                    <span class="kc">true</span><span class="o">,</span>
                    <span class="k">new</span> <span class="n">DomainObjectValueSerializer</span><span class="o">(),</span>
                    <span class="k">new</span> <span class="n">DefaultSimpleFeatureView</span><span class="o">&lt;</span><span class="n">DomainObject</span><span class="o">&gt;(</span><span class="s">&quot;foo&quot;</span><span class="o">));</span>
</pre></div>
</div>
<p>In the code snippet above, we are instantiating an <code class="docutils literal"><span class="pre">AccumuloGeoMesaIndex</span></code> with a type parameter of <code class="docutils literal"><span class="pre">DomainObject</span></code>, the
payload object type that is specific to each usage of the native API.  We have provided a <code class="docutils literal"><span class="pre">DomainObjectValueSerializer</span></code>
an implementation of <code class="docutils literal"><span class="pre">ValueSerializer</span></code> which tells the native API how to convert the domain object into a byte array
payload.  We have also provided a <code class="docutils literal"><span class="pre">DefaultSimpleFeatureView</span></code> which maintains integration with the Geotools infrastructure.
The <code class="docutils literal"><span class="pre">DefaultSimpleFeatureView</span></code> will create a <code class="docutils literal"><span class="pre">SimpleFeatureType</span></code> that contains the geometry, date, and identifier of the
<code class="docutils literal"><span class="pre">DomainObject</span></code> and enable querying based on these attributes.  If you want to enable querying on more attributes from
your domain object, you should create a class that extends <code class="docutils literal"><span class="pre">SimpleFeatureView</span></code> and converts the domain object into a
rich <code class="docutils literal"><span class="pre">SimpleFeature</span></code>.  You can then leverage GeoMesa&#8217;s secondary indexing optimizations on first class attributes.</p>
<p>Persisting data to a <code class="docutils literal"><span class="pre">GeoMesaIndex</span></code> requires utilizing the various <code class="docutils literal"><span class="pre">insert</span></code> methods.  The following code snippet demonstrates
how you can put domain objects into the index.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">final</span> <span class="n">GeometryFactory</span> <span class="n">gf</span> <span class="o">=</span> <span class="n">JTSFactoryFinder</span><span class="o">.</span><span class="na">getGeometryFactory</span><span class="o">();</span>
<span class="n">DomainObject</span> <span class="n">one</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DomainObject</span><span class="o">();</span>
<span class="n">DomainObject</span> <span class="n">two</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DomainObject</span><span class="o">();</span>
<span class="n">index</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span>
    <span class="n">one</span><span class="o">,</span>
    <span class="n">gf</span><span class="o">.</span><span class="na">createPoint</span><span class="o">(</span><span class="k">new</span> <span class="n">Coordinate</span><span class="o">(-</span><span class="mf">78.0</span><span class="o">,</span> <span class="mf">38.0</span><span class="o">)),</span>
    <span class="n">date</span><span class="o">(</span><span class="s">&quot;2016-01-01T12:15:00.000Z&quot;</span><span class="o">));</span>
<span class="n">index</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span>
    <span class="n">two</span><span class="o">,</span>
    <span class="n">gf</span><span class="o">.</span><span class="na">createPoint</span><span class="o">(</span><span class="k">new</span> <span class="n">Coordinate</span><span class="o">(-</span><span class="mf">78.0</span><span class="o">,</span> <span class="mf">40.0</span><span class="o">)),</span>
    <span class="n">date</span><span class="o">(</span><span class="s">&quot;2016-02-01T12:15:00.000Z&quot;</span><span class="o">));</span>
</pre></div>
</div>
<p>The code above will compute an identifier for each of the domain objects.  If you want to control the identifiers,
use the <code class="docutils literal"><span class="pre">insert</span></code> methods with <code class="docutils literal"><span class="pre">id</span></code> in the signature.  If you do not intend to query GeoMesa using the specific identifiers of
your domain object, prefer the method that generates an identifier for you.  The reason is that the identifier chosen by
GeoMesa optimizes the locality properties of the identifier and thus the caching within the underlying database.</p>
<dl class="docutils">
<dt>To query data stored using the GeoMesa Native API, build up a <code class="docutils literal"><span class="pre">GeoMesaQuery</span></code> and pass it to the <code class="docutils literal"><span class="pre">GeoMesaIndex</span></code>.</dt>
<dd>For example, the following code snippet queries GeoMesa on space and time.</dd>
</dl>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">GeoMesaQuery</span> <span class="n">q</span> <span class="o">=</span>
    <span class="n">GeoMesaQuery</span><span class="o">.</span><span class="na">GeoMesaQueryBuilder</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">within</span><span class="o">(-</span><span class="mf">79.0</span><span class="o">,</span> <span class="mf">37.0</span><span class="o">,</span> <span class="o">-</span><span class="mf">77.0</span><span class="o">,</span> <span class="mf">39.0</span><span class="o">)</span>
        <span class="o">.</span><span class="na">during</span><span class="o">(</span><span class="n">date</span><span class="o">(</span><span class="s">&quot;2016-01-01T00:00:00.000Z&quot;</span><span class="o">),</span> <span class="n">date</span><span class="o">(</span><span class="s">&quot;2016-03-01T00:00:00.000Z&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">Iterable</span><span class="o">&lt;</span><span class="n">DomainObject</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
</pre></div>
</div>
<p>If you have used a custom <code class="docutils literal"><span class="pre">SimpleFeatureView</span></code>, you can query on the attributes you&#8217;ve lifted into the <code class="docutils literal"><span class="pre">SimpleFeatureType</span></code>.
For instance, if you have lifted an attribute called <code class="docutils literal"><span class="pre">age</span></code> into the <code class="docutils literal"><span class="pre">SimpleFeatureType</span></code>, you can query on it as follows and
GeoMesa will push the <code class="docutils literal"><span class="pre">age</span></code> predicate down for processing in the database.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">FilterFactory</span> <span class="n">ff</span> <span class="o">=</span> <span class="n">CommonFactoryFinder</span><span class="o">.</span><span class="na">getFilterFactory2</span><span class="o">();</span>
<span class="n">GeoMesaQuery</span> <span class="n">q</span> <span class="o">=</span>
    <span class="n">GeoMesaQuery</span><span class="o">.</span><span class="na">GeoMesaQueryBuilder</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">within</span><span class="o">(-</span><span class="mf">79.0</span><span class="o">,</span> <span class="mf">37.0</span><span class="o">,</span> <span class="o">-</span><span class="mf">77.0</span><span class="o">,</span> <span class="mf">39.0</span><span class="o">)</span>
        <span class="o">.</span><span class="na">during</span><span class="o">(</span><span class="n">date</span><span class="o">(</span><span class="s">&quot;2016-01-01T00:00:00.000Z&quot;</span><span class="o">),</span> <span class="n">date</span><span class="o">(</span><span class="s">&quot;2016-03-01T00:00:00.000Z&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">ff</span><span class="o">.</span><span class="na">greaterThan</span><span class="o">(</span><span class="n">ff</span><span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">&quot;age&quot;</span><span class="o">),</span> <span class="mi">30</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">Iterable</span><span class="o">&lt;</span><span class="n">DomainObject</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="process.html" class="btn btn-neutral float-right" title="GeoMesa Processes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="metrics.html" class="btn btn-neutral" title="GeoMesa Metrics" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2016 Commonwealth Computer Research, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.0-m2-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>