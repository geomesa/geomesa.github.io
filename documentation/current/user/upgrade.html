<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>23. Upgrade Guide &mdash; GeoMesa 4.0.0 Manuals</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/upgrade.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GeoMesa Utils" href="appendix/utils.html" />
    <link rel="prev" title="22. Combined Data Store Views" href="ds_views.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                4.1.0-SNAPSHOT
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo/index.html">15. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka/index.html">17. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis/index.html">18. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem/index.html">19. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgis/index.html">20. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">23. Upgrade Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compatibility-across-versions">23.1. Compatibility Across Versions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#semantic-versioning">23.1.1. Semantic Versioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compatibility">23.1.2. Compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compatibility-matrix">23.1.3. Compatibility Matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-4-0-0-upgrade-guide">23.2. Version 4.0.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#version-compatibility">23.2.1. Version Compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scala-versions">23.2.2. Scala Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geotools-geoserver-versions">23.2.3. GeoTools/GeoServer Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependency-version-upgrades">23.2.4. Dependency Version Upgrades</a></li>
<li class="toctree-l4"><a class="reference internal" href="#removal-of-deprecated-modules">23.2.5. Removal of Deprecated Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#package-changes">23.2.6. Package Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geomesa-nifi-changes">23.2.7. GeoMesa NiFi Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scan-range-changes">23.2.8. Scan Range Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#partitioned-postgis-query-changes">23.2.9. Partitioned PostGIS Query Changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-3-5-0-upgrade-guide">23.3. Version 3.5.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#removal-of-log4j">23.3.1. Removal of Log4j</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kafka-serialization">23.3.2. Kafka Serialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deprecated-modules">23.3.3. Deprecated Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependency-updates">23.3.4. Dependency Updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-3-3-0-upgrade-guide">23.4. Version 3.3.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">23.4.1. Scala Versions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-3-2-0-upgrade-guide">23.5. Version 3.2.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">23.5.1. Scala Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spark-versions">23.5.2. Spark Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">23.5.3. Dependency Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filesystem-data-store-metadata-format-change">23.5.4. FileSystem Data Store Metadata Format Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lambda-data-store-binary-distribution-change">23.5.5. Lambda Data Store Binary Distribution Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#strategydecider-api-update">23.5.6. StrategyDecider API Update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">23.5.7. Deprecated Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deprecated-arrow-output-options">23.5.8. Deprecated Arrow Output Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-3-1-0-upgrade-guide">23.6. Version 3.1.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#maven-type-of-geoserver-plugin-modules">23.6.1. Maven Type of GeoServer Plugin Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#avro-version-update">23.6.2. Avro Version Update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#query-interceptors-api-change">23.6.3. Query Interceptors API Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">23.6.4. Dependency Updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-3-0-0-upgrade-guide">23.7. Version 3.0.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#removal-of-deprecated-modules-and-classes">23.7.1. Removal of Deprecated Modules and Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hbase-2-support">23.7.2. HBase 2 Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accumulo-2-support">23.7.3. Accumulo 2 Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nifi-processors">23.7.4. NiFi Processors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">23.7.5. Dependency Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#apache-arrow-updates">23.7.6. Apache Arrow Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converter-date-functions">23.7.7. Converter Date Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authorizationsprovider-and-auditprovider-api-change">23.7.8. AuthorizationsProvider and AuditProvider API Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accumulo-default-visibilities-removed">23.7.9. Accumulo Default Visibilities Removed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-2-4-0-upgrade-guide">23.8. Version 2.4.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geotools-21-and-geoserver-2-15">23.8.1. GeoTools 21 and GeoServer 2.15</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-of-cached-statistics">23.8.2. Configuration of Cached Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indexing-of-timestamp-attributes">23.8.3. Indexing of Timestamp Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nifi-processor-changes">23.8.4. NiFi Processor Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distribution-of-installation-bundles">23.8.5. Distribution of Installation Bundles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hbase-geoserver-plugin-installation">23.8.6. HBase GeoServer Plugin Installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-2-3-0-upgrade-guide">23.9. Version 2.3.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#default-query-planning-type">23.9.1. Default Query Planning Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#immutable-simple-feature-types">23.9.2. Immutable Simple Feature Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filesystem-storage-api-changes">23.9.3. FileSystem Storage API Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">23.9.4. Deprecated Modules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-2-2-0-upgrade-guide">23.10. Version 2.2.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geotools-20-and-geoserver-2-14">23.10.1. GeoTools 20 and GeoServer 2.14</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accumulo-datastore-geoserver-installation">23.10.2. Accumulo DataStore GeoServer Installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-2-1-0-upgrade-guide">23.11. Version 2.1.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#converter-updates">23.11.1. Converter Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distributed-runtime-version-checks">23.11.2. Distributed Runtime Version Checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shapefile-ingestion">23.11.3. Shapefile Ingestion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delimited-text-auto-ingestion">23.11.4. Delimited Text Auto-Ingestion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">23.11.5. FileSystem Storage API Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spark-version-update">23.11.6. Spark Version Update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arrow-version-update">23.11.7. Arrow Version Update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scalatra-version-update">23.11.8. Scalatra Version Update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#version-2-0-0-upgrade-guide">23.12. Version 2.0.0 Upgrade Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geotools-18-and-geoserver-2-12">23.12.1. GeoTools 18 and GeoServer 2.12</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-store-parameters">23.12.2. Data Store Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#removal-of-joda-time">23.12.3. Removal of Joda Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saxon-xml-parser">23.12.4. Saxon XML Parser</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kafka-data-store">23.12.5. Kafka Data Store</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accumulo-standardization">23.12.6. Accumulo Standardization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#table-splitters">23.12.7. Table Splitters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-properties">23.12.8. System Properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Manual</a></li>
      <li class="breadcrumb-item active"><span class="section-number">23. </span>Upgrade Guide</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="upgrade-guide">
<span id="id1"></span><h1><span class="section-number">23. </span>Upgrade Guide<a class="headerlink" href="#upgrade-guide" title="Permalink to this headline">¶</a></h1>
<p>This section contains general information on version upgrades, as well as version-specific changes that may
affect the end user.</p>
<section id="compatibility-across-versions">
<h2><span class="section-number">23.1. </span>Compatibility Across Versions<a class="headerlink" href="#compatibility-across-versions" title="Permalink to this headline">¶</a></h2>
<section id="semantic-versioning">
<h3><span class="section-number">23.1.1. </span>Semantic Versioning<a class="headerlink" href="#semantic-versioning" title="Permalink to this headline">¶</a></h3>
<p>Starting with 2.0.0, GeoMesa is adhering to <a class="reference external" href="https://semver.org/">semantic versioning</a>. Essentially,
releases are broken down into major, minor and patch versions. For a version number like 2.0.1, 2 is the major
version, 2.0 is the minor version, and 2.0.1 is the patch version.</p>
<p>Major version updates contain breaking public API changes. Minor version updates contain new or updated functionality
that is backwards-compatible. Patch versions contain only backwards-compatible bug fixes. This delineation allows
users to gauge the potential impact of updating versions.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Versions prior to 2.0.0 do not follow semantic versioning, and each release should be
considered a major version change.</p>
</div>
</section>
<section id="compatibility">
<h3><span class="section-number">23.1.2. </span>Compatibility<a class="headerlink" href="#compatibility" title="Permalink to this headline">¶</a></h3>
<p>Semantic versioning makes API guarantees, but GeoMesa has several compatibility vectors to consider:</p>
<section id="data-compatibility">
<h4><span class="section-number">23.1.2.1. </span>Data Compatibility<a class="headerlink" href="#data-compatibility" title="Permalink to this headline">¶</a></h4>
<p>Data compatibility refers to the ability to read and write data written with older versions of GeoMesa. GeoMesa
fully supports data written with version 1.2.2 or later, and mostly supports data written with 1.1.0 or later.</p>
<p>Note that although later versions can read earlier data, the reverse is not necessarily true. Data written
with a newer client may not be readable by an older client.</p>
<p>Data written with 1.2.1 or earlier can be migrated to a newer data format. See <a class="reference internal" href="accumulo/index_config.html#index-upgrades"><span class="std std-ref">Upgrading Existing Indices</span></a> for details
(note that this functionality is currently only implemented for Accumulo).</p>
</section>
<section id="api-compatibility">
<h4><span class="section-number">23.1.2.2. </span>API Compatibility<a class="headerlink" href="#api-compatibility" title="Permalink to this headline">¶</a></h4>
<p>The GeoMesa public API is not currently well defined, so API compatibility is only guaranteed at the GeoTools
<a class="reference external" href="https://docs.geotools.org/stable/javadocs/org/geotools/data/DataStore.html">DataStore</a> level. In the future,
GeoMesa will clearly indicate which classes and methods are part of the public API. Non-public classes may change
without warning between minor versions.</p>
</section>
<section id="binary-compatibility">
<h4><span class="section-number">23.1.2.3. </span>Binary Compatibility<a class="headerlink" href="#binary-compatibility" title="Permalink to this headline">¶</a></h4>
<p>Binary compatibility refers to the ability to have different GeoMesa versions in a single environment. An environment
may be a single process or span multiple servers (for example an ingest pipeline, a query client, and an analytics
platform). For data stores with a distributed component (HBase and Accumulo), the environment includes both the
client and the distributed code.</p>
<p>GeoMesa requires that all JARs in an environment are the same minor version, and that all JARs within a single JVM
are the same patch version.</p>
</section>
<section id="dependency-compatibility">
<h4><span class="section-number">23.1.2.4. </span>Dependency Compatibility<a class="headerlink" href="#dependency-compatibility" title="Permalink to this headline">¶</a></h4>
<p>Dependency compatibility refers to the ability to update GeoMesa without updating other components
(e.g. Accumulo, HBase, Hadoop, Spark, GeoServer, etc). Generally, GeoMesa supports a range of dependency versions
(e.g. Accumulo 1.6 to 1.9). Spark versions are more tightly coupled, due to the use of private Spark APIs.</p>
</section>
<section id="pre-release-code">
<h4><span class="section-number">23.1.2.5. </span>Pre-Release Code<a class="headerlink" href="#pre-release-code" title="Permalink to this headline">¶</a></h4>
<p>GeoMesa sometimes provides modules in an alpha or beta state. Although they share the overall GeoMesa version number,
such modules should be considered pre-1.0, and are not guaranteed to provide any forwards or backwards compatibility
across versions. Pre-release modules will be clearly marked in the documentation.</p>
</section>
</section>
<section id="compatibility-matrix">
<h3><span class="section-number">23.1.3. </span>Compatibility Matrix<a class="headerlink" href="#compatibility-matrix" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Major</p></th>
<th class="head"><p>Minor</p></th>
<th class="head"><p>Patch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Data</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-odd"><td><p>API</p></td>
<td><p>N</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-even"><td><p>Binary</p></td>
<td><p>N</p></td>
<td><p>N</p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-odd"><td><p>Dependencies</p></td>
<td><p>N</p></td>
<td><p>N</p></td>
<td><p>Y</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="version-4-0-0-upgrade-guide">
<h2><span class="section-number">23.2. </span>Version 4.0.0 Upgrade Guide<a class="headerlink" href="#version-4-0-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="version-compatibility">
<h3><span class="section-number">23.2.1. </span>Version Compatibility<a class="headerlink" href="#version-compatibility" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 4.0.0 is focused on upgrading dependency versions and removing deprecated features, and only contains
a few new features. To make upgrading easier, version 4.0.x is generally compatible with version 3.5.x across
different environments. This means that it is possible to upgrade in parts; i.e. upgrade GeoServer to 4.0.0
but keep NiFi at 3.5.1. Please note that previously deprecated functionality (see below) may no longer work once
any part of the environment is upgraded to 4.0.0.</p>
</section>
<section id="scala-versions">
<h3><span class="section-number">23.2.2. </span>Scala Versions<a class="headerlink" href="#scala-versions" title="Permalink to this headline">¶</a></h3>
<p>Scala 2.11 support has been removed, and Scala 2.13 support has been added (in addition to the existing
Scala 2.12 support).</p>
</section>
<section id="geotools-geoserver-versions">
<h3><span class="section-number">23.2.3. </span>GeoTools/GeoServer Versions<a class="headerlink" href="#geotools-geoserver-versions" title="Permalink to this headline">¶</a></h3>
<p>GeoTools has been upgraded from <code class="docutils literal notranslate"><span class="pre">23.3</span></code> to <code class="docutils literal notranslate"><span class="pre">28.2</span></code>. GeoServer has been upgrade from <code class="docutils literal notranslate"><span class="pre">2.17.3</span></code> to <code class="docutils literal notranslate"><span class="pre">2.22.2</span></code>.
JTS has been upgraded from <code class="docutils literal notranslate"><span class="pre">1.17.0</span></code> to <code class="docutils literal notranslate"><span class="pre">1.19.0</span></code>.</p>
<p>As part of this upgrade, various GeoTools methods have changed in incompatible ways. Several classes, in
particular <code class="docutils literal notranslate"><span class="pre">Query</span></code> and <code class="docutils literal notranslate"><span class="pre">SimpleFeatureBuilder</span></code>, have changed from accepting arrays to using varargs (variable
arguments). Additionally, the various <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> methods, such as <code class="docutils literal notranslate"><span class="pre">DataStoreFinder</span></code>, now require
<code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">?&gt;</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">?</span> <span class="pre">extends</span> <span class="pre">Serializable&gt;</span></code>.</p>
</section>
<section id="dependency-version-upgrades">
<h3><span class="section-number">23.2.4. </span>Dependency Version Upgrades<a class="headerlink" href="#dependency-version-upgrades" title="Permalink to this headline">¶</a></h3>
<p>The following high-level dependencies have been upgraded:</p>
<ul class="simple">
<li><p>Apache Hadoop <code class="docutils literal notranslate"><span class="pre">2.8.5</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">2.10.2</span></code></p></li>
<li><p>Apache Spark <code class="docutils literal notranslate"><span class="pre">2.4.7</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">3.3.1</span></code></p></li>
<li><p>Apache Accumulo <code class="docutils literal notranslate"><span class="pre">2.0.0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">2.0.1</span></code></p></li>
<li><p>Apache HBase <code class="docutils literal notranslate"><span class="pre">1.4.12</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.4.14</span></code>, <code class="docutils literal notranslate"><span class="pre">2.2.3</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">2.5.2</span></code></p></li>
<li><p>Apache Kafka <code class="docutils literal notranslate"><span class="pre">2.1.1</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">2.8.2</span></code></p></li>
<li><p>Apache Arrow <code class="docutils literal notranslate"><span class="pre">0.16.0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">11.0.0</span></code></p></li>
<li><p>Apache Avro <code class="docutils literal notranslate"><span class="pre">1.8.2</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.11.1</span></code></p></li>
<li><p>Apache Parquet <code class="docutils literal notranslate"><span class="pre">1.9.0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.12.3</span></code></p></li>
<li><p>Apache Orc <code class="docutils literal notranslate"><span class="pre">1.5.4</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.8.2</span></code></p></li>
<li><p>Jedis <code class="docutils literal notranslate"><span class="pre">3.0.1</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">4.3.1</span></code></p></li>
<li><p>Confluent <code class="docutils literal notranslate"><span class="pre">5.1.0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">6.2.7</span></code></p></li>
<li><p>Kryo <code class="docutils literal notranslate"><span class="pre">3.0.3</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">4.0.2</span></code></p></li>
<li><p>Typesafe Config <code class="docutils literal notranslate"><span class="pre">1.3.3</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.4.2</span></code></p></li>
<li><p>EJML <code class="docutils literal notranslate"><span class="pre">0.34</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">0.41</span></code></p></li>
<li><p>Saxon <code class="docutils literal notranslate"><span class="pre">9.7.0-20</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">11.4</span></code></p></li>
</ul>
<p>For a full changelist of all dependencies, see the diff
<a class="reference external" href="https://gist.github.com/elahrvivaz/f86d31f78b57bf92113c16661a886c12/revisions?diff=split">here</a>.</p>
</section>
<section id="removal-of-deprecated-modules">
<h3><span class="section-number">23.2.5. </span>Removal of Deprecated Modules<a class="headerlink" href="#removal-of-deprecated-modules" title="Permalink to this headline">¶</a></h3>
<p>The following deprecated modules were removed:</p>
<ul class="simple">
<li><p>geomesa-bigtable</p></li>
<li><p>geomesa-kudu</p></li>
<li><p>geomesa-stream</p></li>
<li><p>geomesa-geojson</p></li>
<li><p>geomesa-web</p></li>
<li><p>geomesa-feature-nio</p></li>
<li><p>geomesa-convert-metrics-cloudwatch</p></li>
<li><p>geomesa-convert-metrics-ganglia</p></li>
<li><p>geomesa-convert-metrics-graphite</p></li>
</ul>
<p>In addition, various other deprecated classes and methods were removed. To identify any code that requires changes,
build your project against GeoMesa 3.5.1 and note any deprecation warnings generated by the compiler.</p>
</section>
<section id="package-changes">
<h3><span class="section-number">23.2.6. </span>Package Changes<a class="headerlink" href="#package-changes" title="Permalink to this headline">¶</a></h3>
<p>The following packages were moved, renamed or split in order to support Java 11 modules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.jobs.accumulo</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.accumulo.jobs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.spark.accumulo</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.accumulo.spark</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.spark.hbase</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.hbase.spark</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.arrow.vector</span></code> (partial) -&gt; <code class="docutils literal notranslate"><span class="pre">package</span> <span class="pre">org.locationtech.geomesa.arrow.jts</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.parquet</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.fs.storage.parquet</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.process</span></code> (partial) -&gt; <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.process.wps</span></code></p></li>
</ul>
</section>
<section id="geomesa-nifi-changes">
<h3><span class="section-number">23.2.7. </span>GeoMesa NiFi Changes<a class="headerlink" href="#geomesa-nifi-changes" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa NiFi is now built against NiFi 1.19.1. The GeoMesa NARs and JARs have been renamed to include the Scala
version (i.e. <code class="docutils literal notranslate"><span class="pre">geomesa-datastore-services-nar_2.12-4.0.0.nar</span></code>). The datastore-specific processors (e.g.
<code class="docutils literal notranslate"><span class="pre">PutGeoMesaHBase</span></code>) have been removed in favor of the generic processors (e.g. <code class="docutils literal notranslate"><span class="pre">PutGeoMesa</span></code>). The
recommended upgrade path is to first upgrade to GeoMesa NiFi 3.5.1, and replace all the datastore-specific
processors in the flow. This will ensure that the flow is still valid after upgrading to GeoMesa NiFi 4.0.0.
The <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo2-nar</span></code> has been replaced with <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo20-nar</span></code>, and there is an additional
<code class="docutils literal notranslate"><span class="pre">geomesa-accumulo21-nar</span></code> for Accumulo 2.1 support.</p>
</section>
<section id="scan-range-changes">
<h3><span class="section-number">23.2.8. </span>Scan Range Changes<a class="headerlink" href="#scan-range-changes" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa will now generate a more accurate number of ranges based on <code class="docutils literal notranslate"><span class="pre">geomesa.scan.ranges.target</span></code>. Users
who have configured this property should verify their setting is still appropriate, especially if set to a
large value. Setting <code class="docutils literal notranslate"><span class="pre">geomesa.scan.ranges.recurse</span></code> to <code class="docutils literal notranslate"><span class="pre">7</span></code> will restore the old behavior if needed.</p>
</section>
<section id="partitioned-postgis-query-changes">
<h3><span class="section-number">23.2.9. </span>Partitioned PostGIS Query Changes<a class="headerlink" href="#partitioned-postgis-query-changes" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa will now ignore queries that encompass the entire world in the partitioned PostGIS data store. For more
information, refer to <a class="reference internal" href="postgis/index_config.html#postgis-filter-world"><span class="std std-ref">Configuring Filter Optimizations</span></a>.</p>
</section>
</section>
<section id="version-3-5-0-upgrade-guide">
<h2><span class="section-number">23.3. </span>Version 3.5.0 Upgrade Guide<a class="headerlink" href="#version-3-5-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="removal-of-log4j">
<h3><span class="section-number">23.3.1. </span>Removal of Log4j<a class="headerlink" href="#removal-of-log4j" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa has been updated to ban all usages of <code class="docutils literal notranslate"><span class="pre">log4j</span></code>, to mitigate various CVEs present in that framework. In
most cases, GeoMesa uses <code class="docutils literal notranslate"><span class="pre">slf4j</span></code>, and delegates to the logging framework of the runtime environment.
However, this change impacts the JARs bundled with the command-line tools, which now ship with
<a class="reference external" href="https://reload4j.qos.ch/">reload4j</a> instead. Other environments using GeoMesa (i.e. GeoServer) must be
hardened independently.</p>
</section>
<section id="kafka-serialization">
<h3><span class="section-number">23.3.2. </span>Kafka Serialization<a class="headerlink" href="#kafka-serialization" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa Kafka data store now supports a new serialization format, <code class="docutils literal notranslate"><span class="pre">avro-native</span></code>. This format uses Avro
array and map types for <code class="docutils literal notranslate"><span class="pre">List</span></code> and <code class="docutils literal notranslate"><span class="pre">Map</span></code> type attributes, which makes it easier to read with standard Avro
tools. Note that GeoMesa versions before 3.5.0 will not be able to consume topics written in this format.</p>
</section>
<section id="deprecated-modules">
<h3><span class="section-number">23.3.3. </span>Deprecated Modules<a class="headerlink" href="#deprecated-modules" title="Permalink to this headline">¶</a></h3>
<p>The following modules have been deprecated, and will be removed in a future version:</p>
<ul class="simple">
<li><p>GeoMesa Bigtable</p></li>
</ul>
</section>
<section id="dependency-updates">
<h3><span class="section-number">23.3.4. </span>Dependency Updates<a class="headerlink" href="#dependency-updates" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>org.slf4j:slf4j-api: <code class="docutils literal notranslate"><span class="pre">1.7.25</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.7.36</span></code></p></li>
<li><p>com.google.code.gson:gson: <code class="docutils literal notranslate"><span class="pre">2.8.1</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">2.8.9</span></code></p></li>
</ul>
</section>
</section>
<section id="version-3-3-0-upgrade-guide">
<h2><span class="section-number">23.4. </span>Version 3.3.0 Upgrade Guide<a class="headerlink" href="#version-3-3-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="id2">
<h3><span class="section-number">23.4.1. </span>Scala Versions<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa NiFi NARs now ship with Scala 2.12 by default. This should be largely transparent to end-users, however
any custom GeoMesa converter JARs used in NiFi and written in Scala will need to be compiled with Scala 2.12.</p>
</section>
</section>
<section id="version-3-2-0-upgrade-guide">
<h2><span class="section-number">23.5. </span>Version 3.2.0 Upgrade Guide<a class="headerlink" href="#version-3-2-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="id3">
<h3><span class="section-number">23.5.1. </span>Scala Versions<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa now supports Scala 2.12. Scala 2.11 support has been deprecated and will be removed in a future version.</p>
</section>
<section id="spark-versions">
<h3><span class="section-number">23.5.2. </span>Spark Versions<a class="headerlink" href="#spark-versions" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa now supports Spark 3.0 and 3.1. Support for Spark 2.3 and 2.4 has been deprecated and will be removed
in a future version.</p>
</section>
<section id="id4">
<h3><span class="section-number">23.5.3. </span>Dependency Updates<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>com.fasterxml.jackson: <code class="docutils literal notranslate"><span class="pre">2.9.10</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">2.12.1</span></code></p></li>
</ul>
</section>
<section id="filesystem-data-store-metadata-format-change">
<h3><span class="section-number">23.5.4. </span>FileSystem Data Store Metadata Format Change<a class="headerlink" href="#filesystem-data-store-metadata-format-change" title="Permalink to this headline">¶</a></h3>
<p>The metadata format for the FileSystem data store has been changed to support storing arbitrary key-value pairs.
Any data written with version 3.2.0 or later will not be readable by earlier GeoMesa versions.</p>
</section>
<section id="lambda-data-store-binary-distribution-change">
<h3><span class="section-number">23.5.5. </span>Lambda Data Store Binary Distribution Change<a class="headerlink" href="#lambda-data-store-binary-distribution-change" title="Permalink to this headline">¶</a></h3>
<p>The Lambda data store binary distribution no longer contains the <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo-distributed-runtime</span></code> JAR.
This JAR is available in the Accumulo data store binary distribution.</p>
</section>
<section id="strategydecider-api-update">
<h3><span class="section-number">23.5.6. </span>StrategyDecider API Update<a class="headerlink" href="#strategydecider-api-update" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.index.planning.StrategyDecider</span></code> API has been extended with an optional
<code class="docutils literal notranslate"><span class="pre">GeoMesaStats</span></code> argument that enables stat-based strategy decisions. The old API method has been deprecated
and will be removed in a future version.</p>
</section>
<section id="id5">
<h3><span class="section-number">23.5.7. </span>Deprecated Modules<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The following modules have been deprecated, and will be removed in a future version:</p>
<ul class="simple">
<li><p>GeoMesa Kudu</p></li>
<li><p>GeoMesa Streaming (Camel integration)</p></li>
<li><p>GeoMesa Web</p></li>
<li><p>GeoMesa GeoJSON</p></li>
</ul>
</section>
<section id="deprecated-arrow-output-options">
<h3><span class="section-number">23.5.8. </span>Deprecated Arrow Output Options<a class="headerlink" href="#deprecated-arrow-output-options" title="Permalink to this headline">¶</a></h3>
<p>The Arrow output options for providing cached dictionaries, returning multiple logical files, and running
queries in two passes have been deprecated and will be removed in the next major version.</p>
</section>
</section>
<section id="version-3-1-0-upgrade-guide">
<h2><span class="section-number">23.6. </span>Version 3.1.0 Upgrade Guide<a class="headerlink" href="#version-3-1-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="maven-type-of-geoserver-plugin-modules">
<h3><span class="section-number">23.6.1. </span>Maven Type of GeoServer Plugin Modules<a class="headerlink" href="#maven-type-of-geoserver-plugin-modules" title="Permalink to this headline">¶</a></h3>
<p>All of the <code class="docutils literal notranslate"><span class="pre">geomesa-*-gs-plugin</span></code> artifacts have been changed to <code class="docutils literal notranslate"><span class="pre">&lt;type&gt;pom&lt;/type&gt;</span></code>, since they did not
contain any code. Any <code class="docutils literal notranslate"><span class="pre">pom.xml</span></code> references to them should be updated to use the correct type.</p>
</section>
<section id="avro-version-update">
<h3><span class="section-number">23.6.2. </span>Avro Version Update<a class="headerlink" href="#avro-version-update" title="Permalink to this headline">¶</a></h3>
<p>The version of Avro used by GeoMesa has been updated from 1.7.5 to 1.8.2. Avro serialized files should
be compatible between versions, but compile and runtime dependencies may need to be updated if a project
uses Avro and references GeoMesa.</p>
</section>
<section id="query-interceptors-api-change">
<h3><span class="section-number">23.6.3. </span>Query Interceptors API Change<a class="headerlink" href="#query-interceptors-api-change" title="Permalink to this headline">¶</a></h3>
<p>The query interceptors API has been expanded to support query guards. Any existing query interceptor
implementations will continue to work, but may need to be re-compiled against the GeoMesa 3.1.0.</p>
</section>
<section id="id6">
<h3><span class="section-number">23.6.4. </span>Dependency Updates<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>GeoTools: <code class="docutils literal notranslate"><span class="pre">23.0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">23.3</span></code></p></li>
<li><p>Avro: <code class="docutils literal notranslate"><span class="pre">1.7.5</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">1.8.2</span></code></p></li>
</ul>
</section>
</section>
<section id="version-3-0-0-upgrade-guide">
<h2><span class="section-number">23.7. </span>Version 3.0.0 Upgrade Guide<a class="headerlink" href="#version-3-0-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="removal-of-deprecated-modules-and-classes">
<h3><span class="section-number">23.7.1. </span>Removal of Deprecated Modules and Classes<a class="headerlink" href="#removal-of-deprecated-modules-and-classes" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 3.0.0 removes several lesser-used modules, as well as various obsolete classes and methods.</p>
<p>The modules removed are: <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-compute</span></code>,
<code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-native-api</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-raster-distributed-runtime</span></code>,
<code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-raster</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-security</span></code>,
<code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-stats-gs-plugin</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-convert/geomesa-convert-scripting</span></code>,
<code class="docutils literal notranslate"><span class="pre">geomesa-convert/geomesa-convert-simplefeature</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-hbase/geomesa-hbase-native-api</span></code>,
<code class="docutils literal notranslate"><span class="pre">geomesa-metrics</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-native-api</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-spark/geomesa-spark-geotools</span></code>, <code class="docutils literal notranslate"><span class="pre">geomesa-blobstore/*</span></code>, and
<code class="docutils literal notranslate"><span class="pre">geomesa-web/geomesa-web-data</span></code>.</p>
<p>The classes and methods removed are detailed in <a class="reference external" href="https://geomesa.atlassian.net/browse/GEOMESA-2284">GEOMESA-2284</a>.</p>
</section>
<section id="hbase-2-support">
<h3><span class="section-number">23.7.2. </span>HBase 2 Support<a class="headerlink" href="#hbase-2-support" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 3.0.0 supports both HBase 1.4 and HBase 2.2. HBase 1.3 is no longer supported. HBase 2.0 and 2.1 are
not officially supported, but may work in some cases.</p>
<p>There are now two separate modules for HBase filters and coprocessors - <code class="docutils literal notranslate"><span class="pre">geomesa-hbase-distributed-runtime-hbase1</span></code>
and <code class="docutils literal notranslate"><span class="pre">geomesa-hbase-distributed-runtime-hbase2</span></code>. The previous <code class="docutils literal notranslate"><span class="pre">geomesa-hbase-distributed-runtime</span></code> module has
been removed. Users should install the distributed runtime corresponding to their HBase installation.</p>
<p>Similarly, there are now two separate modules for HBase Spark support - <code class="docutils literal notranslate"><span class="pre">geomesa-hbase-spark-runtime-hbase1</span></code> and
<code class="docutils literal notranslate"><span class="pre">geomesa-hbase-spark-runtime-hbase2</span></code>. The previous <code class="docutils literal notranslate"><span class="pre">geomesa-hbase-spark-runtime</span></code> module has been removed.
Users should use the Spark runtime corresponding to their HBase installation.</p>
</section>
<section id="accumulo-2-support">
<h3><span class="section-number">23.7.3. </span>Accumulo 2 Support<a class="headerlink" href="#accumulo-2-support" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 3.0.0 supports both Accumulo 1.9 with Hadoop 2.8 and Accumulo 2.0 with Hadoop 3.
Earlier versions of Accumulo are no longer supported, but may work in some cases.</p>
<p>There are now two separate modules for Accumulo Spark support - <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo-spark-runtime-accumulo1</span></code> and
<code class="docutils literal notranslate"><span class="pre">geomesa-accumulo-spark-runtime-accumulo2</span></code>. The previous <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo-spark-runtime</span></code> module has been removed.
Users should use the Spark runtime corresponding to their Accumulo installation.</p>
</section>
<section id="nifi-processors">
<h3><span class="section-number">23.7.4. </span>NiFi Processors<a class="headerlink" href="#nifi-processors" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa NiFi processors have been updated to NiFi 11 and split out into separate <code class="docutils literal notranslate"><span class="pre">nar</span></code> files for each
supported back-end database. Additionally, there are separate <code class="docutils literal notranslate"><span class="pre">nar</span></code> files for HBase 1.4/2.2 and Accumulo 1.9/2.0,
respectively. The processor classes and configurations have also changed. See <a class="reference internal" href="nifi/index.html#nifi-bundle"><span class="std std-ref">GeoMesa NiFi Bundle</span></a> for details.</p>
</section>
<section id="id7">
<h3><span class="section-number">23.7.5. </span>Dependency Updates<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Apache Arrow: <code class="docutils literal notranslate"><span class="pre">0.10</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">0.16</span></code></p></li>
</ul>
</section>
<section id="apache-arrow-updates">
<h3><span class="section-number">23.7.6. </span>Apache Arrow Updates<a class="headerlink" href="#apache-arrow-updates" title="Permalink to this headline">¶</a></h3>
<p>As part of the upgrade to Apache Arrow 0.16, the geomesa-arrow modules have been refactored to simplify memory
management and allocation. Some classes have been removed, and some interfaces have changed. This may impact
anyone using the geomesa-arrow modules directly.</p>
<p>The Arrow IPC format changed in Arrow 0.15. Older clients may not be able to read Arrow-encoded results by
default. To enabled the ‘legacy’ Arrow IPC format, set the system property <code class="docutils literal notranslate"><span class="pre">geomesa.arrow.format.version</span></code>
to <code class="docutils literal notranslate"><span class="pre">0.10</span></code>, or use the query hint <code class="docutils literal notranslate"><span class="pre">ARROW_FORMAT_VERSION</span></code>. See <a class="reference internal" href="datastores/analytic_queries.html#arrow-encoding"><span class="std std-ref">Arrow Encoding</span></a> for details.</p>
</section>
<section id="converter-date-functions">
<h3><span class="section-number">23.7.7. </span>Converter Date Functions<a class="headerlink" href="#converter-date-functions" title="Permalink to this headline">¶</a></h3>
<p>The converter functions <code class="docutils literal notranslate"><span class="pre">isoDate</span></code> and <code class="docutils literal notranslate"><span class="pre">isoDateTime</span></code> have been updated to match the equivalent Java
<code class="docutils literal notranslate"><span class="pre">DateTimeFormatter</span></code> pattern. <code class="docutils literal notranslate"><span class="pre">isoDate</span></code> has changed from <code class="docutils literal notranslate"><span class="pre">yyyyMMdd</span></code> to <code class="docutils literal notranslate"><span class="pre">yyyy-MM-dd</span></code>, while <code class="docutils literal notranslate"><span class="pre">isoDateTime</span></code>
has changed from <code class="docutils literal notranslate"><span class="pre">yyyyMMdd'T'HHmmss.SSSZ</span></code> to <code class="docutils literal notranslate"><span class="pre">yyyy-MM-dd'T'HH:mm:ss</span></code>. The old patterns can still be
referenced through <code class="docutils literal notranslate"><span class="pre">basicDate</span></code> and <code class="docutils literal notranslate"><span class="pre">basicDateTime</span></code>.</p>
</section>
<section id="authorizationsprovider-and-auditprovider-api-change">
<h3><span class="section-number">23.7.8. </span>AuthorizationsProvider and AuditProvider API Change<a class="headerlink" href="#authorizationsprovider-and-auditprovider-api-change" title="Permalink to this headline">¶</a></h3>
<p>The signature for <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.security.AuthorizationsProvider#configure</span></code> and
<code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.utils.audit.AuditProvider#configure</span></code> have changed slightly from
<code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">configure(Map&lt;String,</span> <span class="pre">Serializable&gt;</span> <span class="pre">params)</span></code> to
<code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">void</span> <span class="pre">configure(Map&lt;String,</span> <span class="pre">?</span> <span class="pre">extends</span> <span class="pre">Serializable&gt;</span> <span class="pre">params)</span></code>. Any classes implementing either of these
interfaces will need to update their method signature. Any classes invoking these methods should not need to updated,
as the new signature is compatible with the old one.</p>
</section>
<section id="accumulo-default-visibilities-removed">
<h3><span class="section-number">23.7.9. </span>Accumulo Default Visibilities Removed<a class="headerlink" href="#accumulo-default-visibilities-removed" title="Permalink to this headline">¶</a></h3>
<p>The Accumulo data store parameter <code class="docutils literal notranslate"><span class="pre">geomesa.security.visibilities</span></code> have been removed. Visibilities should be set
per-feature, as described in <a class="reference internal" href="datastores/security.html#data-security"><span class="std std-ref">Data Security</span></a>.</p>
</section>
</section>
<section id="version-2-4-0-upgrade-guide">
<h2><span class="section-number">23.8. </span>Version 2.4.0 Upgrade Guide<a class="headerlink" href="#version-2-4-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="geotools-21-and-geoserver-2-15">
<h3><span class="section-number">23.8.1. </span>GeoTools 21 and GeoServer 2.15<a class="headerlink" href="#geotools-21-and-geoserver-2-15" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.4.0 is compiled against GeoTools 21.1 and GeoServer 2.15. This version of GeoTools contains package
and class location changes to support Java 11. Due to the changes, GeoMesa will no longer work with older
versions of GeoTools and GeoServer.</p>
</section>
<section id="configuration-of-cached-statistics">
<h3><span class="section-number">23.8.2. </span>Configuration of Cached Statistics<a class="headerlink" href="#configuration-of-cached-statistics" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.4.0 moves the configuration of cached stats from a data store parameter (where it has to be set every time)
to the feature type user data (where it is set once at schema creation, and only changed through explicit schema
updates). See <a class="reference internal" href="datastores/index_config.html#stat-config"><span class="std std-ref">Configuring Cached Statistics</span></a> for more details.</p>
<p>Feature types that were created in prior versions will continue to behave as before, with the configuration
determined by the data store parameter each time. The configuration can be set permanently through
the <code class="docutils literal notranslate"><span class="pre">updateSchema</span></code> data store method or the <a class="reference internal" href="cli/schemas.html#cli-update-schema"><span class="std std-ref">update-schema</span></a> CLI command.</p>
</section>
<section id="indexing-of-timestamp-attributes">
<h3><span class="section-number">23.8.3. </span>Indexing of Timestamp Attributes<a class="headerlink" href="#indexing-of-timestamp-attributes" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.4.0 fully supports indexing of <code class="docutils literal notranslate"><span class="pre">java.sql.Timestamp</span></code> attributes. In previous versions, timestamp
attribute indices were not officially supported, however they did work in some cases. Any data that was written to
a timestamp attribute index with an older version will no longer be readable by GeoMesa 2.4.0. To migrate old
data, <strong>truncate the index table</strong> first, then re-write all existing records:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nn">data</span><span class="p">.{</span><span class="nc">DataStoreFinder</span><span class="p">,</span><span class="w"> </span><span class="nc">Query</span><span class="p">,</span><span class="w"> </span><span class="nc">Transaction</span><span class="p">}</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">index</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">GeoMesaDataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">locationtech</span><span class="p">.</span><span class="nn">geomesa</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">geotools</span><span class="p">.</span><span class="nc">FeatureUtils</span>

<span class="kd">val</span><span class="w"> </span><span class="n">params</span><span class="p">:</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="nc">Map</span><span class="p">[</span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="nc">String</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">???</span><span class="w"> </span><span class="c1">// data store connection parameters</span>
<span class="kd">val</span><span class="w"> </span><span class="n">ds</span><span class="p">:</span><span class="w"> </span><span class="nc">GeoMesaDataStore</span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">DataStoreFinder</span><span class="p">.</span><span class="n">getDataStore</span><span class="p">(</span><span class="n">params</span><span class="p">).</span><span class="k">asInstanceOf</span><span class="p">[</span><span class="nc">GeoMesaDataStore</span><span class="p">[</span><span class="n">_</span><span class="p">]]</span>
<span class="kd">val</span><span class="w"> </span><span class="n">typeName</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">???</span><span class="w"> </span><span class="c1">// simple feature type name to update</span>
<span class="kd">val</span><span class="w"> </span><span class="n">timestamps</span><span class="p">:</span><span class="w"> </span><span class="nc">Seq</span><span class="p">[</span><span class="nc">String</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">???</span><span class="w"> </span><span class="c1">// names of any timestamp-type attributes</span>
<span class="kd">val</span><span class="w"> </span><span class="n">indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ds</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">indices</span><span class="p">(</span><span class="n">ds</span><span class="p">.</span><span class="n">getSchema</span><span class="p">(</span><span class="n">typeName</span><span class="p">)).</span><span class="n">filter</span><span class="p">(</span><span class="n">_</span><span class="p">.</span><span class="n">attributes</span><span class="p">.</span><span class="n">headOption</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">timestamps</span><span class="p">.</span><span class="n">contains</span><span class="p">))</span>
<span class="kd">val</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ds</span><span class="p">.</span><span class="n">getIndexWriterAppend</span><span class="p">(</span><span class="n">typeName</span><span class="p">,</span><span class="w"> </span><span class="n">indices</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ds</span><span class="p">.</span><span class="n">getFeatureReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="n">typeName</span><span class="p">),</span><span class="w"> </span><span class="nc">Transaction</span><span class="p">.</span><span class="nc">AUTO_COMMIT</span><span class="p">)</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">features</span><span class="p">.</span><span class="n">hasNext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nc">FeatureUtils</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span><span class="w"> </span><span class="n">features</span><span class="p">.</span><span class="n">next</span><span class="p">(),</span><span class="w"> </span><span class="n">useProvidedFid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">features</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="w">  </span><span class="n">writer</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="nifi-processor-changes">
<h3><span class="section-number">23.8.4. </span>NiFi Processor Changes<a class="headerlink" href="#nifi-processor-changes" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa NiFi processors have been refactored to support NiFi nar inheritance and as a first step towards supporting
Java 11. Any existing processors will continue to work under the older version, as long as you don’t delete the old
GeoMesa nar file. However, you will need to create new processors in order to upgrade to 2.4.0.</p>
</section>
<section id="distribution-of-installation-bundles">
<h3><span class="section-number">23.8.5. </span>Distribution of Installation Bundles<a class="headerlink" href="#distribution-of-installation-bundles" title="Permalink to this headline">¶</a></h3>
<p>As of GeoMesa 2.4.0, installation bundles (binary distribution and GeoServer plugin tar files) will no
longer be hosted on Maven Central. They will continue to be available on
<a class="reference external" href="https://github.com/locationtech/geomesa/releases">GitHub</a> and the
<a class="reference external" href="https://repo.eclipse.org/content/groups/releases">Locationtech Maven Repository</a>. Note that this only
applies to large installation bundles; GeoMesa will continue to publish JAR files to Maven Central.</p>
</section>
<section id="hbase-geoserver-plugin-installation">
<h3><span class="section-number">23.8.6. </span>HBase GeoServer Plugin Installation<a class="headerlink" href="#hbase-geoserver-plugin-installation" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa HBase GeoServer plugin installation tar file has been updated to remove the shaded HBase client JARs.
The appropriate client JARS for your HBase version now must be installed separately. See
<a class="reference internal" href="hbase/install.html#install-hbase-geoserver"><span class="std std-ref">Installing GeoMesa HBase in GeoServer</span></a> for details.</p>
<p>If desired, the shaded GeoMesa JAR is still available from Maven, as
<code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa:geomesa-hbase-gs-plugin_2.11</span></code> with the classifier <code class="docutils literal notranslate"><span class="pre">shaded</span></code>. However, this will likely
be removed in the next major version release.</p>
</section>
</section>
<section id="version-2-3-0-upgrade-guide">
<h2><span class="section-number">23.9. </span>Version 2.3.0 Upgrade Guide<a class="headerlink" href="#version-2-3-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="default-query-planning-type">
<h3><span class="section-number">23.9.1. </span>Default Query Planning Type<a class="headerlink" href="#default-query-planning-type" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.3.0 changes the default query planning type from stat-based to heuristic-based. This will only affect the
Accumulo data store, as other stores have not implemented statistics. To enable stat-based query planning, refer
to <a class="reference internal" href="datastores/query_config.html#query-planning-hint"><span class="std std-ref">Query Planning Type</span></a>.</p>
</section>
<section id="immutable-simple-feature-types">
<h3><span class="section-number">23.9.2. </span>Immutable Simple Feature Types<a class="headerlink" href="#immutable-simple-feature-types" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.3.0 returns immutable objects from calls to <code class="docutils literal notranslate"><span class="pre">getSchema</span></code>. This allows for the re-use of SimpleFeatureType
instances, which reduces overhead. In most cases, this will have no effect on end users, however note that mutable
and immutable feature types will never be <code class="docutils literal notranslate"><span class="pre">equals</span></code> when compared directly.</p>
<p>In order to update a schema, or if mutability is desired for some other reason, call
<code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.utils.geotools.SimpleFeatureTypes.mutable()</span></code> to create a mutable copy. Java users
can call <code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes.mutable()</span></code> instead.</p>
</section>
<section id="filesystem-storage-api-changes">
<h3><span class="section-number">23.9.3. </span>FileSystem Storage API Changes<a class="headerlink" href="#filesystem-storage-api-changes" title="Permalink to this headline">¶</a></h3>
<p>The FileSystem Storage API is still considered beta-level software, and has been updated in this release. The
DataStore API has not changed, however the internal class interfaces have changed in this release, potentially
requiring changes in user code.</p>
<p>In addition, the format used to store metadata files has been updated, so older versions of GeoMesa will not be
able to read metadata created with this version.</p>
</section>
<section id="id8">
<h3><span class="section-number">23.9.4. </span>Deprecated Modules<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>The following modules have been deprecated, and will be removed in a future version:</p>
<ul class="simple">
<li><p>GeoMesa Raster</p></li>
<li><p>GeoMesa Native API</p></li>
<li><p>GeoMesa Blob Store</p></li>
<li><p>GeoMesa Metrics</p></li>
</ul>
</section>
</section>
<section id="version-2-2-0-upgrade-guide">
<h2><span class="section-number">23.10. </span>Version 2.2.0 Upgrade Guide<a class="headerlink" href="#version-2-2-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="geotools-20-and-geoserver-2-14">
<h3><span class="section-number">23.10.1. </span>GeoTools 20 and GeoServer 2.14<a class="headerlink" href="#geotools-20-and-geoserver-2-14" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.2.0 is compiled against GeoTools 20.0 and GeoServer 2.14. This version of GeoTools upgrades JTS
from 1.14 to 1.16, which includes a transition of the project to Locationtech. The new version
of JTS renames the packages from <code class="docutils literal notranslate"><span class="pre">com.vividsolutions</span></code> to <code class="docutils literal notranslate"><span class="pre">org.locationtech.jts</span></code>. Due to the package renaming,
GeoMesa will no longer work with older versions of GeoTools and GeoServer.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>GeoMesa 2.2.0 requires GeoTools 20.x and GeoServer 2.14.x.</p>
</div>
</section>
<section id="accumulo-datastore-geoserver-installation">
<h3><span class="section-number">23.10.2. </span>Accumulo DataStore GeoServer Installation<a class="headerlink" href="#accumulo-datastore-geoserver-installation" title="Permalink to this headline">¶</a></h3>
<p>When using GeoServer, the GeoMesa Accumulo data store now requires Accumulo client JARs 1.9.2 or later.
This is due to classpath conflicts between earlier Accumulo clients and GeoServer 2.14. Fortunately, newer Accumulo
clients can talk to older Accumulo instances, so it is only necessary to upgrade the client JARs in GeoServer,
but not the entire Accumulo cluster.</p>
</section>
</section>
<section id="version-2-1-0-upgrade-guide">
<h2><span class="section-number">23.11. </span>Version 2.1.0 Upgrade Guide<a class="headerlink" href="#version-2-1-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="converter-updates">
<h3><span class="section-number">23.11.1. </span>Converter Updates<a class="headerlink" href="#converter-updates" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa converter API has been updated and simplified. The old API has been deprecated, and while custom
converters written against it should still work, users are encouraged to migrate to
<code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.convert2.SimpleFeatureConverter</span></code>. A compatibility bridge is provided so that
all converters registered with either the new or old API will be available to both.</p>
<p>Converter definitions should continue to work the same, but some invalid definitions may start to fail due to
stricter configuration parsing.</p>
<section id="xml-converter-namespaces">
<h4><span class="section-number">23.11.1.1. </span>XML Converter Namespaces<a class="headerlink" href="#xml-converter-namespaces" title="Permalink to this headline">¶</a></h4>
<p>XML parsing is now namespace-aware. This shouldn’t affect most operations, but any custom converter functions
that operate on the XML element objects may need to take this into account (for example, custom XPath querying).</p>
</section>
</section>
<section id="distributed-runtime-version-checks">
<h3><span class="section-number">23.11.2. </span>Distributed Runtime Version Checks<a class="headerlink" href="#distributed-runtime-version-checks" title="Permalink to this headline">¶</a></h3>
<p>To prevent unexpected bugs due to JAR version mismatches, GeoMesa can scan the distributed classpath to
verify compatible versions on the distributed classpath. This behavior may be enabled by setting the system
property <code class="docutils literal notranslate"><span class="pre">geomesa.distributed.version.check=true</span></code>.</p>
</section>
<section id="shapefile-ingestion">
<h3><span class="section-number">23.11.3. </span>Shapefile Ingestion<a class="headerlink" href="#shapefile-ingestion" title="Permalink to this headline">¶</a></h3>
<p>Shapefile ingestion through the GeoMesa command-line tools has changed to use a converter definition. This allows
for on-the-fly modifications to the shapefile during ingestion, however the command now requires user confirmation.
The previous behavior can be simulated by passing <code class="docutils literal notranslate"><span class="pre">--force</span></code> to the ingest command.</p>
</section>
<section id="delimited-text-auto-ingestion">
<h3><span class="section-number">23.11.4. </span>Delimited Text Auto-Ingestion<a class="headerlink" href="#delimited-text-auto-ingestion" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa previously supported auto ingest of specially formatted delimited CSV and TSV files. This functionality
has been replaced with standard ingest type inference, which works similarly but may create different results.
Generally, the previous behavior can be replicated by using type inference to create a converter definition,
then modifying the converter to set the feature ID to the first column (<code class="docutils literal notranslate"><span class="pre">$1</span></code>).</p>
</section>
<section id="id9">
<h3><span class="section-number">23.11.5. </span>FileSystem Storage API Changes<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>The FileSystem Storage API is still considered beta-level software, and has been updated in this release. The
DataStore API has not changed, however the internal class interfaces have changed in this release, potentially
requiring changes in user code.</p>
<p>In addition, the format used to store metadata files has been updated, so older versions of GeoMesa will not be
able to read metadata created with this version. When accessing older metadata for the first time, GeoMesa will
update the files to the new format, potentially breaking any old clients still being used.</p>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">update-metadata</span></code> tools command has been replaced with <code class="docutils literal notranslate"><span class="pre">manage-metadata</span></code>.</p>
</section>
<section id="spark-version-update">
<h3><span class="section-number">23.11.6. </span>Spark Version Update<a class="headerlink" href="#spark-version-update" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa now builds against Spark 2.3.1, and supports versions 2.2.x and 2.3.x.</p>
</section>
<section id="arrow-version-update">
<h3><span class="section-number">23.11.7. </span>Arrow Version Update<a class="headerlink" href="#arrow-version-update" title="Permalink to this headline">¶</a></h3>
<p>The version of Apache Arrow used for Arrow-encoded results has been updated from 0.6.0 to 0.10.0. Due to changes
in the Arrow inter-process communication (IPC) format, clients may need to update to the same Arrow version.</p>
</section>
<section id="scalatra-version-update">
<h3><span class="section-number">23.11.8. </span>Scalatra Version Update<a class="headerlink" href="#scalatra-version-update" title="Permalink to this headline">¶</a></h3>
<p>The version of scalatra used for web servlets has been updated to 2.6.3. The new version requires json4s 3.5.4,
which may require changes to the web server used to deploy the servlets.</p>
</section>
</section>
<section id="version-2-0-0-upgrade-guide">
<h2><span class="section-number">23.12. </span>Version 2.0.0 Upgrade Guide<a class="headerlink" href="#version-2-0-0-upgrade-guide" title="Permalink to this headline">¶</a></h2>
<section id="geotools-18-and-geoserver-2-12">
<h3><span class="section-number">23.12.1. </span>GeoTools 18 and GeoServer 2.12<a class="headerlink" href="#geotools-18-and-geoserver-2-12" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa 2.0.0 is compiled against GeoTools 18.0 and GeoServer 2.12. When upgrading GeoServer instances,
it’s usually best to start over with a new GeoServer data directory. If you upgrade GeoMesa in an existing
GeoServer instance that has run GeoMesa 1.3.x or earlier, layers will still work but you will not be
able to edit any existing GeoMesa stores. In order to edit stores, you will need to delete them and
re-create them through the GeoServer UI. Alternatively, you may edit the GeoServer <code class="docutils literal notranslate"><span class="pre">datastore.xml</span></code> files
(located in the GeoServer data directory) to match the new GeoMesa data store parameters (described below).
In particular, you will need to add a <code class="docutils literal notranslate"><span class="pre">namespace</span></code> parameter that matches the workspace of the GeoServer store.</p>
</section>
<section id="data-store-parameters">
<h3><span class="section-number">23.12.2. </span>Data Store Parameters<a class="headerlink" href="#data-store-parameters" title="Permalink to this headline">¶</a></h3>
<p>The data store parameters used in calls to <code class="docutils literal notranslate"><span class="pre">DataStoreFinder</span></code> and the Spark <code class="docutils literal notranslate"><span class="pre">SpatialRDDProvider</span></code> have
been standardized. New parameters are outlined in the individual data store pages:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="accumulo/usage.html#accumulo-parameters"><span class="std std-ref">Accumulo Data Store Parameters</span></a></p></li>
<li><p><a class="reference internal" href="hbase/usage.html#hbase-parameters"><span class="std std-ref">HBase Data Store Parameters</span></a></p></li>
<li><p><a class="reference internal" href="cassandra/usage.html#cassandra-parameters"><span class="std std-ref">Cassandra Data Store Parameters</span></a></p></li>
<li><p><a class="reference internal" href="kafka/usage.html#kafka-parameters"><span class="std std-ref">Kafka Data Store Parameters</span></a></p></li>
<li><p><a class="reference internal" href="lambda/usage.html#lambda-parameters"><span class="std std-ref">Lambda Data Store Parameters</span></a></p></li>
</ul>
</div></blockquote>
<p>The older parameter names will continue to work, but are deprecated and may be removed in future versions.</p>
</section>
<section id="removal-of-joda-time">
<h3><span class="section-number">23.12.3. </span>Removal of Joda Time<a class="headerlink" href="#removal-of-joda-time" title="Permalink to this headline">¶</a></h3>
<p>With the introduction of <code class="docutils literal notranslate"><span class="pre">java.time</span></code> in Java 8, the Joda Time project has been deprecated. As such, GeoMesa
has removed its Joda dependency in favor of <code class="docutils literal notranslate"><span class="pre">java.time</span></code>. One consequence of this is that custom date patterns
in <code class="docutils literal notranslate"><span class="pre">geomesa-convert</span></code> are interpreted slightly differently. See <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">DateTimeFormatter</a> for details.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In particular, “year of era” has changed from <code class="docutils literal notranslate"><span class="pre">Y</span></code> to <code class="docutils literal notranslate"><span class="pre">y</span></code>. <code class="docutils literal notranslate"><span class="pre">Y</span></code> now means “week-based year”, and will
give different results.</p>
</div>
</section>
<section id="saxon-xml-parser">
<h3><span class="section-number">23.12.4. </span>Saxon XML Parser<a class="headerlink" href="#saxon-xml-parser" title="Permalink to this headline">¶</a></h3>
<p>The GeoMesa converter XML module now ships with Saxon-HE by default. Saxon-HE is generally much faster
at parsing XML than the default Java implementation. Previously, Saxon was available as an additional download.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Saxon parsing has some differences from the default Java implementation, which may cause existing
converter definitions to fail. In particular, Saxon is much stricter with XML namespaces. See
<a class="reference internal" href="convert/xml.html#xml-converter-namespaces"><span class="std std-ref">Handling Namespaces with Saxon</span></a> for more information.</p>
</div>
</section>
<section id="kafka-data-store">
<h3><span class="section-number">23.12.5. </span>Kafka Data Store<a class="headerlink" href="#kafka-data-store" title="Permalink to this headline">¶</a></h3>
<p>The Kafka Data Store has been rewritten into a single implementation for all supported Kafka versions. Support for
Kafka 0.8 has been removed. See <a class="reference internal" href="kafka/index.html#kafka-index"><span class="std std-ref">Kafka Data Store</span></a> for more information.</p>
</section>
<section id="accumulo-standardization">
<h3><span class="section-number">23.12.6. </span>Accumulo Standardization<a class="headerlink" href="#accumulo-standardization" title="Permalink to this headline">¶</a></h3>
<p>In order to standardize behavior between data store implementations, some behaviors of the <code class="docutils literal notranslate"><span class="pre">AccumuloDataStore</span></code>
have been modified.</p>
<section id="attribute-index-coverage">
<h4><span class="section-number">23.12.6.1. </span>Attribute Index Coverage<a class="headerlink" href="#attribute-index-coverage" title="Permalink to this headline">¶</a></h4>
<p>Accumulo attribute indices specified with <code class="docutils literal notranslate"><span class="pre">index=true</span></code> will now create full attribute indices, instead of
join indices. To create a join index, explicitly specify <code class="docutils literal notranslate"><span class="pre">index=join</span></code>. Existing schemas are not affected.</p>
</section>
<section id="record-index-identifier">
<h4><span class="section-number">23.12.6.2. </span>Record Index Identifier<a class="headerlink" href="#record-index-identifier" title="Permalink to this headline">¶</a></h4>
<p>The Accumulo <code class="docutils literal notranslate"><span class="pre">record</span></code> index has been renamed to the <code class="docutils literal notranslate"><span class="pre">id</span></code> index. In general practice, this will have no effect,
however when specifying <code class="docutils literal notranslate"><span class="pre">geomesa.indices.enabled</span></code>, the value <code class="docutils literal notranslate"><span class="pre">id</span></code> must be used in place of <code class="docutils literal notranslate"><span class="pre">records</span></code>.</p>
</section>
<section id="tools-command-name">
<h4><span class="section-number">23.12.6.3. </span>Tools Command Name<a class="headerlink" href="#tools-command-name" title="Permalink to this headline">¶</a></h4>
<p>The Accumulo command line tools script has been renamed from <code class="docutils literal notranslate"><span class="pre">geomesa</span></code> to <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo</span></code>.</p>
</section>
</section>
<section id="table-splitters">
<h3><span class="section-number">23.12.7. </span>Table Splitters<a class="headerlink" href="#table-splitters" title="Permalink to this headline">¶</a></h3>
<p>The table splitting API has changed. Any custom table splitters implementing
<code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.index.conf.TableSplitter</span></code> will need to be updated for the new method signatures.
In addition, the provided GeoMesa splitters have been deprecated and replaced. See <a class="reference internal" href="datastores/index_config.html#table-split-config"><span class="std std-ref">Configuring Index Splits</span></a>
for more details.</p>
</section>
<section id="system-properties">
<h3><span class="section-number">23.12.8. </span>System Properties<a class="headerlink" href="#system-properties" title="Permalink to this headline">¶</a></h3>
<p>Time-related system properties have been standardized to all use readable durations. Durations can be specified
as a number followed by a time unit, e.g. <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">minutes</span></code> or <code class="docutils literal notranslate"><span class="pre">30</span> <span class="pre">seconds</span></code>. The following properties
have been changed to accept durations, and some have been renamed. Note that this will affect system properties
set in the JVM as well as any custom <code class="docutils literal notranslate"><span class="pre">geomesa-site.xml</span></code> files. More details can be found under
<a class="reference internal" href="datastores/runtime_config.html#geomesa-site-xml"><span class="std std-ref">Runtime Configuration</span></a> or the appropriate data store configuration section.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 46%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Previous name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>geomesa.query.timeout</p></td>
<td><p>geomesa.query.timeout.millis</p></td>
</tr>
<tr class="row-odd"><td><p>geomesa.metadata.expiry</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>geomesa.batchwriter.latency</p></td>
<td><p>geomesa.batchwriter.latency.millis</p></td>
</tr>
<tr class="row-odd"><td><p>geomesa.batchwriter.latency</p></td>
<td><p>geomesa.batchwriter.latency.millis</p></td>
</tr>
<tr class="row-even"><td><p>geomesa.stats.compact.interval</p></td>
<td><p>geomesa.stats.compact.millis</p></td>
</tr>
<tr class="row-odd"><td><p>geomesa.cassandra.read.timeout</p></td>
<td><p>geomesa.cassandra.read.timeout.millis</p></td>
</tr>
<tr class="row-even"><td><p>geomesa.cassandra.connection.timeout</p></td>
<td><p>geomesa.cassandra.connection.timeout.millis</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ds_views.html" class="btn btn-neutral float-left" title="22. Combined Data Store Views" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="appendix/utils.html" class="btn btn-neutral float-right" title="GeoMesa Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2023 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/upgrade.rst">GitHub <img src="../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>