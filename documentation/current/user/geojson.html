

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>16. GeoMesa GeoJSON &mdash; GeoMesa 1.3.4-SNAPSHOT Manuals</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme_custom.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/sphinx_tabs/tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.7/segment.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.7/menu.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="GeoMesa 1.3.4-SNAPSHOT Manuals" href="../index.html"/>
        <link rel="up" title="User Manual" href="index.html"/>
        <link rel="next" title="17. GeoMesa Metrics" href="metrics.html"/>
        <link rel="prev" title="15.11. Parsing and Validation" href="convert/parsing_and_validation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.3.4-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">2. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">3. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html">4. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">5. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastores/index.html">6. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo/index.html">7. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="hbase/index.html">8. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="bigtable/index.html">9. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra/index.html">10. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka/index.html">11. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda/index.html">12. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">13. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="blobstore.html">14. GeoMesa Blob Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="convert/index.html">15. GeoMesa Convert</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">16. GeoMesa GeoJSON</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#geojson-api">16.1. GeoJSON API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-and-updating-features">16.1.1. Adding and Updating Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#querying-features">16.1.2. Querying Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programmatic-access">16.1.3. Programmatic Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rest-access">16.1.4. REST Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#methods">16.1.5. Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#json-attributes">16.2. JSON Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jsonpath-cql-filter-function">16.2.1. JSONPath CQL Filter Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">17. GeoMesa Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="native_api.html">18. GeoMesa Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="nifi.html">19. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html">20. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark/index.html">21. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="stream.html">22. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_data.html">23. GeoMesa Web Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem/index.html">24. FileSystem Datastore (Amazon S3, HDFS Datastore)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoMesa</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User Manual</a> &raquo;</li>
        
      <li>16. GeoMesa GeoJSON</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/geojson.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geomesa-geojson">
<h1>16. GeoMesa GeoJSON<a class="headerlink" href="#geomesa-geojson" title="Permalink to this headline">¶</a></h1>
<p>GeoMesa provides built-in integration with GeoJSON. GeoMesa provides a GeoJSON API that allows for the
indexing and querying of GeoJSON data. The GeoJSON API does not use GeoTools - all data and operations
are pure JSON. The API also includes a REST endpoint for web integration.</p>
<p>In addition, when working with GeoTools, JSON can be stored as an attribute in a simple feature
and queried using CQL.</p>
<p>GeoMesa&#8217;s JSON processing uses <a class="reference external" href="http://goessner.net/articles/JsonPath/">JSONPath</a> for selecting JSON elements.</p>
<div class="section" id="geojson-api">
<h2>16.1. GeoJSON API<a class="headerlink" href="#geojson-api" title="Permalink to this headline">¶</a></h2>
<p>The GeoJSON API provides a simplified interface for spatially indexing GeoJSON. GeoJSON is ingested
by indexing the embedded geometry. Additionally, a date field can be indexed by specifying a custom
field in the <code class="docutils literal"><span class="pre">properties</span></code> element, which allows arbitrary JSON extensions.</p>
<p>Data may be accessed programmatically or through a REST endpoint.</p>
<div class="section" id="adding-and-updating-features">
<h3>16.1.1. Adding and Updating Features<a class="headerlink" href="#adding-and-updating-features" title="Permalink to this headline">¶</a></h3>
<p>Data is added to the index as GeoJSON strings. When creating the index, you may optionally specify an ID field
and a date field using JSONPath expressions. The ID field is required in order to update or modify features.
The date field will allow for optimized spatio-temporal queries.</p>
<p>Features can be added to the index by passing in GeoJSON objects of type <code class="docutils literal"><span class="pre">Feature</span></code> or <code class="docutils literal"><span class="pre">FeatureCollection</span></code>.
Updating or deleting features requires the corresponding feature IDs.</p>
</div>
<div class="section" id="querying-features">
<h3>16.1.2. Querying Features<a class="headerlink" href="#querying-features" title="Permalink to this headline">¶</a></h3>
<p>Features can be queried using a MongoDB-like JSON syntax. Results will be the original GeoJSON, or may be
transformed into arbitrary JSON py passing in a projection.</p>
<div class="section" id="predicates">
<h4>16.1.2.1. Predicates<a class="headerlink" href="#predicates" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Predicate</th>
<th class="head">Syntax</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>include</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>equals</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="s2">&quot;bar&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td>greater-than</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;$gt&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;$gte&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>less-than</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;$lt&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;$lte&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td>bounding box</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span> <span class="nt">&quot;geometry&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;$bbox&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">-180</span><span class="p">,</span> <span class="mi">-90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span> <span class="p">}}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>spatial intersects</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;geometry&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;$intersects&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;$geometry&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="nt">&quot;coordinates&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td>spatial within</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;geometry&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;$within&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;$geometry&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span> <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>spatial contains</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;geometry&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;$contains&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;$geometry&quot;</span> <span class="p">:</span> <span class="p">{</span>  <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="nt">&quot;coordinates&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td>and</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="nt">&quot;baz&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>or</td>
<td><div class="first last highlight-json"><div class="highlight"><pre><span class="p">{</span> <span class="nt">&quot;$or&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="nt">&quot;foo&quot;</span> <span class="p">:</span> <span class="s2">&quot;bar&quot;</span> <span class="p">},</span> <span class="p">{</span> <span class="nt">&quot;baz&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="transformations">
<h4>16.1.2.2. Transformations<a class="headerlink" href="#transformations" title="Permalink to this headline">¶</a></h4>
<p>The JSON being returned can be transformed by specifying element mappings. The transform is defined by a
map where the keys define the element in the returned JSON using dot notation, and the values specify the
JSONPath expression used to extract the value from the original GeoJSON.</p>
<p>For example, to return just the geometry you could use a mapping of <code class="docutils literal"><span class="pre">&quot;geom&quot;</span> <span class="pre">-&gt;</span> <span class="pre">&quot;geometry&quot;</span></code>:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;geom&quot;</span><span class="p">:{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">]}}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="programmatic-access">
<h3>16.1.3. Programmatic Access<a class="headerlink" href="#programmatic-access" title="Permalink to this headline">¶</a></h3>
<p>The main interface for programmatic access is the <code class="docutils literal"><span class="pre">GeoJsonIndex</span></code>. It can be instantiated by wrapping a
GeoMesa <code class="docutils literal"><span class="pre">DataStore</span></code>. The module is available through maven:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.locationtech.geomesa<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>geomesa-geojson-api_2.11<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.3.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<p>Example code in scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">org.locationtech.geomesa.geojson.</span><span class="o">{</span><span class="nc">GeoJsonGtIndex</span><span class="o">,</span> <span class="nc">GeoJsonIndex</span><span class="o">}</span>

<span class="k">val</span> <span class="n">ds</span> <span class="k">=</span> <span class="nc">DataStoreFinder</span><span class="o">.</span><span class="n">getDataStore</span><span class="o">(...)</span> <span class="c1">// ensure this is a GeoMesa data store</span>
<span class="k">val</span> <span class="n">index</span><span class="k">:</span> <span class="kt">GeoJsonIndex</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GeoJsonGtIndex</span><span class="o">(</span><span class="n">ds</span><span class="o">)</span>
<span class="n">index</span><span class="o">.</span><span class="n">createIndex</span><span class="o">(</span><span class="s">&quot;test&quot;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="s">&quot;$.properties.id&quot;</span><span class="o">),</span> <span class="n">points</span> <span class="k">=</span> <span class="kc">true</span><span class="o">)</span>

<span class="k">val</span> <span class="n">features</span> <span class="k">=</span>
    <span class="n">s</span><span class="s">&quot;&quot;&quot;{ &quot;type&quot;: &quot;FeatureCollection&quot;,</span>
<span class="s">       |  &quot;features&quot;: [</span>
<span class="s">       |    {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0&quot;}},</span>
<span class="s">       |    {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[31,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1&quot;}},</span>
<span class="s">       |    {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2&quot;}}</span>
<span class="s">       |  ]</span>
<span class="s">       |}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">stripMargin</span>

<span class="n">index</span><span class="o">.</span><span class="n">add</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">features</span><span class="o">)</span>

<span class="c1">// query by bounding box</span>
<span class="n">index</span><span class="o">.</span><span class="n">query</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="s">&quot;&quot;&quot;{ &quot;geometry&quot; : { &quot;$bbox&quot; : [29, 9, 31.5, 11] }}&quot;&quot;&quot;</span><span class="o">).</span><span class="n">toList</span>
<span class="c1">// result:</span>
<span class="c1">// {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0&quot;}}</span>
<span class="c1">// {&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[31,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1&quot;}}</span>

<span class="c1">// query for all, transform JSON coming back</span>
<span class="n">index</span><span class="o">.</span><span class="n">query</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="s">&quot;{}&quot;</span><span class="o">,</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;foo.bar&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;geometry&quot;</span><span class="o">,</span> <span class="s">&quot;foo.baz&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;properties.name&quot;</span><span class="o">)).</span><span class="n">toList</span>
<span class="c1">// result:</span>
<span class="c1">// {&quot;foo&quot;:{&quot;bar&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[30,10]},&quot;baz&quot;:&quot;n0&quot;}}</span>
<span class="c1">// {&quot;foo&quot;:{&quot;bar&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[31,10]},&quot;baz&quot;:&quot;n1&quot;}}</span>
<span class="c1">// {&quot;foo&quot;:{&quot;bar&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[32,10]},&quot;baz&quot;:&quot;n2&quot;}}</span>
</pre></div>
</div>
</div>
<div class="section" id="rest-access">
<h3>16.1.4. REST Access<a class="headerlink" href="#rest-access" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">GeoJsonIndex</span></code> is also exposed through a REST endpoint. Currently, the REST endpoint does not support
updates or deletes of existing features, or transformation of resposes. Furthermore, it requires Accumulo as
the backing data store. It may be installed in GeoServer by extracting the install file into
<code class="docutils literal"><span class="pre">geoserver/WEB-INF/lib</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tar -xf geomesa-geojson/geomesa-geojson-gs-plugin/target/geomesa-geojson-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz -C &lt;dest&gt;
</pre></div>
</div>
<p>Note that this also requires the AccumuloDataStore to be installed. See <a class="reference internal" href="accumulo/install.html#install-accumulo-geoserver"><span class="std std-ref">Installing GeoMesa Accumulo in GeoServer</span></a>.</p>
<p>The REST endpoint will be available at <code class="docutils literal"><span class="pre">&lt;host&gt;:&lt;port&gt;/geoserver/geomesa/geojson/</span></code>.</p>
</div>
<div class="section" id="methods">
<h3>16.1.5. Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<div class="section" id="get-registered-datastores">
<h4>16.1.5.1. Get Registered DataStores<a class="headerlink" href="#get-registered-datastores" title="Permalink to this headline">¶</a></h4>
<p>Returns a list of data stores available for querying.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/ds</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">GET</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td>None</td>
</tr>
<tr class="row-even"><td><strong>Data Params</strong></td>
<td>None</td>
</tr>
<tr class="row-odd"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p><strong>Content:</strong></p>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;mycloud&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;instanceId&quot;</span><span class="p">:</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zookeepers&quot;</span><span class="p">:</span><span class="s2">&quot;foo1,foo2,foo3&quot;</span><span class="p">,</span>
    <span class="nt">&quot;tableName&quot;</span><span class="p">:</span><span class="s2">&quot;foo.bar&quot;</span><span class="p">,</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="s2">&quot;***&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Error</strong>
<strong>Response</strong></td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre>curl <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/ds&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Notes</strong></td>
<td>An entry will be returned for each registered data store</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="register-a-datastore">
<h4>16.1.5.2. Register a DataStore<a class="headerlink" href="#register-a-datastore" title="Permalink to this headline">¶</a></h4>
<p>Registers a data store to make it available for querying.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/ds/:alias</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">POST</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Alias used to reference the data store in future requests</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Data Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">instanceId=[alphanumeric]</span></code></li>
<li><code class="docutils literal"><span class="pre">zookeepers=[alphanumeric]</span></code></li>
<li><code class="docutils literal"><span class="pre">user=[alphanumeric]</span></code></li>
<li><code class="docutils literal"><span class="pre">tableName=[alphanumeric]</span></code></li>
</ul>
<p><strong>Optional</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">auths=[alphanumeric]</span></code></li>
<li><code class="docutils literal"><span class="pre">visibilities=[alphanumeric]</span></code></li>
<li><code class="docutils literal"><span class="pre">queryTimeout=[integer]</span></code></li>
<li><code class="docutils literal"><span class="pre">queryThreads=[integer]</span></code></li>
<li><code class="docutils literal"><span class="pre">recordThreads=[integer]</span></code></li>
<li><code class="docutils literal"><span class="pre">writeThreads=[integer]</span></code></li>
<li><code class="docutils literal"><span class="pre">looseBoundingBox=[Boolean]</span></code></li>
<li><code class="docutils literal"><span class="pre">generateStats=[Boolean]</span></code></li>
<li><code class="docutils literal"><span class="pre">auditQueries=[Boolean]</span></code></li>
<li><code class="docutils literal"><span class="pre">caching=[Boolean]</span></code></li>
<li><code class="docutils literal"><span class="pre">forceEmptyAuths=[Boolean]</span></code></li>
<li><code class="docutils literal"><span class="pre">useMock=[Boolean]</span></code></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if data store can not be created with the provided parameters</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre>curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/ds/myds&#39;</span> <span class="se">\</span>
  -d <span class="nv">user</span><span class="o">=</span>foo -d <span class="nv">password</span><span class="o">=</span>foo -d <span class="nv">tableName</span><span class="o">=</span>foo.bar <span class="se">\</span>
  -d <span class="nv">zookeepers</span><span class="o">=</span>foo1,foo2,foo3 -d <span class="nv">instanceId</span><span class="o">=</span>foo
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Notes</strong></td>
<td>Parameters correspond to the <code class="docutils literal"><span class="pre">AccumuloDataStore</span></code> connection parameters used
by DataStoreFinder</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="create-geojson-index">
<h4>16.1.5.3. Create GeoJSON Index<a class="headerlink" href="#create-geojson-index" title="Permalink to this headline">¶</a></h4>
<p>Creates a new index under an existing data store.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">POST</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of the GeoJSON index to create</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Data Params</strong></td>
<td><p class="first"><strong>Optional</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">points=[Boolean]</span></code> Optimization hint if all geometries will be points</li>
<li><code class="docutils literal"><span class="pre">date=[alphanumeric]</span></code> JSONPath expression to a date field for temporal indexing</li>
<li><code class="docutils literal"><span class="pre">id=[alphanumeric]</span></code> JSONPath expression to an ID field to uniquely identify each
record</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 201</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre>curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test&#39;</span> <span class="se">\</span>
  -d <span class="nv">id</span><span class="o">=</span>properties.id
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="delete-geojson-index">
<h4>16.1.5.4. Delete GeoJSON Index<a class="headerlink" href="#delete-geojson-index" title="Permalink to this headline">¶</a></h4>
<p>Deletes an existing index and all features it contains.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">DELETE</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of the GeoJSON index to create</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 204</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre>curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test&#39;</span> <span class="se">\</span>
  -X DELETE
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="add-features">
<h4>16.1.5.5. Add Features<a class="headerlink" href="#add-features" title="Permalink to this headline">¶</a></h4>
<p>Add features to the index with GeoJSON.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index/features</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">POST</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Body</strong></td>
<td><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">[alphanumeric]</span></code> GeoJSON <code class="docutils literal"><span class="pre">Feature</span></code> or <code class="docutils literal"><span class="pre">FeatureCollection</span></code></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p class="last"><strong>Content:</strong> <code class="docutils literal"><span class="pre">[&quot;1&quot;,&quot;2&quot;]</span></code> List of ids for the added features</p>
</td>
</tr>
<tr class="row-even"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre><span class="nb">echo</span> <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0&quot;}}&#39;</span> <span class="se">\</span>
  &gt; feature.json
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-type: application/json&#39;</span> <span class="se">\</span>
  -d @feature.json

<span class="nb">echo</span> <span class="s1">&#39;{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1&quot;}},&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[34,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2&quot;}}]}&#39;</span> <span class="se">\</span>
  &gt; features.json
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-type: application/json&#39;</span> <span class="se">\</span>
  -d @features.json
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="update-features">
<h4>16.1.5.6. Update Features<a class="headerlink" href="#update-features" title="Permalink to this headline">¶</a></h4>
<p>Update existing features in the index. Feature IDs will be extracted from the GeoJSON submitted.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index/features</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">PUT</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Body</strong></td>
<td><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">[alphanumeric]</span></code> GeoJSON <code class="docutils literal"><span class="pre">Feature</span></code> or <code class="docutils literal"><span class="pre">FeatureCollection</span></code></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p><strong>Content:</strong> empty</p>
<p><strong>Code:</strong> 400 - if ID field was not specified when creating the index</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre><span class="nb">echo</span> <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0-updated&quot;}}&#39;</span> <span class="se">\</span>
  &gt; feature.json
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-type: application/json&#39;</span> <span class="se">\</span>
  --upload-file feature.json

<span class="nb">echo</span> <span class="s1">&#39;{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1-updated&quot;}},&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[34,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2-updated&quot;}}]}&#39;</span> <span class="se">\</span>
  &gt; features.json
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-type: application/json&#39;</span> <span class="se">\</span>
  --upload-file features.json
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="update-features-by-id">
<h4>16.1.5.7. Update Features by ID<a class="headerlink" href="#update-features-by-id" title="Permalink to this headline">¶</a></h4>
<p>Update existing features in the index, explicitly specifying the feature IDs.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index/features/:ids</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">PUT</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</li>
<li><code class="docutils literal"><span class="pre">id=[alphanumeric]</span></code> Feature IDs to update, comma-separated</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Body</strong></td>
<td><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">[alphanumeric]</span></code> GeoJSON <code class="docutils literal"><span class="pre">Feature</span></code> or <code class="docutils literal"><span class="pre">FeatureCollection</span></code></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre><span class="nb">echo</span> <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[30,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;0&quot;,&quot;name&quot;:&quot;n0-updated&quot;}}&#39;</span> <span class="se">\</span>
  &gt; feature.json
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/0&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-type: application/json&#39;</span> <span class="se">\</span>
  --upload-file feature.json

<span class="nb">echo</span> <span class="s1">&#39;{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[32,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;n1-updated&quot;}},&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;{&quot;type&quot;:&quot;Feature&quot;,&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&#39;</span> <span class="se">\</span>
  <span class="s1">&#39;&quot;coordinates&quot;:[34,10]},&quot;properties&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;n2-updated&quot;}}]}&#39;</span> <span class="se">\</span>
  &gt; features.json
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/1,2&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-type: application/json&#39;</span> <span class="se">\</span>
  --upload-file features.json
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="delete-features-by-id">
<h4>16.1.5.8. Delete Features by ID<a class="headerlink" href="#delete-features-by-id" title="Permalink to this headline">¶</a></h4>
<p>Delete existing features in the index by feature IDs.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index/features/:ids</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">DELETE</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</li>
<li><code class="docutils literal"><span class="pre">id=[alphanumeric]</span></code> Feature IDs to delete, comma-separated</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-odd"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre>curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/1,2&#39;</span> <span class="se">\</span>
  -X DELETE
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="query-features-by-id">
<h4>16.1.5.9. Query Features by ID<a class="headerlink" href="#query-features-by-id" title="Permalink to this headline">¶</a></h4>
<p>Query features in the index by feature IDs.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index/features/:ids</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">GET</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</li>
<li><code class="docutils literal"><span class="pre">id=[alphanumeric]</span></code> Feature IDs to query, comma-separated</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> GeoJSON feature collection</p>
<p><strong>Example:</strong></p>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
  <span class="nt">&quot;features&quot;</span><span class="p">:[</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
      <span class="nt">&quot;geometry&quot;</span><span class="p">:{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">32</span><span class="p">,</span><span class="mi">10</span><span class="p">]},</span>
      <span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;n1&quot;</span><span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre>curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features/1,2&#39;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="query-features">
<h4>16.1.5.10. Query Features<a class="headerlink" href="#query-features" title="Permalink to this headline">¶</a></h4>
<p>Query features with a predicate.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URL</strong></td>
<td><code class="docutils literal"><span class="pre">/index/:alias/:index/features</span></code></td>
</tr>
<tr class="row-even"><td><strong>Method</strong></td>
<td><code class="docutils literal"><span class="pre">GET</span></code></td>
</tr>
<tr class="row-odd"><td><strong>URL Params</strong></td>
<td><p class="first"><strong>Required</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">alias=[alphanumeric]</span></code> Reference to a previously registered data store</li>
<li><code class="docutils literal"><span class="pre">index=[alphanumeric]</span></code> Unique name of a GeoJSON index</li>
</ul>
<p><strong>Optional</strong></p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">q=[alphanumeric]</span></code> JSON query predicate</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><strong>Success</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 200</p>
<p><strong>Content:</strong> GeoJSON feature collection</p>
<p><strong>Example:</strong></p>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
  <span class="nt">&quot;features&quot;</span><span class="p">:[</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
      <span class="nt">&quot;geometry&quot;</span><span class="p">:{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">32</span><span class="p">,</span><span class="mi">10</span><span class="p">]},</span>
      <span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;n1&quot;</span><span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Error</strong>
<strong>Response</strong></td>
<td><p class="first"><strong>Code:</strong> 400 - if a required parameter is not specified</p>
<p class="last"><strong>Content:</strong> empty</p>
</td>
</tr>
<tr class="row-even"><td><strong>Sample Call</strong></td>
<td><div class="first last highlight-bash"><div class="highlight"><pre><span class="c"># return all features in the index &#39;test&#39;</span>
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span>

<span class="c"># query by feature id</span>
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  --get --data-urlencode <span class="s1">&#39;q={&quot;properties.id&quot;:&quot;0&quot;}&#39;</span>

<span class="c"># query by bounding box</span>
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  --get --data-urlencode <span class="s1">&#39;q={&quot;geometry&quot;:{&quot;$bbox&quot;:[33,9,35,11]}}&#39;</span>

<span class="c"># query by property</span>
curl <span class="se">\</span>
  <span class="s1">&#39;localhost:8080/geoserver/geomesa/geojson/index/myds/test/features&#39;</span> <span class="se">\</span>
  --get --data-urlencode <span class="s1">&#39;q={&quot;properties.name&quot;:&quot;n1&quot;}&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Notes</strong></td>
<td>See <a class="reference internal" href="#querying-features">Querying Features</a> for full query syntax</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="json-attributes">
<span id="id1"></span><h2>16.2. JSON Attributes<a class="headerlink" href="#json-attributes" title="Permalink to this headline">¶</a></h2>
<p>In addition to the GeoJSON API, GeoMesa allows for JSON integration with GeoTools data stores. Simple
feature <code class="docutils literal"><span class="pre">String</span></code>-type attributes can be marked as JSON and then queried using CQL. JSON attributes
must be specified when creating a simple feature type:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">org.locationtech.geomesa.utils.interop.SimpleFeatureTypes</span><span class="o">;</span>

<span class="c1">// append the json hint after the attribute type, separated by a colon</span>
<span class="n">String</span> <span class="n">spec</span> <span class="o">=</span> <span class="s">&quot;json:String:json=true,dtg:Date,*geom:Point:srid=4326&quot;</span>
<span class="n">SimpleFeatureType</span> <span class="n">sft</span> <span class="o">=</span> <span class="n">SimpleFeatureTypes</span><span class="o">.</span><span class="na">createType</span><span class="o">(</span><span class="s">&quot;mySft&quot;</span><span class="o">,</span> <span class="n">spec</span><span class="o">);</span>
<span class="n">dataStore</span><span class="o">.</span><span class="na">createSchema</span><span class="o">(</span><span class="n">sft</span><span class="o">);</span>
</pre></div>
</div>
<p>JSON attributes are still strings, and are set as any other strings:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">&quot;{ \&quot;foo\&quot; : \&quot;bar\&quot; }&quot;</span><span class="o">;</span>
<span class="n">SimpleFeature</span> <span class="n">sf</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">sf</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">,</span> <span class="n">json</span><span class="o">);</span>
</pre></div>
</div>
<p>JSON attributes can be queried using JSONPath expressions. The first part of the path refers to the simple
feature attribute name, and the rest of the path is applied to the JSON attribute. Note that in ECQL, path
expressions must be enclosed in double quotes.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Filter</span> <span class="n">filter</span> <span class="o">=</span> <span class="n">ECQL</span><span class="o">.</span><span class="na">toFilter</span><span class="o">(</span><span class="s">&quot;\&quot;$.json.foo\&quot; = &#39;bar&#39;&quot;</span><span class="o">)</span>
<span class="n">SimpleFeature</span> <span class="n">sf</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">sf</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">,</span> <span class="s">&quot;{ \&quot;foo\&quot; : \&quot;bar\&quot; }&quot;</span><span class="o">);</span>
<span class="n">filter</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">sf</span><span class="o">);</span> <span class="c1">// returns true</span>
<span class="n">sf</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&quot;\&quot;$.json.foo\&quot;&quot;</span><span class="o">);</span> <span class="c1">// returns &quot;bar&quot;</span>
<span class="n">sf</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">,</span> <span class="s">&quot;{ \&quot;foo\&quot; : \&quot;baz\&quot; }&quot;</span><span class="o">);</span>
<span class="n">filter</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">sf</span><span class="o">);</span> <span class="c1">// returns false</span>
<span class="n">sf</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&quot;\&quot;$.json.foo\&quot;&quot;</span><span class="o">);</span> <span class="c1">// returns &quot;baz&quot;</span>
<span class="n">sf</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&quot;\&quot;$.json.bar\&quot;&quot;</span><span class="o">);</span> <span class="c1">// returns null</span>
</pre></div>
</div>
<div class="section" id="jsonpath-cql-filter-function">
<h3>16.2.1. JSONPath CQL Filter Function<a class="headerlink" href="#jsonpath-cql-filter-function" title="Permalink to this headline">¶</a></h3>
<p>JSON attributes can contain periods and spaces. In order to query these attributes through an ECQL filter
use the jsonPath CQL filter function. This passes the path to an internal interpreter function that understands
how to handle these attribute names.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Filter</span> <span class="n">filter</span> <span class="o">=</span> <span class="n">ECQL</span><span class="o">.</span><span class="na">toFilter</span><span class="o">(</span><span class="s">&quot;jsonPath(&#39;$.json.foo&#39;) = &#39;bar&#39;&quot;</span><span class="o">)</span>
<span class="n">SimpleFeature</span> <span class="n">sf</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">sf</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">,</span> <span class="s">&quot;{ \&quot;foo\&quot; : \&quot;bar\&quot; }&quot;</span><span class="o">);</span>
<span class="n">filter</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">sf</span><span class="o">);</span> <span class="c1">// returns true</span>
</pre></div>
</div>
<p>To handle periods and spaces in attribute names, enclose the attribute in the standard bracket notation. However,
since the path is being passed to the jsonPath function as a string literal parameter, the single quotes need to be
escaped with an additional single quote.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Filter</span> <span class="n">filter</span> <span class="o">=</span> <span class="n">ECQL</span><span class="o">.</span><span class="na">toFilter</span><span class="o">(</span><span class="s">&quot;jsonPath(&#39;$.json.[&#39;&#39;foo.bar&#39;&#39;]&#39;) = &#39;bar&#39;&quot;</span><span class="o">)</span>
<span class="n">SimpleFeature</span> <span class="n">sf</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">sf</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">,</span> <span class="s">&quot;{ \&quot;foo.bar\&quot; : \&quot;bar\&quot; }&quot;</span><span class="o">);</span>
<span class="n">filter</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">sf</span><span class="o">);</span> <span class="c1">// returns true</span>
</pre></div>
</div>
<p>Similarly for spaces:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Filter</span> <span class="n">filter</span> <span class="o">=</span> <span class="n">ECQL</span><span class="o">.</span><span class="na">toFilter</span><span class="o">(</span><span class="s">&quot;jsonPath(&#39;$.json.[&#39;&#39;foo bar&#39;&#39;]&#39;) = &#39;bar&#39;&quot;</span><span class="o">)</span>
<span class="n">SimpleFeature</span> <span class="n">sf</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">sf</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">,</span> <span class="s">&quot;{ \&quot;foo bar\&quot; : \&quot;bar\&quot; }&quot;</span><span class="o">);</span>
<span class="n">filter</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">sf</span><span class="o">);</span> <span class="c1">// returns true</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="metrics.html" class="btn btn-neutral float-right" title="17. GeoMesa Metrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="convert/parsing_and_validation.html" class="btn btn-neutral" title="15.11. Parsing and Validation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2017 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.4-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../_static/sphinx_tabs/tabs.js"></script>
      <script type="text/javascript" src="../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>