<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>12.2. Processors &mdash; GeoMesa 3.5.1 Manuals</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/nifi/processors.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12.3. Converter Processors" href="converters.html" />
    <link rel="prev" title="12.1. Installation" href="install.html" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53087457-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53087457-1');
</script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                4.0.0-SNAPSHOT
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">12. GeoMesa NiFi Bundle</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">12.1. Installation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">12.2. Processors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#records-converters-and-avro">12.2.1. Records, Converters, and Avro</a></li>
<li class="toctree-l4"><a class="reference internal" href="#common-configuration">12.2.2. Common Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="converters.html">12.3. Converter Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="records.html">12.4. Record Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="avro.html">12.5. Avro Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="updates.html">12.6. Record Update Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="datastores.html">12.7. Data Store Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingress.html">12.8. Ingress Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="conversions.html">12.9. Conversion Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="integrations.html">12.10. Cloud Provider Integrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html">12.11. Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">15. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">17. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">18. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">19. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">20. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">23. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">12. </span>GeoMesa NiFi Bundle</a></li>
      <li class="breadcrumb-item active"><span class="section-number">12.2. </span>Processors</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="processors">
<h1><span class="section-number">12.2. </span>Processors<a class="headerlink" href="#processors" title="Permalink to this headline">¶</a></h1>
<p>GeoMesa NiFi provides several processors:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Processor</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PutGeoMesa</span></code></p></td>
<td><p>Ingest data into a GeoMesa data store using a GeoMesa converter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PutGeoMesaRecord</span></code></p></td>
<td><p>Ingest data into a GeoMesa data store using the NiFi record API</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AvroToPutGeoMesa</span></code></p></td>
<td><p>Ingest GeoAvro files into a GeoMesa data store</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">UpdateGeoMesaRecord</span></code></p></td>
<td><p>Update existing records in a GeoMesa data store using the NiFi
record API</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GetGeoMesaKafkaRecord</span></code></p></td>
<td><p>Read GeoMesa Kafka messages and output them as NiFi records</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ConvertToGeoFile</span></code></p></td>
<td><p>Create files in a variety of geometry-enabled formats using a
GeoMesa converter</p></td>
</tr>
</tbody>
</table>
<p>Each processor (with the exception of <code class="docutils literal notranslate"><span class="pre">ConvertToGeoFile</span></code>) needs to be configured with a <code class="docutils literal notranslate"><span class="pre">DataStoreService</span></code>,
which will connect to the GeoMesa back-end data source (for example, HBase or Kafka). See
<a class="reference internal" href="datastores.html#nifi-datstore-services"><span class="std std-ref">Data Store Services</span></a> for the available services.</p>
<section id="records-converters-and-avro">
<h2><span class="section-number">12.2.1. </span>Records, Converters, and Avro<a class="headerlink" href="#records-converters-and-avro" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa provides three different ingest processors. They all write to the same data stores, but
they vary in how the input data is converted into GeoTools <code class="docutils literal notranslate"><span class="pre">SimpleFeatures</span></code> (which are necessary for ingest).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PutGeoMesa</span></code> processor uses the <a class="reference internal" href="../convert/index.html#converters"><span class="std std-ref">GeoMesa Converters</span></a> framework to define <code class="docutils literal notranslate"><span class="pre">SimpleFeatureTypes</span></code> and the mapping
from input files to <code class="docutils literal notranslate"><span class="pre">SimpleFeatures</span></code>. Converters can be re-used in the GeoMesa command-line tools and other
non-NiFi projects. See <a class="reference internal" href="converters.html"><span class="doc">Converter Processors</span></a> for details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PutGeoMesaRecord</span></code> processor uses the NiFi records API to define the input schema using a NiFi <code class="docutils literal notranslate"><span class="pre">RecordReader</span></code>.
Through <code class="docutils literal notranslate"><span class="pre">RecordReaders</span></code>, <code class="docutils literal notranslate"><span class="pre">SimpleFeatureTypes</span></code> can be managed in a centralized schema registry. Similarly, records
can be manipulated using standard NiFi processors before being passed to the GeoMesa processor. The use of standard
NiFi APIs greatly reduces the amount of GeoMesa-specific configuration required. See <a class="reference internal" href="records.html"><span class="doc">Record Processors</span></a>
for details.</p>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">AvroToPutGeoMesa</span></code> processor will ingest GeoMesa-specific GeoAvro files without any configuration.
GeoAvro is a special Avro file that has <code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> metadata included. It can be produced using the
GeoMesa command-line tools export in <code class="docutils literal notranslate"><span class="pre">avro</span></code> format, the <code class="docutils literal notranslate"><span class="pre">ConvertToGeoFile</span></code> processor, the
<code class="docutils literal notranslate"><span class="pre">GeoAvroRecordSetWriterFactory</span></code> record writer factory, or directly through an instance of
<code class="docutils literal notranslate"><span class="pre">org.locationtech.geomesa.features.avro.io.AvroDataFileWriter</span></code>. GeoAvro is particularly useful because it is
self-describing. See <a class="reference internal" href="avro.html"><span class="doc">Avro Processors</span></a> for details.</p>
</section>
<section id="common-configuration">
<h2><span class="section-number">12.2.2. </span>Common Configuration<a class="headerlink" href="#common-configuration" title="Permalink to this headline">¶</a></h2>
<p>All types of input processors have some common configuration parameters for controlling data store writes:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DataStore</span> <span class="pre">Service</span></code></p></td>
<td><p>Controller service to manage the GeoMesa data store being used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Write</span> <span class="pre">Mode</span></code></p></td>
<td><p>Use an appending writer (for new features) or a modifying writer (to update existing
features)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Identifying</span> <span class="pre">Attribute</span></code></p></td>
<td><p>When using a modifying writer, the attribute used to uniquely identify the feature.
If not specified, will use the feature ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Schema</span> <span class="pre">Compatibility</span></code></p></td>
<td><p>Controls how differences between the configured schema and the existing schema in the
data store (if any) will be handled.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Existing</span></code> will use the existing schema and drop any additional fields in the
configured schema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Update</span></code> will update the existing schema to match the configured schema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exact</span></code> requires the configured schema to  match the existing schema.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FeatureWriterCaching</span></code></p></td>
<td><p>Enable caching of feature writers between flow files, useful if flow files have a
small number of records (see below)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FeatureWriterCacheTimeout</span></code></p></td>
<td><p>How often feature writers will be flushed to the data store, if caching is enabled</p></td>
</tr>
</tbody>
</table>
<section id="feature-writer-caching">
<h3><span class="section-number">12.2.2.1. </span>Feature Writer Caching<a class="headerlink" href="#feature-writer-caching" title="Permalink to this headline">¶</a></h3>
<p>Feature writer caching can be used to improve the throughput of processing many small flow files. Instead of a new
feature writer being created for each flow file, writers are cached and re-used between operations. If a writer is
idle for the configured timeout, then it will be flushed to the data store and closed.</p>
<p>Note that if feature writer caching is enabled, features that are processed may not show up in the data store
immediately. In addition, any features that have been processed but not flushed may be lost if NiFi shuts down
unexpectedly. To ensure data is properly flushed, stop the processor before shutting down NiFi.</p>
<p>Alternatively, NiFi’s built-in <code class="docutils literal notranslate"><span class="pre">MergeContent</span></code> processor can be used to batch up small files.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="install.html" class="btn btn-neutral float-left" title="12.1. Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="converters.html" class="btn btn-neutral float-right" title="12.3. Converter Processors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2023 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/nifi/processors.rst">GitHub <img src="../../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53087457-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-53087457-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>