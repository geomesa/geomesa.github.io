

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12.11. Examples &mdash; GeoMesa 3.4.1 Manuals</title>
  

  
  
  
  
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/nifi/examples.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="13. GeoMesa Processes" href="../process.html" />
    <link rel="prev" title="12.10. Cloud Provider Integrations" href="integrations.html" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53087457-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53087457-1');
</script>



  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                3.5.0-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">2. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">4. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">5. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">6. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">12. GeoMesa NiFi Bundle</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">12.1. Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="processors.html">12.2. Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="converters.html">12.3. Converter Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="records.html">12.4. Record Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="avro.html">12.5. Avro Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="updates.html">12.6. Record Update Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="datastores.html">12.7. DataStore Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingress.html">12.8. Ingress Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="conversions.html">12.9. Conversion Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="integrations.html">12.10. Cloud Provider Integrations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">12.11. Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ingest-a-geomesa-kafka-topic-into-hbase">12.11.1. Ingest a GeoMesa Kafka Topic into HBase</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">14. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accumulo/index.html">15. Accumulo Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bigtable/index.html">17. Bigtable Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">18. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">19. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">20. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kudu/index.html">21. Kudu Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">22. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">23. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">24. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geojson.html">25. GeoMesa GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">26. GeoMesa Stream Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">27. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Manual</a> &raquo;</li>
        
          <li><a href="index.html">12. GeoMesa NiFi Bundle</a> &raquo;</li>
        
      <li>12.11. Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1>12.11. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ingest-a-geomesa-kafka-topic-into-hbase">
<h2>12.11.1. Ingest a GeoMesa Kafka Topic into HBase<a class="headerlink" href="#ingest-a-geomesa-kafka-topic-into-hbase" title="Permalink to this headline">¶</a></h2>
<p>A common use case is to store the most recent state of an object in a GeoMesa Kafka data store to drive a live map
view, and to persist every state of the object into long-term storage in HBase or Accumulo for history and
analytics. This example will show how to pull data off a GeoMesa Kafka topic, and persist it in HBase with
minimal configuration.</p>
<div class="section" id="install-the-geomesa-nars">
<h3>12.11.1.1. Install the GeoMesa NARs<a class="headerlink" href="#install-the-geomesa-nars" title="Permalink to this headline">¶</a></h3>
<p>Follow the steps under <a class="reference internal" href="install.html#nifi-install"><span class="std std-ref">Installation</span></a> to install the GeoMesa processors in your NiFi instance. This
tutorial requires the GeoMesa Kafka and HBase NARs, as well as the standard GeoMesa service NARs.</p>
</div>
<div class="section" id="add-and-configure-the-processors">
<h3>12.11.1.2. Add and Configure the Processors<a class="headerlink" href="#add-and-configure-the-processors" title="Permalink to this headline">¶</a></h3>
<p>The first step is to add two processors to your flow, a <code class="docutils literal notranslate"><span class="pre">GetGeoMesaKafkaRecord</span></code> processor and an
<code class="docutils literal notranslate"><span class="pre">AvroToPutGeoMesaHBase</span></code> processor. Connect the output of the <code class="docutils literal notranslate"><span class="pre">Get</span></code> processor to the input of the <code class="docutils literal notranslate"><span class="pre">Put</span></code>
processor:</p>
<img alt="../../_images/nifi-kafka-to-hbase-flow.png" class="align-center" src="../../_images/nifi-kafka-to-hbase-flow.png" />
<p>For a robust system, you would want to add further processing for handling successes and failures. For
this example, just auto-terminate all other connections for simplicity.</p>
<p>Next, create a new controller service by clicking ‘Configure’ on the NiFi flow, then going to the Controller
Services tab and clicking the <code class="docutils literal notranslate"><span class="pre">+</span></code> button, then selecting the <code class="docutils literal notranslate"><span class="pre">GeoAvroRecordSetWriterFactory</span></code>. The
<code class="docutils literal notranslate"><span class="pre">GeoAvroRecordSetWriterFactory</span></code> can be left with its default configuration, which is to use NiFi expressions.
The <code class="docutils literal notranslate"><span class="pre">GetGeoMesaKafkaRecord</span></code> processor will populate the necessary attributes according to the feature type
being read:</p>
<img alt="../../_images/nifi-avro-record-writer-config.png" class="align-center" src="../../_images/nifi-avro-record-writer-config.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">GetGeoMesaKafkaRecord</span></code> processor will pull data off of the GeoMesa Kafka topic and write it out using
a NiFi record writer. The processor can output data in any format supported by the NiFi records API, but for
this example we’re going to use GeoAvro to simplify the ingest into HBase. Configure the processor by
setting the appropriate Kafka connection parameters and setting the <code class="docutils literal notranslate"><span class="pre">GeoAvroRecordWriterFactory</span></code> you just
created for the output. Set a unique Kafka group ID, to ensure that the processor reads all the data coming
from the topic:</p>
<img alt="../../_images/nifi-get-kafka-record-config.png" class="align-center" src="../../_images/nifi-get-kafka-record-config.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">AvroToPutGeoMesaHBase</span></code> processor will read most the necessary configuration from the GeoAvro file, but
you still need to configure it with the <code class="docutils literal notranslate"><span class="pre">hbase-site.xml</span></code> file for your cluster, which will let it connect to HBase,
and a catalog table, which is where it will write out data:</p>
<img alt="../../_images/nifi-avro-to-hbase-config.png" class="align-center" src="../../_images/nifi-avro-to-hbase-config.png" />
<p>Once all the processors and controller services are configured, enable them in the NiFi UI. If everything
goes correctly, you’ll start seeing your Kafka data show up in HBase.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../process.html" class="btn btn-neutral float-right" title="13. GeoMesa Processes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="integrations.html" class="btn btn-neutral" title="12.10. Cloud Provider Integrations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2021 <a href="https://www.ccri.com/">Commonwealth Computer Research, Inc.</a>
    <br/>
    Licensed under the <a href="http://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    
    - view <a href="../../_sources/user/nifi/examples.rst.txt" rel="nofollow">page source</a>
    
  </p>
</div>



</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../_static/copybutton.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>