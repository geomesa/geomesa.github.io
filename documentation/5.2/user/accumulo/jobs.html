<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14.7. GeoMesa Jobs &mdash; GeoMesa 5.2.2 Manuals</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="canonical" href="https://www.geomesa.org/documentation/user/accumulo/jobs.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="14.8. Atomic Write Operations" href="atomic_writes.html" />
    <link rel="prev" title="14.6. Accumulo Index Configuration" href="index_config.html" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          </a>
              <div class="version">
                5.2.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">2. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html">3. Versions and Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">4. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">5. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geotools.html">6. GeoTools Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastores/index.html">7. GeoMesa Data Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/index.html">8. Command-Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../convert/index.html">9. GeoMesa Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geoserver.html">10. GeoServer Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spark/index.html">11. GeoMesa Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/index.html">12. GeoMesa NiFi Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../process.html">13. GeoMesa Processes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">14. Accumulo Data Store</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">14.1. Installing GeoMesa Accumulo</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">14.2. Accumulo Data Store Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html">14.3. Using the Accumulo Data Store in GeoServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandline.html">14.4. Accumulo Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">14.5. Accumulo Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_config.html">14.6. Accumulo Index Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">14.7. GeoMesa Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#building-instructions">14.7.1. Building Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geomesa-input-and-output-formats">14.7.2. GeoMesa Input and Output Formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#map-reduce-jobs">14.7.3. Map/Reduce Jobs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="atomic_writes.html">14.8. Atomic Write Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="kerberos.html">14.9. Kerberos</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html">14.10. Command Line Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hbase/index.html">15. HBase Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra/index.html">16. Cassandra Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../postgis/index.html">17. Partitioned PostGIS Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kafka/index.html">18. Kafka Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/index.html">19. Redis Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem/index.html">20. FileSystem Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lambda/index.html">21. Lambda Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds_views.html">22. Combined Data Store Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade.html">23. Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoMesa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">14. </span>Accumulo Data Store</a></li>
      <li class="breadcrumb-item active"><span class="section-number">14.7. </span>GeoMesa Jobs</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geomesa-jobs">
<h1><span class="section-number">14.7. </span>GeoMesa Jobs<a class="headerlink" href="#geomesa-jobs" title="Permalink to this headline">¶</a></h1>
<p>This project (<code class="docutils literal notranslate"><span class="pre">geomesa-accumulo/geomesa-accumulo-jobs</span></code> in the source distribution) contains Map-Reduce
jobs for maintaining GeoMesa Accumulo.</p>
<section id="building-instructions">
<h2><span class="section-number">14.7.1. </span>Building Instructions<a class="headerlink" href="#building-instructions" title="Permalink to this headline">¶</a></h2>
<p>If you wish to build <code class="docutils literal notranslate"><span class="pre">geomesa-accumulo-jobs</span></code> separately, you can with Maven:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mvn<span class="w"> </span>clean<span class="w"> </span>install<span class="w"> </span>-pl<span class="w"> </span>geomesa-accumulo/geomesa-accumulo-jobs<span class="w"> </span>-am
</pre></div>
</div>
</section>
<section id="geomesa-input-and-output-formats">
<h2><span class="section-number">14.7.2. </span>GeoMesa Input and Output Formats<a class="headerlink" href="#geomesa-input-and-output-formats" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa provides input and output formats that can be used in Hadoop
map/reduce jobs. The input/output formats can be used directly in Scala,
or there are Java interfaces under the <code class="docutils literal notranslate"><span class="pre">interop</span></code> package.</p>
<p>There are sample jobs provided that can be used as templates for more
complex operations. These are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">org</span><span class="o">.</span><span class="n">locationtech</span><span class="o">.</span><span class="n">geomesa</span><span class="o">.</span><span class="n">accumulo</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">mapreduce</span><span class="o">.</span><span class="n">interop</span><span class="o">.</span><span class="n">FeatureCountJob</span>
<span class="n">org</span><span class="o">.</span><span class="n">locationtech</span><span class="o">.</span><span class="n">geomesa</span><span class="o">.</span><span class="n">accumulo</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">mapreduce</span><span class="o">.</span><span class="n">interop</span><span class="o">.</span><span class="n">FeatureWriterJob</span>
</pre></div>
</div>
<section id="geomesaaccumuloinputformat">
<h3><span class="section-number">14.7.2.1. </span>GeoMesaAccumuloInputFormat<a class="headerlink" href="#geomesaaccumuloinputformat" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GeoMesaAccumuloInputFormat</span></code> can be used to get <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code>s into
your jobs directly from GeoMesa.</p>
<p>Use the static <code class="docutils literal notranslate"><span class="pre">configure</span></code> method to set up your job. You need to
provide it with a map of connection parameters, which will be used to
retrieve the GeoTools DataStore. You also need to provide a feature type
name. Optionally, you can provide a CQL filter, which will be used to
select a subset of features in your store.</p>
<p>The key provided to your mapper with be a <code class="docutils literal notranslate"><span class="pre">Text</span></code> with the
<code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> ID. The value will be the <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code>.</p>
</section>
<section id="geomesaoutputformat">
<h3><span class="section-number">14.7.2.2. </span>GeoMesaOutputFormat<a class="headerlink" href="#geomesaoutputformat" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GeoMesaOutputFormat</span></code> can be used to write <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code>s
back into GeoMesa.</p>
<p>Use the static <code class="docutils literal notranslate"><span class="pre">setOutput</span></code> method to set up your job. You need to
provide it with a map of connection parameters, which will be used to
retrieve the GeoTools <code class="docutils literal notranslate"><span class="pre">DataStore</span></code>.</p>
<p>The key you output does not matter, and will be ignored. The value
should be a <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> that you wish to write. If the
<code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code> associated with the <code class="docutils literal notranslate"><span class="pre">SimpleFeature</span></code> does not yet
exist in GeoMesa, it will be created for you. You may write different
<code class="docutils literal notranslate"><span class="pre">SimpleFeatureType</span></code>s, in a single job, if desired.</p>
</section>
</section>
<section id="map-reduce-jobs">
<h2><span class="section-number">14.7.3. </span>Map/Reduce Jobs<a class="headerlink" href="#map-reduce-jobs" title="Permalink to this headline">¶</a></h2>
<p>The following instructions require that you use the <code class="docutils literal notranslate"><span class="pre">-libjars</span></code> argument to ensure the correct JARs
are available on the distributed classpath.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the following examples, replace <code class="docutils literal notranslate"><span class="pre">${VERSION}</span></code> with the appropriate Scala plus GeoMesa versions
(e.g. <code class="docutils literal notranslate"><span class="pre">2.12-5.2.2</span></code>).</p>
</div>
<section id="attribute-indexing">
<span id="attribute-indexing-job"></span><h3><span class="section-number">14.7.3.1. </span>Attribute Indexing<a class="headerlink" href="#attribute-indexing" title="Permalink to this headline">¶</a></h3>
<p>GeoMesa provides indexing on attributes to improve certain queries. You
can indicate attributes that should be indexed when you create your
schema (simple feature type). If you decide later on that you would like
to index additional attributes, you can use the attribute indexing job.
You only need to run this job once; the job will create attribute indices
for each attribute listed in <code class="docutils literal notranslate"><span class="pre">--geomesa.index.attributes</span></code>.</p>
<p>The job can be invoked through Yarn as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>geomesa-accumulo$<span class="w"> </span>yarn<span class="w"> </span>jar<span class="w"> </span>geomesa-accumulo-jobs/target/geomesa-accumulo-jobs_<span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span>.jar<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>org.locationtech.geomesa.accumulo.jobs.index.AttributeIndexJob<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.instanceId<span class="w"> </span>&lt;instance&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.zookeepers<span class="w"> </span>&lt;zookeepers&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.user<span class="w"> </span>&lt;user&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.password<span class="w"> </span>&lt;pwd&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.tableName<span class="w"> </span>&lt;catalog-table&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.feature<span class="w"> </span>&lt;feature&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.index.coverage<span class="w"> </span>&lt;full<span class="p">|</span>join&gt;<span class="w"> </span><span class="se">\ </span><span class="c1"># optional attribute</span>
<span class="w">    </span>--geomesa.index.attributes<span class="w"> </span>&lt;attributes<span class="w"> </span>to<span class="w"> </span>index<span class="w"> </span>-<span class="w"> </span>space<span class="w"> </span>separated&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will also need to include an extensive <code class="docutils literal notranslate"><span class="pre">-libjars</span></code> argument with all dependent JARs.</p>
</div>
</section>
<section id="updating-existing-data-to-the-latest-index-format">
<span id="update-index-format-job"></span><h3><span class="section-number">14.7.3.2. </span>Updating Existing Data to the Latest Index Format<a class="headerlink" href="#updating-existing-data-to-the-latest-index-format" title="Permalink to this headline">¶</a></h3>
<p>The indexing in GeoMesa is constantly being improved. We strive to maintain
backwards compatibility, but old data can’t always take advantage of the
improvements we make. However, old data can be updated through the
<code class="docutils literal notranslate"><span class="pre">SchemaCopyJob</span></code>. This will copy it to a new table (or feature name),
rewriting all the data using the latest codebase. Once the data is
updated, you can drop the old tables and rename the new tables back to
the original names.</p>
<p>The job can be invoked through Yarn as follows (JAR version may vary
slightly):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>geomesa-accumulo$<span class="w"> </span>yarn<span class="w"> </span>jar<span class="w"> </span>geomesa-accumulo-jobs/target/geomesa-accumulo-jobs_<span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span>.jar<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>org.locationtech.geomesa.accumulo.jobs.index.SchemaCopyJob<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.instanceId<span class="w"> </span>&lt;instance&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.output.instanceId<span class="w"> </span>&lt;instance&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.zookeepers<span class="w"> </span>&lt;zookeepers&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.output.zookeepers<span class="w"> </span>&lt;zookeepers&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.user<span class="w"> </span>&lt;user&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.output.user<span class="w"> </span>&lt;user&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.password<span class="w"> </span>&lt;pwd&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.output.password<span class="w"> </span>&lt;pwd&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.tableName<span class="w"> </span>&lt;catalog-table&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.output.tableName<span class="w"> </span>&lt;new-catalog-table&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.feature<span class="w"> </span>&lt;feature&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.output.feature<span class="w"> </span>&lt;feature&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--geomesa.input.cql<span class="w"> </span>&lt;options<span class="w"> </span>cql<span class="w"> </span>filter<span class="w"> </span><span class="k">for</span><span class="w"> </span>input<span class="w"> </span>features&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will also need to include an extensive <code class="docutils literal notranslate"><span class="pre">-libjars</span></code> argument with all dependent JARs.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index_config.html" class="btn btn-neutral float-left" title="14.6. Accumulo Index Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="atomic_writes.html" class="btn btn-neutral float-right" title="14.8. Atomic Write Operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<div role="contentinfo">
  <p>
    &copy; Copyright 2013-2025 <a href="https://www.ga-ccri.com/">General Atomics</a>
    <br/>
    Licensed under the <a href="https://www.opensource.org/licenses/apache2.0.php">Apache License, Version 2.0</a>
  </p>
</div>

<div role="contentinfo">
  <p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
    using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>
    - contribute to this page on
    <a href="https://github.com/locationtech/geomesa/edit/main/docs/user/accumulo/jobs.rst">GitHub <img src="../../_static/launch.svg"/></a>
  </p>

</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>